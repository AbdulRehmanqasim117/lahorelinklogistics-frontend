function Vx(u,m){for(var f=0;f<m.length;f++){const y=m[f];if(typeof y!="string"&&!Array.isArray(y)){for(const C in y)if(C!=="default"&&!(C in u)){const w=Object.getOwnPropertyDescriptor(y,C);w&&Object.defineProperty(u,C,w.get?w:{enumerable:!0,get:()=>y[C]})}}}return Object.freeze(Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}))}(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const C of document.querySelectorAll('link[rel="modulepreload"]'))y(C);new MutationObserver(C=>{for(const w of C)if(w.type==="childList")for(const E of w.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&y(E)}).observe(document,{childList:!0,subtree:!0});function f(C){const w={};return C.integrity&&(w.integrity=C.integrity),C.referrerPolicy&&(w.referrerPolicy=C.referrerPolicy),C.crossOrigin==="use-credentials"?w.credentials="include":C.crossOrigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function y(C){if(C.ep)return;C.ep=!0;const w=f(C);fetch(C.href,w)}})();var Sc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zc(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var zu={exports:{}},Jl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I1;function Gg(){if(I1)return Jl;I1=1;var u=Symbol.for("react.transitional.element"),m=Symbol.for("react.fragment");function f(y,C,w){var E=null;if(w!==void 0&&(E=""+w),C.key!==void 0&&(E=""+C.key),"key"in C){w={};for(var T in C)T!=="key"&&(w[T]=C[T])}else w=C;return C=w.ref,{$$typeof:u,type:y,key:E,ref:C!==void 0?C:null,props:w}}return Jl.Fragment=m,Jl.jsx=f,Jl.jsxs=f,Jl}var M1;function Xg(){return M1||(M1=1,zu.exports=Gg()),zu.exports}var s=Xg(),Hu={exports:{}},lt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k1;function Yg(){if(k1)return lt;k1=1;var u=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),E=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),R=Symbol.iterator;function z(X){return X===null||typeof X!="object"?null:(X=R&&X[R]||X["@@iterator"],typeof X=="function"?X:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,Z={};function ne(X,se,Ee){this.props=X,this.context=se,this.refs=Z,this.updater=Ee||P}ne.prototype.isReactComponent={},ne.prototype.setState=function(X,se){if(typeof X!="object"&&typeof X!="function"&&X!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,X,se,"setState")},ne.prototype.forceUpdate=function(X){this.updater.enqueueForceUpdate(this,X,"forceUpdate")};function Y(){}Y.prototype=ne.prototype;function q(X,se,Ee){this.props=X,this.context=se,this.refs=Z,this.updater=Ee||P}var oe=q.prototype=new Y;oe.constructor=q,F(oe,ne.prototype),oe.isPureReactComponent=!0;var Q=Array.isArray;function te(){}var K={H:null,A:null,T:null,S:null},Te=Object.prototype.hasOwnProperty;function re(X,se,Ee){var ye=Ee.ref;return{$$typeof:u,type:X,key:se,ref:ye!==void 0?ye:null,props:Ee}}function le(X,se){return re(X.type,se,X.props)}function Oe(X){return typeof X=="object"&&X!==null&&X.$$typeof===u}function $(X){var se={"=":"=0",":":"=2"};return"$"+X.replace(/[=:]/g,function(Ee){return se[Ee]})}var ve=/\/+/g;function Ne(X,se){return typeof X=="object"&&X!==null&&X.key!=null?$(""+X.key):se.toString(36)}function M(X){switch(X.status){case"fulfilled":return X.value;case"rejected":throw X.reason;default:switch(typeof X.status=="string"?X.then(te,te):(X.status="pending",X.then(function(se){X.status==="pending"&&(X.status="fulfilled",X.value=se)},function(se){X.status==="pending"&&(X.status="rejected",X.reason=se)})),X.status){case"fulfilled":return X.value;case"rejected":throw X.reason}}throw X}function L(X,se,Ee,ye,Ue){var Re=typeof X;(Re==="undefined"||Re==="boolean")&&(X=null);var Ge=!1;if(X===null)Ge=!0;else switch(Re){case"bigint":case"string":case"number":Ge=!0;break;case"object":switch(X.$$typeof){case u:case m:Ge=!0;break;case A:return Ge=X._init,L(Ge(X._payload),se,Ee,ye,Ue)}}if(Ge)return Ue=Ue(X),Ge=ye===""?"."+Ne(X,0):ye,Q(Ue)?(Ee="",Ge!=null&&(Ee=Ge.replace(ve,"$&/")+"/"),L(Ue,se,Ee,"",function(ns){return ns})):Ue!=null&&(Oe(Ue)&&(Ue=le(Ue,Ee+(Ue.key==null||X&&X.key===Ue.key?"":(""+Ue.key).replace(ve,"$&/")+"/")+Ge)),se.push(Ue)),1;Ge=0;var et=ye===""?".":ye+":";if(Q(X))for(var ct=0;ct<X.length;ct++)ye=X[ct],Re=et+Ne(ye,ct),Ge+=L(ye,se,Ee,Re,Ue);else if(ct=z(X),typeof ct=="function")for(X=ct.call(X),ct=0;!(ye=X.next()).done;)ye=ye.value,Re=et+Ne(ye,ct++),Ge+=L(ye,se,Ee,Re,Ue);else if(Re==="object"){if(typeof X.then=="function")return L(M(X),se,Ee,ye,Ue);throw se=String(X),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(X).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return Ge}function U(X,se,Ee){if(X==null)return X;var ye=[],Ue=0;return L(X,ye,"","",function(Re){return se.call(Ee,Re,Ue++)}),ye}function V(X){if(X._status===-1){var se=X._result;se=se(),se.then(function(Ee){(X._status===0||X._status===-1)&&(X._status=1,X._result=Ee)},function(Ee){(X._status===0||X._status===-1)&&(X._status=2,X._result=Ee)}),X._status===-1&&(X._status=0,X._result=se)}if(X._status===1)return X._result.default;throw X._result}var fe=typeof reportError=="function"?reportError:function(X){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof X=="object"&&X!==null&&typeof X.message=="string"?String(X.message):String(X),error:X});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",X);return}console.error(X)},he={map:U,forEach:function(X,se,Ee){U(X,function(){se.apply(this,arguments)},Ee)},count:function(X){var se=0;return U(X,function(){se++}),se},toArray:function(X){return U(X,function(se){return se})||[]},only:function(X){if(!Oe(X))throw Error("React.Children.only expected to receive a single React element child.");return X}};return lt.Activity=O,lt.Children=he,lt.Component=ne,lt.Fragment=f,lt.Profiler=C,lt.PureComponent=q,lt.StrictMode=y,lt.Suspense=N,lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=K,lt.__COMPILER_RUNTIME={__proto__:null,c:function(X){return K.H.useMemoCache(X)}},lt.cache=function(X){return function(){return X.apply(null,arguments)}},lt.cacheSignal=function(){return null},lt.cloneElement=function(X,se,Ee){if(X==null)throw Error("The argument must be a React element, but you passed "+X+".");var ye=F({},X.props),Ue=X.key;if(se!=null)for(Re in se.key!==void 0&&(Ue=""+se.key),se)!Te.call(se,Re)||Re==="key"||Re==="__self"||Re==="__source"||Re==="ref"&&se.ref===void 0||(ye[Re]=se[Re]);var Re=arguments.length-2;if(Re===1)ye.children=Ee;else if(1<Re){for(var Ge=Array(Re),et=0;et<Re;et++)Ge[et]=arguments[et+2];ye.children=Ge}return re(X.type,Ue,ye)},lt.createContext=function(X){return X={$$typeof:E,_currentValue:X,_currentValue2:X,_threadCount:0,Provider:null,Consumer:null},X.Provider=X,X.Consumer={$$typeof:w,_context:X},X},lt.createElement=function(X,se,Ee){var ye,Ue={},Re=null;if(se!=null)for(ye in se.key!==void 0&&(Re=""+se.key),se)Te.call(se,ye)&&ye!=="key"&&ye!=="__self"&&ye!=="__source"&&(Ue[ye]=se[ye]);var Ge=arguments.length-2;if(Ge===1)Ue.children=Ee;else if(1<Ge){for(var et=Array(Ge),ct=0;ct<Ge;ct++)et[ct]=arguments[ct+2];Ue.children=et}if(X&&X.defaultProps)for(ye in Ge=X.defaultProps,Ge)Ue[ye]===void 0&&(Ue[ye]=Ge[ye]);return re(X,Re,Ue)},lt.createRef=function(){return{current:null}},lt.forwardRef=function(X){return{$$typeof:T,render:X}},lt.isValidElement=Oe,lt.lazy=function(X){return{$$typeof:A,_payload:{_status:-1,_result:X},_init:V}},lt.memo=function(X,se){return{$$typeof:v,type:X,compare:se===void 0?null:se}},lt.startTransition=function(X){var se=K.T,Ee={};K.T=Ee;try{var ye=X(),Ue=K.S;Ue!==null&&Ue(Ee,ye),typeof ye=="object"&&ye!==null&&typeof ye.then=="function"&&ye.then(te,fe)}catch(Re){fe(Re)}finally{se!==null&&Ee.types!==null&&(se.types=Ee.types),K.T=se}},lt.unstable_useCacheRefresh=function(){return K.H.useCacheRefresh()},lt.use=function(X){return K.H.use(X)},lt.useActionState=function(X,se,Ee){return K.H.useActionState(X,se,Ee)},lt.useCallback=function(X,se){return K.H.useCallback(X,se)},lt.useContext=function(X){return K.H.useContext(X)},lt.useDebugValue=function(){},lt.useDeferredValue=function(X,se){return K.H.useDeferredValue(X,se)},lt.useEffect=function(X,se){return K.H.useEffect(X,se)},lt.useEffectEvent=function(X){return K.H.useEffectEvent(X)},lt.useId=function(){return K.H.useId()},lt.useImperativeHandle=function(X,se,Ee){return K.H.useImperativeHandle(X,se,Ee)},lt.useInsertionEffect=function(X,se){return K.H.useInsertionEffect(X,se)},lt.useLayoutEffect=function(X,se){return K.H.useLayoutEffect(X,se)},lt.useMemo=function(X,se){return K.H.useMemo(X,se)},lt.useOptimistic=function(X,se){return K.H.useOptimistic(X,se)},lt.useReducer=function(X,se,Ee){return K.H.useReducer(X,se,Ee)},lt.useRef=function(X){return K.H.useRef(X)},lt.useState=function(X){return K.H.useState(X)},lt.useSyncExternalStore=function(X,se,Ee){return K.H.useSyncExternalStore(X,se,Ee)},lt.useTransition=function(){return K.H.useTransition()},lt.version="19.2.0",lt}var B1;function lo(){return B1||(B1=1,Hu.exports=Yg()),Hu.exports}var D=lo();const al=zc(D),qg=Vx({__proto__:null,default:al},[D]);var Vu={exports:{}},$l={},Gu={exports:{}},Xu={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L1;function Kg(){return L1||(L1=1,(function(u){function m(L,U){var V=L.length;L.push(U);e:for(;0<V;){var fe=V-1>>>1,he=L[fe];if(0<C(he,U))L[fe]=U,L[V]=he,V=fe;else break e}}function f(L){return L.length===0?null:L[0]}function y(L){if(L.length===0)return null;var U=L[0],V=L.pop();if(V!==U){L[0]=V;e:for(var fe=0,he=L.length,X=he>>>1;fe<X;){var se=2*(fe+1)-1,Ee=L[se],ye=se+1,Ue=L[ye];if(0>C(Ee,V))ye<he&&0>C(Ue,Ee)?(L[fe]=Ue,L[ye]=V,fe=ye):(L[fe]=Ee,L[se]=V,fe=se);else if(ye<he&&0>C(Ue,V))L[fe]=Ue,L[ye]=V,fe=ye;else break e}}return U}function C(L,U){var V=L.sortIndex-U.sortIndex;return V!==0?V:L.id-U.id}if(u.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var w=performance;u.unstable_now=function(){return w.now()}}else{var E=Date,T=E.now();u.unstable_now=function(){return E.now()-T}}var N=[],v=[],A=1,O=null,R=3,z=!1,P=!1,F=!1,Z=!1,ne=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;function oe(L){for(var U=f(v);U!==null;){if(U.callback===null)y(v);else if(U.startTime<=L)y(v),U.sortIndex=U.expirationTime,m(N,U);else break;U=f(v)}}function Q(L){if(F=!1,oe(L),!P)if(f(N)!==null)P=!0,te||(te=!0,$());else{var U=f(v);U!==null&&M(Q,U.startTime-L)}}var te=!1,K=-1,Te=5,re=-1;function le(){return Z?!0:!(u.unstable_now()-re<Te)}function Oe(){if(Z=!1,te){var L=u.unstable_now();re=L;var U=!0;try{e:{P=!1,F&&(F=!1,Y(K),K=-1),z=!0;var V=R;try{t:{for(oe(L),O=f(N);O!==null&&!(O.expirationTime>L&&le());){var fe=O.callback;if(typeof fe=="function"){O.callback=null,R=O.priorityLevel;var he=fe(O.expirationTime<=L);if(L=u.unstable_now(),typeof he=="function"){O.callback=he,oe(L),U=!0;break t}O===f(N)&&y(N),oe(L)}else y(N);O=f(N)}if(O!==null)U=!0;else{var X=f(v);X!==null&&M(Q,X.startTime-L),U=!1}}break e}finally{O=null,R=V,z=!1}U=void 0}}finally{U?$():te=!1}}}var $;if(typeof q=="function")$=function(){q(Oe)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,Ne=ve.port2;ve.port1.onmessage=Oe,$=function(){Ne.postMessage(null)}}else $=function(){ne(Oe,0)};function M(L,U){K=ne(function(){L(u.unstable_now())},U)}u.unstable_IdlePriority=5,u.unstable_ImmediatePriority=1,u.unstable_LowPriority=4,u.unstable_NormalPriority=3,u.unstable_Profiling=null,u.unstable_UserBlockingPriority=2,u.unstable_cancelCallback=function(L){L.callback=null},u.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Te=0<L?Math.floor(1e3/L):5},u.unstable_getCurrentPriorityLevel=function(){return R},u.unstable_next=function(L){switch(R){case 1:case 2:case 3:var U=3;break;default:U=R}var V=R;R=U;try{return L()}finally{R=V}},u.unstable_requestPaint=function(){Z=!0},u.unstable_runWithPriority=function(L,U){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var V=R;R=L;try{return U()}finally{R=V}},u.unstable_scheduleCallback=function(L,U,V){var fe=u.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?fe+V:fe):V=fe,L){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=V+he,L={id:A++,callback:U,priorityLevel:L,startTime:V,expirationTime:he,sortIndex:-1},V>fe?(L.sortIndex=V,m(v,L),f(N)===null&&L===f(v)&&(F?(Y(K),K=-1):F=!0,M(Q,V-fe))):(L.sortIndex=he,m(N,L),P||z||(P=!0,te||(te=!0,$()))),L},u.unstable_shouldYield=le,u.unstable_wrapCallback=function(L){var U=R;return function(){var V=R;R=U;try{return L.apply(this,arguments)}finally{R=V}}}})(Xu)),Xu}var P1;function Zg(){return P1||(P1=1,Gu.exports=Kg()),Gu.exports}var Yu={exports:{}},$s={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F1;function Wg(){if(F1)return $s;F1=1;var u=lo();function m(N){var v="https://react.dev/errors/"+N;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)v+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+N+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function f(){}var y={d:{f,r:function(){throw Error(m(522))},D:f,C:f,L:f,m:f,X:f,S:f,M:f},p:0,findDOMNode:null},C=Symbol.for("react.portal");function w(N,v,A){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:C,key:O==null?null:""+O,children:N,containerInfo:v,implementation:A}}var E=u.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function T(N,v){if(N==="font")return"";if(typeof v=="string")return v==="use-credentials"?v:""}return $s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=y,$s.createPortal=function(N,v){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v||v.nodeType!==1&&v.nodeType!==9&&v.nodeType!==11)throw Error(m(299));return w(N,v,null,A)},$s.flushSync=function(N){var v=E.T,A=y.p;try{if(E.T=null,y.p=2,N)return N()}finally{E.T=v,y.p=A,y.d.f()}},$s.preconnect=function(N,v){typeof N=="string"&&(v?(v=v.crossOrigin,v=typeof v=="string"?v==="use-credentials"?v:"":void 0):v=null,y.d.C(N,v))},$s.prefetchDNS=function(N){typeof N=="string"&&y.d.D(N)},$s.preinit=function(N,v){if(typeof N=="string"&&v&&typeof v.as=="string"){var A=v.as,O=T(A,v.crossOrigin),R=typeof v.integrity=="string"?v.integrity:void 0,z=typeof v.fetchPriority=="string"?v.fetchPriority:void 0;A==="style"?y.d.S(N,typeof v.precedence=="string"?v.precedence:void 0,{crossOrigin:O,integrity:R,fetchPriority:z}):A==="script"&&y.d.X(N,{crossOrigin:O,integrity:R,fetchPriority:z,nonce:typeof v.nonce=="string"?v.nonce:void 0})}},$s.preinitModule=function(N,v){if(typeof N=="string")if(typeof v=="object"&&v!==null){if(v.as==null||v.as==="script"){var A=T(v.as,v.crossOrigin);y.d.M(N,{crossOrigin:A,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0})}}else v==null&&y.d.M(N)},$s.preload=function(N,v){if(typeof N=="string"&&typeof v=="object"&&v!==null&&typeof v.as=="string"){var A=v.as,O=T(A,v.crossOrigin);y.d.L(N,A,{crossOrigin:O,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0,type:typeof v.type=="string"?v.type:void 0,fetchPriority:typeof v.fetchPriority=="string"?v.fetchPriority:void 0,referrerPolicy:typeof v.referrerPolicy=="string"?v.referrerPolicy:void 0,imageSrcSet:typeof v.imageSrcSet=="string"?v.imageSrcSet:void 0,imageSizes:typeof v.imageSizes=="string"?v.imageSizes:void 0,media:typeof v.media=="string"?v.media:void 0})}},$s.preloadModule=function(N,v){if(typeof N=="string")if(v){var A=T(v.as,v.crossOrigin);y.d.m(N,{as:typeof v.as=="string"&&v.as!=="script"?v.as:void 0,crossOrigin:A,integrity:typeof v.integrity=="string"?v.integrity:void 0})}else y.d.m(N)},$s.requestFormReset=function(N){y.d.r(N)},$s.unstable_batchedUpdates=function(N,v){return N(v)},$s.useFormState=function(N,v,A){return E.H.useFormState(N,v,A)},$s.useFormStatus=function(){return E.H.useHostTransitionStatus()},$s.version="19.2.0",$s}var U1;function Gx(){if(U1)return Yu.exports;U1=1;function u(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u)}catch(m){console.error(m)}}return u(),Yu.exports=Wg(),Yu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z1;function Qg(){if(z1)return $l;z1=1;var u=Zg(),m=lo(),f=Gx();function y(e){var a="https://react.dev/errors/"+e;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)a+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function C(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function w(e){var a=e,i=e;if(e.alternate)for(;a.return;)a=a.return;else{e=a;do a=e,(a.flags&4098)!==0&&(i=a.return),e=a.return;while(e)}return a.tag===3?i:null}function E(e){if(e.tag===13){var a=e.memoizedState;if(a===null&&(e=e.alternate,e!==null&&(a=e.memoizedState)),a!==null)return a.dehydrated}return null}function T(e){if(e.tag===31){var a=e.memoizedState;if(a===null&&(e=e.alternate,e!==null&&(a=e.memoizedState)),a!==null)return a.dehydrated}return null}function N(e){if(w(e)!==e)throw Error(y(188))}function v(e){var a=e.alternate;if(!a){if(a=w(e),a===null)throw Error(y(188));return a!==e?null:e}for(var i=e,c=a;;){var x=i.return;if(x===null)break;var p=x.alternate;if(p===null){if(c=x.return,c!==null){i=c;continue}break}if(x.child===p.child){for(p=x.child;p;){if(p===i)return N(x),e;if(p===c)return N(x),a;p=p.sibling}throw Error(y(188))}if(i.return!==c.return)i=x,c=p;else{for(var S=!1,B=x.child;B;){if(B===i){S=!0,i=x,c=p;break}if(B===c){S=!0,c=x,i=p;break}B=B.sibling}if(!S){for(B=p.child;B;){if(B===i){S=!0,i=p,c=x;break}if(B===c){S=!0,c=p,i=x;break}B=B.sibling}if(!S)throw Error(y(189))}}if(i.alternate!==c)throw Error(y(190))}if(i.tag!==3)throw Error(y(188));return i.stateNode.current===i?e:a}function A(e){var a=e.tag;if(a===5||a===26||a===27||a===6)return e;for(e=e.child;e!==null;){if(a=A(e),a!==null)return a;e=e.sibling}return null}var O=Object.assign,R=Symbol.for("react.element"),z=Symbol.for("react.transitional.element"),P=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),Z=Symbol.for("react.strict_mode"),ne=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),q=Symbol.for("react.context"),oe=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),K=Symbol.for("react.memo"),Te=Symbol.for("react.lazy"),re=Symbol.for("react.activity"),le=Symbol.for("react.memo_cache_sentinel"),Oe=Symbol.iterator;function $(e){return e===null||typeof e!="object"?null:(e=Oe&&e[Oe]||e["@@iterator"],typeof e=="function"?e:null)}var ve=Symbol.for("react.client.reference");function Ne(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ve?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case F:return"Fragment";case ne:return"Profiler";case Z:return"StrictMode";case Q:return"Suspense";case te:return"SuspenseList";case re:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case P:return"Portal";case q:return e.displayName||"Context";case Y:return(e._context.displayName||"Context")+".Consumer";case oe:var a=e.render;return e=e.displayName,e||(e=a.displayName||a.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case K:return a=e.displayName||null,a!==null?a:Ne(e.type)||"Memo";case Te:a=e._payload,e=e._init;try{return Ne(e(a))}catch{}}return null}var M=Array.isArray,L=m.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=f.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},fe=[],he=-1;function X(e){return{current:e}}function se(e){0>he||(e.current=fe[he],fe[he]=null,he--)}function Ee(e,a){he++,fe[he]=e.current,e.current=a}var ye=X(null),Ue=X(null),Re=X(null),Ge=X(null);function et(e,a){switch(Ee(Re,a),Ee(Ue,e),Ee(ye,null),a.nodeType){case 9:case 11:e=(e=a.documentElement)&&(e=e.namespaceURI)?s1(e):0;break;default:if(e=a.tagName,a=a.namespaceURI)a=s1(a),e=a1(a,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}se(ye),Ee(ye,e)}function ct(){se(ye),se(Ue),se(Re)}function ns(e){e.memoizedState!==null&&Ee(Ge,e);var a=ye.current,i=a1(a,e.type);a!==i&&(Ee(Ue,e),Ee(ye,i))}function Dt(e){Ue.current===e&&(se(ye),se(Ue)),Ge.current===e&&(se(Ge),Kl._currentValue=V)}var Js,dt;function Ns(e){if(Js===void 0)try{throw Error()}catch(i){var a=i.stack.trim().match(/\n( *(at )?)/);Js=a&&a[1]||"",dt=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Js+e+dt}var Bs=!1;function us(e,a){if(!e||Bs)return"";Bs=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var Se=function(){throw Error()};if(Object.defineProperty(Se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Se,[])}catch(Ce){var pe=Ce}Reflect.construct(e,[],Se)}else{try{Se.call()}catch(Ce){pe=Ce}e.call(Se.prototype)}}else{try{throw Error()}catch(Ce){pe=Ce}(Se=e())&&typeof Se.catch=="function"&&Se.catch(function(){})}}catch(Ce){if(Ce&&pe&&typeof Ce.stack=="string")return[Ce.stack,pe.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=c.DetermineComponentFrameRoot(),S=p[0],B=p[1];if(S&&B){var W=S.split(`
`),ge=B.split(`
`);for(x=c=0;c<W.length&&!W[c].includes("DetermineComponentFrameRoot");)c++;for(;x<ge.length&&!ge[x].includes("DetermineComponentFrameRoot");)x++;if(c===W.length||x===ge.length)for(c=W.length-1,x=ge.length-1;1<=c&&0<=x&&W[c]!==ge[x];)x--;for(;1<=c&&0<=x;c--,x--)if(W[c]!==ge[x]){if(c!==1||x!==1)do if(c--,x--,0>x||W[c]!==ge[x]){var Ae=`
`+W[c].replace(" at new "," at ");return e.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",e.displayName)),Ae}while(1<=c&&0<=x);break}}}finally{Bs=!1,Error.prepareStackTrace=i}return(i=e?e.displayName||e.name:"")?Ns(i):""}function Xt(e,a){switch(e.tag){case 26:case 27:case 5:return Ns(e.type);case 16:return Ns("Lazy");case 13:return e.child!==a&&a!==null?Ns("Suspense Fallback"):Ns("Suspense");case 19:return Ns("SuspenseList");case 0:case 15:return us(e.type,!1);case 11:return us(e.type.render,!1);case 1:return us(e.type,!0);case 31:return Ns("Activity");default:return""}}function Rt(e){try{var a="",i=null;do a+=Xt(e,i),i=e,e=e.return;while(e);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var de=Object.prototype.hasOwnProperty,Le=u.unstable_scheduleCallback,_e=u.unstable_cancelCallback,ie=u.unstable_shouldYield,Fe=u.unstable_requestPaint,Ke=u.unstable_now,Ye=u.unstable_getCurrentPriorityLevel,Pe=u.unstable_ImmediatePriority,ot=u.unstable_UserBlockingPriority,St=u.unstable_NormalPriority,rt=u.unstable_LowPriority,ba=u.unstable_IdlePriority,wa=u.log,an=u.unstable_setDisableYieldValue,It=null,ke=null;function zt(e){if(typeof wa=="function"&&an(e),ke&&typeof ke.setStrictMode=="function")try{ke.setStrictMode(It,e)}catch{}}var ut=Math.clz32?Math.clz32:ol,hs=Math.log,Vr=Math.LN2;function ol(e){return e>>>=0,e===0?32:31-(hs(e)/Vr|0)|0}var Gr=256,Ct=262144,Ma=4194304;function nn(e){var a=e&42;if(a!==0)return a;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Xr(e,a,i){var c=e.pendingLanes;if(c===0)return 0;var x=0,p=e.suspendedLanes,S=e.pingedLanes;e=e.warmLanes;var B=c&134217727;return B!==0?(c=B&~p,c!==0?x=nn(c):(S&=B,S!==0?x=nn(S):i||(i=B&~e,i!==0&&(x=nn(i))))):(B=c&~p,B!==0?x=nn(B):S!==0?x=nn(S):i||(i=c&~e,i!==0&&(x=nn(i)))),x===0?0:a!==0&&a!==x&&(a&p)===0&&(p=x&-x,i=a&-a,p>=i||p===32&&(i&4194048)!==0)?a:x}function Xs(e,a){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&a)===0}function cl(e,a){switch(e){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ls(){var e=Ma;return Ma<<=1,(Ma&62914560)===0&&(Ma=4194304),e}function rn(e){for(var a=[],i=0;31>i;i++)a.push(e);return a}function ln(e,a){e.pendingLanes|=a,a!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ka(e,a,i,c,x,p){var S=e.pendingLanes;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=i,e.entangledLanes&=i,e.errorRecoveryDisabledLanes&=i,e.shellSuspendCounter=0;var B=e.entanglements,W=e.expirationTimes,ge=e.hiddenUpdates;for(i=S&~i;0<i;){var Ae=31-ut(i),Se=1<<Ae;B[Ae]=0,W[Ae]=-1;var pe=ge[Ae];if(pe!==null)for(ge[Ae]=null,Ae=0;Ae<pe.length;Ae++){var Ce=pe[Ae];Ce!==null&&(Ce.lane&=-536870913)}i&=~Se}c!==0&&co(e,c,0),p!==0&&x===0&&e.tag!==0&&(e.suspendedLanes|=p&~(S&~a))}function co(e,a,i){e.pendingLanes|=a,e.suspendedLanes&=~a;var c=31-ut(a);e.entangledLanes|=a,e.entanglements[c]=e.entanglements[c]|1073741824|i&261930}function on(e,a){var i=e.entangledLanes|=a;for(e=e.entanglements;i;){var c=31-ut(i),x=1<<c;x&a|e[c]&a&&(e[c]|=a),i&=~x}}function pi(e,a){var i=a&-a;return i=(i&42)!==0?1:Hs(i),(i&(e.suspendedLanes|a))!==0?0:i}function Hs(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function qa(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ta(){var e=U.p;return e!==0?e:(e=window.event,e===void 0?32:j1(e.type))}function ze(e,a){var i=U.p;try{return U.p=e,a()}finally{U.p=i}}var sa=Math.random().toString(36).slice(2),Cs="__reactFiber$"+sa,Yt="__reactProps$"+sa,va="__reactContainer$"+sa,Qn="__reactEvents$"+sa,yi="__reactListeners$"+sa,Ba="__reactHandles$"+sa,uo="__reactResources$"+sa,Yr="__reactMarker$"+sa;function oa(e){delete e[Cs],delete e[Yt],delete e[Qn],delete e[yi],delete e[Ba]}function ms(e){var a=e[Cs];if(a)return a;for(var i=e.parentNode;i;){if(a=i[va]||i[Cs]){if(i=a.alternate,a.child!==null||i!==null&&i.child!==null)for(e=d1(e);e!==null;){if(i=e[Cs])return i;e=d1(e)}return a}e=i,i=e.parentNode}return null}function Lt(e){if(e=e[Cs]||e[va]){var a=e.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return e}return null}function Jn(e){var a=e.tag;if(a===5||a===26||a===27||a===6)return e.stateNode;throw Error(y(33))}function aa(e){var a=e[uo];return a||(a=e[uo]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function gs(e){e[Yr]=!0}var De=new Set,ho={};function Ht(e,a){Na(e,a),Na(e+"Capture",a)}function Na(e,a){for(ho[e]=a,e=0;e<a.length;e++)De.add(a[e])}var qc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),_t={},Ot={};function wt(e){return de.call(Ot,e)?!0:de.call(_t,e)?!1:qc.test(e)?Ot[e]=!0:(_t[e]=!0,!1)}function $n(e,a,i){if(wt(a))if(i===null)e.removeAttribute(a);else{switch(typeof i){case"undefined":case"function":case"symbol":e.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){e.removeAttribute(a);return}}e.setAttribute(a,""+i)}}function er(e,a,i){if(i===null)e.removeAttribute(a);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttribute(a,""+i)}}function Ca(e,a,i,c){if(c===null)e.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttributeNS(a,i,""+c)}}function Mt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ka(e){var a=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Kc(e,a,i){var c=Object.getOwnPropertyDescriptor(e.constructor.prototype,a);if(!e.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var x=c.get,p=c.set;return Object.defineProperty(e,a,{configurable:!0,get:function(){return x.call(this)},set:function(S){i=""+S,p.call(this,S)}}),Object.defineProperty(e,a,{enumerable:c.enumerable}),{getValue:function(){return i},setValue:function(S){i=""+S},stopTracking:function(){e._valueTracker=null,delete e[a]}}}}function rs(e){if(!e._valueTracker){var a=Ka(e)?"checked":"value";e._valueTracker=Kc(e,a,""+e[a])}}function Za(e){if(!e)return!1;var a=e._valueTracker;if(!a)return!0;var i=a.getValue(),c="";return e&&(c=Ka(e)?e.checked?"true":"false":e.value),e=c,e!==i?(a.setValue(e),!0):!1}function bi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var tr=/[\n"\\]/g;function pt(e){return e.replace(tr,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Rs(e,a,i,c,x,p,S,B){e.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?e.type=S:e.removeAttribute("type"),a!=null?S==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+Mt(a)):e.value!==""+Mt(a)&&(e.value=""+Mt(a)):S!=="submit"&&S!=="reset"||e.removeAttribute("value"),a!=null?H(e,S,Mt(a)):i!=null?H(e,S,Mt(i)):c!=null&&e.removeAttribute("value"),x==null&&p!=null&&(e.defaultChecked=!!p),x!=null&&(e.checked=x&&typeof x!="function"&&typeof x!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?e.name=""+Mt(B):e.removeAttribute("name")}function xe(e,a,i,c,x,p,S,B){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(e.type=p),a!=null||i!=null){if(!(p!=="submit"&&p!=="reset"||a!=null)){rs(e);return}i=i!=null?""+Mt(i):"",a=a!=null?""+Mt(a):i,B||a===e.value||(e.value=a),e.defaultValue=a}c=c??x,c=typeof c!="function"&&typeof c!="symbol"&&!!c,e.checked=B?e.checked:!!c,e.defaultChecked=!!c,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(e.name=S),rs(e)}function H(e,a,i){a==="number"&&bi(e.ownerDocument)===e||e.defaultValue===""+i||(e.defaultValue=""+i)}function Xe(e,a,i,c){if(e=e.options,a){a={};for(var x=0;x<i.length;x++)a["$"+i[x]]=!0;for(i=0;i<e.length;i++)x=a.hasOwnProperty("$"+e[i].value),e[i].selected!==x&&(e[i].selected=x),x&&c&&(e[i].defaultSelected=!0)}else{for(i=""+Mt(i),a=null,x=0;x<e.length;x++){if(e[x].value===i){e[x].selected=!0,c&&(e[x].defaultSelected=!0);return}a!==null||e[x].disabled||(a=e[x])}a!==null&&(a.selected=!0)}}function Es(e,a,i){if(a!=null&&(a=""+Mt(a),a!==e.value&&(e.value=a),i==null)){e.defaultValue!==a&&(e.defaultValue=a);return}e.defaultValue=i!=null?""+Mt(i):""}function na(e,a,i,c){if(a==null){if(c!=null){if(i!=null)throw Error(y(92));if(M(c)){if(1<c.length)throw Error(y(93));c=c[0]}i=c}i==null&&(i=""),a=i}i=Mt(a),e.defaultValue=i,c=e.textContent,c===i&&c!==""&&c!==null&&(e.value=c),rs(e)}function sr(e,a){if(a){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=a;return}}e.textContent=a}var dl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ra(e,a,i){var c=a.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?c?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="":c?e.setProperty(a,i):typeof i!="number"||i===0||dl.has(a)?a==="float"?e.cssFloat=i:e[a]=(""+i).trim():e[a]=i+"px"}function We(e,a,i){if(a!=null&&typeof a!="object")throw Error(y(62));if(e=e.style,i!=null){for(var c in i)!i.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?e.setProperty(c,""):c==="float"?e.cssFloat="":e[c]="");for(var x in a)c=a[x],a.hasOwnProperty(x)&&i[x]!==c&&ra(e,x,c)}else for(var p in a)a.hasOwnProperty(p)&&ra(e,p,a[p])}function $t(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ar(e){return Zc.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function ca(){}var qr=null;function ul(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var is=null,La=null;function Wa(e){var a=Lt(e);if(a&&(e=a.stateNode)){var i=e[Yt]||null;e:switch(e=a.stateNode,a.type){case"input":if(Rs(e,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),a=i.name,i.type==="radio"&&a!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+pt(""+a)+'"][type="radio"]'),a=0;a<i.length;a++){var c=i[a];if(c!==e&&c.form===e.form){var x=c[Yt]||null;if(!x)throw Error(y(90));Rs(c,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(a=0;a<i.length;a++)c=i[a],c.form===e.form&&Za(c)}break e;case"textarea":Es(e,i.value,i.defaultValue);break e;case"select":a=i.value,a!=null&&Xe(e,!!i.multiple,a,!1)}}}var Je=!1;function xo(e,a,i){if(Je)return e(a,i);Je=!0;try{var c=e(a);return c}finally{if(Je=!1,(is!==null||La!==null)&&(rc(),is&&(a=is,e=La,La=is=null,Wa(a),e)))for(a=0;a<e.length;a++)Wa(e[a])}}function nt(e,a){var i=e.stateNode;if(i===null)return null;var c=i[Yt]||null;if(c===null)return null;i=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(y(231,a,typeof i));return i}var es=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hl=!1;if(es)try{var wn={};Object.defineProperty(wn,"passive",{get:function(){hl=!0}}),window.addEventListener("test",wn,wn),window.removeEventListener("test",wn,wn)}catch{hl=!1}var Qa=null,Ja=null,wi=null;function nr(){if(wi)return wi;var e,a=Ja,i=a.length,c,x="value"in Qa?Qa.value:Qa.textContent,p=x.length;for(e=0;e<i&&a[e]===x[e];e++);var S=i-e;for(c=1;c<=S&&a[i-c]===x[p-c];c++);return wi=x.slice(e,1<c?1-c:void 0)}function cn(e){var a=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&a===13&&(e=13)):e=a,e===10&&(e=13),32<=e||e===13?e:0}function dn(){return!0}function fl(){return!1}function Os(e){function a(i,c,x,p,S){this._reactName=i,this._targetInst=x,this.type=c,this.nativeEvent=p,this.target=S,this.currentTarget=null;for(var B in e)e.hasOwnProperty(B)&&(i=e[B],this[B]=i?i(p):p[B]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?dn:fl,this.isPropagationStopped=fl,this}return O(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=dn)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=dn)},persist:function(){},isPersistent:dn}),a}var Ea={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ps=Os(Ea),rr=O({},Ea,{view:0,detail:0}),mo=Os(rr),vi,xl,Kr,Ni=O({},rr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zr,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Kr&&(Kr&&e.type==="mousemove"?(vi=e.screenX-Kr.screenX,xl=e.screenY-Kr.screenY):xl=vi=0,Kr=e),vi)},movementY:function(e){return"movementY"in e?e.movementY:xl}}),Pt=Os(Ni),go=O({},Ni,{dataTransfer:0}),Ci=Os(go),un=O({},rr,{relatedTarget:0}),ml=Os(un),we=O({},Ea,{animationName:0,elapsedTime:0,pseudoElement:0}),ft=Os(we),Fs=O({},Ea,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ei=Os(Fs),po=O({},Ea,{data:0}),yo=Os(po),Wc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function As(e){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(e):(e=gl[e])?!!a[e]:!1}function Zr(){return As}var fs=O({},rr,{key:function(e){if(e.key){var a=Wc[e.key]||e.key;if(a!=="Unidentified")return a}return e.type==="keypress"?(e=cn(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Qc[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zr,charCode:function(e){return e.type==="keypress"?cn(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?cn(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ai=Os(fs),vn=O({},Ni,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vt=Os(vn),$e=O({},rr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zr}),Jc=Os($e),ts=O({},Ea,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nn=Os(ts),ir=O({},Ni,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$c=Os(ir),Pa=O({},Ea,{newState:0,oldState:0}),pl=Os(Pa),bo=[9,13,27,32],Wr=es&&"CompositionEvent"in window,lr=null;es&&"documentMode"in document&&(lr=document.documentMode);var wo=es&&"TextEvent"in window&&!lr,vo=es&&(!Wr||lr&&8<lr&&11>=lr),Cn=" ",ji=!1;function No(e,a){switch(e){case"keyup":return bo.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function or(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var cr=!1;function hn(e,a){switch(e){case"compositionend":return or(a);case"keypress":return a.which!==32?null:(ji=!0,Cn);case"textInput":return e=a.data,e===Cn&&ji?null:e;default:return null}}function Si(e,a){if(cr)return e==="compositionend"||!Wr&&No(e,a)?(e=nr(),wi=Ja=Qa=null,cr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return vo&&a.locale!=="ko"?null:a.data;default:return null}}var da={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yl(e){var a=e&&e.nodeName&&e.nodeName.toLowerCase();return a==="input"?!!da[e.type]:a==="textarea"}function Aa(e,a,i,c){is?La?La.push(c):La=[c]:is=c,a=hc(a,"onChange"),0<a.length&&(i=new Ps("onChange","change",null,i,c),e.push({event:i,listeners:a}))}var Qr=null,En=null;function ed(e){Wf(e,0)}function Jr(e){var a=Jn(e);if(Za(a))return e}function ja(e,a){if(e==="change")return a}var Co=!1;if(es){var $r;if(es){var An="oninput"in document;if(!An){var Et=document.createElement("div");Et.setAttribute("oninput","return;"),An=typeof Et.oninput=="function"}$r=An}else $r=!1;Co=$r&&(!document.documentMode||9<document.documentMode)}function ei(){Qr&&(Qr.detachEvent("onpropertychange",_),En=Qr=null)}function _(e){if(e.propertyName==="value"&&Jr(En)){var a=[];Aa(a,En,e,ul(e)),xo(ed,a)}}function t(e,a,i){e==="focusin"?(ei(),Qr=a,En=i,Qr.attachEvent("onpropertychange",_)):e==="focusout"&&ei()}function n(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Jr(En)}function r(e,a){if(e==="click")return Jr(a)}function l(e,a){if(e==="input"||e==="change")return Jr(a)}function o(e,a){return e===a&&(e!==0||1/e===1/a)||e!==e&&a!==a}var d=typeof Object.is=="function"?Object.is:o;function h(e,a){if(d(e,a))return!0;if(typeof e!="object"||e===null||typeof a!="object"||a===null)return!1;var i=Object.keys(e),c=Object.keys(a);if(i.length!==c.length)return!1;for(c=0;c<i.length;c++){var x=i[c];if(!de.call(a,x)||!d(e[x],a[x]))return!1}return!0}function g(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function b(e,a){var i=g(e);e=0;for(var c;i;){if(i.nodeType===3){if(c=e+i.textContent.length,e<=a&&c>=a)return{node:i,offset:a-e};e=c}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=g(i)}}function j(e,a){return e&&a?e===a?!0:e&&e.nodeType===3?!1:a&&a.nodeType===3?j(e,a.parentNode):"contains"in e?e.contains(a):e.compareDocumentPosition?!!(e.compareDocumentPosition(a)&16):!1:!1}function I(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var a=bi(e.document);a instanceof e.HTMLIFrameElement;){try{var i=typeof a.contentWindow.location.href=="string"}catch{i=!1}if(i)e=a.contentWindow;else break;a=bi(e.document)}return a}function k(e){var a=e&&e.nodeName&&e.nodeName.toLowerCase();return a&&(a==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||a==="textarea"||e.contentEditable==="true")}var G=es&&"documentMode"in document&&11>=document.documentMode,J=null,ee=null,ue=null,be=!1;function Be(e,a,i){var c=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;be||J==null||J!==bi(c)||(c=J,"selectionStart"in c&&k(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),ue&&h(ue,c)||(ue=c,c=hc(ee,"onSelect"),0<c.length&&(a=new Ps("onSelect","select",null,a,i),e.push({event:a,listeners:c}),a.target=J)))}function Me(e,a){var i={};return i[e.toLowerCase()]=a.toLowerCase(),i["Webkit"+e]="webkit"+a,i["Moz"+e]="moz"+a,i}var Ie={animationend:Me("Animation","AnimationEnd"),animationiteration:Me("Animation","AnimationIteration"),animationstart:Me("Animation","AnimationStart"),transitionrun:Me("Transition","TransitionRun"),transitionstart:Me("Transition","TransitionStart"),transitioncancel:Me("Transition","TransitionCancel"),transitionend:Me("Transition","TransitionEnd")},mt={},it={};es&&(it=document.createElement("div").style,"AnimationEvent"in window||(delete Ie.animationend.animation,delete Ie.animationiteration.animation,delete Ie.animationstart.animation),"TransitionEvent"in window||delete Ie.transitionend.transition);function ps(e){if(mt[e])return mt[e];if(!Ie[e])return e;var a=Ie[e],i;for(i in a)if(a.hasOwnProperty(i)&&i in it)return mt[e]=a[i];return e}var ua=ps("animationend"),Ys=ps("animationiteration"),Gt=ps("animationstart"),Us=ps("transitionrun"),ia=ps("transitionstart"),dr=ps("transitioncancel"),jn=ps("transitionend"),Eo=new Map,bl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");bl.push("scrollEnd");function $a(e,a){Eo.set(e,a),Ht(a,[e])}var Ao=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Fa=[],Ti=0,td=0;function jo(){for(var e=Ti,a=td=Ti=0;a<e;){var i=Fa[a];Fa[a++]=null;var c=Fa[a];Fa[a++]=null;var x=Fa[a];Fa[a++]=null;var p=Fa[a];if(Fa[a++]=null,c!==null&&x!==null){var S=c.pending;S===null?x.next=x:(x.next=S.next,S.next=x),c.pending=x}p!==0&&O0(i,x,p)}}function So(e,a,i,c){Fa[Ti++]=e,Fa[Ti++]=a,Fa[Ti++]=i,Fa[Ti++]=c,td|=c,e.lanes|=c,e=e.alternate,e!==null&&(e.lanes|=c)}function sd(e,a,i,c){return So(e,a,i,c),To(e)}function ti(e,a){return So(e,null,null,a),To(e)}function O0(e,a,i){e.lanes|=i;var c=e.alternate;c!==null&&(c.lanes|=i);for(var x=!1,p=e.return;p!==null;)p.childLanes|=i,c=p.alternate,c!==null&&(c.childLanes|=i),p.tag===22&&(e=p.stateNode,e===null||e._visibility&1||(x=!0)),e=p,p=p.return;return e.tag===3?(p=e.stateNode,x&&a!==null&&(x=31-ut(i),e=p.hiddenUpdates,c=e[x],c===null?e[x]=[a]:c.push(a),a.lane=i|536870912),p):null}function To(e){if(50<zl)throw zl=0,uu=null,Error(y(185));for(var a=e.return;a!==null;)e=a,a=e.return;return e.tag===3?e.stateNode:null}var Ri={};function Sm(e,a,i,c){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sa(e,a,i,c){return new Sm(e,a,i,c)}function ad(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Sn(e,a){var i=e.alternate;return i===null?(i=Sa(e.tag,a,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=a,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&65011712,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,a=e.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i.refCleanup=e.refCleanup,i}function D0(e,a){e.flags&=65011714;var i=e.alternate;return i===null?(e.childLanes=0,e.lanes=a,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,e.type=i.type,a=i.dependencies,e.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),e}function Ro(e,a,i,c,x,p){var S=0;if(c=e,typeof e=="function")ad(e)&&(S=1);else if(typeof e=="string")S=_g(e,i,ye.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case re:return e=Sa(31,i,a,x),e.elementType=re,e.lanes=p,e;case F:return si(i.children,x,p,a);case Z:S=8,x|=24;break;case ne:return e=Sa(12,i,a,x|2),e.elementType=ne,e.lanes=p,e;case Q:return e=Sa(13,i,a,x),e.elementType=Q,e.lanes=p,e;case te:return e=Sa(19,i,a,x),e.elementType=te,e.lanes=p,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case q:S=10;break e;case Y:S=9;break e;case oe:S=11;break e;case K:S=14;break e;case Te:S=16,c=null;break e}S=29,i=Error(y(130,e===null?"null":typeof e,"")),c=null}return a=Sa(S,i,a,x),a.elementType=e,a.type=c,a.lanes=p,a}function si(e,a,i,c){return e=Sa(7,e,c,a),e.lanes=i,e}function nd(e,a,i){return e=Sa(6,e,null,a),e.lanes=i,e}function _0(e){var a=Sa(18,null,null,0);return a.stateNode=e,a}function rd(e,a,i){return a=Sa(4,e.children!==null?e.children:[],e.key,a),a.lanes=i,a.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},a}var I0=new WeakMap;function Ua(e,a){if(typeof e=="object"&&e!==null){var i=I0.get(e);return i!==void 0?i:(a={value:e,source:a,stack:Rt(a)},I0.set(e,a),a)}return{value:e,source:a,stack:Rt(a)}}var Oi=[],Di=0,Oo=null,wl=0,za=[],Ha=0,ur=null,fn=1,xn="";function Tn(e,a){Oi[Di++]=wl,Oi[Di++]=Oo,Oo=e,wl=a}function M0(e,a,i){za[Ha++]=fn,za[Ha++]=xn,za[Ha++]=ur,ur=e;var c=fn;e=xn;var x=32-ut(c)-1;c&=~(1<<x),i+=1;var p=32-ut(a)+x;if(30<p){var S=x-x%5;p=(c&(1<<S)-1).toString(32),c>>=S,x-=S,fn=1<<32-ut(a)+x|i<<x|c,xn=p+e}else fn=1<<p|i<<x|c,xn=e}function id(e){e.return!==null&&(Tn(e,1),M0(e,1,0))}function ld(e){for(;e===Oo;)Oo=Oi[--Di],Oi[Di]=null,wl=Oi[--Di],Oi[Di]=null;for(;e===ur;)ur=za[--Ha],za[Ha]=null,xn=za[--Ha],za[Ha]=null,fn=za[--Ha],za[Ha]=null}function k0(e,a){za[Ha++]=fn,za[Ha++]=xn,za[Ha++]=ur,fn=a.id,xn=a.overflow,ur=e}var qs=null,ls=null,Tt=!1,hr=null,Va=!1,od=Error(y(519));function fr(e){var a=Error(y(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw vl(Ua(a,e)),od}function B0(e){var a=e.stateNode,i=e.type,c=e.memoizedProps;switch(a[Cs]=e,a[Yt]=c,i){case"dialog":Nt("cancel",a),Nt("close",a);break;case"iframe":case"object":case"embed":Nt("load",a);break;case"video":case"audio":for(i=0;i<Vl.length;i++)Nt(Vl[i],a);break;case"source":Nt("error",a);break;case"img":case"image":case"link":Nt("error",a),Nt("load",a);break;case"details":Nt("toggle",a);break;case"input":Nt("invalid",a),xe(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Nt("invalid",a);break;case"textarea":Nt("invalid",a),na(a,c.value,c.defaultValue,c.children)}i=c.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||a.textContent===""+i||c.suppressHydrationWarning===!0||e1(a.textContent,i)?(c.popover!=null&&(Nt("beforetoggle",a),Nt("toggle",a)),c.onScroll!=null&&Nt("scroll",a),c.onScrollEnd!=null&&Nt("scrollend",a),c.onClick!=null&&(a.onclick=ca),a=!0):a=!1,a||fr(e,!0)}function L0(e){for(qs=e.return;qs;)switch(qs.tag){case 5:case 31:case 13:Va=!1;return;case 27:case 3:Va=!0;return;default:qs=qs.return}}function _i(e){if(e!==qs)return!1;if(!Tt)return L0(e),Tt=!0,!1;var a=e.tag,i;if((i=a!==3&&a!==27)&&((i=a===5)&&(i=e.type,i=!(i!=="form"&&i!=="button")||ju(e.type,e.memoizedProps)),i=!i),i&&ls&&fr(e),L0(e),a===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(y(317));ls=c1(e)}else if(a===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(y(317));ls=c1(e)}else a===27?(a=ls,Sr(e.type)?(e=Du,Du=null,ls=e):ls=a):ls=qs?Xa(e.stateNode.nextSibling):null;return!0}function ai(){ls=qs=null,Tt=!1}function cd(){var e=hr;return e!==null&&(ma===null?ma=e:ma.push.apply(ma,e),hr=null),e}function vl(e){hr===null?hr=[e]:hr.push(e)}var dd=X(null),ni=null,Rn=null;function xr(e,a,i){Ee(dd,a._currentValue),a._currentValue=i}function On(e){e._currentValue=dd.current,se(dd)}function ud(e,a,i){for(;e!==null;){var c=e.alternate;if((e.childLanes&a)!==a?(e.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),e===i)break;e=e.return}}function hd(e,a,i,c){var x=e.child;for(x!==null&&(x.return=e);x!==null;){var p=x.dependencies;if(p!==null){var S=x.child;p=p.firstContext;e:for(;p!==null;){var B=p;p=x;for(var W=0;W<a.length;W++)if(B.context===a[W]){p.lanes|=i,B=p.alternate,B!==null&&(B.lanes|=i),ud(p.return,i,e),c||(S=null);break e}p=B.next}}else if(x.tag===18){if(S=x.return,S===null)throw Error(y(341));S.lanes|=i,p=S.alternate,p!==null&&(p.lanes|=i),ud(S,i,e),S=null}else S=x.child;if(S!==null)S.return=x;else for(S=x;S!==null;){if(S===e){S=null;break}if(x=S.sibling,x!==null){x.return=S.return,S=x;break}S=S.return}x=S}}function Ii(e,a,i,c){e=null;for(var x=a,p=!1;x!==null;){if(!p){if((x.flags&524288)!==0)p=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var S=x.alternate;if(S===null)throw Error(y(387));if(S=S.memoizedProps,S!==null){var B=x.type;d(x.pendingProps.value,S.value)||(e!==null?e.push(B):e=[B])}}else if(x===Ge.current){if(S=x.alternate,S===null)throw Error(y(387));S.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(e!==null?e.push(Kl):e=[Kl])}x=x.return}e!==null&&hd(a,e,i,c),a.flags|=262144}function Do(e){for(e=e.firstContext;e!==null;){if(!d(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function ri(e){ni=e,Rn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Ks(e){return P0(ni,e)}function _o(e,a){return ni===null&&ri(e),P0(e,a)}function P0(e,a){var i=a._currentValue;if(a={context:a,memoizedValue:i,next:null},Rn===null){if(e===null)throw Error(y(308));Rn=a,e.dependencies={lanes:0,firstContext:a},e.flags|=524288}else Rn=Rn.next=a;return i}var Tm=typeof AbortController<"u"?AbortController:function(){var e=[],a=this.signal={aborted:!1,addEventListener:function(i,c){e.push(c)}};this.abort=function(){a.aborted=!0,e.forEach(function(i){return i()})}},Rm=u.unstable_scheduleCallback,Om=u.unstable_NormalPriority,Ds={$$typeof:q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fd(){return{controller:new Tm,data:new Map,refCount:0}}function Nl(e){e.refCount--,e.refCount===0&&Rm(Om,function(){e.controller.abort()})}var Cl=null,xd=0,Mi=0,ki=null;function Dm(e,a){if(Cl===null){var i=Cl=[];xd=0,Mi=pu(),ki={status:"pending",value:void 0,then:function(c){i.push(c)}}}return xd++,a.then(F0,F0),a}function F0(){if(--xd===0&&Cl!==null){ki!==null&&(ki.status="fulfilled");var e=Cl;Cl=null,Mi=0,ki=null;for(var a=0;a<e.length;a++)(0,e[a])()}}function _m(e,a){var i=[],c={status:"pending",value:null,reason:null,then:function(x){i.push(x)}};return e.then(function(){c.status="fulfilled",c.value=a;for(var x=0;x<i.length;x++)(0,i[x])(a)},function(x){for(c.status="rejected",c.reason=x,x=0;x<i.length;x++)(0,i[x])(void 0)}),c}var U0=L.S;L.S=function(e,a){Ef=Ke(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&Dm(e,a),U0!==null&&U0(e,a)};var ii=X(null);function md(){var e=ii.current;return e!==null?e:ss.pooledCache}function Io(e,a){a===null?Ee(ii,ii.current):Ee(ii,a.pool)}function z0(){var e=md();return e===null?null:{parent:Ds._currentValue,pool:e}}var Bi=Error(y(460)),gd=Error(y(474)),Mo=Error(y(542)),ko={then:function(){}};function H0(e){return e=e.status,e==="fulfilled"||e==="rejected"}function V0(e,a,i){switch(i=e[i],i===void 0?e.push(a):i!==a&&(a.then(ca,ca),a=i),a.status){case"fulfilled":return a.value;case"rejected":throw e=a.reason,X0(e),e;default:if(typeof a.status=="string")a.then(ca,ca);else{if(e=ss,e!==null&&100<e.shellSuspendCounter)throw Error(y(482));e=a,e.status="pending",e.then(function(c){if(a.status==="pending"){var x=a;x.status="fulfilled",x.value=c}},function(c){if(a.status==="pending"){var x=a;x.status="rejected",x.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw e=a.reason,X0(e),e}throw oi=a,Bi}}function li(e){try{var a=e._init;return a(e._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(oi=i,Bi):i}}var oi=null;function G0(){if(oi===null)throw Error(y(459));var e=oi;return oi=null,e}function X0(e){if(e===Bi||e===Mo)throw Error(y(483))}var Li=null,El=0;function Bo(e){var a=El;return El+=1,Li===null&&(Li=[]),V0(Li,e,a)}function Al(e,a){a=a.props.ref,e.ref=a!==void 0?a:null}function Lo(e,a){throw a.$$typeof===R?Error(y(525)):(e=Object.prototype.toString.call(a),Error(y(31,e==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":e)))}function Y0(e){function a(ce,ae){if(e){var me=ce.deletions;me===null?(ce.deletions=[ae],ce.flags|=16):me.push(ae)}}function i(ce,ae){if(!e)return null;for(;ae!==null;)a(ce,ae),ae=ae.sibling;return null}function c(ce){for(var ae=new Map;ce!==null;)ce.key!==null?ae.set(ce.key,ce):ae.set(ce.index,ce),ce=ce.sibling;return ae}function x(ce,ae){return ce=Sn(ce,ae),ce.index=0,ce.sibling=null,ce}function p(ce,ae,me){return ce.index=me,e?(me=ce.alternate,me!==null?(me=me.index,me<ae?(ce.flags|=67108866,ae):me):(ce.flags|=67108866,ae)):(ce.flags|=1048576,ae)}function S(ce){return e&&ce.alternate===null&&(ce.flags|=67108866),ce}function B(ce,ae,me,je){return ae===null||ae.tag!==6?(ae=nd(me,ce.mode,je),ae.return=ce,ae):(ae=x(ae,me),ae.return=ce,ae)}function W(ce,ae,me,je){var Qe=me.type;return Qe===F?Ae(ce,ae,me.props.children,je,me.key):ae!==null&&(ae.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===Te&&li(Qe)===ae.type)?(ae=x(ae,me.props),Al(ae,me),ae.return=ce,ae):(ae=Ro(me.type,me.key,me.props,null,ce.mode,je),Al(ae,me),ae.return=ce,ae)}function ge(ce,ae,me,je){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==me.containerInfo||ae.stateNode.implementation!==me.implementation?(ae=rd(me,ce.mode,je),ae.return=ce,ae):(ae=x(ae,me.children||[]),ae.return=ce,ae)}function Ae(ce,ae,me,je,Qe){return ae===null||ae.tag!==7?(ae=si(me,ce.mode,je,Qe),ae.return=ce,ae):(ae=x(ae,me),ae.return=ce,ae)}function Se(ce,ae,me){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ae=nd(""+ae,ce.mode,me),ae.return=ce,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case z:return me=Ro(ae.type,ae.key,ae.props,null,ce.mode,me),Al(me,ae),me.return=ce,me;case P:return ae=rd(ae,ce.mode,me),ae.return=ce,ae;case Te:return ae=li(ae),Se(ce,ae,me)}if(M(ae)||$(ae))return ae=si(ae,ce.mode,me,null),ae.return=ce,ae;if(typeof ae.then=="function")return Se(ce,Bo(ae),me);if(ae.$$typeof===q)return Se(ce,_o(ce,ae),me);Lo(ce,ae)}return null}function pe(ce,ae,me,je){var Qe=ae!==null?ae.key:null;if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return Qe!==null?null:B(ce,ae,""+me,je);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case z:return me.key===Qe?W(ce,ae,me,je):null;case P:return me.key===Qe?ge(ce,ae,me,je):null;case Te:return me=li(me),pe(ce,ae,me,je)}if(M(me)||$(me))return Qe!==null?null:Ae(ce,ae,me,je,null);if(typeof me.then=="function")return pe(ce,ae,Bo(me),je);if(me.$$typeof===q)return pe(ce,ae,_o(ce,me),je);Lo(ce,me)}return null}function Ce(ce,ae,me,je,Qe){if(typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint")return ce=ce.get(me)||null,B(ae,ce,""+je,Qe);if(typeof je=="object"&&je!==null){switch(je.$$typeof){case z:return ce=ce.get(je.key===null?me:je.key)||null,W(ae,ce,je,Qe);case P:return ce=ce.get(je.key===null?me:je.key)||null,ge(ae,ce,je,Qe);case Te:return je=li(je),Ce(ce,ae,me,je,Qe)}if(M(je)||$(je))return ce=ce.get(me)||null,Ae(ae,ce,je,Qe,null);if(typeof je.then=="function")return Ce(ce,ae,me,Bo(je),Qe);if(je.$$typeof===q)return Ce(ce,ae,me,_o(ae,je),Qe);Lo(ae,je)}return null}function Ve(ce,ae,me,je){for(var Qe=null,kt=null,qe=ae,xt=ae=0,jt=null;qe!==null&&xt<me.length;xt++){qe.index>xt?(jt=qe,qe=null):jt=qe.sibling;var Bt=pe(ce,qe,me[xt],je);if(Bt===null){qe===null&&(qe=jt);break}e&&qe&&Bt.alternate===null&&a(ce,qe),ae=p(Bt,ae,xt),kt===null?Qe=Bt:kt.sibling=Bt,kt=Bt,qe=jt}if(xt===me.length)return i(ce,qe),Tt&&Tn(ce,xt),Qe;if(qe===null){for(;xt<me.length;xt++)qe=Se(ce,me[xt],je),qe!==null&&(ae=p(qe,ae,xt),kt===null?Qe=qe:kt.sibling=qe,kt=qe);return Tt&&Tn(ce,xt),Qe}for(qe=c(qe);xt<me.length;xt++)jt=Ce(qe,ce,xt,me[xt],je),jt!==null&&(e&&jt.alternate!==null&&qe.delete(jt.key===null?xt:jt.key),ae=p(jt,ae,xt),kt===null?Qe=jt:kt.sibling=jt,kt=jt);return e&&qe.forEach(function(_r){return a(ce,_r)}),Tt&&Tn(ce,xt),Qe}function tt(ce,ae,me,je){if(me==null)throw Error(y(151));for(var Qe=null,kt=null,qe=ae,xt=ae=0,jt=null,Bt=me.next();qe!==null&&!Bt.done;xt++,Bt=me.next()){qe.index>xt?(jt=qe,qe=null):jt=qe.sibling;var _r=pe(ce,qe,Bt.value,je);if(_r===null){qe===null&&(qe=jt);break}e&&qe&&_r.alternate===null&&a(ce,qe),ae=p(_r,ae,xt),kt===null?Qe=_r:kt.sibling=_r,kt=_r,qe=jt}if(Bt.done)return i(ce,qe),Tt&&Tn(ce,xt),Qe;if(qe===null){for(;!Bt.done;xt++,Bt=me.next())Bt=Se(ce,Bt.value,je),Bt!==null&&(ae=p(Bt,ae,xt),kt===null?Qe=Bt:kt.sibling=Bt,kt=Bt);return Tt&&Tn(ce,xt),Qe}for(qe=c(qe);!Bt.done;xt++,Bt=me.next())Bt=Ce(qe,ce,xt,Bt.value,je),Bt!==null&&(e&&Bt.alternate!==null&&qe.delete(Bt.key===null?xt:Bt.key),ae=p(Bt,ae,xt),kt===null?Qe=Bt:kt.sibling=Bt,kt=Bt);return e&&qe.forEach(function(Vg){return a(ce,Vg)}),Tt&&Tn(ce,xt),Qe}function Qt(ce,ae,me,je){if(typeof me=="object"&&me!==null&&me.type===F&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case z:e:{for(var Qe=me.key;ae!==null;){if(ae.key===Qe){if(Qe=me.type,Qe===F){if(ae.tag===7){i(ce,ae.sibling),je=x(ae,me.props.children),je.return=ce,ce=je;break e}}else if(ae.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===Te&&li(Qe)===ae.type){i(ce,ae.sibling),je=x(ae,me.props),Al(je,me),je.return=ce,ce=je;break e}i(ce,ae);break}else a(ce,ae);ae=ae.sibling}me.type===F?(je=si(me.props.children,ce.mode,je,me.key),je.return=ce,ce=je):(je=Ro(me.type,me.key,me.props,null,ce.mode,je),Al(je,me),je.return=ce,ce=je)}return S(ce);case P:e:{for(Qe=me.key;ae!==null;){if(ae.key===Qe)if(ae.tag===4&&ae.stateNode.containerInfo===me.containerInfo&&ae.stateNode.implementation===me.implementation){i(ce,ae.sibling),je=x(ae,me.children||[]),je.return=ce,ce=je;break e}else{i(ce,ae);break}else a(ce,ae);ae=ae.sibling}je=rd(me,ce.mode,je),je.return=ce,ce=je}return S(ce);case Te:return me=li(me),Qt(ce,ae,me,je)}if(M(me))return Ve(ce,ae,me,je);if($(me)){if(Qe=$(me),typeof Qe!="function")throw Error(y(150));return me=Qe.call(me),tt(ce,ae,me,je)}if(typeof me.then=="function")return Qt(ce,ae,Bo(me),je);if(me.$$typeof===q)return Qt(ce,ae,_o(ce,me),je);Lo(ce,me)}return typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint"?(me=""+me,ae!==null&&ae.tag===6?(i(ce,ae.sibling),je=x(ae,me),je.return=ce,ce=je):(i(ce,ae),je=nd(me,ce.mode,je),je.return=ce,ce=je),S(ce)):i(ce,ae)}return function(ce,ae,me,je){try{El=0;var Qe=Qt(ce,ae,me,je);return Li=null,Qe}catch(qe){if(qe===Bi||qe===Mo)throw qe;var kt=Sa(29,qe,null,ce.mode);return kt.lanes=je,kt.return=ce,kt}finally{}}}var ci=Y0(!0),q0=Y0(!1),mr=!1;function pd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yd(e,a){e=e.updateQueue,a.updateQueue===e&&(a.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function gr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function pr(e,a,i){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,(Ft&2)!==0){var x=c.pending;return x===null?a.next=a:(a.next=x.next,x.next=a),c.pending=a,a=To(e),O0(e,null,i),a}return So(e,c,a,i),To(e)}function jl(e,a,i){if(a=a.updateQueue,a!==null&&(a=a.shared,(i&4194048)!==0)){var c=a.lanes;c&=e.pendingLanes,i|=c,a.lanes=i,on(e,i)}}function bd(e,a){var i=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,i===c)){var x=null,p=null;if(i=i.firstBaseUpdate,i!==null){do{var S={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};p===null?x=p=S:p=p.next=S,i=i.next}while(i!==null);p===null?x=p=a:p=p.next=a}else x=p=a;i={baseState:c.baseState,firstBaseUpdate:x,lastBaseUpdate:p,shared:c.shared,callbacks:c.callbacks},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=a:e.next=a,i.lastBaseUpdate=a}var wd=!1;function Sl(){if(wd){var e=ki;if(e!==null)throw e}}function Tl(e,a,i,c){wd=!1;var x=e.updateQueue;mr=!1;var p=x.firstBaseUpdate,S=x.lastBaseUpdate,B=x.shared.pending;if(B!==null){x.shared.pending=null;var W=B,ge=W.next;W.next=null,S===null?p=ge:S.next=ge,S=W;var Ae=e.alternate;Ae!==null&&(Ae=Ae.updateQueue,B=Ae.lastBaseUpdate,B!==S&&(B===null?Ae.firstBaseUpdate=ge:B.next=ge,Ae.lastBaseUpdate=W))}if(p!==null){var Se=x.baseState;S=0,Ae=ge=W=null,B=p;do{var pe=B.lane&-536870913,Ce=pe!==B.lane;if(Ce?(At&pe)===pe:(c&pe)===pe){pe!==0&&pe===Mi&&(wd=!0),Ae!==null&&(Ae=Ae.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});e:{var Ve=e,tt=B;pe=a;var Qt=i;switch(tt.tag){case 1:if(Ve=tt.payload,typeof Ve=="function"){Se=Ve.call(Qt,Se,pe);break e}Se=Ve;break e;case 3:Ve.flags=Ve.flags&-65537|128;case 0:if(Ve=tt.payload,pe=typeof Ve=="function"?Ve.call(Qt,Se,pe):Ve,pe==null)break e;Se=O({},Se,pe);break e;case 2:mr=!0}}pe=B.callback,pe!==null&&(e.flags|=64,Ce&&(e.flags|=8192),Ce=x.callbacks,Ce===null?x.callbacks=[pe]:Ce.push(pe))}else Ce={lane:pe,tag:B.tag,payload:B.payload,callback:B.callback,next:null},Ae===null?(ge=Ae=Ce,W=Se):Ae=Ae.next=Ce,S|=pe;if(B=B.next,B===null){if(B=x.shared.pending,B===null)break;Ce=B,B=Ce.next,Ce.next=null,x.lastBaseUpdate=Ce,x.shared.pending=null}}while(!0);Ae===null&&(W=Se),x.baseState=W,x.firstBaseUpdate=ge,x.lastBaseUpdate=Ae,p===null&&(x.shared.lanes=0),Nr|=S,e.lanes=S,e.memoizedState=Se}}function K0(e,a){if(typeof e!="function")throw Error(y(191,e));e.call(a)}function Z0(e,a){var i=e.callbacks;if(i!==null)for(e.callbacks=null,e=0;e<i.length;e++)K0(i[e],a)}var Pi=X(null),Po=X(0);function W0(e,a){e=Fn,Ee(Po,e),Ee(Pi,a),Fn=e|a.baseLanes}function vd(){Ee(Po,Fn),Ee(Pi,Pi.current)}function Nd(){Fn=Po.current,se(Pi),se(Po)}var Ta=X(null),Ga=null;function yr(e){var a=e.alternate;Ee(js,js.current&1),Ee(Ta,e),Ga===null&&(a===null||Pi.current!==null||a.memoizedState!==null)&&(Ga=e)}function Cd(e){Ee(js,js.current),Ee(Ta,e),Ga===null&&(Ga=e)}function Q0(e){e.tag===22?(Ee(js,js.current),Ee(Ta,e),Ga===null&&(Ga=e)):br()}function br(){Ee(js,js.current),Ee(Ta,Ta.current)}function Ra(e){se(Ta),Ga===e&&(Ga=null),se(js)}var js=X(0);function Fo(e){for(var a=e;a!==null;){if(a.tag===13){var i=a.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||Ru(i)||Ou(i)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Dn=0,ht=null,Zt=null,_s=null,Uo=!1,Fi=!1,di=!1,zo=0,Rl=0,Ui=null,Im=0;function ys(){throw Error(y(321))}function Ed(e,a){if(a===null)return!1;for(var i=0;i<a.length&&i<e.length;i++)if(!d(e[i],a[i]))return!1;return!0}function Ad(e,a,i,c,x,p){return Dn=p,ht=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,L.H=e===null||e.memoizedState===null?Mh:Ud,di=!1,p=i(c,x),di=!1,Fi&&(p=$0(a,i,c,x)),J0(e),p}function J0(e){L.H=_l;var a=Zt!==null&&Zt.next!==null;if(Dn=0,_s=Zt=ht=null,Uo=!1,Rl=0,Ui=null,a)throw Error(y(300));e===null||Is||(e=e.dependencies,e!==null&&Do(e)&&(Is=!0))}function $0(e,a,i,c){ht=e;var x=0;do{if(Fi&&(Ui=null),Rl=0,Fi=!1,25<=x)throw Error(y(301));if(x+=1,_s=Zt=null,e.updateQueue!=null){var p=e.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}L.H=kh,p=a(i,c)}while(Fi);return p}function Mm(){var e=L.H,a=e.useState()[0];return a=typeof a.then=="function"?Ol(a):a,e=e.useState()[0],(Zt!==null?Zt.memoizedState:null)!==e&&(ht.flags|=1024),a}function jd(){var e=zo!==0;return zo=0,e}function Sd(e,a,i){a.updateQueue=e.updateQueue,a.flags&=-2053,e.lanes&=~i}function Td(e){if(Uo){for(e=e.memoizedState;e!==null;){var a=e.queue;a!==null&&(a.pending=null),e=e.next}Uo=!1}Dn=0,_s=Zt=ht=null,Fi=!1,Rl=zo=0,Ui=null}function la(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _s===null?ht.memoizedState=_s=e:_s=_s.next=e,_s}function Ss(){if(Zt===null){var e=ht.alternate;e=e!==null?e.memoizedState:null}else e=Zt.next;var a=_s===null?ht.memoizedState:_s.next;if(a!==null)_s=a,Zt=e;else{if(e===null)throw ht.alternate===null?Error(y(467)):Error(y(310));Zt=e,e={memoizedState:Zt.memoizedState,baseState:Zt.baseState,baseQueue:Zt.baseQueue,queue:Zt.queue,next:null},_s===null?ht.memoizedState=_s=e:_s=_s.next=e}return _s}function Ho(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ol(e){var a=Rl;return Rl+=1,Ui===null&&(Ui=[]),e=V0(Ui,e,a),a=ht,(_s===null?a.memoizedState:_s.next)===null&&(a=a.alternate,L.H=a===null||a.memoizedState===null?Mh:Ud),e}function Vo(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ol(e);if(e.$$typeof===q)return Ks(e)}throw Error(y(438,String(e)))}function Rd(e){var a=null,i=ht.updateQueue;if(i!==null&&(a=i.memoCache),a==null){var c=ht.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(x){return x.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),i===null&&(i=Ho(),ht.updateQueue=i),i.memoCache=a,i=a.data[a.index],i===void 0)for(i=a.data[a.index]=Array(e),c=0;c<e;c++)i[c]=le;return a.index++,i}function _n(e,a){return typeof a=="function"?a(e):a}function Go(e){var a=Ss();return Od(a,Zt,e)}function Od(e,a,i){var c=e.queue;if(c===null)throw Error(y(311));c.lastRenderedReducer=i;var x=e.baseQueue,p=c.pending;if(p!==null){if(x!==null){var S=x.next;x.next=p.next,p.next=S}a.baseQueue=x=p,c.pending=null}if(p=e.baseState,x===null)e.memoizedState=p;else{a=x.next;var B=S=null,W=null,ge=a,Ae=!1;do{var Se=ge.lane&-536870913;if(Se!==ge.lane?(At&Se)===Se:(Dn&Se)===Se){var pe=ge.revertLane;if(pe===0)W!==null&&(W=W.next={lane:0,revertLane:0,gesture:null,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),Se===Mi&&(Ae=!0);else if((Dn&pe)===pe){ge=ge.next,pe===Mi&&(Ae=!0);continue}else Se={lane:0,revertLane:ge.revertLane,gesture:null,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null},W===null?(B=W=Se,S=p):W=W.next=Se,ht.lanes|=pe,Nr|=pe;Se=ge.action,di&&i(p,Se),p=ge.hasEagerState?ge.eagerState:i(p,Se)}else pe={lane:Se,revertLane:ge.revertLane,gesture:ge.gesture,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null},W===null?(B=W=pe,S=p):W=W.next=pe,ht.lanes|=Se,Nr|=Se;ge=ge.next}while(ge!==null&&ge!==a);if(W===null?S=p:W.next=B,!d(p,e.memoizedState)&&(Is=!0,Ae&&(i=ki,i!==null)))throw i;e.memoizedState=p,e.baseState=S,e.baseQueue=W,c.lastRenderedState=p}return x===null&&(c.lanes=0),[e.memoizedState,c.dispatch]}function Dd(e){var a=Ss(),i=a.queue;if(i===null)throw Error(y(311));i.lastRenderedReducer=e;var c=i.dispatch,x=i.pending,p=a.memoizedState;if(x!==null){i.pending=null;var S=x=x.next;do p=e(p,S.action),S=S.next;while(S!==x);d(p,a.memoizedState)||(Is=!0),a.memoizedState=p,a.baseQueue===null&&(a.baseState=p),i.lastRenderedState=p}return[p,c]}function eh(e,a,i){var c=ht,x=Ss(),p=Tt;if(p){if(i===void 0)throw Error(y(407));i=i()}else i=a();var S=!d((Zt||x).memoizedState,i);if(S&&(x.memoizedState=i,Is=!0),x=x.queue,Md(ah.bind(null,c,x,e),[e]),x.getSnapshot!==a||S||_s!==null&&_s.memoizedState.tag&1){if(c.flags|=2048,zi(9,{destroy:void 0},sh.bind(null,c,x,i,a),null),ss===null)throw Error(y(349));p||(Dn&127)!==0||th(c,a,i)}return i}function th(e,a,i){e.flags|=16384,e={getSnapshot:a,value:i},a=ht.updateQueue,a===null?(a=Ho(),ht.updateQueue=a,a.stores=[e]):(i=a.stores,i===null?a.stores=[e]:i.push(e))}function sh(e,a,i,c){a.value=i,a.getSnapshot=c,nh(a)&&rh(e)}function ah(e,a,i){return i(function(){nh(a)&&rh(e)})}function nh(e){var a=e.getSnapshot;e=e.value;try{var i=a();return!d(e,i)}catch{return!0}}function rh(e){var a=ti(e,2);a!==null&&ga(a,e,2)}function _d(e){var a=la();if(typeof e=="function"){var i=e;if(e=i(),di){zt(!0);try{i()}finally{zt(!1)}}}return a.memoizedState=a.baseState=e,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_n,lastRenderedState:e},a}function ih(e,a,i,c){return e.baseState=i,Od(e,Zt,typeof c=="function"?c:_n)}function km(e,a,i,c,x){if(qo(e))throw Error(y(485));if(e=a.action,e!==null){var p={payload:x,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){p.listeners.push(S)}};L.T!==null?i(!0):p.isTransition=!1,c(p),i=a.pending,i===null?(p.next=a.pending=p,lh(a,p)):(p.next=i.next,a.pending=i.next=p)}}function lh(e,a){var i=a.action,c=a.payload,x=e.state;if(a.isTransition){var p=L.T,S={};L.T=S;try{var B=i(x,c),W=L.S;W!==null&&W(S,B),oh(e,a,B)}catch(ge){Id(e,a,ge)}finally{p!==null&&S.types!==null&&(p.types=S.types),L.T=p}}else try{p=i(x,c),oh(e,a,p)}catch(ge){Id(e,a,ge)}}function oh(e,a,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(c){ch(e,a,c)},function(c){return Id(e,a,c)}):ch(e,a,i)}function ch(e,a,i){a.status="fulfilled",a.value=i,dh(a),e.state=i,a=e.pending,a!==null&&(i=a.next,i===a?e.pending=null:(i=i.next,a.next=i,lh(e,i)))}function Id(e,a,i){var c=e.pending;if(e.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=i,dh(a),a=a.next;while(a!==c)}e.action=null}function dh(e){e=e.listeners;for(var a=0;a<e.length;a++)(0,e[a])()}function uh(e,a){return a}function hh(e,a){if(Tt){var i=ss.formState;if(i!==null){e:{var c=ht;if(Tt){if(ls){t:{for(var x=ls,p=Va;x.nodeType!==8;){if(!p){x=null;break t}if(x=Xa(x.nextSibling),x===null){x=null;break t}}p=x.data,x=p==="F!"||p==="F"?x:null}if(x){ls=Xa(x.nextSibling),c=x.data==="F!";break e}}fr(c)}c=!1}c&&(a=i[0])}}return i=la(),i.memoizedState=i.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:uh,lastRenderedState:a},i.queue=c,i=Dh.bind(null,ht,c),c.dispatch=i,c=_d(!1),p=Fd.bind(null,ht,!1,c.queue),c=la(),x={state:a,dispatch:null,action:e,pending:null},c.queue=x,i=km.bind(null,ht,x,p,i),x.dispatch=i,c.memoizedState=e,[a,i,!1]}function fh(e){var a=Ss();return xh(a,Zt,e)}function xh(e,a,i){if(a=Od(e,a,uh)[0],e=Go(_n)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=Ol(a)}catch(S){throw S===Bi?Mo:S}else c=a;a=Ss();var x=a.queue,p=x.dispatch;return i!==a.memoizedState&&(ht.flags|=2048,zi(9,{destroy:void 0},Bm.bind(null,x,i),null)),[c,p,e]}function Bm(e,a){e.action=a}function mh(e){var a=Ss(),i=Zt;if(i!==null)return xh(a,i,e);Ss(),a=a.memoizedState,i=Ss();var c=i.queue.dispatch;return i.memoizedState=e,[a,c,!1]}function zi(e,a,i,c){return e={tag:e,create:i,deps:c,inst:a,next:null},a=ht.updateQueue,a===null&&(a=Ho(),ht.updateQueue=a),i=a.lastEffect,i===null?a.lastEffect=e.next=e:(c=i.next,i.next=e,e.next=c,a.lastEffect=e),e}function gh(){return Ss().memoizedState}function Xo(e,a,i,c){var x=la();ht.flags|=e,x.memoizedState=zi(1|a,{destroy:void 0},i,c===void 0?null:c)}function Yo(e,a,i,c){var x=Ss();c=c===void 0?null:c;var p=x.memoizedState.inst;Zt!==null&&c!==null&&Ed(c,Zt.memoizedState.deps)?x.memoizedState=zi(a,p,i,c):(ht.flags|=e,x.memoizedState=zi(1|a,p,i,c))}function ph(e,a){Xo(8390656,8,e,a)}function Md(e,a){Yo(2048,8,e,a)}function Lm(e){ht.flags|=4;var a=ht.updateQueue;if(a===null)a=Ho(),ht.updateQueue=a,a.events=[e];else{var i=a.events;i===null?a.events=[e]:i.push(e)}}function yh(e){var a=Ss().memoizedState;return Lm({ref:a,nextImpl:e}),function(){if((Ft&2)!==0)throw Error(y(440));return a.impl.apply(void 0,arguments)}}function bh(e,a){return Yo(4,2,e,a)}function wh(e,a){return Yo(4,4,e,a)}function vh(e,a){if(typeof a=="function"){e=e();var i=a(e);return function(){typeof i=="function"?i():a(null)}}if(a!=null)return e=e(),a.current=e,function(){a.current=null}}function Nh(e,a,i){i=i!=null?i.concat([e]):null,Yo(4,4,vh.bind(null,a,e),i)}function kd(){}function Ch(e,a){var i=Ss();a=a===void 0?null:a;var c=i.memoizedState;return a!==null&&Ed(a,c[1])?c[0]:(i.memoizedState=[e,a],e)}function Eh(e,a){var i=Ss();a=a===void 0?null:a;var c=i.memoizedState;if(a!==null&&Ed(a,c[1]))return c[0];if(c=e(),di){zt(!0);try{e()}finally{zt(!1)}}return i.memoizedState=[c,a],c}function Bd(e,a,i){return i===void 0||(Dn&1073741824)!==0&&(At&261930)===0?e.memoizedState=a:(e.memoizedState=i,e=jf(),ht.lanes|=e,Nr|=e,i)}function Ah(e,a,i,c){return d(i,a)?i:Pi.current!==null?(e=Bd(e,i,c),d(e,a)||(Is=!0),e):(Dn&42)===0||(Dn&1073741824)!==0&&(At&261930)===0?(Is=!0,e.memoizedState=i):(e=jf(),ht.lanes|=e,Nr|=e,a)}function jh(e,a,i,c,x){var p=U.p;U.p=p!==0&&8>p?p:8;var S=L.T,B={};L.T=B,Fd(e,!1,a,i);try{var W=x(),ge=L.S;if(ge!==null&&ge(B,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var Ae=_m(W,c);Dl(e,a,Ae,_a(e))}else Dl(e,a,c,_a(e))}catch(Se){Dl(e,a,{then:function(){},status:"rejected",reason:Se},_a())}finally{U.p=p,S!==null&&B.types!==null&&(S.types=B.types),L.T=S}}function Pm(){}function Ld(e,a,i,c){if(e.tag!==5)throw Error(y(476));var x=Sh(e).queue;jh(e,x,a,V,i===null?Pm:function(){return Th(e),i(c)})}function Sh(e){var a=e.memoizedState;if(a!==null)return a;a={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_n,lastRenderedState:V},next:null};var i={};return a.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_n,lastRenderedState:i},next:null},e.memoizedState=a,e=e.alternate,e!==null&&(e.memoizedState=a),a}function Th(e){var a=Sh(e);a.next===null&&(a=e.alternate.memoizedState),Dl(e,a.next.queue,{},_a())}function Pd(){return Ks(Kl)}function Rh(){return Ss().memoizedState}function Oh(){return Ss().memoizedState}function Fm(e){for(var a=e.return;a!==null;){switch(a.tag){case 24:case 3:var i=_a();e=gr(i);var c=pr(a,e,i);c!==null&&(ga(c,a,i),jl(c,a,i)),a={cache:fd()},e.payload=a;return}a=a.return}}function Um(e,a,i){var c=_a();i={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},qo(e)?_h(a,i):(i=sd(e,a,i,c),i!==null&&(ga(i,e,c),Ih(i,a,c)))}function Dh(e,a,i){var c=_a();Dl(e,a,i,c)}function Dl(e,a,i,c){var x={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(qo(e))_h(a,x);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=a.lastRenderedReducer,p!==null))try{var S=a.lastRenderedState,B=p(S,i);if(x.hasEagerState=!0,x.eagerState=B,d(B,S))return So(e,a,x,0),ss===null&&jo(),!1}catch{}finally{}if(i=sd(e,a,x,c),i!==null)return ga(i,e,c),Ih(i,a,c),!0}return!1}function Fd(e,a,i,c){if(c={lane:2,revertLane:pu(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},qo(e)){if(a)throw Error(y(479))}else a=sd(e,i,c,2),a!==null&&ga(a,e,2)}function qo(e){var a=e.alternate;return e===ht||a!==null&&a===ht}function _h(e,a){Fi=Uo=!0;var i=e.pending;i===null?a.next=a:(a.next=i.next,i.next=a),e.pending=a}function Ih(e,a,i){if((i&4194048)!==0){var c=a.lanes;c&=e.pendingLanes,i|=c,a.lanes=i,on(e,i)}}var _l={readContext:Ks,use:Vo,useCallback:ys,useContext:ys,useEffect:ys,useImperativeHandle:ys,useLayoutEffect:ys,useInsertionEffect:ys,useMemo:ys,useReducer:ys,useRef:ys,useState:ys,useDebugValue:ys,useDeferredValue:ys,useTransition:ys,useSyncExternalStore:ys,useId:ys,useHostTransitionStatus:ys,useFormState:ys,useActionState:ys,useOptimistic:ys,useMemoCache:ys,useCacheRefresh:ys};_l.useEffectEvent=ys;var Mh={readContext:Ks,use:Vo,useCallback:function(e,a){return la().memoizedState=[e,a===void 0?null:a],e},useContext:Ks,useEffect:ph,useImperativeHandle:function(e,a,i){i=i!=null?i.concat([e]):null,Xo(4194308,4,vh.bind(null,a,e),i)},useLayoutEffect:function(e,a){return Xo(4194308,4,e,a)},useInsertionEffect:function(e,a){Xo(4,2,e,a)},useMemo:function(e,a){var i=la();a=a===void 0?null:a;var c=e();if(di){zt(!0);try{e()}finally{zt(!1)}}return i.memoizedState=[c,a],c},useReducer:function(e,a,i){var c=la();if(i!==void 0){var x=i(a);if(di){zt(!0);try{i(a)}finally{zt(!1)}}}else x=a;return c.memoizedState=c.baseState=x,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:x},c.queue=e,e=e.dispatch=Um.bind(null,ht,e),[c.memoizedState,e]},useRef:function(e){var a=la();return e={current:e},a.memoizedState=e},useState:function(e){e=_d(e);var a=e.queue,i=Dh.bind(null,ht,a);return a.dispatch=i,[e.memoizedState,i]},useDebugValue:kd,useDeferredValue:function(e,a){var i=la();return Bd(i,e,a)},useTransition:function(){var e=_d(!1);return e=jh.bind(null,ht,e.queue,!0,!1),la().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,a,i){var c=ht,x=la();if(Tt){if(i===void 0)throw Error(y(407));i=i()}else{if(i=a(),ss===null)throw Error(y(349));(At&127)!==0||th(c,a,i)}x.memoizedState=i;var p={value:i,getSnapshot:a};return x.queue=p,ph(ah.bind(null,c,p,e),[e]),c.flags|=2048,zi(9,{destroy:void 0},sh.bind(null,c,p,i,a),null),i},useId:function(){var e=la(),a=ss.identifierPrefix;if(Tt){var i=xn,c=fn;i=(c&~(1<<32-ut(c)-1)).toString(32)+i,a="_"+a+"R_"+i,i=zo++,0<i&&(a+="H"+i.toString(32)),a+="_"}else i=Im++,a="_"+a+"r_"+i.toString(32)+"_";return e.memoizedState=a},useHostTransitionStatus:Pd,useFormState:hh,useActionState:hh,useOptimistic:function(e){var a=la();a.memoizedState=a.baseState=e;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=i,a=Fd.bind(null,ht,!0,i),i.dispatch=a,[e,a]},useMemoCache:Rd,useCacheRefresh:function(){return la().memoizedState=Fm.bind(null,ht)},useEffectEvent:function(e){var a=la(),i={impl:e};return a.memoizedState=i,function(){if((Ft&2)!==0)throw Error(y(440));return i.impl.apply(void 0,arguments)}}},Ud={readContext:Ks,use:Vo,useCallback:Ch,useContext:Ks,useEffect:Md,useImperativeHandle:Nh,useInsertionEffect:bh,useLayoutEffect:wh,useMemo:Eh,useReducer:Go,useRef:gh,useState:function(){return Go(_n)},useDebugValue:kd,useDeferredValue:function(e,a){var i=Ss();return Ah(i,Zt.memoizedState,e,a)},useTransition:function(){var e=Go(_n)[0],a=Ss().memoizedState;return[typeof e=="boolean"?e:Ol(e),a]},useSyncExternalStore:eh,useId:Rh,useHostTransitionStatus:Pd,useFormState:fh,useActionState:fh,useOptimistic:function(e,a){var i=Ss();return ih(i,Zt,e,a)},useMemoCache:Rd,useCacheRefresh:Oh};Ud.useEffectEvent=yh;var kh={readContext:Ks,use:Vo,useCallback:Ch,useContext:Ks,useEffect:Md,useImperativeHandle:Nh,useInsertionEffect:bh,useLayoutEffect:wh,useMemo:Eh,useReducer:Dd,useRef:gh,useState:function(){return Dd(_n)},useDebugValue:kd,useDeferredValue:function(e,a){var i=Ss();return Zt===null?Bd(i,e,a):Ah(i,Zt.memoizedState,e,a)},useTransition:function(){var e=Dd(_n)[0],a=Ss().memoizedState;return[typeof e=="boolean"?e:Ol(e),a]},useSyncExternalStore:eh,useId:Rh,useHostTransitionStatus:Pd,useFormState:mh,useActionState:mh,useOptimistic:function(e,a){var i=Ss();return Zt!==null?ih(i,Zt,e,a):(i.baseState=e,[e,i.queue.dispatch])},useMemoCache:Rd,useCacheRefresh:Oh};kh.useEffectEvent=yh;function zd(e,a,i,c){a=e.memoizedState,i=i(c,a),i=i==null?a:O({},a,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var Hd={enqueueSetState:function(e,a,i){e=e._reactInternals;var c=_a(),x=gr(c);x.payload=a,i!=null&&(x.callback=i),a=pr(e,x,c),a!==null&&(ga(a,e,c),jl(a,e,c))},enqueueReplaceState:function(e,a,i){e=e._reactInternals;var c=_a(),x=gr(c);x.tag=1,x.payload=a,i!=null&&(x.callback=i),a=pr(e,x,c),a!==null&&(ga(a,e,c),jl(a,e,c))},enqueueForceUpdate:function(e,a){e=e._reactInternals;var i=_a(),c=gr(i);c.tag=2,a!=null&&(c.callback=a),a=pr(e,c,i),a!==null&&(ga(a,e,i),jl(a,e,i))}};function Bh(e,a,i,c,x,p,S){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,p,S):a.prototype&&a.prototype.isPureReactComponent?!h(i,c)||!h(x,p):!0}function Lh(e,a,i,c){e=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(i,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(i,c),a.state!==e&&Hd.enqueueReplaceState(a,a.state,null)}function ui(e,a){var i=a;if("ref"in a){i={};for(var c in a)c!=="ref"&&(i[c]=a[c])}if(e=e.defaultProps){i===a&&(i=O({},i));for(var x in e)i[x]===void 0&&(i[x]=e[x])}return i}function Ph(e){Ao(e)}function Fh(e){console.error(e)}function Uh(e){Ao(e)}function Ko(e,a){try{var i=e.onUncaughtError;i(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function zh(e,a,i){try{var c=e.onCaughtError;c(i.value,{componentStack:i.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Vd(e,a,i){return i=gr(i),i.tag=3,i.payload={element:null},i.callback=function(){Ko(e,a)},i}function Hh(e){return e=gr(e),e.tag=3,e}function Vh(e,a,i,c){var x=i.type.getDerivedStateFromError;if(typeof x=="function"){var p=c.value;e.payload=function(){return x(p)},e.callback=function(){zh(a,i,c)}}var S=i.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(e.callback=function(){zh(a,i,c),typeof x!="function"&&(Cr===null?Cr=new Set([this]):Cr.add(this));var B=c.stack;this.componentDidCatch(c.value,{componentStack:B!==null?B:""})})}function zm(e,a,i,c,x){if(i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=i.alternate,a!==null&&Ii(a,i,x,!0),i=Ta.current,i!==null){switch(i.tag){case 31:case 13:return Ga===null?ic():i.alternate===null&&bs===0&&(bs=3),i.flags&=-257,i.flags|=65536,i.lanes=x,c===ko?i.flags|=16384:(a=i.updateQueue,a===null?i.updateQueue=new Set([c]):a.add(c),xu(e,c,x)),!1;case 22:return i.flags|=65536,c===ko?i.flags|=16384:(a=i.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},i.updateQueue=a):(i=a.retryQueue,i===null?a.retryQueue=new Set([c]):i.add(c)),xu(e,c,x)),!1}throw Error(y(435,i.tag))}return xu(e,c,x),ic(),!1}if(Tt)return a=Ta.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=x,c!==od&&(e=Error(y(422),{cause:c}),vl(Ua(e,i)))):(c!==od&&(a=Error(y(423),{cause:c}),vl(Ua(a,i))),e=e.current.alternate,e.flags|=65536,x&=-x,e.lanes|=x,c=Ua(c,i),x=Vd(e.stateNode,c,x),bd(e,x),bs!==4&&(bs=2)),!1;var p=Error(y(520),{cause:c});if(p=Ua(p,i),Ul===null?Ul=[p]:Ul.push(p),bs!==4&&(bs=2),a===null)return!0;c=Ua(c,i),i=a;do{switch(i.tag){case 3:return i.flags|=65536,e=x&-x,i.lanes|=e,e=Vd(i.stateNode,c,e),bd(i,e),!1;case 1:if(a=i.type,p=i.stateNode,(i.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Cr===null||!Cr.has(p))))return i.flags|=65536,x&=-x,i.lanes|=x,x=Hh(x),Vh(x,e,i,c),bd(i,x),!1}i=i.return}while(i!==null);return!1}var Gd=Error(y(461)),Is=!1;function Zs(e,a,i,c){a.child=e===null?q0(a,null,i,c):ci(a,e.child,i,c)}function Gh(e,a,i,c,x){i=i.render;var p=a.ref;if("ref"in c){var S={};for(var B in c)B!=="ref"&&(S[B]=c[B])}else S=c;return ri(a),c=Ad(e,a,i,S,p,x),B=jd(),e!==null&&!Is?(Sd(e,a,x),In(e,a,x)):(Tt&&B&&id(a),a.flags|=1,Zs(e,a,c,x),a.child)}function Xh(e,a,i,c,x){if(e===null){var p=i.type;return typeof p=="function"&&!ad(p)&&p.defaultProps===void 0&&i.compare===null?(a.tag=15,a.type=p,Yh(e,a,p,c,x)):(e=Ro(i.type,null,c,a,a.mode,x),e.ref=a.ref,e.return=a,a.child=e)}if(p=e.child,!Jd(e,x)){var S=p.memoizedProps;if(i=i.compare,i=i!==null?i:h,i(S,c)&&e.ref===a.ref)return In(e,a,x)}return a.flags|=1,e=Sn(p,c),e.ref=a.ref,e.return=a,a.child=e}function Yh(e,a,i,c,x){if(e!==null){var p=e.memoizedProps;if(h(p,c)&&e.ref===a.ref)if(Is=!1,a.pendingProps=c=p,Jd(e,x))(e.flags&131072)!==0&&(Is=!0);else return a.lanes=e.lanes,In(e,a,x)}return Xd(e,a,i,c,x)}function qh(e,a,i,c){var x=c.children,p=e!==null?e.memoizedState:null;if(e===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(p=p!==null?p.baseLanes|i:i,e!==null){for(c=a.child=e.child,x=0;c!==null;)x=x|c.lanes|c.childLanes,c=c.sibling;c=x&~p}else c=0,a.child=null;return Kh(e,a,p,i,c)}if((i&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},e!==null&&Io(a,p!==null?p.cachePool:null),p!==null?W0(a,p):vd(),Q0(a);else return c=a.lanes=536870912,Kh(e,a,p!==null?p.baseLanes|i:i,i,c)}else p!==null?(Io(a,p.cachePool),W0(a,p),br(),a.memoizedState=null):(e!==null&&Io(a,null),vd(),br());return Zs(e,a,x,i),a.child}function Il(e,a){return e!==null&&e.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Kh(e,a,i,c,x){var p=md();return p=p===null?null:{parent:Ds._currentValue,pool:p},a.memoizedState={baseLanes:i,cachePool:p},e!==null&&Io(a,null),vd(),Q0(a),e!==null&&Ii(e,a,c,!0),a.childLanes=x,null}function Zo(e,a){return a=Qo({mode:a.mode,children:a.children},e.mode),a.ref=e.ref,e.child=a,a.return=e,a}function Zh(e,a,i){return ci(a,e.child,null,i),e=Zo(a,a.pendingProps),e.flags|=2,Ra(a),a.memoizedState=null,e}function Hm(e,a,i){var c=a.pendingProps,x=(a.flags&128)!==0;if(a.flags&=-129,e===null){if(Tt){if(c.mode==="hidden")return e=Zo(a,c),a.lanes=536870912,Il(null,e);if(Cd(a),(e=ls)?(e=o1(e,Va),e=e!==null&&e.data==="&"?e:null,e!==null&&(a.memoizedState={dehydrated:e,treeContext:ur!==null?{id:fn,overflow:xn}:null,retryLane:536870912,hydrationErrors:null},i=_0(e),i.return=a,a.child=i,qs=a,ls=null)):e=null,e===null)throw fr(a);return a.lanes=536870912,null}return Zo(a,c)}var p=e.memoizedState;if(p!==null){var S=p.dehydrated;if(Cd(a),x)if(a.flags&256)a.flags&=-257,a=Zh(e,a,i);else if(a.memoizedState!==null)a.child=e.child,a.flags|=128,a=null;else throw Error(y(558));else if(Is||Ii(e,a,i,!1),x=(i&e.childLanes)!==0,Is||x){if(c=ss,c!==null&&(S=pi(c,i),S!==0&&S!==p.retryLane))throw p.retryLane=S,ti(e,S),ga(c,e,S),Gd;ic(),a=Zh(e,a,i)}else e=p.treeContext,ls=Xa(S.nextSibling),qs=a,Tt=!0,hr=null,Va=!1,e!==null&&k0(a,e),a=Zo(a,c),a.flags|=4096;return a}return e=Sn(e.child,{mode:c.mode,children:c.children}),e.ref=a.ref,a.child=e,e.return=a,e}function Wo(e,a){var i=a.ref;if(i===null)e!==null&&e.ref!==null&&(a.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(y(284));(e===null||e.ref!==i)&&(a.flags|=4194816)}}function Xd(e,a,i,c,x){return ri(a),i=Ad(e,a,i,c,void 0,x),c=jd(),e!==null&&!Is?(Sd(e,a,x),In(e,a,x)):(Tt&&c&&id(a),a.flags|=1,Zs(e,a,i,x),a.child)}function Wh(e,a,i,c,x,p){return ri(a),a.updateQueue=null,i=$0(a,c,i,x),J0(e),c=jd(),e!==null&&!Is?(Sd(e,a,p),In(e,a,p)):(Tt&&c&&id(a),a.flags|=1,Zs(e,a,i,p),a.child)}function Qh(e,a,i,c,x){if(ri(a),a.stateNode===null){var p=Ri,S=i.contextType;typeof S=="object"&&S!==null&&(p=Ks(S)),p=new i(c,p),a.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Hd,a.stateNode=p,p._reactInternals=a,p=a.stateNode,p.props=c,p.state=a.memoizedState,p.refs={},pd(a),S=i.contextType,p.context=typeof S=="object"&&S!==null?Ks(S):Ri,p.state=a.memoizedState,S=i.getDerivedStateFromProps,typeof S=="function"&&(zd(a,i,S,c),p.state=a.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(S=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),S!==p.state&&Hd.enqueueReplaceState(p,p.state,null),Tl(a,c,p,x),Sl(),p.state=a.memoizedState),typeof p.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(e===null){p=a.stateNode;var B=a.memoizedProps,W=ui(i,B);p.props=W;var ge=p.context,Ae=i.contextType;S=Ri,typeof Ae=="object"&&Ae!==null&&(S=Ks(Ae));var Se=i.getDerivedStateFromProps;Ae=typeof Se=="function"||typeof p.getSnapshotBeforeUpdate=="function",B=a.pendingProps!==B,Ae||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(B||ge!==S)&&Lh(a,p,c,S),mr=!1;var pe=a.memoizedState;p.state=pe,Tl(a,c,p,x),Sl(),ge=a.memoizedState,B||pe!==ge||mr?(typeof Se=="function"&&(zd(a,i,Se,c),ge=a.memoizedState),(W=mr||Bh(a,i,W,c,pe,ge,S))?(Ae||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(a.flags|=4194308)):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=ge),p.props=c,p.state=ge,p.context=S,c=W):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{p=a.stateNode,yd(e,a),S=a.memoizedProps,Ae=ui(i,S),p.props=Ae,Se=a.pendingProps,pe=p.context,ge=i.contextType,W=Ri,typeof ge=="object"&&ge!==null&&(W=Ks(ge)),B=i.getDerivedStateFromProps,(ge=typeof B=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S!==Se||pe!==W)&&Lh(a,p,c,W),mr=!1,pe=a.memoizedState,p.state=pe,Tl(a,c,p,x),Sl();var Ce=a.memoizedState;S!==Se||pe!==Ce||mr||e!==null&&e.dependencies!==null&&Do(e.dependencies)?(typeof B=="function"&&(zd(a,i,B,c),Ce=a.memoizedState),(Ae=mr||Bh(a,i,Ae,c,pe,Ce,W)||e!==null&&e.dependencies!==null&&Do(e.dependencies))?(ge||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(c,Ce,W),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(c,Ce,W)),typeof p.componentDidUpdate=="function"&&(a.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof p.componentDidUpdate!="function"||S===e.memoizedProps&&pe===e.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===e.memoizedProps&&pe===e.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=Ce),p.props=c,p.state=Ce,p.context=W,c=Ae):(typeof p.componentDidUpdate!="function"||S===e.memoizedProps&&pe===e.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===e.memoizedProps&&pe===e.memoizedState||(a.flags|=1024),c=!1)}return p=c,Wo(e,a),c=(a.flags&128)!==0,p||c?(p=a.stateNode,i=c&&typeof i.getDerivedStateFromError!="function"?null:p.render(),a.flags|=1,e!==null&&c?(a.child=ci(a,e.child,null,x),a.child=ci(a,null,i,x)):Zs(e,a,i,x),a.memoizedState=p.state,e=a.child):e=In(e,a,x),e}function Jh(e,a,i,c){return ai(),a.flags|=256,Zs(e,a,i,c),a.child}var Yd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function qd(e){return{baseLanes:e,cachePool:z0()}}function Kd(e,a,i){return e=e!==null?e.childLanes&~i:0,a&&(e|=Da),e}function $h(e,a,i){var c=a.pendingProps,x=!1,p=(a.flags&128)!==0,S;if((S=p)||(S=e!==null&&e.memoizedState===null?!1:(js.current&2)!==0),S&&(x=!0,a.flags&=-129),S=(a.flags&32)!==0,a.flags&=-33,e===null){if(Tt){if(x?yr(a):br(),(e=ls)?(e=o1(e,Va),e=e!==null&&e.data!=="&"?e:null,e!==null&&(a.memoizedState={dehydrated:e,treeContext:ur!==null?{id:fn,overflow:xn}:null,retryLane:536870912,hydrationErrors:null},i=_0(e),i.return=a,a.child=i,qs=a,ls=null)):e=null,e===null)throw fr(a);return Ou(e)?a.lanes=32:a.lanes=536870912,null}var B=c.children;return c=c.fallback,x?(br(),x=a.mode,B=Qo({mode:"hidden",children:B},x),c=si(c,x,i,null),B.return=a,c.return=a,B.sibling=c,a.child=B,c=a.child,c.memoizedState=qd(i),c.childLanes=Kd(e,S,i),a.memoizedState=Yd,Il(null,c)):(yr(a),Zd(a,B))}var W=e.memoizedState;if(W!==null&&(B=W.dehydrated,B!==null)){if(p)a.flags&256?(yr(a),a.flags&=-257,a=Wd(e,a,i)):a.memoizedState!==null?(br(),a.child=e.child,a.flags|=128,a=null):(br(),B=c.fallback,x=a.mode,c=Qo({mode:"visible",children:c.children},x),B=si(B,x,i,null),B.flags|=2,c.return=a,B.return=a,c.sibling=B,a.child=c,ci(a,e.child,null,i),c=a.child,c.memoizedState=qd(i),c.childLanes=Kd(e,S,i),a.memoizedState=Yd,a=Il(null,c));else if(yr(a),Ou(B)){if(S=B.nextSibling&&B.nextSibling.dataset,S)var ge=S.dgst;S=ge,c=Error(y(419)),c.stack="",c.digest=S,vl({value:c,source:null,stack:null}),a=Wd(e,a,i)}else if(Is||Ii(e,a,i,!1),S=(i&e.childLanes)!==0,Is||S){if(S=ss,S!==null&&(c=pi(S,i),c!==0&&c!==W.retryLane))throw W.retryLane=c,ti(e,c),ga(S,e,c),Gd;Ru(B)||ic(),a=Wd(e,a,i)}else Ru(B)?(a.flags|=192,a.child=e.child,a=null):(e=W.treeContext,ls=Xa(B.nextSibling),qs=a,Tt=!0,hr=null,Va=!1,e!==null&&k0(a,e),a=Zd(a,c.children),a.flags|=4096);return a}return x?(br(),B=c.fallback,x=a.mode,W=e.child,ge=W.sibling,c=Sn(W,{mode:"hidden",children:c.children}),c.subtreeFlags=W.subtreeFlags&65011712,ge!==null?B=Sn(ge,B):(B=si(B,x,i,null),B.flags|=2),B.return=a,c.return=a,c.sibling=B,a.child=c,Il(null,c),c=a.child,B=e.child.memoizedState,B===null?B=qd(i):(x=B.cachePool,x!==null?(W=Ds._currentValue,x=x.parent!==W?{parent:W,pool:W}:x):x=z0(),B={baseLanes:B.baseLanes|i,cachePool:x}),c.memoizedState=B,c.childLanes=Kd(e,S,i),a.memoizedState=Yd,Il(e.child,c)):(yr(a),i=e.child,e=i.sibling,i=Sn(i,{mode:"visible",children:c.children}),i.return=a,i.sibling=null,e!==null&&(S=a.deletions,S===null?(a.deletions=[e],a.flags|=16):S.push(e)),a.child=i,a.memoizedState=null,i)}function Zd(e,a){return a=Qo({mode:"visible",children:a},e.mode),a.return=e,e.child=a}function Qo(e,a){return e=Sa(22,e,null,a),e.lanes=0,e}function Wd(e,a,i){return ci(a,e.child,null,i),e=Zd(a,a.pendingProps.children),e.flags|=2,a.memoizedState=null,e}function ef(e,a,i){e.lanes|=a;var c=e.alternate;c!==null&&(c.lanes|=a),ud(e.return,a,i)}function Qd(e,a,i,c,x,p){var S=e.memoizedState;S===null?e.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:i,tailMode:x,treeForkCount:p}:(S.isBackwards=a,S.rendering=null,S.renderingStartTime=0,S.last=c,S.tail=i,S.tailMode=x,S.treeForkCount=p)}function tf(e,a,i){var c=a.pendingProps,x=c.revealOrder,p=c.tail;c=c.children;var S=js.current,B=(S&2)!==0;if(B?(S=S&1|2,a.flags|=128):S&=1,Ee(js,S),Zs(e,a,c,i),c=Tt?wl:0,!B&&e!==null&&(e.flags&128)!==0)e:for(e=a.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ef(e,i,a);else if(e.tag===19)ef(e,i,a);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===a)break e;for(;e.sibling===null;){if(e.return===null||e.return===a)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(x){case"forwards":for(i=a.child,x=null;i!==null;)e=i.alternate,e!==null&&Fo(e)===null&&(x=i),i=i.sibling;i=x,i===null?(x=a.child,a.child=null):(x=i.sibling,i.sibling=null),Qd(a,!1,x,i,p,c);break;case"backwards":case"unstable_legacy-backwards":for(i=null,x=a.child,a.child=null;x!==null;){if(e=x.alternate,e!==null&&Fo(e)===null){a.child=x;break}e=x.sibling,x.sibling=i,i=x,x=e}Qd(a,!0,i,null,p,c);break;case"together":Qd(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function In(e,a,i){if(e!==null&&(a.dependencies=e.dependencies),Nr|=a.lanes,(i&a.childLanes)===0)if(e!==null){if(Ii(e,a,i,!1),(i&a.childLanes)===0)return null}else return null;if(e!==null&&a.child!==e.child)throw Error(y(153));if(a.child!==null){for(e=a.child,i=Sn(e,e.pendingProps),a.child=i,i.return=a;e.sibling!==null;)e=e.sibling,i=i.sibling=Sn(e,e.pendingProps),i.return=a;i.sibling=null}return a.child}function Jd(e,a){return(e.lanes&a)!==0?!0:(e=e.dependencies,!!(e!==null&&Do(e)))}function Vm(e,a,i){switch(a.tag){case 3:et(a,a.stateNode.containerInfo),xr(a,Ds,e.memoizedState.cache),ai();break;case 27:case 5:ns(a);break;case 4:et(a,a.stateNode.containerInfo);break;case 10:xr(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Cd(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(yr(a),a.flags|=128,null):(i&a.child.childLanes)!==0?$h(e,a,i):(yr(a),e=In(e,a,i),e!==null?e.sibling:null);yr(a);break;case 19:var x=(e.flags&128)!==0;if(c=(i&a.childLanes)!==0,c||(Ii(e,a,i,!1),c=(i&a.childLanes)!==0),x){if(c)return tf(e,a,i);a.flags|=128}if(x=a.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Ee(js,js.current),c)break;return null;case 22:return a.lanes=0,qh(e,a,i,a.pendingProps);case 24:xr(a,Ds,e.memoizedState.cache)}return In(e,a,i)}function sf(e,a,i){if(e!==null)if(e.memoizedProps!==a.pendingProps)Is=!0;else{if(!Jd(e,i)&&(a.flags&128)===0)return Is=!1,Vm(e,a,i);Is=(e.flags&131072)!==0}else Is=!1,Tt&&(a.flags&1048576)!==0&&M0(a,wl,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(e=li(a.elementType),a.type=e,typeof e=="function")ad(e)?(c=ui(e,c),a.tag=1,a=Qh(null,a,e,c,i)):(a.tag=0,a=Xd(null,a,e,c,i));else{if(e!=null){var x=e.$$typeof;if(x===oe){a.tag=11,a=Gh(null,a,e,c,i);break e}else if(x===K){a.tag=14,a=Xh(null,a,e,c,i);break e}}throw a=Ne(e)||e,Error(y(306,a,""))}}return a;case 0:return Xd(e,a,a.type,a.pendingProps,i);case 1:return c=a.type,x=ui(c,a.pendingProps),Qh(e,a,c,x,i);case 3:e:{if(et(a,a.stateNode.containerInfo),e===null)throw Error(y(387));c=a.pendingProps;var p=a.memoizedState;x=p.element,yd(e,a),Tl(a,c,null,i);var S=a.memoizedState;if(c=S.cache,xr(a,Ds,c),c!==p.cache&&hd(a,[Ds],i,!0),Sl(),c=S.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:S.cache},a.updateQueue.baseState=p,a.memoizedState=p,a.flags&256){a=Jh(e,a,c,i);break e}else if(c!==x){x=Ua(Error(y(424)),a),vl(x),a=Jh(e,a,c,i);break e}else{switch(e=a.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ls=Xa(e.firstChild),qs=a,Tt=!0,hr=null,Va=!0,i=q0(a,null,c,i),a.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling}else{if(ai(),c===x){a=In(e,a,i);break e}Zs(e,a,c,i)}a=a.child}return a;case 26:return Wo(e,a),e===null?(i=x1(a.type,null,a.pendingProps,null))?a.memoizedState=i:Tt||(i=a.type,e=a.pendingProps,c=fc(Re.current).createElement(i),c[Cs]=a,c[Yt]=e,Ws(c,i,e),gs(c),a.stateNode=c):a.memoizedState=x1(a.type,e.memoizedProps,a.pendingProps,e.memoizedState),null;case 27:return ns(a),e===null&&Tt&&(c=a.stateNode=u1(a.type,a.pendingProps,Re.current),qs=a,Va=!0,x=ls,Sr(a.type)?(Du=x,ls=Xa(c.firstChild)):ls=x),Zs(e,a,a.pendingProps.children,i),Wo(e,a),e===null&&(a.flags|=4194304),a.child;case 5:return e===null&&Tt&&((x=c=ls)&&(c=bg(c,a.type,a.pendingProps,Va),c!==null?(a.stateNode=c,qs=a,ls=Xa(c.firstChild),Va=!1,x=!0):x=!1),x||fr(a)),ns(a),x=a.type,p=a.pendingProps,S=e!==null?e.memoizedProps:null,c=p.children,ju(x,p)?c=null:S!==null&&ju(x,S)&&(a.flags|=32),a.memoizedState!==null&&(x=Ad(e,a,Mm,null,null,i),Kl._currentValue=x),Wo(e,a),Zs(e,a,c,i),a.child;case 6:return e===null&&Tt&&((e=i=ls)&&(i=wg(i,a.pendingProps,Va),i!==null?(a.stateNode=i,qs=a,ls=null,e=!0):e=!1),e||fr(a)),null;case 13:return $h(e,a,i);case 4:return et(a,a.stateNode.containerInfo),c=a.pendingProps,e===null?a.child=ci(a,null,c,i):Zs(e,a,c,i),a.child;case 11:return Gh(e,a,a.type,a.pendingProps,i);case 7:return Zs(e,a,a.pendingProps,i),a.child;case 8:return Zs(e,a,a.pendingProps.children,i),a.child;case 12:return Zs(e,a,a.pendingProps.children,i),a.child;case 10:return c=a.pendingProps,xr(a,a.type,c.value),Zs(e,a,c.children,i),a.child;case 9:return x=a.type._context,c=a.pendingProps.children,ri(a),x=Ks(x),c=c(x),a.flags|=1,Zs(e,a,c,i),a.child;case 14:return Xh(e,a,a.type,a.pendingProps,i);case 15:return Yh(e,a,a.type,a.pendingProps,i);case 19:return tf(e,a,i);case 31:return Hm(e,a,i);case 22:return qh(e,a,i,a.pendingProps);case 24:return ri(a),c=Ks(Ds),e===null?(x=md(),x===null&&(x=ss,p=fd(),x.pooledCache=p,p.refCount++,p!==null&&(x.pooledCacheLanes|=i),x=p),a.memoizedState={parent:c,cache:x},pd(a),xr(a,Ds,x)):((e.lanes&i)!==0&&(yd(e,a),Tl(a,null,null,i),Sl()),x=e.memoizedState,p=a.memoizedState,x.parent!==c?(x={parent:c,cache:c},a.memoizedState=x,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=x),xr(a,Ds,c)):(c=p.cache,xr(a,Ds,c),c!==x.cache&&hd(a,[Ds],i,!0))),Zs(e,a,a.pendingProps.children,i),a.child;case 29:throw a.pendingProps}throw Error(y(156,a.tag))}function Mn(e){e.flags|=4}function $d(e,a,i,c,x){if((a=(e.mode&32)!==0)&&(a=!1),a){if(e.flags|=16777216,(x&335544128)===x)if(e.stateNode.complete)e.flags|=8192;else if(Of())e.flags|=8192;else throw oi=ko,gd}else e.flags&=-16777217}function af(e,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!b1(a))if(Of())e.flags|=8192;else throw oi=ko,gd}function Jo(e,a){a!==null&&(e.flags|=4),e.flags&16384&&(a=e.tag!==22?Ls():536870912,e.lanes|=a,Xi|=a)}function Ml(e,a){if(!Tt)switch(e.tailMode){case"hidden":a=e.tail;for(var i=null;a!==null;)a.alternate!==null&&(i=a),a=a.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?a||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function os(e){var a=e.alternate!==null&&e.alternate.child===e.child,i=0,c=0;if(a)for(var x=e.child;x!==null;)i|=x.lanes|x.childLanes,c|=x.subtreeFlags&65011712,c|=x.flags&65011712,x.return=e,x=x.sibling;else for(x=e.child;x!==null;)i|=x.lanes|x.childLanes,c|=x.subtreeFlags,c|=x.flags,x.return=e,x=x.sibling;return e.subtreeFlags|=c,e.childLanes=i,a}function Gm(e,a,i){var c=a.pendingProps;switch(ld(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return os(a),null;case 1:return os(a),null;case 3:return i=a.stateNode,c=null,e!==null&&(c=e.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),On(Ds),ct(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(_i(a)?Mn(a):e===null||e.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,cd())),os(a),null;case 26:var x=a.type,p=a.memoizedState;return e===null?(Mn(a),p!==null?(os(a),af(a,p)):(os(a),$d(a,x,null,c,i))):p?p!==e.memoizedState?(Mn(a),os(a),af(a,p)):(os(a),a.flags&=-16777217):(e=e.memoizedProps,e!==c&&Mn(a),os(a),$d(a,x,e,c,i)),null;case 27:if(Dt(a),i=Re.current,x=a.type,e!==null&&a.stateNode!=null)e.memoizedProps!==c&&Mn(a);else{if(!c){if(a.stateNode===null)throw Error(y(166));return os(a),null}e=ye.current,_i(a)?B0(a):(e=u1(x,c,i),a.stateNode=e,Mn(a))}return os(a),null;case 5:if(Dt(a),x=a.type,e!==null&&a.stateNode!=null)e.memoizedProps!==c&&Mn(a);else{if(!c){if(a.stateNode===null)throw Error(y(166));return os(a),null}if(p=ye.current,_i(a))B0(a);else{var S=fc(Re.current);switch(p){case 1:p=S.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:p=S.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":p=S.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":p=S.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":p=S.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof c.is=="string"?S.createElement("select",{is:c.is}):S.createElement("select"),c.multiple?p.multiple=!0:c.size&&(p.size=c.size);break;default:p=typeof c.is=="string"?S.createElement(x,{is:c.is}):S.createElement(x)}}p[Cs]=a,p[Yt]=c;e:for(S=a.child;S!==null;){if(S.tag===5||S.tag===6)p.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===a)break e;for(;S.sibling===null;){if(S.return===null||S.return===a)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}a.stateNode=p;e:switch(Ws(p,x,c),x){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Mn(a)}}return os(a),$d(a,a.type,e===null?null:e.memoizedProps,a.pendingProps,i),null;case 6:if(e&&a.stateNode!=null)e.memoizedProps!==c&&Mn(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(y(166));if(e=Re.current,_i(a)){if(e=a.stateNode,i=a.memoizedProps,c=null,x=qs,x!==null)switch(x.tag){case 27:case 5:c=x.memoizedProps}e[Cs]=a,e=!!(e.nodeValue===i||c!==null&&c.suppressHydrationWarning===!0||e1(e.nodeValue,i)),e||fr(a,!0)}else e=fc(e).createTextNode(c),e[Cs]=a,a.stateNode=e}return os(a),null;case 31:if(i=a.memoizedState,e===null||e.memoizedState!==null){if(c=_i(a),i!==null){if(e===null){if(!c)throw Error(y(318));if(e=a.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(y(557));e[Cs]=a}else ai(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;os(a),e=!1}else i=cd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=i),e=!0;if(!e)return a.flags&256?(Ra(a),a):(Ra(a),null);if((a.flags&128)!==0)throw Error(y(558))}return os(a),null;case 13:if(c=a.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(x=_i(a),c!==null&&c.dehydrated!==null){if(e===null){if(!x)throw Error(y(318));if(x=a.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(y(317));x[Cs]=a}else ai(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;os(a),x=!1}else x=cd(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=x),x=!0;if(!x)return a.flags&256?(Ra(a),a):(Ra(a),null)}return Ra(a),(a.flags&128)!==0?(a.lanes=i,a):(i=c!==null,e=e!==null&&e.memoizedState!==null,i&&(c=a.child,x=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(x=c.alternate.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==x&&(c.flags|=2048)),i!==e&&i&&(a.child.flags|=8192),Jo(a,a.updateQueue),os(a),null);case 4:return ct(),e===null&&vu(a.stateNode.containerInfo),os(a),null;case 10:return On(a.type),os(a),null;case 19:if(se(js),c=a.memoizedState,c===null)return os(a),null;if(x=(a.flags&128)!==0,p=c.rendering,p===null)if(x)Ml(c,!1);else{if(bs!==0||e!==null&&(e.flags&128)!==0)for(e=a.child;e!==null;){if(p=Fo(e),p!==null){for(a.flags|=128,Ml(c,!1),e=p.updateQueue,a.updateQueue=e,Jo(a,e),a.subtreeFlags=0,e=i,i=a.child;i!==null;)D0(i,e),i=i.sibling;return Ee(js,js.current&1|2),Tt&&Tn(a,c.treeForkCount),a.child}e=e.sibling}c.tail!==null&&Ke()>ac&&(a.flags|=128,x=!0,Ml(c,!1),a.lanes=4194304)}else{if(!x)if(e=Fo(p),e!==null){if(a.flags|=128,x=!0,e=e.updateQueue,a.updateQueue=e,Jo(a,e),Ml(c,!0),c.tail===null&&c.tailMode==="hidden"&&!p.alternate&&!Tt)return os(a),null}else 2*Ke()-c.renderingStartTime>ac&&i!==536870912&&(a.flags|=128,x=!0,Ml(c,!1),a.lanes=4194304);c.isBackwards?(p.sibling=a.child,a.child=p):(e=c.last,e!==null?e.sibling=p:a.child=p,c.last=p)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=Ke(),e.sibling=null,i=js.current,Ee(js,x?i&1|2:i&1),Tt&&Tn(a,c.treeForkCount),e):(os(a),null);case 22:case 23:return Ra(a),Nd(),c=a.memoizedState!==null,e!==null?e.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(i&536870912)!==0&&(a.flags&128)===0&&(os(a),a.subtreeFlags&6&&(a.flags|=8192)):os(a),i=a.updateQueue,i!==null&&Jo(a,i.retryQueue),i=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==i&&(a.flags|=2048),e!==null&&se(ii),null;case 24:return i=null,e!==null&&(i=e.memoizedState.cache),a.memoizedState.cache!==i&&(a.flags|=2048),On(Ds),os(a),null;case 25:return null;case 30:return null}throw Error(y(156,a.tag))}function Xm(e,a){switch(ld(a),a.tag){case 1:return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 3:return On(Ds),ct(),e=a.flags,(e&65536)!==0&&(e&128)===0?(a.flags=e&-65537|128,a):null;case 26:case 27:case 5:return Dt(a),null;case 31:if(a.memoizedState!==null){if(Ra(a),a.alternate===null)throw Error(y(340));ai()}return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 13:if(Ra(a),e=a.memoizedState,e!==null&&e.dehydrated!==null){if(a.alternate===null)throw Error(y(340));ai()}return e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 19:return se(js),null;case 4:return ct(),null;case 10:return On(a.type),null;case 22:case 23:return Ra(a),Nd(),e!==null&&se(ii),e=a.flags,e&65536?(a.flags=e&-65537|128,a):null;case 24:return On(Ds),null;case 25:return null;default:return null}}function nf(e,a){switch(ld(a),a.tag){case 3:On(Ds),ct();break;case 26:case 27:case 5:Dt(a);break;case 4:ct();break;case 31:a.memoizedState!==null&&Ra(a);break;case 13:Ra(a);break;case 19:se(js);break;case 10:On(a.type);break;case 22:case 23:Ra(a),Nd(),e!==null&&se(ii);break;case 24:On(Ds)}}function kl(e,a){try{var i=a.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var x=c.next;i=x;do{if((i.tag&e)===e){c=void 0;var p=i.create,S=i.inst;c=p(),S.destroy=c}i=i.next}while(i!==x)}}catch(B){Kt(a,a.return,B)}}function wr(e,a,i){try{var c=a.updateQueue,x=c!==null?c.lastEffect:null;if(x!==null){var p=x.next;c=p;do{if((c.tag&e)===e){var S=c.inst,B=S.destroy;if(B!==void 0){S.destroy=void 0,x=a;var W=i,ge=B;try{ge()}catch(Ae){Kt(x,W,Ae)}}}c=c.next}while(c!==p)}}catch(Ae){Kt(a,a.return,Ae)}}function rf(e){var a=e.updateQueue;if(a!==null){var i=e.stateNode;try{Z0(a,i)}catch(c){Kt(e,e.return,c)}}}function lf(e,a,i){i.props=ui(e.type,e.memoizedProps),i.state=e.memoizedState;try{i.componentWillUnmount()}catch(c){Kt(e,a,c)}}function Bl(e,a){try{var i=e.ref;if(i!==null){switch(e.tag){case 26:case 27:case 5:var c=e.stateNode;break;case 30:c=e.stateNode;break;default:c=e.stateNode}typeof i=="function"?e.refCleanup=i(c):i.current=c}}catch(x){Kt(e,a,x)}}function mn(e,a){var i=e.ref,c=e.refCleanup;if(i!==null)if(typeof c=="function")try{c()}catch(x){Kt(e,a,x)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(x){Kt(e,a,x)}else i.current=null}function of(e){var a=e.type,i=e.memoizedProps,c=e.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":i.autoFocus&&c.focus();break e;case"img":i.src?c.src=i.src:i.srcSet&&(c.srcset=i.srcSet)}}catch(x){Kt(e,e.return,x)}}function eu(e,a,i){try{var c=e.stateNode;fg(c,e.type,i,a),c[Yt]=a}catch(x){Kt(e,e.return,x)}}function cf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Sr(e.type)||e.tag===4}function tu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||cf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Sr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function su(e,a,i){var c=e.tag;if(c===5||c===6)e=e.stateNode,a?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(e,a):(a=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,a.appendChild(e),i=i._reactRootContainer,i!=null||a.onclick!==null||(a.onclick=ca));else if(c!==4&&(c===27&&Sr(e.type)&&(i=e.stateNode,a=null),e=e.child,e!==null))for(su(e,a,i),e=e.sibling;e!==null;)su(e,a,i),e=e.sibling}function $o(e,a,i){var c=e.tag;if(c===5||c===6)e=e.stateNode,a?i.insertBefore(e,a):i.appendChild(e);else if(c!==4&&(c===27&&Sr(e.type)&&(i=e.stateNode),e=e.child,e!==null))for($o(e,a,i),e=e.sibling;e!==null;)$o(e,a,i),e=e.sibling}function df(e){var a=e.stateNode,i=e.memoizedProps;try{for(var c=e.type,x=a.attributes;x.length;)a.removeAttributeNode(x[0]);Ws(a,c,i),a[Cs]=e,a[Yt]=i}catch(p){Kt(e,e.return,p)}}var kn=!1,Ms=!1,au=!1,uf=typeof WeakSet=="function"?WeakSet:Set,Vs=null;function Ym(e,a){if(e=e.containerInfo,Eu=wc,e=I(e),k(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var c=i.getSelection&&i.getSelection();if(c&&c.rangeCount!==0){i=c.anchorNode;var x=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{i.nodeType,p.nodeType}catch{i=null;break e}var S=0,B=-1,W=-1,ge=0,Ae=0,Se=e,pe=null;t:for(;;){for(var Ce;Se!==i||x!==0&&Se.nodeType!==3||(B=S+x),Se!==p||c!==0&&Se.nodeType!==3||(W=S+c),Se.nodeType===3&&(S+=Se.nodeValue.length),(Ce=Se.firstChild)!==null;)pe=Se,Se=Ce;for(;;){if(Se===e)break t;if(pe===i&&++ge===x&&(B=S),pe===p&&++Ae===c&&(W=S),(Ce=Se.nextSibling)!==null)break;Se=pe,pe=Se.parentNode}Se=Ce}i=B===-1||W===-1?null:{start:B,end:W}}else i=null}i=i||{start:0,end:0}}else i=null;for(Au={focusedElem:e,selectionRange:i},wc=!1,Vs=a;Vs!==null;)if(a=Vs,e=a.child,(a.subtreeFlags&1028)!==0&&e!==null)e.return=a,Vs=e;else for(;Vs!==null;){switch(a=Vs,p=a.alternate,e=a.flags,a.tag){case 0:if((e&4)!==0&&(e=a.updateQueue,e=e!==null?e.events:null,e!==null))for(i=0;i<e.length;i++)x=e[i],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&p!==null){e=void 0,i=a,x=p.memoizedProps,p=p.memoizedState,c=i.stateNode;try{var Ve=ui(i.type,x);e=c.getSnapshotBeforeUpdate(Ve,p),c.__reactInternalSnapshotBeforeUpdate=e}catch(tt){Kt(i,i.return,tt)}}break;case 3:if((e&1024)!==0){if(e=a.stateNode.containerInfo,i=e.nodeType,i===9)Tu(e);else if(i===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Tu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(y(163))}if(e=a.sibling,e!==null){e.return=a.return,Vs=e;break}Vs=a.return}}function hf(e,a,i){var c=i.flags;switch(i.tag){case 0:case 11:case 15:Ln(e,i),c&4&&kl(5,i);break;case 1:if(Ln(e,i),c&4)if(e=i.stateNode,a===null)try{e.componentDidMount()}catch(S){Kt(i,i.return,S)}else{var x=ui(i.type,a.memoizedProps);a=a.memoizedState;try{e.componentDidUpdate(x,a,e.__reactInternalSnapshotBeforeUpdate)}catch(S){Kt(i,i.return,S)}}c&64&&rf(i),c&512&&Bl(i,i.return);break;case 3:if(Ln(e,i),c&64&&(e=i.updateQueue,e!==null)){if(a=null,i.child!==null)switch(i.child.tag){case 27:case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}try{Z0(e,a)}catch(S){Kt(i,i.return,S)}}break;case 27:a===null&&c&4&&df(i);case 26:case 5:Ln(e,i),a===null&&c&4&&of(i),c&512&&Bl(i,i.return);break;case 12:Ln(e,i);break;case 31:Ln(e,i),c&4&&mf(e,i);break;case 13:Ln(e,i),c&4&&gf(e,i),c&64&&(e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(i=tg.bind(null,i),vg(e,i))));break;case 22:if(c=i.memoizedState!==null||kn,!c){a=a!==null&&a.memoizedState!==null||Ms,x=kn;var p=Ms;kn=c,(Ms=a)&&!p?Pn(e,i,(i.subtreeFlags&8772)!==0):Ln(e,i),kn=x,Ms=p}break;case 30:break;default:Ln(e,i)}}function ff(e){var a=e.alternate;a!==null&&(e.alternate=null,ff(a)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(a=e.stateNode,a!==null&&oa(a)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var xs=null,ha=!1;function Bn(e,a,i){for(i=i.child;i!==null;)xf(e,a,i),i=i.sibling}function xf(e,a,i){if(ke&&typeof ke.onCommitFiberUnmount=="function")try{ke.onCommitFiberUnmount(It,i)}catch{}switch(i.tag){case 26:Ms||mn(i,a),Bn(e,a,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:Ms||mn(i,a);var c=xs,x=ha;Sr(i.type)&&(xs=i.stateNode,ha=!1),Bn(e,a,i),Xl(i.stateNode),xs=c,ha=x;break;case 5:Ms||mn(i,a);case 6:if(c=xs,x=ha,xs=null,Bn(e,a,i),xs=c,ha=x,xs!==null)if(ha)try{(xs.nodeType===9?xs.body:xs.nodeName==="HTML"?xs.ownerDocument.body:xs).removeChild(i.stateNode)}catch(p){Kt(i,a,p)}else try{xs.removeChild(i.stateNode)}catch(p){Kt(i,a,p)}break;case 18:xs!==null&&(ha?(e=xs,i1(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,i.stateNode),$i(e)):i1(xs,i.stateNode));break;case 4:c=xs,x=ha,xs=i.stateNode.containerInfo,ha=!0,Bn(e,a,i),xs=c,ha=x;break;case 0:case 11:case 14:case 15:wr(2,i,a),Ms||wr(4,i,a),Bn(e,a,i);break;case 1:Ms||(mn(i,a),c=i.stateNode,typeof c.componentWillUnmount=="function"&&lf(i,a,c)),Bn(e,a,i);break;case 21:Bn(e,a,i);break;case 22:Ms=(c=Ms)||i.memoizedState!==null,Bn(e,a,i),Ms=c;break;default:Bn(e,a,i)}}function mf(e,a){if(a.memoizedState===null&&(e=a.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{$i(e)}catch(i){Kt(a,a.return,i)}}}function gf(e,a){if(a.memoizedState===null&&(e=a.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{$i(e)}catch(i){Kt(a,a.return,i)}}function qm(e){switch(e.tag){case 31:case 13:case 19:var a=e.stateNode;return a===null&&(a=e.stateNode=new uf),a;case 22:return e=e.stateNode,a=e._retryCache,a===null&&(a=e._retryCache=new uf),a;default:throw Error(y(435,e.tag))}}function ec(e,a){var i=qm(e);a.forEach(function(c){if(!i.has(c)){i.add(c);var x=sg.bind(null,e,c);c.then(x,x)}})}function fa(e,a){var i=a.deletions;if(i!==null)for(var c=0;c<i.length;c++){var x=i[c],p=e,S=a,B=S;e:for(;B!==null;){switch(B.tag){case 27:if(Sr(B.type)){xs=B.stateNode,ha=!1;break e}break;case 5:xs=B.stateNode,ha=!1;break e;case 3:case 4:xs=B.stateNode.containerInfo,ha=!0;break e}B=B.return}if(xs===null)throw Error(y(160));xf(p,S,x),xs=null,ha=!1,p=x.alternate,p!==null&&(p.return=null),x.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)pf(a,e),a=a.sibling}var en=null;function pf(e,a){var i=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:fa(a,e),xa(e),c&4&&(wr(3,e,e.return),kl(3,e),wr(5,e,e.return));break;case 1:fa(a,e),xa(e),c&512&&(Ms||i===null||mn(i,i.return)),c&64&&kn&&(e=e.updateQueue,e!==null&&(c=e.callbacks,c!==null&&(i=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=i===null?c:i.concat(c))));break;case 26:var x=en;if(fa(a,e),xa(e),c&512&&(Ms||i===null||mn(i,i.return)),c&4){var p=i!==null?i.memoizedState:null;if(c=e.memoizedState,i===null)if(c===null)if(e.stateNode===null){e:{c=e.type,i=e.memoizedProps,x=x.ownerDocument||x;t:switch(c){case"title":p=x.getElementsByTagName("title")[0],(!p||p[Yr]||p[Cs]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=x.createElement(c),x.head.insertBefore(p,x.querySelector("head > title"))),Ws(p,c,i),p[Cs]=e,gs(p),c=p;break e;case"link":var S=p1("link","href",x).get(c+(i.href||""));if(S){for(var B=0;B<S.length;B++)if(p=S[B],p.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&p.getAttribute("rel")===(i.rel==null?null:i.rel)&&p.getAttribute("title")===(i.title==null?null:i.title)&&p.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){S.splice(B,1);break t}}p=x.createElement(c),Ws(p,c,i),x.head.appendChild(p);break;case"meta":if(S=p1("meta","content",x).get(c+(i.content||""))){for(B=0;B<S.length;B++)if(p=S[B],p.getAttribute("content")===(i.content==null?null:""+i.content)&&p.getAttribute("name")===(i.name==null?null:i.name)&&p.getAttribute("property")===(i.property==null?null:i.property)&&p.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&p.getAttribute("charset")===(i.charSet==null?null:i.charSet)){S.splice(B,1);break t}}p=x.createElement(c),Ws(p,c,i),x.head.appendChild(p);break;default:throw Error(y(468,c))}p[Cs]=e,gs(p),c=p}e.stateNode=c}else y1(x,e.type,e.stateNode);else e.stateNode=g1(x,c,e.memoizedProps);else p!==c?(p===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):p.count--,c===null?y1(x,e.type,e.stateNode):g1(x,c,e.memoizedProps)):c===null&&e.stateNode!==null&&eu(e,e.memoizedProps,i.memoizedProps)}break;case 27:fa(a,e),xa(e),c&512&&(Ms||i===null||mn(i,i.return)),i!==null&&c&4&&eu(e,e.memoizedProps,i.memoizedProps);break;case 5:if(fa(a,e),xa(e),c&512&&(Ms||i===null||mn(i,i.return)),e.flags&32){x=e.stateNode;try{sr(x,"")}catch(Ve){Kt(e,e.return,Ve)}}c&4&&e.stateNode!=null&&(x=e.memoizedProps,eu(e,x,i!==null?i.memoizedProps:x)),c&1024&&(au=!0);break;case 6:if(fa(a,e),xa(e),c&4){if(e.stateNode===null)throw Error(y(162));c=e.memoizedProps,i=e.stateNode;try{i.nodeValue=c}catch(Ve){Kt(e,e.return,Ve)}}break;case 3:if(gc=null,x=en,en=xc(a.containerInfo),fa(a,e),en=x,xa(e),c&4&&i!==null&&i.memoizedState.isDehydrated)try{$i(a.containerInfo)}catch(Ve){Kt(e,e.return,Ve)}au&&(au=!1,yf(e));break;case 4:c=en,en=xc(e.stateNode.containerInfo),fa(a,e),xa(e),en=c;break;case 12:fa(a,e),xa(e);break;case 31:fa(a,e),xa(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,ec(e,c)));break;case 13:fa(a,e),xa(e),e.child.flags&8192&&e.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(sc=Ke()),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,ec(e,c)));break;case 22:x=e.memoizedState!==null;var W=i!==null&&i.memoizedState!==null,ge=kn,Ae=Ms;if(kn=ge||x,Ms=Ae||W,fa(a,e),Ms=Ae,kn=ge,xa(e),c&8192)e:for(a=e.stateNode,a._visibility=x?a._visibility&-2:a._visibility|1,x&&(i===null||W||kn||Ms||hi(e)),i=null,a=e;;){if(a.tag===5||a.tag===26){if(i===null){W=i=a;try{if(p=W.stateNode,x)S=p.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{B=W.stateNode;var Se=W.memoizedProps.style,pe=Se!=null&&Se.hasOwnProperty("display")?Se.display:null;B.style.display=pe==null||typeof pe=="boolean"?"":(""+pe).trim()}}catch(Ve){Kt(W,W.return,Ve)}}}else if(a.tag===6){if(i===null){W=a;try{W.stateNode.nodeValue=x?"":W.memoizedProps}catch(Ve){Kt(W,W.return,Ve)}}}else if(a.tag===18){if(i===null){W=a;try{var Ce=W.stateNode;x?l1(Ce,!0):l1(W.stateNode,!1)}catch(Ve){Kt(W,W.return,Ve)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===e)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break e;for(;a.sibling===null;){if(a.return===null||a.return===e)break e;i===a&&(i=null),a=a.return}i===a&&(i=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=e.updateQueue,c!==null&&(i=c.retryQueue,i!==null&&(c.retryQueue=null,ec(e,i))));break;case 19:fa(a,e),xa(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,ec(e,c)));break;case 30:break;case 21:break;default:fa(a,e),xa(e)}}function xa(e){var a=e.flags;if(a&2){try{for(var i,c=e.return;c!==null;){if(cf(c)){i=c;break}c=c.return}if(i==null)throw Error(y(160));switch(i.tag){case 27:var x=i.stateNode,p=tu(e);$o(e,p,x);break;case 5:var S=i.stateNode;i.flags&32&&(sr(S,""),i.flags&=-33);var B=tu(e);$o(e,B,S);break;case 3:case 4:var W=i.stateNode.containerInfo,ge=tu(e);su(e,ge,W);break;default:throw Error(y(161))}}catch(Ae){Kt(e,e.return,Ae)}e.flags&=-3}a&4096&&(e.flags&=-4097)}function yf(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var a=e;yf(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),e=e.sibling}}function Ln(e,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)hf(e,a.alternate,a),a=a.sibling}function hi(e){for(e=e.child;e!==null;){var a=e;switch(a.tag){case 0:case 11:case 14:case 15:wr(4,a,a.return),hi(a);break;case 1:mn(a,a.return);var i=a.stateNode;typeof i.componentWillUnmount=="function"&&lf(a,a.return,i),hi(a);break;case 27:Xl(a.stateNode);case 26:case 5:mn(a,a.return),hi(a);break;case 22:a.memoizedState===null&&hi(a);break;case 30:hi(a);break;default:hi(a)}e=e.sibling}}function Pn(e,a,i){for(i=i&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,x=e,p=a,S=p.flags;switch(p.tag){case 0:case 11:case 15:Pn(x,p,i),kl(4,p);break;case 1:if(Pn(x,p,i),c=p,x=c.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(ge){Kt(c,c.return,ge)}if(c=p,x=c.updateQueue,x!==null){var B=c.stateNode;try{var W=x.shared.hiddenCallbacks;if(W!==null)for(x.shared.hiddenCallbacks=null,x=0;x<W.length;x++)K0(W[x],B)}catch(ge){Kt(c,c.return,ge)}}i&&S&64&&rf(p),Bl(p,p.return);break;case 27:df(p);case 26:case 5:Pn(x,p,i),i&&c===null&&S&4&&of(p),Bl(p,p.return);break;case 12:Pn(x,p,i);break;case 31:Pn(x,p,i),i&&S&4&&mf(x,p);break;case 13:Pn(x,p,i),i&&S&4&&gf(x,p);break;case 22:p.memoizedState===null&&Pn(x,p,i),Bl(p,p.return);break;case 30:break;default:Pn(x,p,i)}a=a.sibling}}function nu(e,a){var i=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),e=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(e=a.memoizedState.cachePool.pool),e!==i&&(e!=null&&e.refCount++,i!=null&&Nl(i))}function ru(e,a){e=null,a.alternate!==null&&(e=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==e&&(a.refCount++,e!=null&&Nl(e))}function tn(e,a,i,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)bf(e,a,i,c),a=a.sibling}function bf(e,a,i,c){var x=a.flags;switch(a.tag){case 0:case 11:case 15:tn(e,a,i,c),x&2048&&kl(9,a);break;case 1:tn(e,a,i,c);break;case 3:tn(e,a,i,c),x&2048&&(e=null,a.alternate!==null&&(e=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==e&&(a.refCount++,e!=null&&Nl(e)));break;case 12:if(x&2048){tn(e,a,i,c),e=a.stateNode;try{var p=a.memoizedProps,S=p.id,B=p.onPostCommit;typeof B=="function"&&B(S,a.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(W){Kt(a,a.return,W)}}else tn(e,a,i,c);break;case 31:tn(e,a,i,c);break;case 13:tn(e,a,i,c);break;case 23:break;case 22:p=a.stateNode,S=a.alternate,a.memoizedState!==null?p._visibility&2?tn(e,a,i,c):Ll(e,a):p._visibility&2?tn(e,a,i,c):(p._visibility|=2,Hi(e,a,i,c,(a.subtreeFlags&10256)!==0||!1)),x&2048&&nu(S,a);break;case 24:tn(e,a,i,c),x&2048&&ru(a.alternate,a);break;default:tn(e,a,i,c)}}function Hi(e,a,i,c,x){for(x=x&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var p=e,S=a,B=i,W=c,ge=S.flags;switch(S.tag){case 0:case 11:case 15:Hi(p,S,B,W,x),kl(8,S);break;case 23:break;case 22:var Ae=S.stateNode;S.memoizedState!==null?Ae._visibility&2?Hi(p,S,B,W,x):Ll(p,S):(Ae._visibility|=2,Hi(p,S,B,W,x)),x&&ge&2048&&nu(S.alternate,S);break;case 24:Hi(p,S,B,W,x),x&&ge&2048&&ru(S.alternate,S);break;default:Hi(p,S,B,W,x)}a=a.sibling}}function Ll(e,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var i=e,c=a,x=c.flags;switch(c.tag){case 22:Ll(i,c),x&2048&&nu(c.alternate,c);break;case 24:Ll(i,c),x&2048&&ru(c.alternate,c);break;default:Ll(i,c)}a=a.sibling}}var Pl=8192;function Vi(e,a,i){if(e.subtreeFlags&Pl)for(e=e.child;e!==null;)wf(e,a,i),e=e.sibling}function wf(e,a,i){switch(e.tag){case 26:Vi(e,a,i),e.flags&Pl&&e.memoizedState!==null&&Ig(i,en,e.memoizedState,e.memoizedProps);break;case 5:Vi(e,a,i);break;case 3:case 4:var c=en;en=xc(e.stateNode.containerInfo),Vi(e,a,i),en=c;break;case 22:e.memoizedState===null&&(c=e.alternate,c!==null&&c.memoizedState!==null?(c=Pl,Pl=16777216,Vi(e,a,i),Pl=c):Vi(e,a,i));break;default:Vi(e,a,i)}}function vf(e){var a=e.alternate;if(a!==null&&(e=a.child,e!==null)){a.child=null;do a=e.sibling,e.sibling=null,e=a;while(e!==null)}}function Fl(e){var a=e.deletions;if((e.flags&16)!==0){if(a!==null)for(var i=0;i<a.length;i++){var c=a[i];Vs=c,Cf(c,e)}vf(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Nf(e),e=e.sibling}function Nf(e){switch(e.tag){case 0:case 11:case 15:Fl(e),e.flags&2048&&wr(9,e,e.return);break;case 3:Fl(e);break;case 12:Fl(e);break;case 22:var a=e.stateNode;e.memoizedState!==null&&a._visibility&2&&(e.return===null||e.return.tag!==13)?(a._visibility&=-3,tc(e)):Fl(e);break;default:Fl(e)}}function tc(e){var a=e.deletions;if((e.flags&16)!==0){if(a!==null)for(var i=0;i<a.length;i++){var c=a[i];Vs=c,Cf(c,e)}vf(e)}for(e=e.child;e!==null;){switch(a=e,a.tag){case 0:case 11:case 15:wr(8,a,a.return),tc(a);break;case 22:i=a.stateNode,i._visibility&2&&(i._visibility&=-3,tc(a));break;default:tc(a)}e=e.sibling}}function Cf(e,a){for(;Vs!==null;){var i=Vs;switch(i.tag){case 0:case 11:case 15:wr(8,i,a);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var c=i.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Nl(i.memoizedState.cache)}if(c=i.child,c!==null)c.return=i,Vs=c;else e:for(i=e;Vs!==null;){c=Vs;var x=c.sibling,p=c.return;if(ff(c),c===i){Vs=null;break e}if(x!==null){x.return=p,Vs=x;break e}Vs=p}}}var Km={getCacheForType:function(e){var a=Ks(Ds),i=a.data.get(e);return i===void 0&&(i=e(),a.data.set(e,i)),i},cacheSignal:function(){return Ks(Ds).controller.signal}},Zm=typeof WeakMap=="function"?WeakMap:Map,Ft=0,ss=null,vt=null,At=0,qt=0,Oa=null,vr=!1,Gi=!1,iu=!1,Fn=0,bs=0,Nr=0,fi=0,lu=0,Da=0,Xi=0,Ul=null,ma=null,ou=!1,sc=0,Ef=0,ac=1/0,nc=null,Cr=null,zs=0,Er=null,Yi=null,Un=0,cu=0,du=null,Af=null,zl=0,uu=null;function _a(){return(Ft&2)!==0&&At!==0?At&-At:L.T!==null?pu():ta()}function jf(){if(Da===0)if((At&536870912)===0||Tt){var e=Ct;Ct<<=1,(Ct&3932160)===0&&(Ct=262144),Da=e}else Da=536870912;return e=Ta.current,e!==null&&(e.flags|=32),Da}function ga(e,a,i){(e===ss&&(qt===2||qt===9)||e.cancelPendingCommit!==null)&&(qi(e,0),Ar(e,At,Da,!1)),ln(e,i),((Ft&2)===0||e!==ss)&&(e===ss&&((Ft&2)===0&&(fi|=i),bs===4&&Ar(e,At,Da,!1)),gn(e))}function Sf(e,a,i){if((Ft&6)!==0)throw Error(y(327));var c=!i&&(a&127)===0&&(a&e.expiredLanes)===0||Xs(e,a),x=c?Jm(e,a):fu(e,a,!0),p=c;do{if(x===0){Gi&&!c&&Ar(e,a,0,!1);break}else{if(i=e.current.alternate,p&&!Wm(i)){x=fu(e,a,!1),p=!1;continue}if(x===2){if(p=a,e.errorRecoveryDisabledLanes&p)var S=0;else S=e.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){a=S;e:{var B=e;x=Ul;var W=B.current.memoizedState.isDehydrated;if(W&&(qi(B,S).flags|=256),S=fu(B,S,!1),S!==2){if(iu&&!W){B.errorRecoveryDisabledLanes|=p,fi|=p,x=4;break e}p=ma,ma=x,p!==null&&(ma===null?ma=p:ma.push.apply(ma,p))}x=S}if(p=!1,x!==2)continue}}if(x===1){qi(e,0),Ar(e,a,0,!0);break}e:{switch(c=e,p=x,p){case 0:case 1:throw Error(y(345));case 4:if((a&4194048)!==a)break;case 6:Ar(c,a,Da,!vr);break e;case 2:ma=null;break;case 3:case 5:break;default:throw Error(y(329))}if((a&62914560)===a&&(x=sc+300-Ke(),10<x)){if(Ar(c,a,Da,!vr),Xr(c,0,!0)!==0)break e;Un=a,c.timeoutHandle=n1(Tf.bind(null,c,i,ma,nc,ou,a,Da,fi,Xi,vr,p,"Throttled",-0,0),x);break e}Tf(c,i,ma,nc,ou,a,Da,fi,Xi,vr,p,null,-0,0)}}break}while(!0);gn(e)}function Tf(e,a,i,c,x,p,S,B,W,ge,Ae,Se,pe,Ce){if(e.timeoutHandle=-1,Se=a.subtreeFlags,Se&8192||(Se&16785408)===16785408){Se={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ca},wf(a,p,Se);var Ve=(p&62914560)===p?sc-Ke():(p&4194048)===p?Ef-Ke():0;if(Ve=Mg(Se,Ve),Ve!==null){Un=p,e.cancelPendingCommit=Ve(Bf.bind(null,e,a,p,i,c,x,S,B,W,Ae,Se,null,pe,Ce)),Ar(e,p,S,!ge);return}}Bf(e,a,p,i,c,x,S,B,W)}function Wm(e){for(var a=e;;){var i=a.tag;if((i===0||i===11||i===15)&&a.flags&16384&&(i=a.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var c=0;c<i.length;c++){var x=i[c],p=x.getSnapshot;x=x.value;try{if(!d(p(),x))return!1}catch{return!1}}if(i=a.child,a.subtreeFlags&16384&&i!==null)i.return=a,a=i;else{if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ar(e,a,i,c){a&=~lu,a&=~fi,e.suspendedLanes|=a,e.pingedLanes&=~a,c&&(e.warmLanes|=a),c=e.expirationTimes;for(var x=a;0<x;){var p=31-ut(x),S=1<<p;c[p]=-1,x&=~S}i!==0&&co(e,i,a)}function rc(){return(Ft&6)===0?(Hl(0),!1):!0}function hu(){if(vt!==null){if(qt===0)var e=vt.return;else e=vt,Rn=ni=null,Td(e),Li=null,El=0,e=vt;for(;e!==null;)nf(e.alternate,e),e=e.return;vt=null}}function qi(e,a){var i=e.timeoutHandle;i!==-1&&(e.timeoutHandle=-1,gg(i)),i=e.cancelPendingCommit,i!==null&&(e.cancelPendingCommit=null,i()),Un=0,hu(),ss=e,vt=i=Sn(e.current,null),At=a,qt=0,Oa=null,vr=!1,Gi=Xs(e,a),iu=!1,Xi=Da=lu=fi=Nr=bs=0,ma=Ul=null,ou=!1,(a&8)!==0&&(a|=a&32);var c=e.entangledLanes;if(c!==0)for(e=e.entanglements,c&=a;0<c;){var x=31-ut(c),p=1<<x;a|=e[x],c&=~p}return Fn=a,jo(),i}function Rf(e,a){ht=null,L.H=_l,a===Bi||a===Mo?(a=G0(),qt=3):a===gd?(a=G0(),qt=4):qt=a===Gd?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Oa=a,vt===null&&(bs=1,Ko(e,Ua(a,e.current)))}function Of(){var e=Ta.current;return e===null?!0:(At&4194048)===At?Ga===null:(At&62914560)===At||(At&536870912)!==0?e===Ga:!1}function Df(){var e=L.H;return L.H=_l,e===null?_l:e}function _f(){var e=L.A;return L.A=Km,e}function ic(){bs=4,vr||(At&4194048)!==At&&Ta.current!==null||(Gi=!0),(Nr&134217727)===0&&(fi&134217727)===0||ss===null||Ar(ss,At,Da,!1)}function fu(e,a,i){var c=Ft;Ft|=2;var x=Df(),p=_f();(ss!==e||At!==a)&&(nc=null,qi(e,a)),a=!1;var S=bs;e:do try{if(qt!==0&&vt!==null){var B=vt,W=Oa;switch(qt){case 8:hu(),S=6;break e;case 3:case 2:case 9:case 6:Ta.current===null&&(a=!0);var ge=qt;if(qt=0,Oa=null,Ki(e,B,W,ge),i&&Gi){S=0;break e}break;default:ge=qt,qt=0,Oa=null,Ki(e,B,W,ge)}}Qm(),S=bs;break}catch(Ae){Rf(e,Ae)}while(!0);return a&&e.shellSuspendCounter++,Rn=ni=null,Ft=c,L.H=x,L.A=p,vt===null&&(ss=null,At=0,jo()),S}function Qm(){for(;vt!==null;)If(vt)}function Jm(e,a){var i=Ft;Ft|=2;var c=Df(),x=_f();ss!==e||At!==a?(nc=null,ac=Ke()+500,qi(e,a)):Gi=Xs(e,a);e:do try{if(qt!==0&&vt!==null){a=vt;var p=Oa;t:switch(qt){case 1:qt=0,Oa=null,Ki(e,a,p,1);break;case 2:case 9:if(H0(p)){qt=0,Oa=null,Mf(a);break}a=function(){qt!==2&&qt!==9||ss!==e||(qt=7),gn(e)},p.then(a,a);break e;case 3:qt=7;break e;case 4:qt=5;break e;case 7:H0(p)?(qt=0,Oa=null,Mf(a)):(qt=0,Oa=null,Ki(e,a,p,7));break;case 5:var S=null;switch(vt.tag){case 26:S=vt.memoizedState;case 5:case 27:var B=vt;if(S?b1(S):B.stateNode.complete){qt=0,Oa=null;var W=B.sibling;if(W!==null)vt=W;else{var ge=B.return;ge!==null?(vt=ge,lc(ge)):vt=null}break t}}qt=0,Oa=null,Ki(e,a,p,5);break;case 6:qt=0,Oa=null,Ki(e,a,p,6);break;case 8:hu(),bs=6;break e;default:throw Error(y(462))}}$m();break}catch(Ae){Rf(e,Ae)}while(!0);return Rn=ni=null,L.H=c,L.A=x,Ft=i,vt!==null?0:(ss=null,At=0,jo(),bs)}function $m(){for(;vt!==null&&!ie();)If(vt)}function If(e){var a=sf(e.alternate,e,Fn);e.memoizedProps=e.pendingProps,a===null?lc(e):vt=a}function Mf(e){var a=e,i=a.alternate;switch(a.tag){case 15:case 0:a=Wh(i,a,a.pendingProps,a.type,void 0,At);break;case 11:a=Wh(i,a,a.pendingProps,a.type.render,a.ref,At);break;case 5:Td(a);default:nf(i,a),a=vt=D0(a,Fn),a=sf(i,a,Fn)}e.memoizedProps=e.pendingProps,a===null?lc(e):vt=a}function Ki(e,a,i,c){Rn=ni=null,Td(a),Li=null,El=0;var x=a.return;try{if(zm(e,x,a,i,At)){bs=1,Ko(e,Ua(i,e.current)),vt=null;return}}catch(p){if(x!==null)throw vt=x,p;bs=1,Ko(e,Ua(i,e.current)),vt=null;return}a.flags&32768?(Tt||c===1?e=!0:Gi||(At&536870912)!==0?e=!1:(vr=e=!0,(c===2||c===9||c===3||c===6)&&(c=Ta.current,c!==null&&c.tag===13&&(c.flags|=16384))),kf(a,e)):lc(a)}function lc(e){var a=e;do{if((a.flags&32768)!==0){kf(a,vr);return}e=a.return;var i=Gm(a.alternate,a,Fn);if(i!==null){vt=i;return}if(a=a.sibling,a!==null){vt=a;return}vt=a=e}while(a!==null);bs===0&&(bs=5)}function kf(e,a){do{var i=Xm(e.alternate,e);if(i!==null){i.flags&=32767,vt=i;return}if(i=e.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!a&&(e=e.sibling,e!==null)){vt=e;return}vt=e=i}while(e!==null);bs=6,vt=null}function Bf(e,a,i,c,x,p,S,B,W){e.cancelPendingCommit=null;do oc();while(zs!==0);if((Ft&6)!==0)throw Error(y(327));if(a!==null){if(a===e.current)throw Error(y(177));if(p=a.lanes|a.childLanes,p|=td,ka(e,i,p,S,B,W),e===ss&&(vt=ss=null,At=0),Yi=a,Er=e,Un=i,cu=p,du=x,Af=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,ag(St,function(){return zf(),null})):(e.callbackNode=null,e.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=L.T,L.T=null,x=U.p,U.p=2,S=Ft,Ft|=4;try{Ym(e,a,i)}finally{Ft=S,U.p=x,L.T=c}}zs=1,Lf(),Pf(),Ff()}}function Lf(){if(zs===1){zs=0;var e=Er,a=Yi,i=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||i){i=L.T,L.T=null;var c=U.p;U.p=2;var x=Ft;Ft|=4;try{pf(a,e);var p=Au,S=I(e.containerInfo),B=p.focusedElem,W=p.selectionRange;if(S!==B&&B&&B.ownerDocument&&j(B.ownerDocument.documentElement,B)){if(W!==null&&k(B)){var ge=W.start,Ae=W.end;if(Ae===void 0&&(Ae=ge),"selectionStart"in B)B.selectionStart=ge,B.selectionEnd=Math.min(Ae,B.value.length);else{var Se=B.ownerDocument||document,pe=Se&&Se.defaultView||window;if(pe.getSelection){var Ce=pe.getSelection(),Ve=B.textContent.length,tt=Math.min(W.start,Ve),Qt=W.end===void 0?tt:Math.min(W.end,Ve);!Ce.extend&&tt>Qt&&(S=Qt,Qt=tt,tt=S);var ce=b(B,tt),ae=b(B,Qt);if(ce&&ae&&(Ce.rangeCount!==1||Ce.anchorNode!==ce.node||Ce.anchorOffset!==ce.offset||Ce.focusNode!==ae.node||Ce.focusOffset!==ae.offset)){var me=Se.createRange();me.setStart(ce.node,ce.offset),Ce.removeAllRanges(),tt>Qt?(Ce.addRange(me),Ce.extend(ae.node,ae.offset)):(me.setEnd(ae.node,ae.offset),Ce.addRange(me))}}}}for(Se=[],Ce=B;Ce=Ce.parentNode;)Ce.nodeType===1&&Se.push({element:Ce,left:Ce.scrollLeft,top:Ce.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<Se.length;B++){var je=Se[B];je.element.scrollLeft=je.left,je.element.scrollTop=je.top}}wc=!!Eu,Au=Eu=null}finally{Ft=x,U.p=c,L.T=i}}e.current=a,zs=2}}function Pf(){if(zs===2){zs=0;var e=Er,a=Yi,i=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||i){i=L.T,L.T=null;var c=U.p;U.p=2;var x=Ft;Ft|=4;try{hf(e,a.alternate,a)}finally{Ft=x,U.p=c,L.T=i}}zs=3}}function Ff(){if(zs===4||zs===3){zs=0,Fe();var e=Er,a=Yi,i=Un,c=Af;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?zs=5:(zs=0,Yi=Er=null,Uf(e,e.pendingLanes));var x=e.pendingLanes;if(x===0&&(Cr=null),qa(i),a=a.stateNode,ke&&typeof ke.onCommitFiberRoot=="function")try{ke.onCommitFiberRoot(It,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=L.T,x=U.p,U.p=2,L.T=null;try{for(var p=e.onRecoverableError,S=0;S<c.length;S++){var B=c[S];p(B.value,{componentStack:B.stack})}}finally{L.T=a,U.p=x}}(Un&3)!==0&&oc(),gn(e),x=e.pendingLanes,(i&261930)!==0&&(x&42)!==0?e===uu?zl++:(zl=0,uu=e):zl=0,Hl(0)}}function Uf(e,a){(e.pooledCacheLanes&=a)===0&&(a=e.pooledCache,a!=null&&(e.pooledCache=null,Nl(a)))}function oc(){return Lf(),Pf(),Ff(),zf()}function zf(){if(zs!==5)return!1;var e=Er,a=cu;cu=0;var i=qa(Un),c=L.T,x=U.p;try{U.p=32>i?32:i,L.T=null,i=du,du=null;var p=Er,S=Un;if(zs=0,Yi=Er=null,Un=0,(Ft&6)!==0)throw Error(y(331));var B=Ft;if(Ft|=4,Nf(p.current),bf(p,p.current,S,i),Ft=B,Hl(0,!1),ke&&typeof ke.onPostCommitFiberRoot=="function")try{ke.onPostCommitFiberRoot(It,p)}catch{}return!0}finally{U.p=x,L.T=c,Uf(e,a)}}function Hf(e,a,i){a=Ua(i,a),a=Vd(e.stateNode,a,2),e=pr(e,a,2),e!==null&&(ln(e,2),gn(e))}function Kt(e,a,i){if(e.tag===3)Hf(e,e,i);else for(;a!==null;){if(a.tag===3){Hf(a,e,i);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Cr===null||!Cr.has(c))){e=Ua(i,e),i=Hh(2),c=pr(a,i,2),c!==null&&(Vh(i,c,a,e),ln(c,2),gn(c));break}}a=a.return}}function xu(e,a,i){var c=e.pingCache;if(c===null){c=e.pingCache=new Zm;var x=new Set;c.set(a,x)}else x=c.get(a),x===void 0&&(x=new Set,c.set(a,x));x.has(i)||(iu=!0,x.add(i),e=eg.bind(null,e,a,i),a.then(e,e))}function eg(e,a,i){var c=e.pingCache;c!==null&&c.delete(a),e.pingedLanes|=e.suspendedLanes&i,e.warmLanes&=~i,ss===e&&(At&i)===i&&(bs===4||bs===3&&(At&62914560)===At&&300>Ke()-sc?(Ft&2)===0&&qi(e,0):lu|=i,Xi===At&&(Xi=0)),gn(e)}function Vf(e,a){a===0&&(a=Ls()),e=ti(e,a),e!==null&&(ln(e,a),gn(e))}function tg(e){var a=e.memoizedState,i=0;a!==null&&(i=a.retryLane),Vf(e,i)}function sg(e,a){var i=0;switch(e.tag){case 31:case 13:var c=e.stateNode,x=e.memoizedState;x!==null&&(i=x.retryLane);break;case 19:c=e.stateNode;break;case 22:c=e.stateNode._retryCache;break;default:throw Error(y(314))}c!==null&&c.delete(a),Vf(e,i)}function ag(e,a){return Le(e,a)}var cc=null,Zi=null,mu=!1,dc=!1,gu=!1,jr=0;function gn(e){e!==Zi&&e.next===null&&(Zi===null?cc=Zi=e:Zi=Zi.next=e),dc=!0,mu||(mu=!0,rg())}function Hl(e,a){if(!gu&&dc){gu=!0;do for(var i=!1,c=cc;c!==null;){if(e!==0){var x=c.pendingLanes;if(x===0)var p=0;else{var S=c.suspendedLanes,B=c.pingedLanes;p=(1<<31-ut(42|e)+1)-1,p&=x&~(S&~B),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(i=!0,qf(c,p))}else p=At,p=Xr(c,c===ss?p:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(p&3)===0||Xs(c,p)||(i=!0,qf(c,p));c=c.next}while(i);gu=!1}}function ng(){Gf()}function Gf(){dc=mu=!1;var e=0;jr!==0&&mg()&&(e=jr);for(var a=Ke(),i=null,c=cc;c!==null;){var x=c.next,p=Xf(c,a);p===0?(c.next=null,i===null?cc=x:i.next=x,x===null&&(Zi=i)):(i=c,(e!==0||(p&3)!==0)&&(dc=!0)),c=x}zs!==0&&zs!==5||Hl(e),jr!==0&&(jr=0)}function Xf(e,a){for(var i=e.suspendedLanes,c=e.pingedLanes,x=e.expirationTimes,p=e.pendingLanes&-62914561;0<p;){var S=31-ut(p),B=1<<S,W=x[S];W===-1?((B&i)===0||(B&c)!==0)&&(x[S]=cl(B,a)):W<=a&&(e.expiredLanes|=B),p&=~B}if(a=ss,i=At,i=Xr(e,e===a?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c=e.callbackNode,i===0||e===a&&(qt===2||qt===9)||e.cancelPendingCommit!==null)return c!==null&&c!==null&&_e(c),e.callbackNode=null,e.callbackPriority=0;if((i&3)===0||Xs(e,i)){if(a=i&-i,a===e.callbackPriority)return a;switch(c!==null&&_e(c),qa(i)){case 2:case 8:i=ot;break;case 32:i=St;break;case 268435456:i=ba;break;default:i=St}return c=Yf.bind(null,e),i=Le(i,c),e.callbackPriority=a,e.callbackNode=i,a}return c!==null&&c!==null&&_e(c),e.callbackPriority=2,e.callbackNode=null,2}function Yf(e,a){if(zs!==0&&zs!==5)return e.callbackNode=null,e.callbackPriority=0,null;var i=e.callbackNode;if(oc()&&e.callbackNode!==i)return null;var c=At;return c=Xr(e,e===ss?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c===0?null:(Sf(e,c,a),Xf(e,Ke()),e.callbackNode!=null&&e.callbackNode===i?Yf.bind(null,e):null)}function qf(e,a){if(oc())return null;Sf(e,a,!0)}function rg(){pg(function(){(Ft&6)!==0?Le(Pe,ng):Gf()})}function pu(){if(jr===0){var e=Mi;e===0&&(e=Gr,Gr<<=1,(Gr&261888)===0&&(Gr=256)),jr=e}return jr}function Kf(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ar(""+e)}function Zf(e,a){var i=a.ownerDocument.createElement("input");return i.name=a.name,i.value=a.value,e.id&&i.setAttribute("form",e.id),a.parentNode.insertBefore(i,a),e=new FormData(e),i.parentNode.removeChild(i),e}function ig(e,a,i,c,x){if(a==="submit"&&i&&i.stateNode===x){var p=Kf((x[Yt]||null).action),S=c.submitter;S&&(a=(a=S[Yt]||null)?Kf(a.formAction):S.getAttribute("formAction"),a!==null&&(p=a,S=null));var B=new Ps("action","action",null,c,x);e.push({event:B,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(jr!==0){var W=S?Zf(x,S):new FormData(x);Ld(i,{pending:!0,data:W,method:x.method,action:p},null,W)}}else typeof p=="function"&&(B.preventDefault(),W=S?Zf(x,S):new FormData(x),Ld(i,{pending:!0,data:W,method:x.method,action:p},p,W))},currentTarget:x}]})}}for(var yu=0;yu<bl.length;yu++){var bu=bl[yu],lg=bu.toLowerCase(),og=bu[0].toUpperCase()+bu.slice(1);$a(lg,"on"+og)}$a(ua,"onAnimationEnd"),$a(Ys,"onAnimationIteration"),$a(Gt,"onAnimationStart"),$a("dblclick","onDoubleClick"),$a("focusin","onFocus"),$a("focusout","onBlur"),$a(Us,"onTransitionRun"),$a(ia,"onTransitionStart"),$a(dr,"onTransitionCancel"),$a(jn,"onTransitionEnd"),Na("onMouseEnter",["mouseout","mouseover"]),Na("onMouseLeave",["mouseout","mouseover"]),Na("onPointerEnter",["pointerout","pointerover"]),Na("onPointerLeave",["pointerout","pointerover"]),Ht("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ht("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ht("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ht("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ht("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ht("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vl));function Wf(e,a){a=(a&4)!==0;for(var i=0;i<e.length;i++){var c=e[i],x=c.event;c=c.listeners;e:{var p=void 0;if(a)for(var S=c.length-1;0<=S;S--){var B=c[S],W=B.instance,ge=B.currentTarget;if(B=B.listener,W!==p&&x.isPropagationStopped())break e;p=B,x.currentTarget=ge;try{p(x)}catch(Ae){Ao(Ae)}x.currentTarget=null,p=W}else for(S=0;S<c.length;S++){if(B=c[S],W=B.instance,ge=B.currentTarget,B=B.listener,W!==p&&x.isPropagationStopped())break e;p=B,x.currentTarget=ge;try{p(x)}catch(Ae){Ao(Ae)}x.currentTarget=null,p=W}}}}function Nt(e,a){var i=a[Qn];i===void 0&&(i=a[Qn]=new Set);var c=e+"__bubble";i.has(c)||(Qf(a,e,2,!1),i.add(c))}function wu(e,a,i){var c=0;a&&(c|=4),Qf(i,e,c,a)}var uc="_reactListening"+Math.random().toString(36).slice(2);function vu(e){if(!e[uc]){e[uc]=!0,De.forEach(function(i){i!=="selectionchange"&&(cg.has(i)||wu(i,!1,e),wu(i,!0,e))});var a=e.nodeType===9?e:e.ownerDocument;a===null||a[uc]||(a[uc]=!0,wu("selectionchange",!1,a))}}function Qf(e,a,i,c){switch(j1(a)){case 2:var x=Lg;break;case 8:x=Pg;break;default:x=Bu}i=x.bind(null,a,i,e),x=void 0,!hl||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(x=!0),c?x!==void 0?e.addEventListener(a,i,{capture:!0,passive:x}):e.addEventListener(a,i,!0):x!==void 0?e.addEventListener(a,i,{passive:x}):e.addEventListener(a,i,!1)}function Nu(e,a,i,c,x){var p=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var S=c.tag;if(S===3||S===4){var B=c.stateNode.containerInfo;if(B===x)break;if(S===4)for(S=c.return;S!==null;){var W=S.tag;if((W===3||W===4)&&S.stateNode.containerInfo===x)return;S=S.return}for(;B!==null;){if(S=ms(B),S===null)return;if(W=S.tag,W===5||W===6||W===26||W===27){c=p=S;continue e}B=B.parentNode}}c=c.return}xo(function(){var ge=p,Ae=ul(i),Se=[];e:{var pe=Eo.get(e);if(pe!==void 0){var Ce=Ps,Ve=e;switch(e){case"keypress":if(cn(i)===0)break e;case"keydown":case"keyup":Ce=Ai;break;case"focusin":Ve="focus",Ce=ml;break;case"focusout":Ve="blur",Ce=ml;break;case"beforeblur":case"afterblur":Ce=ml;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ce=Pt;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ce=Ci;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ce=Jc;break;case ua:case Ys:case Gt:Ce=ft;break;case jn:Ce=Nn;break;case"scroll":case"scrollend":Ce=mo;break;case"wheel":Ce=$c;break;case"copy":case"cut":case"paste":Ce=Ei;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ce=Vt;break;case"toggle":case"beforetoggle":Ce=pl}var tt=(a&4)!==0,Qt=!tt&&(e==="scroll"||e==="scrollend"),ce=tt?pe!==null?pe+"Capture":null:pe;tt=[];for(var ae=ge,me;ae!==null;){var je=ae;if(me=je.stateNode,je=je.tag,je!==5&&je!==26&&je!==27||me===null||ce===null||(je=nt(ae,ce),je!=null&&tt.push(Gl(ae,je,me))),Qt)break;ae=ae.return}0<tt.length&&(pe=new Ce(pe,Ve,null,i,Ae),Se.push({event:pe,listeners:tt}))}}if((a&7)===0){e:{if(pe=e==="mouseover"||e==="pointerover",Ce=e==="mouseout"||e==="pointerout",pe&&i!==qr&&(Ve=i.relatedTarget||i.fromElement)&&(ms(Ve)||Ve[va]))break e;if((Ce||pe)&&(pe=Ae.window===Ae?Ae:(pe=Ae.ownerDocument)?pe.defaultView||pe.parentWindow:window,Ce?(Ve=i.relatedTarget||i.toElement,Ce=ge,Ve=Ve?ms(Ve):null,Ve!==null&&(Qt=w(Ve),tt=Ve.tag,Ve!==Qt||tt!==5&&tt!==27&&tt!==6)&&(Ve=null)):(Ce=null,Ve=ge),Ce!==Ve)){if(tt=Pt,je="onMouseLeave",ce="onMouseEnter",ae="mouse",(e==="pointerout"||e==="pointerover")&&(tt=Vt,je="onPointerLeave",ce="onPointerEnter",ae="pointer"),Qt=Ce==null?pe:Jn(Ce),me=Ve==null?pe:Jn(Ve),pe=new tt(je,ae+"leave",Ce,i,Ae),pe.target=Qt,pe.relatedTarget=me,je=null,ms(Ae)===ge&&(tt=new tt(ce,ae+"enter",Ve,i,Ae),tt.target=me,tt.relatedTarget=Qt,je=tt),Qt=je,Ce&&Ve)t:{for(tt=dg,ce=Ce,ae=Ve,me=0,je=ce;je;je=tt(je))me++;je=0;for(var Qe=ae;Qe;Qe=tt(Qe))je++;for(;0<me-je;)ce=tt(ce),me--;for(;0<je-me;)ae=tt(ae),je--;for(;me--;){if(ce===ae||ae!==null&&ce===ae.alternate){tt=ce;break t}ce=tt(ce),ae=tt(ae)}tt=null}else tt=null;Ce!==null&&Jf(Se,pe,Ce,tt,!1),Ve!==null&&Qt!==null&&Jf(Se,Qt,Ve,tt,!0)}}e:{if(pe=ge?Jn(ge):window,Ce=pe.nodeName&&pe.nodeName.toLowerCase(),Ce==="select"||Ce==="input"&&pe.type==="file")var kt=ja;else if(yl(pe))if(Co)kt=l;else{kt=n;var qe=t}else Ce=pe.nodeName,!Ce||Ce.toLowerCase()!=="input"||pe.type!=="checkbox"&&pe.type!=="radio"?ge&&$t(ge.elementType)&&(kt=ja):kt=r;if(kt&&(kt=kt(e,ge))){Aa(Se,kt,i,Ae);break e}qe&&qe(e,pe,ge),e==="focusout"&&ge&&pe.type==="number"&&ge.memoizedProps.value!=null&&H(pe,"number",pe.value)}switch(qe=ge?Jn(ge):window,e){case"focusin":(yl(qe)||qe.contentEditable==="true")&&(J=qe,ee=ge,ue=null);break;case"focusout":ue=ee=J=null;break;case"mousedown":be=!0;break;case"contextmenu":case"mouseup":case"dragend":be=!1,Be(Se,i,Ae);break;case"selectionchange":if(G)break;case"keydown":case"keyup":Be(Se,i,Ae)}var xt;if(Wr)e:{switch(e){case"compositionstart":var jt="onCompositionStart";break e;case"compositionend":jt="onCompositionEnd";break e;case"compositionupdate":jt="onCompositionUpdate";break e}jt=void 0}else cr?No(e,i)&&(jt="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(jt="onCompositionStart");jt&&(vo&&i.locale!=="ko"&&(cr||jt!=="onCompositionStart"?jt==="onCompositionEnd"&&cr&&(xt=nr()):(Qa=Ae,Ja="value"in Qa?Qa.value:Qa.textContent,cr=!0)),qe=hc(ge,jt),0<qe.length&&(jt=new yo(jt,e,null,i,Ae),Se.push({event:jt,listeners:qe}),xt?jt.data=xt:(xt=or(i),xt!==null&&(jt.data=xt)))),(xt=wo?hn(e,i):Si(e,i))&&(jt=hc(ge,"onBeforeInput"),0<jt.length&&(qe=new yo("onBeforeInput","beforeinput",null,i,Ae),Se.push({event:qe,listeners:jt}),qe.data=xt)),ig(Se,e,ge,i,Ae)}Wf(Se,a)})}function Gl(e,a,i){return{instance:e,listener:a,currentTarget:i}}function hc(e,a){for(var i=a+"Capture",c=[];e!==null;){var x=e,p=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||p===null||(x=nt(e,i),x!=null&&c.unshift(Gl(e,x,p)),x=nt(e,a),x!=null&&c.push(Gl(e,x,p))),e.tag===3)return c;e=e.return}return[]}function dg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Jf(e,a,i,c,x){for(var p=a._reactName,S=[];i!==null&&i!==c;){var B=i,W=B.alternate,ge=B.stateNode;if(B=B.tag,W!==null&&W===c)break;B!==5&&B!==26&&B!==27||ge===null||(W=ge,x?(ge=nt(i,p),ge!=null&&S.unshift(Gl(i,ge,W))):x||(ge=nt(i,p),ge!=null&&S.push(Gl(i,ge,W)))),i=i.return}S.length!==0&&e.push({event:a,listeners:S})}var ug=/\r\n?/g,hg=/\u0000|\uFFFD/g;function $f(e){return(typeof e=="string"?e:""+e).replace(ug,`
`).replace(hg,"")}function e1(e,a){return a=$f(a),$f(e)===a}function Wt(e,a,i,c,x,p){switch(i){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||sr(e,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&sr(e,""+c);break;case"className":er(e,"class",c);break;case"tabIndex":er(e,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":er(e,i,c);break;case"style":We(e,c,p);break;case"data":if(a!=="object"){er(e,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||i!=="href")){e.removeAttribute(i);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(i);break}c=ar(""+c),e.setAttribute(i,c);break;case"action":case"formAction":if(typeof c=="function"){e.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(i==="formAction"?(a!=="input"&&Wt(e,a,"name",x.name,x,null),Wt(e,a,"formEncType",x.formEncType,x,null),Wt(e,a,"formMethod",x.formMethod,x,null),Wt(e,a,"formTarget",x.formTarget,x,null)):(Wt(e,a,"encType",x.encType,x,null),Wt(e,a,"method",x.method,x,null),Wt(e,a,"target",x.target,x,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(i);break}c=ar(""+c),e.setAttribute(i,c);break;case"onClick":c!=null&&(e.onclick=ca);break;case"onScroll":c!=null&&Nt("scroll",e);break;case"onScrollEnd":c!=null&&Nt("scrollend",e);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(y(61));if(i=c.__html,i!=null){if(x.children!=null)throw Error(y(60));e.innerHTML=i}}break;case"multiple":e.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":e.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){e.removeAttribute("xlink:href");break}i=ar(""+c),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(i,""+c):e.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(i,""):e.removeAttribute(i);break;case"capture":case"download":c===!0?e.setAttribute(i,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(i,c):e.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?e.setAttribute(i,c):e.removeAttribute(i);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?e.removeAttribute(i):e.setAttribute(i,c);break;case"popover":Nt("beforetoggle",e),Nt("toggle",e),$n(e,"popover",c);break;case"xlinkActuate":Ca(e,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Ca(e,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Ca(e,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Ca(e,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Ca(e,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Ca(e,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Ca(e,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Ca(e,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Ca(e,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":$n(e,"is",c);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=fo.get(i)||i,$n(e,i,c))}}function Cu(e,a,i,c,x,p){switch(i){case"style":We(e,c,p);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(y(61));if(i=c.__html,i!=null){if(x.children!=null)throw Error(y(60));e.innerHTML=i}}break;case"children":typeof c=="string"?sr(e,c):(typeof c=="number"||typeof c=="bigint")&&sr(e,""+c);break;case"onScroll":c!=null&&Nt("scroll",e);break;case"onScrollEnd":c!=null&&Nt("scrollend",e);break;case"onClick":c!=null&&(e.onclick=ca);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ho.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(x=i.endsWith("Capture"),a=i.slice(2,x?i.length-7:void 0),p=e[Yt]||null,p=p!=null?p[i]:null,typeof p=="function"&&e.removeEventListener(a,p,x),typeof c=="function")){typeof p!="function"&&p!==null&&(i in e?e[i]=null:e.hasAttribute(i)&&e.removeAttribute(i)),e.addEventListener(a,c,x);break e}i in e?e[i]=c:c===!0?e.setAttribute(i,""):$n(e,i,c)}}}function Ws(e,a,i){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Nt("error",e),Nt("load",e);var c=!1,x=!1,p;for(p in i)if(i.hasOwnProperty(p)){var S=i[p];if(S!=null)switch(p){case"src":c=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(y(137,a));default:Wt(e,a,p,S,i,null)}}x&&Wt(e,a,"srcSet",i.srcSet,i,null),c&&Wt(e,a,"src",i.src,i,null);return;case"input":Nt("invalid",e);var B=p=S=x=null,W=null,ge=null;for(c in i)if(i.hasOwnProperty(c)){var Ae=i[c];if(Ae!=null)switch(c){case"name":x=Ae;break;case"type":S=Ae;break;case"checked":W=Ae;break;case"defaultChecked":ge=Ae;break;case"value":p=Ae;break;case"defaultValue":B=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(y(137,a));break;default:Wt(e,a,c,Ae,i,null)}}xe(e,p,B,W,ge,S,x,!1);return;case"select":Nt("invalid",e),c=S=p=null;for(x in i)if(i.hasOwnProperty(x)&&(B=i[x],B!=null))switch(x){case"value":p=B;break;case"defaultValue":S=B;break;case"multiple":c=B;default:Wt(e,a,x,B,i,null)}a=p,i=S,e.multiple=!!c,a!=null?Xe(e,!!c,a,!1):i!=null&&Xe(e,!!c,i,!0);return;case"textarea":Nt("invalid",e),p=x=c=null;for(S in i)if(i.hasOwnProperty(S)&&(B=i[S],B!=null))switch(S){case"value":c=B;break;case"defaultValue":x=B;break;case"children":p=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(y(91));break;default:Wt(e,a,S,B,i,null)}na(e,c,x,p);return;case"option":for(W in i)if(i.hasOwnProperty(W)&&(c=i[W],c!=null))switch(W){case"selected":e.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Wt(e,a,W,c,i,null)}return;case"dialog":Nt("beforetoggle",e),Nt("toggle",e),Nt("cancel",e),Nt("close",e);break;case"iframe":case"object":Nt("load",e);break;case"video":case"audio":for(c=0;c<Vl.length;c++)Nt(Vl[c],e);break;case"image":Nt("error",e),Nt("load",e);break;case"details":Nt("toggle",e);break;case"embed":case"source":case"link":Nt("error",e),Nt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ge in i)if(i.hasOwnProperty(ge)&&(c=i[ge],c!=null))switch(ge){case"children":case"dangerouslySetInnerHTML":throw Error(y(137,a));default:Wt(e,a,ge,c,i,null)}return;default:if($t(a)){for(Ae in i)i.hasOwnProperty(Ae)&&(c=i[Ae],c!==void 0&&Cu(e,a,Ae,c,i,void 0));return}}for(B in i)i.hasOwnProperty(B)&&(c=i[B],c!=null&&Wt(e,a,B,c,i,null))}function fg(e,a,i,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,p=null,S=null,B=null,W=null,ge=null,Ae=null;for(Ce in i){var Se=i[Ce];if(i.hasOwnProperty(Ce)&&Se!=null)switch(Ce){case"checked":break;case"value":break;case"defaultValue":W=Se;default:c.hasOwnProperty(Ce)||Wt(e,a,Ce,null,c,Se)}}for(var pe in c){var Ce=c[pe];if(Se=i[pe],c.hasOwnProperty(pe)&&(Ce!=null||Se!=null))switch(pe){case"type":p=Ce;break;case"name":x=Ce;break;case"checked":ge=Ce;break;case"defaultChecked":Ae=Ce;break;case"value":S=Ce;break;case"defaultValue":B=Ce;break;case"children":case"dangerouslySetInnerHTML":if(Ce!=null)throw Error(y(137,a));break;default:Ce!==Se&&Wt(e,a,pe,Ce,c,Se)}}Rs(e,S,B,W,ge,Ae,p,x);return;case"select":Ce=S=B=pe=null;for(p in i)if(W=i[p],i.hasOwnProperty(p)&&W!=null)switch(p){case"value":break;case"multiple":Ce=W;default:c.hasOwnProperty(p)||Wt(e,a,p,null,c,W)}for(x in c)if(p=c[x],W=i[x],c.hasOwnProperty(x)&&(p!=null||W!=null))switch(x){case"value":pe=p;break;case"defaultValue":B=p;break;case"multiple":S=p;default:p!==W&&Wt(e,a,x,p,c,W)}a=B,i=S,c=Ce,pe!=null?Xe(e,!!i,pe,!1):!!c!=!!i&&(a!=null?Xe(e,!!i,a,!0):Xe(e,!!i,i?[]:"",!1));return;case"textarea":Ce=pe=null;for(B in i)if(x=i[B],i.hasOwnProperty(B)&&x!=null&&!c.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:Wt(e,a,B,null,c,x)}for(S in c)if(x=c[S],p=i[S],c.hasOwnProperty(S)&&(x!=null||p!=null))switch(S){case"value":pe=x;break;case"defaultValue":Ce=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(y(91));break;default:x!==p&&Wt(e,a,S,x,c,p)}Es(e,pe,Ce);return;case"option":for(var Ve in i)if(pe=i[Ve],i.hasOwnProperty(Ve)&&pe!=null&&!c.hasOwnProperty(Ve))switch(Ve){case"selected":e.selected=!1;break;default:Wt(e,a,Ve,null,c,pe)}for(W in c)if(pe=c[W],Ce=i[W],c.hasOwnProperty(W)&&pe!==Ce&&(pe!=null||Ce!=null))switch(W){case"selected":e.selected=pe&&typeof pe!="function"&&typeof pe!="symbol";break;default:Wt(e,a,W,pe,c,Ce)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var tt in i)pe=i[tt],i.hasOwnProperty(tt)&&pe!=null&&!c.hasOwnProperty(tt)&&Wt(e,a,tt,null,c,pe);for(ge in c)if(pe=c[ge],Ce=i[ge],c.hasOwnProperty(ge)&&pe!==Ce&&(pe!=null||Ce!=null))switch(ge){case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(y(137,a));break;default:Wt(e,a,ge,pe,c,Ce)}return;default:if($t(a)){for(var Qt in i)pe=i[Qt],i.hasOwnProperty(Qt)&&pe!==void 0&&!c.hasOwnProperty(Qt)&&Cu(e,a,Qt,void 0,c,pe);for(Ae in c)pe=c[Ae],Ce=i[Ae],!c.hasOwnProperty(Ae)||pe===Ce||pe===void 0&&Ce===void 0||Cu(e,a,Ae,pe,c,Ce);return}}for(var ce in i)pe=i[ce],i.hasOwnProperty(ce)&&pe!=null&&!c.hasOwnProperty(ce)&&Wt(e,a,ce,null,c,pe);for(Se in c)pe=c[Se],Ce=i[Se],!c.hasOwnProperty(Se)||pe===Ce||pe==null&&Ce==null||Wt(e,a,Se,pe,c,Ce)}function t1(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function xg(){if(typeof performance.getEntriesByType=="function"){for(var e=0,a=0,i=performance.getEntriesByType("resource"),c=0;c<i.length;c++){var x=i[c],p=x.transferSize,S=x.initiatorType,B=x.duration;if(p&&B&&t1(S)){for(S=0,B=x.responseEnd,c+=1;c<i.length;c++){var W=i[c],ge=W.startTime;if(ge>B)break;var Ae=W.transferSize,Se=W.initiatorType;Ae&&t1(Se)&&(W=W.responseEnd,S+=Ae*(W<B?1:(B-ge)/(W-ge)))}if(--c,a+=8*(p+S)/(x.duration/1e3),e++,10<e)break}}if(0<e)return a/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Eu=null,Au=null;function fc(e){return e.nodeType===9?e:e.ownerDocument}function s1(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function a1(e,a){if(e===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&a==="foreignObject"?0:e}function ju(e,a){return e==="textarea"||e==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Su=null;function mg(){var e=window.event;return e&&e.type==="popstate"?e===Su?!1:(Su=e,!0):(Su=null,!1)}var n1=typeof setTimeout=="function"?setTimeout:void 0,gg=typeof clearTimeout=="function"?clearTimeout:void 0,r1=typeof Promise=="function"?Promise:void 0,pg=typeof queueMicrotask=="function"?queueMicrotask:typeof r1<"u"?function(e){return r1.resolve(null).then(e).catch(yg)}:n1;function yg(e){setTimeout(function(){throw e})}function Sr(e){return e==="head"}function i1(e,a){var i=a,c=0;do{var x=i.nextSibling;if(e.removeChild(i),x&&x.nodeType===8)if(i=x.data,i==="/$"||i==="/&"){if(c===0){e.removeChild(x),$i(a);return}c--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")c++;else if(i==="html")Xl(e.ownerDocument.documentElement);else if(i==="head"){i=e.ownerDocument.head,Xl(i);for(var p=i.firstChild;p;){var S=p.nextSibling,B=p.nodeName;p[Yr]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&p.rel.toLowerCase()==="stylesheet"||i.removeChild(p),p=S}}else i==="body"&&Xl(e.ownerDocument.body);i=x}while(i);$i(a)}function l1(e,a){var i=e;e=0;do{var c=i.nextSibling;if(i.nodeType===1?a?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(a?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),c&&c.nodeType===8)if(i=c.data,i==="/$"){if(e===0)break;e--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||e++;i=c}while(i)}function Tu(e){var a=e.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var i=a;switch(a=a.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":Tu(i),oa(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}e.removeChild(i)}}function bg(e,a,i,c){for(;e.nodeType===1;){var x=i;if(e.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(c){if(!e[Yr])switch(a){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(p=e.getAttribute("rel"),p==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(p!==x.rel||e.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||e.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||e.getAttribute("title")!==(x.title==null?null:x.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(p=e.getAttribute("src"),(p!==(x.src==null?null:x.src)||e.getAttribute("type")!==(x.type==null?null:x.type)||e.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&p&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(a==="input"&&e.type==="hidden"){var p=x.name==null?null:""+x.name;if(x.type==="hidden"&&e.getAttribute("name")===p)return e}else return e;if(e=Xa(e.nextSibling),e===null)break}return null}function wg(e,a,i){if(a==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=Xa(e.nextSibling),e===null))return null;return e}function o1(e,a){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=Xa(e.nextSibling),e===null))return null;return e}function Ru(e){return e.data==="$?"||e.data==="$~"}function Ou(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function vg(e,a){var i=e.ownerDocument;if(e.data==="$~")e._reactRetry=a;else if(e.data!=="$?"||i.readyState!=="loading")a();else{var c=function(){a(),i.removeEventListener("DOMContentLoaded",c)};i.addEventListener("DOMContentLoaded",c),e._reactRetry=c}}function Xa(e){for(;e!=null;e=e.nextSibling){var a=e.nodeType;if(a===1||a===3)break;if(a===8){if(a=e.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return e}var Du=null;function c1(e){e=e.nextSibling;for(var a=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"||i==="/&"){if(a===0)return Xa(e.nextSibling);a--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||a++}e=e.nextSibling}return null}function d1(e){e=e.previousSibling;for(var a=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(a===0)return e;a--}else i!=="/$"&&i!=="/&"||a++}e=e.previousSibling}return null}function u1(e,a,i){switch(a=fc(i),e){case"html":if(e=a.documentElement,!e)throw Error(y(452));return e;case"head":if(e=a.head,!e)throw Error(y(453));return e;case"body":if(e=a.body,!e)throw Error(y(454));return e;default:throw Error(y(451))}}function Xl(e){for(var a=e.attributes;a.length;)e.removeAttributeNode(a[0]);oa(e)}var Ya=new Map,h1=new Set;function xc(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var zn=U.d;U.d={f:Ng,r:Cg,D:Eg,C:Ag,L:jg,m:Sg,X:Rg,S:Tg,M:Og};function Ng(){var e=zn.f(),a=rc();return e||a}function Cg(e){var a=Lt(e);a!==null&&a.tag===5&&a.type==="form"?Th(a):zn.r(e)}var Wi=typeof document>"u"?null:document;function f1(e,a,i){var c=Wi;if(c&&typeof a=="string"&&a){var x=pt(a);x='link[rel="'+e+'"][href="'+x+'"]',typeof i=="string"&&(x+='[crossorigin="'+i+'"]'),h1.has(x)||(h1.add(x),e={rel:e,crossOrigin:i,href:a},c.querySelector(x)===null&&(a=c.createElement("link"),Ws(a,"link",e),gs(a),c.head.appendChild(a)))}}function Eg(e){zn.D(e),f1("dns-prefetch",e,null)}function Ag(e,a){zn.C(e,a),f1("preconnect",e,a)}function jg(e,a,i){zn.L(e,a,i);var c=Wi;if(c&&e&&a){var x='link[rel="preload"][as="'+pt(a)+'"]';a==="image"&&i&&i.imageSrcSet?(x+='[imagesrcset="'+pt(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(x+='[imagesizes="'+pt(i.imageSizes)+'"]')):x+='[href="'+pt(e)+'"]';var p=x;switch(a){case"style":p=Qi(e);break;case"script":p=Ji(e)}Ya.has(p)||(e=O({rel:"preload",href:a==="image"&&i&&i.imageSrcSet?void 0:e,as:a},i),Ya.set(p,e),c.querySelector(x)!==null||a==="style"&&c.querySelector(Yl(p))||a==="script"&&c.querySelector(ql(p))||(a=c.createElement("link"),Ws(a,"link",e),gs(a),c.head.appendChild(a)))}}function Sg(e,a){zn.m(e,a);var i=Wi;if(i&&e){var c=a&&typeof a.as=="string"?a.as:"script",x='link[rel="modulepreload"][as="'+pt(c)+'"][href="'+pt(e)+'"]',p=x;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=Ji(e)}if(!Ya.has(p)&&(e=O({rel:"modulepreload",href:e},a),Ya.set(p,e),i.querySelector(x)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(ql(p)))return}c=i.createElement("link"),Ws(c,"link",e),gs(c),i.head.appendChild(c)}}}function Tg(e,a,i){zn.S(e,a,i);var c=Wi;if(c&&e){var x=aa(c).hoistableStyles,p=Qi(e);a=a||"default";var S=x.get(p);if(!S){var B={loading:0,preload:null};if(S=c.querySelector(Yl(p)))B.loading=5;else{e=O({rel:"stylesheet",href:e,"data-precedence":a},i),(i=Ya.get(p))&&_u(e,i);var W=S=c.createElement("link");gs(W),Ws(W,"link",e),W._p=new Promise(function(ge,Ae){W.onload=ge,W.onerror=Ae}),W.addEventListener("load",function(){B.loading|=1}),W.addEventListener("error",function(){B.loading|=2}),B.loading|=4,mc(S,a,c)}S={type:"stylesheet",instance:S,count:1,state:B},x.set(p,S)}}}function Rg(e,a){zn.X(e,a);var i=Wi;if(i&&e){var c=aa(i).hoistableScripts,x=Ji(e),p=c.get(x);p||(p=i.querySelector(ql(x)),p||(e=O({src:e,async:!0},a),(a=Ya.get(x))&&Iu(e,a),p=i.createElement("script"),gs(p),Ws(p,"link",e),i.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(x,p))}}function Og(e,a){zn.M(e,a);var i=Wi;if(i&&e){var c=aa(i).hoistableScripts,x=Ji(e),p=c.get(x);p||(p=i.querySelector(ql(x)),p||(e=O({src:e,async:!0,type:"module"},a),(a=Ya.get(x))&&Iu(e,a),p=i.createElement("script"),gs(p),Ws(p,"link",e),i.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(x,p))}}function x1(e,a,i,c){var x=(x=Re.current)?xc(x):null;if(!x)throw Error(y(446));switch(e){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(a=Qi(i.href),i=aa(x).hoistableStyles,c=i.get(a),c||(c={type:"style",instance:null,count:0,state:null},i.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){e=Qi(i.href);var p=aa(x).hoistableStyles,S=p.get(e);if(S||(x=x.ownerDocument||x,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(e,S),(p=x.querySelector(Yl(e)))&&!p._p&&(S.instance=p,S.state.loading=5),Ya.has(e)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},Ya.set(e,i),p||Dg(x,e,i,S.state))),a&&c===null)throw Error(y(528,""));return S}if(a&&c!==null)throw Error(y(529,""));return null;case"script":return a=i.async,i=i.src,typeof i=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ji(i),i=aa(x).hoistableScripts,c=i.get(a),c||(c={type:"script",instance:null,count:0,state:null},i.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(y(444,e))}}function Qi(e){return'href="'+pt(e)+'"'}function Yl(e){return'link[rel="stylesheet"]['+e+"]"}function m1(e){return O({},e,{"data-precedence":e.precedence,precedence:null})}function Dg(e,a,i,c){e.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=e.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),Ws(a,"link",i),gs(a),e.head.appendChild(a))}function Ji(e){return'[src="'+pt(e)+'"]'}function ql(e){return"script[async]"+e}function g1(e,a,i){if(a.count++,a.instance===null)switch(a.type){case"style":var c=e.querySelector('style[data-href~="'+pt(i.href)+'"]');if(c)return a.instance=c,gs(c),c;var x=O({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return c=(e.ownerDocument||e).createElement("style"),gs(c),Ws(c,"style",x),mc(c,i.precedence,e),a.instance=c;case"stylesheet":x=Qi(i.href);var p=e.querySelector(Yl(x));if(p)return a.state.loading|=4,a.instance=p,gs(p),p;c=m1(i),(x=Ya.get(x))&&_u(c,x),p=(e.ownerDocument||e).createElement("link"),gs(p);var S=p;return S._p=new Promise(function(B,W){S.onload=B,S.onerror=W}),Ws(p,"link",c),a.state.loading|=4,mc(p,i.precedence,e),a.instance=p;case"script":return p=Ji(i.src),(x=e.querySelector(ql(p)))?(a.instance=x,gs(x),x):(c=i,(x=Ya.get(p))&&(c=O({},i),Iu(c,x)),e=e.ownerDocument||e,x=e.createElement("script"),gs(x),Ws(x,"link",c),e.head.appendChild(x),a.instance=x);case"void":return null;default:throw Error(y(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,mc(c,i.precedence,e));return a.instance}function mc(e,a,i){for(var c=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=c.length?c[c.length-1]:null,p=x,S=0;S<c.length;S++){var B=c[S];if(B.dataset.precedence===a)p=B;else if(p!==x)break}p?p.parentNode.insertBefore(e,p.nextSibling):(a=i.nodeType===9?i.head:i,a.insertBefore(e,a.firstChild))}function _u(e,a){e.crossOrigin==null&&(e.crossOrigin=a.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=a.referrerPolicy),e.title==null&&(e.title=a.title)}function Iu(e,a){e.crossOrigin==null&&(e.crossOrigin=a.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=a.referrerPolicy),e.integrity==null&&(e.integrity=a.integrity)}var gc=null;function p1(e,a,i){if(gc===null){var c=new Map,x=gc=new Map;x.set(i,c)}else x=gc,c=x.get(i),c||(c=new Map,x.set(i,c));if(c.has(e))return c;for(c.set(e,null),i=i.getElementsByTagName(e),x=0;x<i.length;x++){var p=i[x];if(!(p[Yr]||p[Cs]||e==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var S=p.getAttribute(a)||"";S=e+S;var B=c.get(S);B?B.push(p):c.set(S,[p])}}return c}function y1(e,a,i){e=e.ownerDocument||e,e.head.insertBefore(i,a==="title"?e.querySelector("head > title"):null)}function _g(e,a,i){if(i===1||a.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return e=a.disabled,typeof a.precedence=="string"&&e==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function b1(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Ig(e,a,i,c){if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var x=Qi(c.href),p=a.querySelector(Yl(x));if(p){a=p._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(e.count++,e=pc.bind(e),a.then(e,e)),i.state.loading|=4,i.instance=p,gs(p);return}p=a.ownerDocument||a,c=m1(c),(x=Ya.get(x))&&_u(c,x),p=p.createElement("link"),gs(p);var S=p;S._p=new Promise(function(B,W){S.onload=B,S.onerror=W}),Ws(p,"link",c),i.instance=p}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(i,a),(a=i.state.preload)&&(i.state.loading&3)===0&&(e.count++,i=pc.bind(e),a.addEventListener("load",i),a.addEventListener("error",i))}}var Mu=0;function Mg(e,a){return e.stylesheets&&e.count===0&&bc(e,e.stylesheets),0<e.count||0<e.imgCount?function(i){var c=setTimeout(function(){if(e.stylesheets&&bc(e,e.stylesheets),e.unsuspend){var p=e.unsuspend;e.unsuspend=null,p()}},6e4+a);0<e.imgBytes&&Mu===0&&(Mu=62500*xg());var x=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&bc(e,e.stylesheets),e.unsuspend)){var p=e.unsuspend;e.unsuspend=null,p()}},(e.imgBytes>Mu?50:800)+a);return e.unsuspend=i,function(){e.unsuspend=null,clearTimeout(c),clearTimeout(x)}}:null}function pc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var yc=null;function bc(e,a){e.stylesheets=null,e.unsuspend!==null&&(e.count++,yc=new Map,a.forEach(kg,e),yc=null,pc.call(e))}function kg(e,a){if(!(a.state.loading&4)){var i=yc.get(e);if(i)var c=i.get(null);else{i=new Map,yc.set(e,i);for(var x=e.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<x.length;p++){var S=x[p];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(i.set(S.dataset.precedence,S),c=S)}c&&i.set(null,c)}x=a.instance,S=x.getAttribute("data-precedence"),p=i.get(S)||c,p===c&&i.set(null,x),i.set(S,x),this.count++,c=pc.bind(this),x.addEventListener("load",c),x.addEventListener("error",c),p?p.parentNode.insertBefore(x,p.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(x,e.firstChild)),a.state.loading|=4}}var Kl={$$typeof:q,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function Bg(e,a,i,c,x,p,S,B,W){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=rn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rn(0),this.hiddenUpdates=rn(null),this.identifierPrefix=c,this.onUncaughtError=x,this.onCaughtError=p,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function w1(e,a,i,c,x,p,S,B,W,ge,Ae,Se){return e=new Bg(e,a,i,S,W,ge,Ae,Se,B),a=1,p===!0&&(a|=24),p=Sa(3,null,null,a),e.current=p,p.stateNode=e,a=fd(),a.refCount++,e.pooledCache=a,a.refCount++,p.memoizedState={element:c,isDehydrated:i,cache:a},pd(p),e}function v1(e){return e?(e=Ri,e):Ri}function N1(e,a,i,c,x,p){x=v1(x),c.context===null?c.context=x:c.pendingContext=x,c=gr(a),c.payload={element:i},p=p===void 0?null:p,p!==null&&(c.callback=p),i=pr(e,c,a),i!==null&&(ga(i,e,a),jl(i,e,a))}function C1(e,a){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<a?i:a}}function ku(e,a){C1(e,a),(e=e.alternate)&&C1(e,a)}function E1(e){if(e.tag===13||e.tag===31){var a=ti(e,67108864);a!==null&&ga(a,e,67108864),ku(e,67108864)}}function A1(e){if(e.tag===13||e.tag===31){var a=_a();a=Hs(a);var i=ti(e,a);i!==null&&ga(i,e,a),ku(e,a)}}var wc=!0;function Lg(e,a,i,c){var x=L.T;L.T=null;var p=U.p;try{U.p=2,Bu(e,a,i,c)}finally{U.p=p,L.T=x}}function Pg(e,a,i,c){var x=L.T;L.T=null;var p=U.p;try{U.p=8,Bu(e,a,i,c)}finally{U.p=p,L.T=x}}function Bu(e,a,i,c){if(wc){var x=Lu(c);if(x===null)Nu(e,a,c,vc,i),S1(e,c);else if(Ug(x,e,a,i,c))c.stopPropagation();else if(S1(e,c),a&4&&-1<Fg.indexOf(e)){for(;x!==null;){var p=Lt(x);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var S=nn(p.pendingLanes);if(S!==0){var B=p;for(B.pendingLanes|=2,B.entangledLanes|=2;S;){var W=1<<31-ut(S);B.entanglements[1]|=W,S&=~W}gn(p),(Ft&6)===0&&(ac=Ke()+500,Hl(0))}}break;case 31:case 13:B=ti(p,2),B!==null&&ga(B,p,2),rc(),ku(p,2)}if(p=Lu(c),p===null&&Nu(e,a,c,vc,i),p===x)break;x=p}x!==null&&c.stopPropagation()}else Nu(e,a,c,null,i)}}function Lu(e){return e=ul(e),Pu(e)}var vc=null;function Pu(e){if(vc=null,e=ms(e),e!==null){var a=w(e);if(a===null)e=null;else{var i=a.tag;if(i===13){if(e=E(a),e!==null)return e;e=null}else if(i===31){if(e=T(a),e!==null)return e;e=null}else if(i===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;e=null}else a!==e&&(e=null)}}return vc=e,null}function j1(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ye()){case Pe:return 2;case ot:return 8;case St:case rt:return 32;case ba:return 268435456;default:return 32}default:return 32}}var Fu=!1,Tr=null,Rr=null,Or=null,Zl=new Map,Wl=new Map,Dr=[],Fg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function S1(e,a){switch(e){case"focusin":case"focusout":Tr=null;break;case"dragenter":case"dragleave":Rr=null;break;case"mouseover":case"mouseout":Or=null;break;case"pointerover":case"pointerout":Zl.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wl.delete(a.pointerId)}}function Ql(e,a,i,c,x,p){return e===null||e.nativeEvent!==p?(e={blockedOn:a,domEventName:i,eventSystemFlags:c,nativeEvent:p,targetContainers:[x]},a!==null&&(a=Lt(a),a!==null&&E1(a)),e):(e.eventSystemFlags|=c,a=e.targetContainers,x!==null&&a.indexOf(x)===-1&&a.push(x),e)}function Ug(e,a,i,c,x){switch(a){case"focusin":return Tr=Ql(Tr,e,a,i,c,x),!0;case"dragenter":return Rr=Ql(Rr,e,a,i,c,x),!0;case"mouseover":return Or=Ql(Or,e,a,i,c,x),!0;case"pointerover":var p=x.pointerId;return Zl.set(p,Ql(Zl.get(p)||null,e,a,i,c,x)),!0;case"gotpointercapture":return p=x.pointerId,Wl.set(p,Ql(Wl.get(p)||null,e,a,i,c,x)),!0}return!1}function T1(e){var a=ms(e.target);if(a!==null){var i=w(a);if(i!==null){if(a=i.tag,a===13){if(a=E(i),a!==null){e.blockedOn=a,ze(e.priority,function(){A1(i)});return}}else if(a===31){if(a=T(i),a!==null){e.blockedOn=a,ze(e.priority,function(){A1(i)});return}}else if(a===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Nc(e){if(e.blockedOn!==null)return!1;for(var a=e.targetContainers;0<a.length;){var i=Lu(e.nativeEvent);if(i===null){i=e.nativeEvent;var c=new i.constructor(i.type,i);qr=c,i.target.dispatchEvent(c),qr=null}else return a=Lt(i),a!==null&&E1(a),e.blockedOn=i,!1;a.shift()}return!0}function R1(e,a,i){Nc(e)&&i.delete(a)}function zg(){Fu=!1,Tr!==null&&Nc(Tr)&&(Tr=null),Rr!==null&&Nc(Rr)&&(Rr=null),Or!==null&&Nc(Or)&&(Or=null),Zl.forEach(R1),Wl.forEach(R1)}function Cc(e,a){e.blockedOn===a&&(e.blockedOn=null,Fu||(Fu=!0,u.unstable_scheduleCallback(u.unstable_NormalPriority,zg)))}var Ec=null;function O1(e){Ec!==e&&(Ec=e,u.unstable_scheduleCallback(u.unstable_NormalPriority,function(){Ec===e&&(Ec=null);for(var a=0;a<e.length;a+=3){var i=e[a],c=e[a+1],x=e[a+2];if(typeof c!="function"){if(Pu(c||i)===null)continue;break}var p=Lt(i);p!==null&&(e.splice(a,3),a-=3,Ld(p,{pending:!0,data:x,method:i.method,action:c},c,x))}}))}function $i(e){function a(W){return Cc(W,e)}Tr!==null&&Cc(Tr,e),Rr!==null&&Cc(Rr,e),Or!==null&&Cc(Or,e),Zl.forEach(a),Wl.forEach(a);for(var i=0;i<Dr.length;i++){var c=Dr[i];c.blockedOn===e&&(c.blockedOn=null)}for(;0<Dr.length&&(i=Dr[0],i.blockedOn===null);)T1(i),i.blockedOn===null&&Dr.shift();if(i=(e.ownerDocument||e).$$reactFormReplay,i!=null)for(c=0;c<i.length;c+=3){var x=i[c],p=i[c+1],S=x[Yt]||null;if(typeof p=="function")S||O1(i);else if(S){var B=null;if(p&&p.hasAttribute("formAction")){if(x=p,S=p[Yt]||null)B=S.formAction;else if(Pu(x)!==null)continue}else B=S.action;typeof B=="function"?i[c+1]=B:(i.splice(c,3),c-=3),O1(i)}}}function D1(){function e(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(S){return x=S})},focusReset:"manual",scroll:"manual"})}function a(){x!==null&&(x(),x=null),c||setTimeout(i,20)}function i(){if(!c&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,x=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(i,100),function(){c=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),x!==null&&(x(),x=null)}}}function Uu(e){this._internalRoot=e}Ac.prototype.render=Uu.prototype.render=function(e){var a=this._internalRoot;if(a===null)throw Error(y(409));var i=a.current,c=_a();N1(i,c,e,a,null,null)},Ac.prototype.unmount=Uu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var a=e.containerInfo;N1(e.current,2,null,e,null,null),rc(),a[va]=null}};function Ac(e){this._internalRoot=e}Ac.prototype.unstable_scheduleHydration=function(e){if(e){var a=ta();e={blockedOn:null,target:e,priority:a};for(var i=0;i<Dr.length&&a!==0&&a<Dr[i].priority;i++);Dr.splice(i,0,e),i===0&&T1(e)}};var _1=m.version;if(_1!=="19.2.0")throw Error(y(527,_1,"19.2.0"));U.findDOMNode=function(e){var a=e._reactInternals;if(a===void 0)throw typeof e.render=="function"?Error(y(188)):(e=Object.keys(e).join(","),Error(y(268,e)));return e=v(a),e=e!==null?A(e):null,e=e===null?null:e.stateNode,e};var Hg={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jc.isDisabled&&jc.supportsFiber)try{It=jc.inject(Hg),ke=jc}catch{}}return $l.createRoot=function(e,a){if(!C(e))throw Error(y(299));var i=!1,c="",x=Ph,p=Fh,S=Uh;return a!=null&&(a.unstable_strictMode===!0&&(i=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(x=a.onUncaughtError),a.onCaughtError!==void 0&&(p=a.onCaughtError),a.onRecoverableError!==void 0&&(S=a.onRecoverableError)),a=w1(e,1,!1,null,null,i,c,null,x,p,S,D1),e[va]=a.current,vu(e),new Uu(a)},$l.hydrateRoot=function(e,a,i){if(!C(e))throw Error(y(299));var c=!1,x="",p=Ph,S=Fh,B=Uh,W=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(x=i.identifierPrefix),i.onUncaughtError!==void 0&&(p=i.onUncaughtError),i.onCaughtError!==void 0&&(S=i.onCaughtError),i.onRecoverableError!==void 0&&(B=i.onRecoverableError),i.formState!==void 0&&(W=i.formState)),a=w1(e,1,!0,a,i??null,c,x,W,p,S,B,D1),a.context=v1(null),i=a.current,c=_a(),c=Hs(c),x=gr(c),x.callback=null,pr(i,x,c),i=c,a.current.lanes=i,ln(a,i),gn(a),e[va]=a.current,vu(e),new Ac(a)},$l.version="19.2.0",$l}var H1;function Jg(){if(H1)return Vu.exports;H1=1;function u(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u)}catch(m){console.error(m)}}return u(),Vu.exports=Qg(),Vu.exports}var $g=Jg();const ep=zc($g);Gx();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function no(){return no=Object.assign?Object.assign.bind():function(u){for(var m=1;m<arguments.length;m++){var f=arguments[m];for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(u[y]=f[y])}return u},no.apply(this,arguments)}var kr;(function(u){u.Pop="POP",u.Push="PUSH",u.Replace="REPLACE"})(kr||(kr={}));const V1="popstate";function tp(u){u===void 0&&(u={});function m(y,C){let{pathname:w,search:E,hash:T}=y.location;return c0("",{pathname:w,search:E,hash:T},C.state&&C.state.usr||null,C.state&&C.state.key||"default")}function f(y,C){return typeof C=="string"?C:Mc(C)}return ap(m,f,null,u)}function Ts(u,m){if(u===!1||u===null||typeof u>"u")throw new Error(m)}function y0(u,m){if(!u){typeof console<"u"&&console.warn(m);try{throw new Error(m)}catch{}}}function sp(){return Math.random().toString(36).substr(2,8)}function G1(u,m){return{usr:u.state,key:u.key,idx:m}}function c0(u,m,f,y){return f===void 0&&(f=null),no({pathname:typeof u=="string"?u:u.pathname,search:"",hash:""},typeof m=="string"?il(m):m,{state:f,key:m&&m.key||y||sp()})}function Mc(u){let{pathname:m="/",search:f="",hash:y=""}=u;return f&&f!=="?"&&(m+=f.charAt(0)==="?"?f:"?"+f),y&&y!=="#"&&(m+=y.charAt(0)==="#"?y:"#"+y),m}function il(u){let m={};if(u){let f=u.indexOf("#");f>=0&&(m.hash=u.substr(f),u=u.substr(0,f));let y=u.indexOf("?");y>=0&&(m.search=u.substr(y),u=u.substr(0,y)),u&&(m.pathname=u)}return m}function ap(u,m,f,y){y===void 0&&(y={});let{window:C=document.defaultView,v5Compat:w=!1}=y,E=C.history,T=kr.Pop,N=null,v=A();v==null&&(v=0,E.replaceState(no({},E.state,{idx:v}),""));function A(){return(E.state||{idx:null}).idx}function O(){T=kr.Pop;let Z=A(),ne=Z==null?null:Z-v;v=Z,N&&N({action:T,location:F.location,delta:ne})}function R(Z,ne){T=kr.Push;let Y=c0(F.location,Z,ne);v=A()+1;let q=G1(Y,v),oe=F.createHref(Y);try{E.pushState(q,"",oe)}catch(Q){if(Q instanceof DOMException&&Q.name==="DataCloneError")throw Q;C.location.assign(oe)}w&&N&&N({action:T,location:F.location,delta:1})}function z(Z,ne){T=kr.Replace;let Y=c0(F.location,Z,ne);v=A();let q=G1(Y,v),oe=F.createHref(Y);E.replaceState(q,"",oe),w&&N&&N({action:T,location:F.location,delta:0})}function P(Z){let ne=C.location.origin!=="null"?C.location.origin:C.location.href,Y=typeof Z=="string"?Z:Mc(Z);return Y=Y.replace(/ $/,"%20"),Ts(ne,"No window.location.(origin|href) available to create URL for href: "+Y),new URL(Y,ne)}let F={get action(){return T},get location(){return u(C,E)},listen(Z){if(N)throw new Error("A history only accepts one active listener");return C.addEventListener(V1,O),N=Z,()=>{C.removeEventListener(V1,O),N=null}},createHref(Z){return m(C,Z)},createURL:P,encodeLocation(Z){let ne=P(Z);return{pathname:ne.pathname,search:ne.search,hash:ne.hash}},push:R,replace:z,go(Z){return E.go(Z)}};return F}var X1;(function(u){u.data="data",u.deferred="deferred",u.redirect="redirect",u.error="error"})(X1||(X1={}));function np(u,m,f){return f===void 0&&(f="/"),rp(u,m,f)}function rp(u,m,f,y){let C=typeof m=="string"?il(m):m,w=b0(C.pathname||"/",f);if(w==null)return null;let E=Xx(u);ip(E);let T=null;for(let N=0;T==null&&N<E.length;++N){let v=yp(w);T=mp(E[N],v)}return T}function Xx(u,m,f,y){m===void 0&&(m=[]),f===void 0&&(f=[]),y===void 0&&(y="");let C=(w,E,T)=>{let N={relativePath:T===void 0?w.path||"":T,caseSensitive:w.caseSensitive===!0,childrenIndex:E,route:w};N.relativePath.startsWith("/")&&(Ts(N.relativePath.startsWith(y),'Absolute route path "'+N.relativePath+'" nested under path '+('"'+y+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),N.relativePath=N.relativePath.slice(y.length));let v=Br([y,N.relativePath]),A=f.concat(N);w.children&&w.children.length>0&&(Ts(w.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),Xx(w.children,m,A,v)),!(w.path==null&&!w.index)&&m.push({path:v,score:fp(v,w.index),routesMeta:A})};return u.forEach((w,E)=>{var T;if(w.path===""||!((T=w.path)!=null&&T.includes("?")))C(w,E);else for(let N of Yx(w.path))C(w,E,N)}),m}function Yx(u){let m=u.split("/");if(m.length===0)return[];let[f,...y]=m,C=f.endsWith("?"),w=f.replace(/\?$/,"");if(y.length===0)return C?[w,""]:[w];let E=Yx(y.join("/")),T=[];return T.push(...E.map(N=>N===""?w:[w,N].join("/"))),C&&T.push(...E),T.map(N=>u.startsWith("/")&&N===""?"/":N)}function ip(u){u.sort((m,f)=>m.score!==f.score?f.score-m.score:xp(m.routesMeta.map(y=>y.childrenIndex),f.routesMeta.map(y=>y.childrenIndex)))}const lp=/^:[\w-]+$/,op=3,cp=2,dp=1,up=10,hp=-2,Y1=u=>u==="*";function fp(u,m){let f=u.split("/"),y=f.length;return f.some(Y1)&&(y+=hp),m&&(y+=cp),f.filter(C=>!Y1(C)).reduce((C,w)=>C+(lp.test(w)?op:w===""?dp:up),y)}function xp(u,m){return u.length===m.length&&u.slice(0,-1).every((y,C)=>y===m[C])?u[u.length-1]-m[m.length-1]:0}function mp(u,m,f){let{routesMeta:y}=u,C={},w="/",E=[];for(let T=0;T<y.length;++T){let N=y[T],v=T===y.length-1,A=w==="/"?m:m.slice(w.length)||"/",O=gp({path:N.relativePath,caseSensitive:N.caseSensitive,end:v},A),R=N.route;if(!O)return null;Object.assign(C,O.params),E.push({params:C,pathname:Br([w,O.pathname]),pathnameBase:Cp(Br([w,O.pathnameBase])),route:R}),O.pathnameBase!=="/"&&(w=Br([w,O.pathnameBase]))}return E}function gp(u,m){typeof u=="string"&&(u={path:u,caseSensitive:!1,end:!0});let[f,y]=pp(u.path,u.caseSensitive,u.end),C=m.match(f);if(!C)return null;let w=C[0],E=w.replace(/(.)\/+$/,"$1"),T=C.slice(1);return{params:y.reduce((v,A,O)=>{let{paramName:R,isOptional:z}=A;if(R==="*"){let F=T[O]||"";E=w.slice(0,w.length-F.length).replace(/(.)\/+$/,"$1")}const P=T[O];return z&&!P?v[R]=void 0:v[R]=(P||"").replace(/%2F/g,"/"),v},{}),pathname:w,pathnameBase:E,pattern:u}}function pp(u,m,f){m===void 0&&(m=!1),f===void 0&&(f=!0),y0(u==="*"||!u.endsWith("*")||u.endsWith("/*"),'Route path "'+u+'" will be treated as if it were '+('"'+u.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+u.replace(/\*$/,"/*")+'".'));let y=[],C="^"+u.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(E,T,N)=>(y.push({paramName:T,isOptional:N!=null}),N?"/?([^\\/]+)?":"/([^\\/]+)"));return u.endsWith("*")?(y.push({paramName:"*"}),C+=u==="*"||u==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):f?C+="\\/*$":u!==""&&u!=="/"&&(C+="(?:(?=\\/|$))"),[new RegExp(C,m?void 0:"i"),y]}function yp(u){try{return u.split("/").map(m=>decodeURIComponent(m).replace(/\//g,"%2F")).join("/")}catch(m){return y0(!1,'The URL path "'+u+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+m+").")),u}}function b0(u,m){if(m==="/")return u;if(!u.toLowerCase().startsWith(m.toLowerCase()))return null;let f=m.endsWith("/")?m.length-1:m.length,y=u.charAt(f);return y&&y!=="/"?null:u.slice(f)||"/"}const bp=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wp=u=>bp.test(u);function vp(u,m){m===void 0&&(m="/");let{pathname:f,search:y="",hash:C=""}=typeof u=="string"?il(u):u,w;if(f)if(wp(f))w=f;else{if(f.includes("//")){let E=f;f=f.replace(/\/\/+/g,"/"),y0(!1,"Pathnames cannot have embedded double slashes - normalizing "+(E+" -> "+f))}f.startsWith("/")?w=q1(f.substring(1),"/"):w=q1(f,m)}else w=m;return{pathname:w,search:Ep(y),hash:Ap(C)}}function q1(u,m){let f=m.replace(/\/+$/,"").split("/");return u.split("/").forEach(C=>{C===".."?f.length>1&&f.pop():C!=="."&&f.push(C)}),f.length>1?f.join("/"):"/"}function qu(u,m,f,y){return"Cannot include a '"+u+"' character in a manually specified "+("`to."+m+"` field ["+JSON.stringify(y)+"].  Please separate it out to the ")+("`to."+f+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Np(u){return u.filter((m,f)=>f===0||m.route.path&&m.route.path.length>0)}function w0(u,m){let f=Np(u);return m?f.map((y,C)=>C===f.length-1?y.pathname:y.pathnameBase):f.map(y=>y.pathnameBase)}function v0(u,m,f,y){y===void 0&&(y=!1);let C;typeof u=="string"?C=il(u):(C=no({},u),Ts(!C.pathname||!C.pathname.includes("?"),qu("?","pathname","search",C)),Ts(!C.pathname||!C.pathname.includes("#"),qu("#","pathname","hash",C)),Ts(!C.search||!C.search.includes("#"),qu("#","search","hash",C)));let w=u===""||C.pathname==="",E=w?"/":C.pathname,T;if(E==null)T=f;else{let O=m.length-1;if(!y&&E.startsWith("..")){let R=E.split("/");for(;R[0]==="..";)R.shift(),O-=1;C.pathname=R.join("/")}T=O>=0?m[O]:"/"}let N=vp(C,T),v=E&&E!=="/"&&E.endsWith("/"),A=(w||E===".")&&f.endsWith("/");return!N.pathname.endsWith("/")&&(v||A)&&(N.pathname+="/"),N}const Br=u=>u.join("/").replace(/\/\/+/g,"/"),Cp=u=>u.replace(/\/+$/,"").replace(/^\/*/,"/"),Ep=u=>!u||u==="?"?"":u.startsWith("?")?u:"?"+u,Ap=u=>!u||u==="#"?"":u.startsWith("#")?u:"#"+u;function jp(u){return u!=null&&typeof u.status=="number"&&typeof u.statusText=="string"&&typeof u.internal=="boolean"&&"data"in u}const qx=["post","put","patch","delete"];new Set(qx);const Sp=["get",...qx];new Set(Sp);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ro(){return ro=Object.assign?Object.assign.bind():function(u){for(var m=1;m<arguments.length;m++){var f=arguments[m];for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(u[y]=f[y])}return u},ro.apply(this,arguments)}const N0=D.createContext(null),Tp=D.createContext(null),zr=D.createContext(null),Hc=D.createContext(null),Wn=D.createContext({outlet:null,matches:[],isDataRoute:!1}),Kx=D.createContext(null);function Rp(u,m){let{relative:f}=m===void 0?{}:m;ll()||Ts(!1);let{basename:y,navigator:C}=D.useContext(zr),{hash:w,pathname:E,search:T}=Wx(u,{relative:f}),N=E;return y!=="/"&&(N=E==="/"?y:Br([y,E])),C.createHref({pathname:N,search:T,hash:w})}function ll(){return D.useContext(Hc)!=null}function sn(){return ll()||Ts(!1),D.useContext(Hc).location}function Zx(u){D.useContext(zr).static||D.useLayoutEffect(u)}function Gs(){let{isDataRoute:u}=D.useContext(Wn);return u?Hp():Op()}function Op(){ll()||Ts(!1);let u=D.useContext(N0),{basename:m,future:f,navigator:y}=D.useContext(zr),{matches:C}=D.useContext(Wn),{pathname:w}=sn(),E=JSON.stringify(w0(C,f.v7_relativeSplatPath)),T=D.useRef(!1);return Zx(()=>{T.current=!0}),D.useCallback(function(v,A){if(A===void 0&&(A={}),!T.current)return;if(typeof v=="number"){y.go(v);return}let O=v0(v,JSON.parse(E),w,A.relative==="path");u==null&&m!=="/"&&(O.pathname=O.pathname==="/"?m:Br([m,O.pathname])),(A.replace?y.replace:y.push)(O,A.state,A)},[m,y,E,w,u])}function Vc(){let{matches:u}=D.useContext(Wn),m=u[u.length-1];return m?m.params:{}}function Wx(u,m){let{relative:f}=m===void 0?{}:m,{future:y}=D.useContext(zr),{matches:C}=D.useContext(Wn),{pathname:w}=sn(),E=JSON.stringify(w0(C,y.v7_relativeSplatPath));return D.useMemo(()=>v0(u,JSON.parse(E),w,f==="path"),[u,E,w,f])}function Dp(u,m){return _p(u,m)}function _p(u,m,f,y){ll()||Ts(!1);let{navigator:C}=D.useContext(zr),{matches:w}=D.useContext(Wn),E=w[w.length-1],T=E?E.params:{};E&&E.pathname;let N=E?E.pathnameBase:"/";E&&E.route;let v=sn(),A;if(m){var O;let Z=typeof m=="string"?il(m):m;N==="/"||(O=Z.pathname)!=null&&O.startsWith(N)||Ts(!1),A=Z}else A=v;let R=A.pathname||"/",z=R;if(N!=="/"){let Z=N.replace(/^\//,"").split("/");z="/"+R.replace(/^\//,"").split("/").slice(Z.length).join("/")}let P=np(u,{pathname:z}),F=Lp(P&&P.map(Z=>Object.assign({},Z,{params:Object.assign({},T,Z.params),pathname:Br([N,C.encodeLocation?C.encodeLocation(Z.pathname).pathname:Z.pathname]),pathnameBase:Z.pathnameBase==="/"?N:Br([N,C.encodeLocation?C.encodeLocation(Z.pathnameBase).pathname:Z.pathnameBase])})),w,f,y);return m&&F?D.createElement(Hc.Provider,{value:{location:ro({pathname:"/",search:"",hash:"",state:null,key:"default"},A),navigationType:kr.Pop}},F):F}function Ip(){let u=zp(),m=jp(u)?u.status+" "+u.statusText:u instanceof Error?u.message:JSON.stringify(u),f=u instanceof Error?u.stack:null,C={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},m),f?D.createElement("pre",{style:C},f):null,null)}const Mp=D.createElement(Ip,null);class kp extends D.Component{constructor(m){super(m),this.state={location:m.location,revalidation:m.revalidation,error:m.error}}static getDerivedStateFromError(m){return{error:m}}static getDerivedStateFromProps(m,f){return f.location!==m.location||f.revalidation!=="idle"&&m.revalidation==="idle"?{error:m.error,location:m.location,revalidation:m.revalidation}:{error:m.error!==void 0?m.error:f.error,location:f.location,revalidation:m.revalidation||f.revalidation}}componentDidCatch(m,f){console.error("React Router caught the following error during render",m,f)}render(){return this.state.error!==void 0?D.createElement(Wn.Provider,{value:this.props.routeContext},D.createElement(Kx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Bp(u){let{routeContext:m,match:f,children:y}=u,C=D.useContext(N0);return C&&C.static&&C.staticContext&&(f.route.errorElement||f.route.ErrorBoundary)&&(C.staticContext._deepestRenderedBoundaryId=f.route.id),D.createElement(Wn.Provider,{value:m},y)}function Lp(u,m,f,y){var C;if(m===void 0&&(m=[]),f===void 0&&(f=null),y===void 0&&(y=null),u==null){var w;if(!f)return null;if(f.errors)u=f.matches;else if((w=y)!=null&&w.v7_partialHydration&&m.length===0&&!f.initialized&&f.matches.length>0)u=f.matches;else return null}let E=u,T=(C=f)==null?void 0:C.errors;if(T!=null){let A=E.findIndex(O=>O.route.id&&(T==null?void 0:T[O.route.id])!==void 0);A>=0||Ts(!1),E=E.slice(0,Math.min(E.length,A+1))}let N=!1,v=-1;if(f&&y&&y.v7_partialHydration)for(let A=0;A<E.length;A++){let O=E[A];if((O.route.HydrateFallback||O.route.hydrateFallbackElement)&&(v=A),O.route.id){let{loaderData:R,errors:z}=f,P=O.route.loader&&R[O.route.id]===void 0&&(!z||z[O.route.id]===void 0);if(O.route.lazy||P){N=!0,v>=0?E=E.slice(0,v+1):E=[E[0]];break}}}return E.reduceRight((A,O,R)=>{let z,P=!1,F=null,Z=null;f&&(z=T&&O.route.id?T[O.route.id]:void 0,F=O.route.errorElement||Mp,N&&(v<0&&R===0?(Vp("route-fallback"),P=!0,Z=null):v===R&&(P=!0,Z=O.route.hydrateFallbackElement||null)));let ne=m.concat(E.slice(0,R+1)),Y=()=>{let q;return z?q=F:P?q=Z:O.route.Component?q=D.createElement(O.route.Component,null):O.route.element?q=O.route.element:q=A,D.createElement(Bp,{match:O,routeContext:{outlet:A,matches:ne,isDataRoute:f!=null},children:q})};return f&&(O.route.ErrorBoundary||O.route.errorElement||R===0)?D.createElement(kp,{location:f.location,revalidation:f.revalidation,component:F,error:z,children:Y(),routeContext:{outlet:null,matches:ne,isDataRoute:!0}}):Y()},null)}var Qx=(function(u){return u.UseBlocker="useBlocker",u.UseRevalidator="useRevalidator",u.UseNavigateStable="useNavigate",u})(Qx||{}),Jx=(function(u){return u.UseBlocker="useBlocker",u.UseLoaderData="useLoaderData",u.UseActionData="useActionData",u.UseRouteError="useRouteError",u.UseNavigation="useNavigation",u.UseRouteLoaderData="useRouteLoaderData",u.UseMatches="useMatches",u.UseRevalidator="useRevalidator",u.UseNavigateStable="useNavigate",u.UseRouteId="useRouteId",u})(Jx||{});function Pp(u){let m=D.useContext(N0);return m||Ts(!1),m}function Fp(u){let m=D.useContext(Tp);return m||Ts(!1),m}function Up(u){let m=D.useContext(Wn);return m||Ts(!1),m}function $x(u){let m=Up(),f=m.matches[m.matches.length-1];return f.route.id||Ts(!1),f.route.id}function zp(){var u;let m=D.useContext(Kx),f=Fp(),y=$x();return m!==void 0?m:(u=f.errors)==null?void 0:u[y]}function Hp(){let{router:u}=Pp(Qx.UseNavigateStable),m=$x(Jx.UseNavigateStable),f=D.useRef(!1);return Zx(()=>{f.current=!0}),D.useCallback(function(C,w){w===void 0&&(w={}),f.current&&(typeof C=="number"?u.navigate(C):u.navigate(C,ro({fromRouteId:m},w)))},[u,m])}const K1={};function Vp(u,m,f){K1[u]||(K1[u]=!0)}function Gp(u,m){u==null||u.v7_startTransition,u==null||u.v7_relativeSplatPath}function mi(u){let{to:m,replace:f,state:y,relative:C}=u;ll()||Ts(!1);let{future:w,static:E}=D.useContext(zr),{matches:T}=D.useContext(Wn),{pathname:N}=sn(),v=Gs(),A=v0(m,w0(T,w.v7_relativeSplatPath),N,C==="path"),O=JSON.stringify(A);return D.useEffect(()=>v(JSON.parse(O),{replace:f,state:y,relative:C}),[v,O,C,f,y]),null}function at(u){Ts(!1)}function Xp(u){let{basename:m="/",children:f=null,location:y,navigationType:C=kr.Pop,navigator:w,static:E=!1,future:T}=u;ll()&&Ts(!1);let N=m.replace(/^\/*/,"/"),v=D.useMemo(()=>({basename:N,navigator:w,static:E,future:ro({v7_relativeSplatPath:!1},T)}),[N,T,w,E]);typeof y=="string"&&(y=il(y));let{pathname:A="/",search:O="",hash:R="",state:z=null,key:P="default"}=y,F=D.useMemo(()=>{let Z=b0(A,N);return Z==null?null:{location:{pathname:Z,search:O,hash:R,state:z,key:P},navigationType:C}},[N,A,O,R,z,P,C]);return F==null?null:D.createElement(zr.Provider,{value:v},D.createElement(Hc.Provider,{children:f,value:F}))}function Yp(u){let{children:m,location:f}=u;return Dp(d0(m),f)}new Promise(()=>{});function d0(u,m){m===void 0&&(m=[]);let f=[];return D.Children.forEach(u,(y,C)=>{if(!D.isValidElement(y))return;let w=[...m,C];if(y.type===D.Fragment){f.push.apply(f,d0(y.props.children,w));return}y.type!==at&&Ts(!1),!y.props.index||!y.props.children||Ts(!1);let E={id:y.props.id||w.join("-"),caseSensitive:y.props.caseSensitive,element:y.props.element,Component:y.props.Component,index:y.props.index,path:y.props.path,loader:y.props.loader,action:y.props.action,errorElement:y.props.errorElement,ErrorBoundary:y.props.ErrorBoundary,hasErrorBoundary:y.props.ErrorBoundary!=null||y.props.errorElement!=null,shouldRevalidate:y.props.shouldRevalidate,handle:y.props.handle,lazy:y.props.lazy};y.props.children&&(E.children=d0(y.props.children,w)),f.push(E)}),f}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function u0(){return u0=Object.assign?Object.assign.bind():function(u){for(var m=1;m<arguments.length;m++){var f=arguments[m];for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(u[y]=f[y])}return u},u0.apply(this,arguments)}function qp(u,m){if(u==null)return{};var f={},y=Object.keys(u),C,w;for(w=0;w<y.length;w++)C=y[w],!(m.indexOf(C)>=0)&&(f[C]=u[C]);return f}function Kp(u){return!!(u.metaKey||u.altKey||u.ctrlKey||u.shiftKey)}function Zp(u,m){return u.button===0&&(!m||m==="_self")&&!Kp(u)}const Wp=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Qp="6";try{window.__reactRouterVersion=Qp}catch{}const Jp="startTransition",Z1=qg[Jp];function $p(u){let{basename:m,children:f,future:y,window:C}=u,w=D.useRef();w.current==null&&(w.current=tp({window:C,v5Compat:!0}));let E=w.current,[T,N]=D.useState({action:E.action,location:E.location}),{v7_startTransition:v}=y||{},A=D.useCallback(O=>{v&&Z1?Z1(()=>N(O)):N(O)},[N,v]);return D.useLayoutEffect(()=>E.listen(A),[E,A]),D.useEffect(()=>Gp(y),[y]),D.createElement(Xp,{basename:m,children:f,location:T.location,navigationType:T.action,navigator:E,future:y})}const e2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",t2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_c=D.forwardRef(function(m,f){let{onClick:y,relative:C,reloadDocument:w,replace:E,state:T,target:N,to:v,preventScrollReset:A,viewTransition:O}=m,R=qp(m,Wp),{basename:z}=D.useContext(zr),P,F=!1;if(typeof v=="string"&&t2.test(v)&&(P=v,e2))try{let q=new URL(window.location.href),oe=v.startsWith("//")?new URL(q.protocol+v):new URL(v),Q=b0(oe.pathname,z);oe.origin===q.origin&&Q!=null?v=Q+oe.search+oe.hash:F=!0}catch{}let Z=Rp(v,{relative:C}),ne=s2(v,{replace:E,state:T,target:N,preventScrollReset:A,relative:C,viewTransition:O});function Y(q){y&&y(q),q.defaultPrevented||ne(q)}return D.createElement("a",u0({},R,{href:P||Z,onClick:F||w?y:Y,ref:f,target:N}))});var W1;(function(u){u.UseScrollRestoration="useScrollRestoration",u.UseSubmit="useSubmit",u.UseSubmitFetcher="useSubmitFetcher",u.UseFetcher="useFetcher",u.useViewTransitionState="useViewTransitionState"})(W1||(W1={}));var Q1;(function(u){u.UseFetcher="useFetcher",u.UseFetchers="useFetchers",u.UseScrollRestoration="useScrollRestoration"})(Q1||(Q1={}));function s2(u,m){let{target:f,replace:y,state:C,preventScrollReset:w,relative:E,viewTransition:T}=m===void 0?{}:m,N=Gs(),v=sn(),A=Wx(u,{relative:E});return D.useCallback(O=>{if(Zp(O,f)){O.preventDefault();let R=y!==void 0?y:Mc(v)===Mc(A);N(u,{replace:R,state:C,preventScrollReset:w,relative:E,viewTransition:T})}},[v,N,A,y,C,f,u,w,E,T])}const a2=()=>!!ea(),ea=()=>{const u=localStorage.getItem("token");return u||null},J1=u=>{u.token&&localStorage.setItem("token",u.token),u.role&&localStorage.setItem("role",u.role),u.name&&localStorage.setItem("name",u.name),u.email&&localStorage.setItem("email",u.email),u.id&&localStorage.setItem("userId",u.id),u.portalActive!==void 0&&(u.portalActive===null?localStorage.removeItem("portalActive"):localStorage.setItem("portalActive",String(!!u.portalActive))),u.weightBracketsCount!==void 0&&(u.weightBracketsCount===null||u.weightBracketsCount===void 0?localStorage.removeItem("weightBracketsCount"):localStorage.setItem("weightBracketsCount",String(Number(u.weightBracketsCount)))),u.commissionRate!==void 0&&(u.commissionRate===null?localStorage.removeItem("commissionRate"):localStorage.setItem("commissionRate",String(u.commissionRate))),u.commissionType!==void 0&&(u.commissionType?localStorage.setItem("commissionType",String(u.commissionType)):localStorage.removeItem("commissionType")),u.commissionValue!==void 0&&(u.commissionValue===null?localStorage.removeItem("commissionValue"):localStorage.setItem("commissionValue",String(u.commissionValue))),u.commissionStatus!==void 0&&(u.commissionStatus?localStorage.setItem("commissionStatus",String(u.commissionStatus)):localStorage.removeItem("commissionStatus")),u.isCommissionApproved!==void 0&&(u.isCommissionApproved===null?localStorage.removeItem("isCommissionApproved"):localStorage.setItem("isCommissionApproved",String(!!u.isCommissionApproved)))},$1=()=>(localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("name"),localStorage.removeItem("email"),localStorage.removeItem("userId"),localStorage.removeItem("portalActive"),localStorage.removeItem("weightBracketsCount"),localStorage.removeItem("commissionRate"),localStorage.removeItem("commissionType"),localStorage.removeItem("commissionValue"),localStorage.removeItem("commissionStatus"),localStorage.removeItem("isCommissionApproved"),fetch("/api/auth/logout",{method:"POST",credentials:"include"})),em=D.createContext(),n2=({children:u})=>{const[m,f]=D.useState(null),[y,C]=D.useState(!0),w=async N=>{const v=N||ea(),A=await fetch("/api/auth/me",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json",...v?{Authorization:`Bearer ${v}`}:{}}});if(!A.ok){const P=await A.json().catch(()=>({})),F=new Error((P==null?void 0:P.message)||`Failed to fetch profile (HTTP ${A.status})`);throw F.status=A.status,F}const O=await A.json(),R=O==null?void 0:O.user,z={token:v,id:(R==null?void 0:R._id)||(R==null?void 0:R.id),role:R==null?void 0:R.role,name:R==null?void 0:R.name,email:R==null?void 0:R.email,portalActive:(R==null?void 0:R.portalActive)??!0,weightBracketsCount:(R==null?void 0:R.weightBracketsCount)!==void 0&&(R==null?void 0:R.weightBracketsCount)!==null?Number(R.weightBracketsCount):null,commissionRate:(R==null?void 0:R.commissionRate)??null,commissionType:(R==null?void 0:R.commissionType)??null,commissionValue:(R==null?void 0:R.commissionValue)??null,commissionStatus:(R==null?void 0:R.commissionStatus)??null,isCommissionApproved:(R==null?void 0:R.isCommissionApproved)??null};return J1(z),f(z),z};D.useEffect(()=>{(async()=>{try{if(a2()){const v=ea();await w(v)}}catch(v){console.error("Auth check failed:",v);try{await $1()}finally{f(null)}}finally{C(!1)}})()},[]);const E=async({token:N})=>(J1({token:N}),w(N)),T=async()=>{try{return await $1(),f(null),!0}catch(N){return console.error("Logout failed:",N),!1}};return s.jsx(em.Provider,{value:{user:m,loading:y,login:E,logout:T,refreshMe:w},children:!y&&u})},Qs=()=>{const u=D.useContext(em);if(!u)throw new Error("useAuth must be used within an AuthProvider");return u};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r2=u=>u.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i2=u=>u.replace(/^([A-Z])|[\s-_]+(\w)/g,(m,f,y)=>y?y.toUpperCase():f.toLowerCase()),ex=u=>{const m=i2(u);return m.charAt(0).toUpperCase()+m.slice(1)},tm=(...u)=>u.filter((m,f,y)=>!!m&&m.trim()!==""&&y.indexOf(m)===f).join(" ").trim(),l2=u=>{for(const m in u)if(m.startsWith("aria-")||m==="role"||m==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var o2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c2=D.forwardRef(({color:u="currentColor",size:m=24,strokeWidth:f=2,absoluteStrokeWidth:y,className:C="",children:w,iconNode:E,...T},N)=>D.createElement("svg",{ref:N,...o2,width:m,height:m,stroke:u,strokeWidth:y?Number(f)*24/Number(m):f,className:tm("lucide",C),...!w&&!l2(T)&&{"aria-hidden":"true"},...T},[...E.map(([v,A])=>D.createElement(v,A)),...Array.isArray(w)?w:[w]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=(u,m)=>{const f=D.forwardRef(({className:y,...C},w)=>D.createElement(c2,{ref:w,iconNode:m,className:tm(`lucide-${r2(ex(u))}`,`lucide-${u}`,y),...C}));return f.displayName=ex(u),f};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]],u2=Ze("arrow-down-to-line",d2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],f2=Ze("arrow-left",h2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],m2=Ze("bell",x2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]],p2=Ze("bike",g2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],rl=Ze("building-2",y2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=[["path",{d:"M14.564 14.558a3 3 0 1 1-4.122-4.121",key:"1rnrzw"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M20 20H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 .819-.175",key:"1x3arw"}],["path",{d:"M9.695 4.024A2 2 0 0 1 10.004 4h3.993a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v7.344",key:"1i84u0"}]],w2=Ze("camera-off",b2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],so=Ze("camera",v2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],h0=Ze("check",N2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C2=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ur=Ze("circle-alert",C2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],qn=Ze("circle-check-big",E2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A2=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],yn=Ze("circle-x",A2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],S2=Ze("clipboard-list",j2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],R2=Ze("clipboard",T2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O2=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],bn=Ze("clock",O2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],_2=Ze("copy",D2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ut=Ze("dollar-sign",I2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],kc=Ze("download",M2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k2=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],B2=Ze("eye-off",k2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],P2=Ze("eye",L2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Tc=Ze("file-text",F2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],C0=Ze("funnel",U2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],sm=Ze("globe",z2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H2=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],V2=Ze("house",H2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],X2=Ze("info",G2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],q2=Ze("key",Y2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K2=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],Rc=Ze("layout-dashboard",K2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],W2=Ze("loader-circle",Z2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],nl=Ze("loader",Q2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],am=Ze("log-out",J2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Bc=Ze("mail",$2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ey=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Kn=Ze("map-pin",ey);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ty=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],sy=Ze("menu",ty);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ay=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],gt=Ze("package",ay);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ny=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Lr=Ze("phone",ny);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],nm=Ze("play",ry);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iy=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],f0=Ze("plus",iy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],rm=Ze("printer",ly);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oy=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],Pr=Ze("qr-code",oy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cy=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],Fr=Ze("refresh-ccw",cy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dy=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],uy=Ze("refresh-cw",dy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hy=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],x0=Ze("rotate-ccw",hy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fy=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],E0=Ze("save",fy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xy=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],tx=Ze("scale",xy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const my=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],sx=Ze("scan",my);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gy=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],A0=Ze("search",gy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const py=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],im=Ze("shield",py);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yy=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],by=Ze("square",yy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wy=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],lm=Ze("trash-2",wy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vy=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],om=Ze("trending-up",vy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ny=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Cy=Ze("triangle-alert",Ny);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ey=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],ds=Ze("truck",Ey);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ay=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Ku=Ze("type",Ay);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jy=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Sy=Ze("upload",jy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ty=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],io=Ze("user",Ty);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ry=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],gi=Ze("users",Ry);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oy=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Dy=Ze("wallet",Oy);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _y=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],cm=Ze("x",_y),Iy=({children:u,title:m})=>{var oe;const{user:f,logout:y}=Qs(),[C,w]=D.useState(!1),[E,T]=D.useState([]),[N,v]=D.useState(!1),[A,O]=D.useState(""),R=Gs(),z=sn(),P=(f==null?void 0:f.token)||ea(),F=async()=>{try{await y(),R("/")}catch(Q){console.error("Failed to log out",Q)}},Z=()=>w(!C),ne=async()=>{if(!(!P||(f==null?void 0:f.role)!=="CEO"&&(f==null?void 0:f.role)!=="MANAGER"))try{const Q=await fetch("/api/notifications",{headers:{Authorization:`Bearer ${P}`}});if(Q.ok){const te=await Q.json();T(te.filter(K=>!K.read))}}catch(Q){console.error("Failed to fetch notifications:",Q)}},Y=async Q=>{try{(await fetch(`/api/notifications/${Q}/mark-read`,{method:"PATCH",headers:{Authorization:`Bearer ${P}`}})).ok&&await ne()}catch(te){console.error("Failed to mark notification as read:",te)}};D.useEffect(()=>{if(f&&(f.role==="CEO"||f.role==="MANAGER")){ne();const Q=setInterval(ne,1e4);return()=>clearInterval(Q)}},[f,P]),D.useEffect(()=>{(async()=>{try{const te=await fetch("/api/company-profile/public"),K=await te.json();te.ok&&K.success&&O(K.data.logoUrl||"")}catch{}})()},[]);const q=()=>{if(!f)return[];const Q=[{icon:am,label:"Logout",action:F,variant:"danger"}];switch(f.role){case"CEO":return[{icon:Rc,label:"Dashboard",path:"/dashboard/ceo"},{icon:gi,label:"Users",path:"/ceo/users"},{icon:ds,label:"Riders",path:"/ceo/riders"},{icon:gt,label:"Orders",path:"/ceo/orders"},{icon:Pr,label:"Assign by Scan",path:"/ceo/assign-scan"},{icon:Ut,label:"Commission",path:"/ceo/commission"},{icon:Tc,label:"Finance  Invoice",path:"/ceo/finance/invoice"},{icon:Tc,label:"Finance  Company",path:"/ceo/finance/company"},{icon:ds,label:"Logistics",path:"/ceo/logistics"},{icon:sx,label:"Warehouse Scan",path:"/ceo/warehouse-scan"},{icon:rl,label:"Company Profile",path:"/ceo/company-profile"},...Q];case"MANAGER":return[{icon:Rc,label:"Overview",path:"/manager/dashboard"},{icon:gt,label:"All Orders",path:"/manager/orders"},{icon:ds,label:"Riders",path:"/manager/riders"},{icon:Pr,label:"Assign by Scan",path:"/manager/assign-scan"},{icon:Ut,label:"Commission",path:"/manager/commission"},{icon:Tc,label:"Finance  Invoice",path:"/manager/finance/invoice"},{icon:Tc,label:"Finance  Company",path:"/manager/finance/company"},{icon:ds,label:"Logistics",path:"/manager/logistics"},{icon:sx,label:"Warehouse Scan",path:"/manager/warehouse-scan"},...Q];case"SHIPPER":return[{icon:Rc,label:"Dashboard",path:"/shipper/dashboard"},{icon:gt,label:"My Orders",path:"/shipper/orders"},{icon:Ut,label:"Finance",path:"/shipper/finance"},{icon:gt,label:"Integrated Orders",path:"/shipper/integrated-orders"},{icon:gt,label:"Integrations",path:"/shipper/integrations"},{icon:gt,label:"Create Booking",path:"/shipper/create"},...Q];case"RIDER":return[{icon:Rc,label:"Dashboard",path:"/dashboard/rider"},{icon:gt,label:"All Orders",path:"/rider/history"},{icon:Ut,label:"Finance",path:"/rider/finance"},{icon:Pr,label:"Scanner",path:"/rider/scan"},...Q];default:return Q}};return s.jsxs("div",{className:"min-h-screen bg-[#F8F9FA] flex",children:[C&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>w(!1)}),s.jsx("aside",{className:`
        fixed top-0 left-0 bottom-0 z-50 w-64 bg-white border-r border-gray-200 transform transition-transform duration-200 ease-in-out
        lg:translate-x-0
        ${C?"translate-x-0":"-translate-x-full"}
      `,children:s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsx("div",{className:"p-6 border-b border-gray-100 flex items-center gap-3",children:s.jsx("img",{src:A||"/assets/logo.png",alt:"LahoreLink Logistics",className:"h-8 object-contain",onError:Q=>{Q.currentTarget.src="/assets/logo.png"}})}),s.jsx("div",{className:"p-4 flex-1 overflow-y-auto",children:f&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3 px-3 py-3 bg-gray-50 rounded-lg mb-6 border border-gray-100",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold",children:((oe=f.name)==null?void 0:oe.charAt(0))||"U"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-semibold text-secondary truncate",children:f.name||"User"}),s.jsx("p",{className:"text-xs text-gray-500 truncate",children:f.role||"User"})]})]}),s.jsx("nav",{className:"space-y-1",children:q().map((Q,te)=>{const K=Q.icon;return s.jsxs("button",{onClick:Q.action||(()=>Q.path&&R(Q.path)),className:`
                          w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors
                          ${Q.variant==="danger"?"text-red-600 hover:bg-red-50":Q!=null&&Q.path&&z.pathname===Q.path?"bg-primary/10 text-primary":"text-gray-600 hover:bg-gray-50 hover:text-secondary"}`,children:[s.jsx(K,{className:"w-5 h-5"}),Q.label]},te)})})]})})]})}),s.jsxs("div",{className:"flex-1 flex flex-col min-w-0 lg:ml-64",children:[s.jsxs("header",{className:"bg-white border-b border-gray-200 h-16 flex items-center justify-between px-4 lg:px-8 sticky top-0 z-30",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:Z,className:"lg:hidden p-2 -ml-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:s.jsx(sy,{className:"w-6 h-6"})}),s.jsx("h2",{className:"text-xl font-bold text-secondary",children:m})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[((f==null?void 0:f.role)==="CEO"||(f==null?void 0:f.role)==="MANAGER")&&s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>v(!N),className:"relative p-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:[s.jsx(m2,{className:"w-5 h-5"}),E.length>0&&s.jsx("span",{className:"absolute top-0 right-0 w-4 h-4 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:E.length})]}),N&&s.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto",children:[s.jsx("div",{className:"p-4 border-b border-gray-100",children:s.jsx("h4",{className:"font-bold text-secondary",children:"Notifications"})}),E.length===0?s.jsx("div",{className:"p-4 text-sm text-gray-500",children:"No new notifications"}):s.jsx("div",{className:"divide-y divide-gray-100",children:E.map(Q=>{var te;return s.jsx("div",{className:"p-4 hover:bg-gray-50",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:((te=Q.shipper)==null?void 0:te.name)||"Shipper"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Q.message}),s.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[Q.totalPendingParcels," pending parcels"]})]}),s.jsx("button",{onClick:()=>Y(Q._id),className:"ml-2 px-2 py-1 text-xs bg-primary text-white rounded hover:bg-primary-hover",children:"Mark as picked up"})]})},Q._id)})})]})]}),s.jsx("div",{className:"hidden md:block text-sm text-gray-500",children:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),s.jsx("main",{className:"flex-1 p-4 lg:p-8 overflow-y-auto",children:u})]})]})},yt=({children:u,allowedRoles:m=[],noLayout:f=!1})=>{const{user:y,loading:C}=Qs(),w=sn(),E=["/pending-approval","/shipper/pending-approval"],T=v=>v?v.portalActive===!0:!1;if(C)return s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."});if(!y)return s.jsx(mi,{to:"/",state:{from:w},replace:!0});if(m.length>0&&!m.includes(y.role)){const v=y.role==="CEO"?"/dashboard/ceo":y.role==="MANAGER"?"/manager/dashboard":y.role==="SHIPPER"?"/shipper/dashboard":"/rider/dashboard";return s.jsx(mi,{to:v,replace:!0})}if(y.role==="SHIPPER"&&!T(y)&&!E.includes(w.pathname))return s.jsx(mi,{to:"/pending-approval",replace:!0});if(f)return u;const N=()=>{switch(y.role){case"CEO":return"Executive Dashboard";case"MANAGER":return"Operations Dashboard";case"SHIPPER":return"Shipper Dashboard";case"RIDER":return"Rider Dashboard";default:return"Dashboard"}};return s.jsx(Iy,{title:N(),children:u})},as=({children:u,variant:m="primary",fullWidth:f=!1,className:y="",...C})=>{const w="px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 text-sm",E={primary:"bg-primary hover:bg-primary-hover text-white shadow-md shadow-primary/20",secondary:"bg-secondary hover:bg-black text-white",outline:"border border-gray-300 text-secondary hover:bg-gray-50 bg-white",ghost:"text-gray-600 hover:text-primary hover:bg-primary/5"};return s.jsx("button",{className:`${w} ${E[m]} ${f?"w-full":""} ${y}`,...C,children:u})},st=({label:u,error:m,className:f="",rightAdornment:y,...C})=>{const w=!!y;return s.jsxs("div",{className:`w-full ${f}`,children:[u&&s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:u}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{className:`w-full px-4 py-2.5 rounded-lg border ${m?"border-red-500 focus:ring-red-200":"border-gray-200 focus:border-primary focus:ring-primary/20"} bg-white text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 transition-all duration-200 ${w?"pr-10":""}`,...C}),w&&s.jsx("div",{className:"absolute inset-y-0 right-3 flex items-center",children:y})]}),m&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:m})]})};let My={data:""},ky=u=>{if(typeof window=="object"){let m=(u?u.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return m.nonce=window.__nonce__,m.parentNode||(u||document.head).appendChild(m),m.firstChild}return u||My},By=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Ly=/\/\*[^]*?\*\/|  +/g,ax=/\n+/g,Mr=(u,m)=>{let f="",y="",C="";for(let w in u){let E=u[w];w[0]=="@"?w[1]=="i"?f=w+" "+E+";":y+=w[1]=="f"?Mr(E,w):w+"{"+Mr(E,w[1]=="k"?"":m)+"}":typeof E=="object"?y+=Mr(E,m?m.replace(/([^,])+/g,T=>w.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,N=>/&/.test(N)?N.replace(/&/g,T):T?T+" "+N:N)):w):E!=null&&(w=/^--/.test(w)?w:w.replace(/[A-Z]/g,"-$&").toLowerCase(),C+=Mr.p?Mr.p(w,E):w+":"+E+";")}return f+(m&&C?m+"{"+C+"}":C)+y},Hn={},dm=u=>{if(typeof u=="object"){let m="";for(let f in u)m+=f+dm(u[f]);return m}return u},Py=(u,m,f,y,C)=>{let w=dm(u),E=Hn[w]||(Hn[w]=(N=>{let v=0,A=11;for(;v<N.length;)A=101*A+N.charCodeAt(v++)>>>0;return"go"+A})(w));if(!Hn[E]){let N=w!==u?u:(v=>{let A,O,R=[{}];for(;A=By.exec(v.replace(Ly,""));)A[4]?R.shift():A[3]?(O=A[3].replace(ax," ").trim(),R.unshift(R[0][O]=R[0][O]||{})):R[0][A[1]]=A[2].replace(ax," ").trim();return R[0]})(u);Hn[E]=Mr(C?{["@keyframes "+E]:N}:N,f?"":"."+E)}let T=f&&Hn.g?Hn.g:null;return f&&(Hn.g=Hn[E]),((N,v,A,O)=>{O?v.data=v.data.replace(O,N):v.data.indexOf(N)===-1&&(v.data=A?N+v.data:v.data+N)})(Hn[E],m,y,T),E},Fy=(u,m,f)=>u.reduce((y,C,w)=>{let E=m[w];if(E&&E.call){let T=E(f),N=T&&T.props&&T.props.className||/^go/.test(T)&&T;E=N?"."+N:T&&typeof T=="object"?T.props?"":Mr(T,""):T===!1?"":T}return y+C+(E??"")},"");function Gc(u){let m=this||{},f=u.call?u(m.p):u;return Py(f.unshift?f.raw?Fy(f,[].slice.call(arguments,1),m.p):f.reduce((y,C)=>Object.assign(y,C&&C.call?C(m.p):C),{}):f,ky(m.target),m.g,m.o,m.k)}let um,m0,g0;Gc.bind({g:1});let Zn=Gc.bind({k:1});function Uy(u,m,f,y){Mr.p=m,um=u,m0=f,g0=y}function Hr(u,m){let f=this||{};return function(){let y=arguments;function C(w,E){let T=Object.assign({},w),N=T.className||C.className;f.p=Object.assign({theme:m0&&m0()},T),f.o=/ *go\d+/.test(N),T.className=Gc.apply(f,y)+(N?" "+N:"");let v=u;return u[0]&&(v=T.as||u,delete T.as),g0&&v[0]&&g0(T),um(v,T)}return C}}var zy=u=>typeof u=="function",Lc=(u,m)=>zy(u)?u(m):u,Hy=(()=>{let u=0;return()=>(++u).toString()})(),hm=(()=>{let u;return()=>{if(u===void 0&&typeof window<"u"){let m=matchMedia("(prefers-reduced-motion: reduce)");u=!m||m.matches}return u}})(),Vy=20,j0="default",fm=(u,m)=>{let{toastLimit:f}=u.settings;switch(m.type){case 0:return{...u,toasts:[m.toast,...u.toasts].slice(0,f)};case 1:return{...u,toasts:u.toasts.map(E=>E.id===m.toast.id?{...E,...m.toast}:E)};case 2:let{toast:y}=m;return fm(u,{type:u.toasts.find(E=>E.id===y.id)?1:0,toast:y});case 3:let{toastId:C}=m;return{...u,toasts:u.toasts.map(E=>E.id===C||C===void 0?{...E,dismissed:!0,visible:!1}:E)};case 4:return m.toastId===void 0?{...u,toasts:[]}:{...u,toasts:u.toasts.filter(E=>E.id!==m.toastId)};case 5:return{...u,pausedAt:m.time};case 6:let w=m.time-(u.pausedAt||0);return{...u,pausedAt:void 0,toasts:u.toasts.map(E=>({...E,pauseDuration:E.pauseDuration+w}))}}},Ic=[],xm={toasts:[],pausedAt:void 0,settings:{toastLimit:Vy}},pn={},mm=(u,m=j0)=>{pn[m]=fm(pn[m]||xm,u),Ic.forEach(([f,y])=>{f===m&&y(pn[m])})},gm=u=>Object.keys(pn).forEach(m=>mm(u,m)),Gy=u=>Object.keys(pn).find(m=>pn[m].toasts.some(f=>f.id===u)),Xc=(u=j0)=>m=>{mm(m,u)},Xy={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Yy=(u={},m=j0)=>{let[f,y]=D.useState(pn[m]||xm),C=D.useRef(pn[m]);D.useEffect(()=>(C.current!==pn[m]&&y(pn[m]),Ic.push([m,y]),()=>{let E=Ic.findIndex(([T])=>T===m);E>-1&&Ic.splice(E,1)}),[m]);let w=f.toasts.map(E=>{var T,N,v;return{...u,...u[E.type],...E,removeDelay:E.removeDelay||((T=u[E.type])==null?void 0:T.removeDelay)||(u==null?void 0:u.removeDelay),duration:E.duration||((N=u[E.type])==null?void 0:N.duration)||(u==null?void 0:u.duration)||Xy[E.type],style:{...u.style,...(v=u[E.type])==null?void 0:v.style,...E.style}}});return{...f,toasts:w}},qy=(u,m="blank",f)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:m,ariaProps:{role:"status","aria-live":"polite"},message:u,pauseDuration:0,...f,id:(f==null?void 0:f.id)||Hy()}),oo=u=>(m,f)=>{let y=qy(m,u,f);return Xc(y.toasterId||Gy(y.id))({type:2,toast:y}),y.id},vs=(u,m)=>oo("blank")(u,m);vs.error=oo("error");vs.success=oo("success");vs.loading=oo("loading");vs.custom=oo("custom");vs.dismiss=(u,m)=>{let f={type:3,toastId:u};m?Xc(m)(f):gm(f)};vs.dismissAll=u=>vs.dismiss(void 0,u);vs.remove=(u,m)=>{let f={type:4,toastId:u};m?Xc(m)(f):gm(f)};vs.removeAll=u=>vs.remove(void 0,u);vs.promise=(u,m,f)=>{let y=vs.loading(m.loading,{...f,...f==null?void 0:f.loading});return typeof u=="function"&&(u=u()),u.then(C=>{let w=m.success?Lc(m.success,C):void 0;return w?vs.success(w,{id:y,...f,...f==null?void 0:f.success}):vs.dismiss(y),C}).catch(C=>{let w=m.error?Lc(m.error,C):void 0;w?vs.error(w,{id:y,...f,...f==null?void 0:f.error}):vs.dismiss(y)}),u};var Ky=1e3,Zy=(u,m="default")=>{let{toasts:f,pausedAt:y}=Yy(u,m),C=D.useRef(new Map).current,w=D.useCallback((O,R=Ky)=>{if(C.has(O))return;let z=setTimeout(()=>{C.delete(O),E({type:4,toastId:O})},R);C.set(O,z)},[]);D.useEffect(()=>{if(y)return;let O=Date.now(),R=f.map(z=>{if(z.duration===1/0)return;let P=(z.duration||0)+z.pauseDuration-(O-z.createdAt);if(P<0){z.visible&&vs.dismiss(z.id);return}return setTimeout(()=>vs.dismiss(z.id,m),P)});return()=>{R.forEach(z=>z&&clearTimeout(z))}},[f,y,m]);let E=D.useCallback(Xc(m),[m]),T=D.useCallback(()=>{E({type:5,time:Date.now()})},[E]),N=D.useCallback((O,R)=>{E({type:1,toast:{id:O,height:R}})},[E]),v=D.useCallback(()=>{y&&E({type:6,time:Date.now()})},[y,E]),A=D.useCallback((O,R)=>{let{reverseOrder:z=!1,gutter:P=8,defaultPosition:F}=R||{},Z=f.filter(q=>(q.position||F)===(O.position||F)&&q.height),ne=Z.findIndex(q=>q.id===O.id),Y=Z.filter((q,oe)=>oe<ne&&q.visible).length;return Z.filter(q=>q.visible).slice(...z?[Y+1]:[0,Y]).reduce((q,oe)=>q+(oe.height||0)+P,0)},[f]);return D.useEffect(()=>{f.forEach(O=>{if(O.dismissed)w(O.id,O.removeDelay);else{let R=C.get(O.id);R&&(clearTimeout(R),C.delete(O.id))}})},[f,w]),{toasts:f,handlers:{updateHeight:N,startPause:T,endPause:v,calculateOffset:A}}},Wy=Zn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Qy=Zn`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Jy=Zn`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,$y=Hr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${u=>u.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Wy} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Qy} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${u=>u.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Jy} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,eb=Zn`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,tb=Hr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${u=>u.secondary||"#e0e0e0"};
  border-right-color: ${u=>u.primary||"#616161"};
  animation: ${eb} 1s linear infinite;
`,sb=Zn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,ab=Zn`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,nb=Hr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${u=>u.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${sb} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${ab} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${u=>u.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,rb=Hr("div")`
  position: absolute;
`,ib=Hr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,lb=Zn`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ob=Hr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${lb} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,cb=({toast:u})=>{let{icon:m,type:f,iconTheme:y}=u;return m!==void 0?typeof m=="string"?D.createElement(ob,null,m):m:f==="blank"?null:D.createElement(ib,null,D.createElement(tb,{...y}),f!=="loading"&&D.createElement(rb,null,f==="error"?D.createElement($y,{...y}):D.createElement(nb,{...y})))},db=u=>`
0% {transform: translate3d(0,${u*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,ub=u=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${u*-150}%,-1px) scale(.6); opacity:0;}
`,hb="0%{opacity:0;} 100%{opacity:1;}",fb="0%{opacity:1;} 100%{opacity:0;}",xb=Hr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,mb=Hr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,gb=(u,m)=>{let f=u.includes("top")?1:-1,[y,C]=hm()?[hb,fb]:[db(f),ub(f)];return{animation:m?`${Zn(y)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Zn(C)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},pb=D.memo(({toast:u,position:m,style:f,children:y})=>{let C=u.height?gb(u.position||m||"top-center",u.visible):{opacity:0},w=D.createElement(cb,{toast:u}),E=D.createElement(mb,{...u.ariaProps},Lc(u.message,u));return D.createElement(xb,{className:u.className,style:{...C,...f,...u.style}},typeof y=="function"?y({icon:w,message:E}):D.createElement(D.Fragment,null,w,E))});Uy(D.createElement);var yb=({id:u,className:m,style:f,onHeightUpdate:y,children:C})=>{let w=D.useCallback(E=>{if(E){let T=()=>{let N=E.getBoundingClientRect().height;y(u,N)};T(),new MutationObserver(T).observe(E,{subtree:!0,childList:!0,characterData:!0})}},[u,y]);return D.createElement("div",{ref:w,className:m,style:f},C)},bb=(u,m)=>{let f=u.includes("top"),y=f?{top:0}:{bottom:0},C=u.includes("center")?{justifyContent:"center"}:u.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:hm()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${m*(f?1:-1)}px)`,...y,...C}},wb=Gc`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Oc=16,vb=({reverseOrder:u,position:m="top-center",toastOptions:f,gutter:y,children:C,toasterId:w,containerStyle:E,containerClassName:T})=>{let{toasts:N,handlers:v}=Zy(f,w);return D.createElement("div",{"data-rht-toaster":w||"",style:{position:"fixed",zIndex:9999,top:Oc,left:Oc,right:Oc,bottom:Oc,pointerEvents:"none",...E},className:T,onMouseEnter:v.startPause,onMouseLeave:v.endPause},N.map(A=>{let O=A.position||m,R=v.calculateOffset(A,{reverseOrder:u,gutter:y,defaultPosition:m}),z=bb(O,R);return D.createElement(yb,{id:A.id,key:A.id,onHeightUpdate:v.updateHeight,className:A.visible?wb:"",style:z},A.type==="custom"?Lc(A.message,A):C?C(A):D.createElement(pb,{toast:A,position:O}))}))};const ks=(u,m)=>vs.success(u,m),bt=(u,m)=>vs.error(u,m),ya=(u,m)=>vs.loading(u,m),pa=u=>vs.dismiss(u),Nb=()=>{const[u,m]=D.useState({email:"ceo@lahorelink.com",password:"Password123"}),[f,y]=D.useState(""),[C,w]=D.useState(!1),[E,T]=D.useState({}),[N,v]=D.useState(!1),A=Gs(),{login:O}=Qs(),R=()=>{const F={};return u.email?/\S+@\S+\.\S+/.test(u.email)||(F.email="Email is invalid"):F.email="Email is required",u.password||(F.password="Password is required"),T(F),Object.keys(F).length===0},z=F=>{const{name:Z,value:ne}=F.target;m(Y=>({...Y,[Z]:ne})),E[Z]&&T(Y=>({...Y,[Z]:""}))},P=async F=>{if(F.preventDefault(),!R())return;y(""),w(!0);const Z=ya("Signing in...");try{const ne=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:u.email.trim(),password:u.password})}),Y=await ne.json();if(!ne.ok)throw new Error((Y==null?void 0:Y.message)||`Login failed (HTTP ${ne.status})`);const q=await O({token:Y.token});ks("Signed in successfully");const oe=(q==null?void 0:q.portalActive)===!0,Q=(q==null?void 0:q.role)==="CEO"?"/dashboard/ceo":(q==null?void 0:q.role)==="MANAGER"?"/manager/dashboard":(q==null?void 0:q.role)==="SHIPPER"?oe?"/shipper/dashboard":"/pending-approval":"/rider/dashboard";A(Q)}catch(ne){y(ne.message||"Failed to log in. Please try again."),bt(ne.message||"Login failed")}finally{w(!1),pa(Z)}};return s.jsxs("div",{className:"min-h-screen flex bg-[#F8F9FA]",children:[s.jsxs("div",{className:"hidden lg:flex flex-1 bg-secondary relative overflow-hidden flex-col justify-between p-12 text-white",children:[s.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-primary rounded-full mix-blend-multiply filter blur-3xl opacity-20 -translate-y-1/2 translate-x-1/2"}),s.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-primary rounded-full mix-blend-multiply filter blur-3xl opacity-20 translate-y-1/2 -translate-x-1/2"}),s.jsxs("div",{className:"relative z-10",children:[s.jsx("div",{className:"w-20 h-20 bg-white rounded-lg flex items-center justify-center mb-6 shadow-lg shadow-green-900/50",children:s.jsx("img",{src:"/assets/logo.png",alt:""})}),s.jsx("h1",{className:"text-4xl font-bold mb-4 tracking-tight",children:"LahoreLink Logistics"}),s.jsx("p",{className:"text-gray-400 text-lg max-w-md",children:"Smart logistics dashboard for same-day deliveries. Manage your fleet, shipments, and COD with ease."})]}),s.jsxs("div",{className:"relative z-10 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-3 bg-white/5 rounded-lg backdrop-blur-sm border border-white/10",children:s.jsx(om,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Real-time Tracking"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Monitor orders as they move through the city."})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-3 bg-white/5 rounded-lg backdrop-blur-sm border border-white/10",children:s.jsx(im,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Secure COD Workflows"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Automated reconciliation for cash on delivery."})]})]})]}),s.jsx("div",{className:"text-xs text-gray-500 relative z-10",children:" 2023 LahoreLink Logistics Inc."})]}),s.jsx("div",{className:"flex-1 flex flex-col justify-center items-center p-6 lg:p-12",children:s.jsxs("div",{className:"w-full max-w-md space-y-8",children:[s.jsxs("div",{className:"text-center lg:text-left",children:[s.jsx("div",{className:"lg:hidden flex justify-center",children:s.jsx("div",{className:"w-[200px] h-[200px] flex items-center justify-center ",children:s.jsx("img",{src:"/assets/logo.png",alt:""})})}),s.jsx("h2",{className:"text-3xl font-bold text-secondary",children:"Welcome back"}),s.jsx("p",{className:"mt-2 text-gray-500",children:"Please enter your details to sign in."})]}),s.jsxs("form",{onSubmit:P,className:"mt-8 space-y-6 bg-white p-8 rounded-2xl shadow-sm border border-gray-100",children:[f&&s.jsxs("div",{className:"p-3 rounded-lg bg-red-50 border border-red-100 flex items-center gap-2 text-red-600 text-sm",children:[s.jsx(Ur,{className:"w-4 h-4"}),f]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(st,{label:"Email",name:"email",type:"email",value:u.email,onChange:z,placeholder:"name@company.com",required:!0,error:E.email}),E.email&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:E.email})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Password",name:"password",type:N?"text":"password",value:u.password,onChange:z,placeholder:"",required:!0,error:E.password,rightAdornment:s.jsx("button",{type:"button",onClick:()=>v(F=>!F),className:"text-gray-400 hover:text-secondary transition-colors","aria-label":N?"Hide password":"Show password",children:N?s.jsx(B2,{className:"w-5 h-5"}):s.jsx(P2,{className:"w-5 h-5"})})}),E.password&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:E.password})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[s.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary transition-colors"}),s.jsx("span",{className:"text-gray-500 group-hover:text-gray-700",children:"Remember me"})]}),s.jsx(_c,{to:"/forgot-password",className:"font-medium text-primary hover:text-primary-hover hover:underline",children:"Forgot password?"})]}),s.jsx(as,{type:"submit",fullWidth:!0,disabled:C,className:"h-11 text-base shadow-lg shadow-primary/25 flex items-center justify-center gap-2",children:C?s.jsxs(s.Fragment,{children:[s.jsx(W2,{className:"w-4 h-4 animate-spin"}),"Signing in..."]}):"Sign in to Dashboard"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-gray-200"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Sign up"})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[s.jsx(_c,{to:"/signup/shipper",className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 transition-colors text-center",children:"Sign up as Shipper"}),s.jsx(_c,{to:"/signup/rider",className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 transition-colors text-center",children:"Sign up as Rider"})]})]}),s.jsxs("p",{className:"text-center text-sm text-gray-500",children:["Having trouble logging in? ",s.jsx("a",{href:"#",className:"font-medium text-secondary hover:underline",children:"Contact Administrator"})]})]})})]})},Jt=({icon:u,title:m,count:f,bgColor:y})=>s.jsx("div",{className:`bg-white p-5 rounded-xl border border-gray-100 shadow-sm ${y}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[u&&s.jsx(u,{className:"w-5 h-5 text-gray-500"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:m}),s.jsx("h3",{className:"text-xl font-bold text-secondary",children:f})]})]})}),Xn=({icon:u,title:m,count:f,onClick:y,colorClass:C="text-green-600"})=>s.jsxs("div",{onClick:y,className:`bg-white rounded-xl p-4 shadow-sm border border-gray-100 flex flex-col justify-between h-28 relative overflow-hidden transition-colors ${y?"active:bg-gray-50 cursor-pointer":"cursor-default"}`,children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsx("div",{className:`p-1.5 rounded-full bg-gray-50 ${C}`,children:s.jsx(u,{size:20})}),s.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider text-right max-w-[70%] leading-tight",children:m})]}),s.jsx("div",{className:"mt-auto",children:s.jsx("span",{className:"text-2xl font-bold text-gray-800",children:f})})]}),Cb=({options:u,active:m,onChange:f})=>!u||u.length===0?null:s.jsx("div",{className:"flex justify-center gap-2 mb-4 px-2 overflow-x-auto",children:u.map(y=>s.jsx("button",{onClick:()=>f==null?void 0:f(y.value),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${m===y.value?"bg-black text-white":"bg-white text-gray-500 border border-gray-200"}`,children:y.label},y.value))}),Eb=({options:u,value:m,onChange:f})=>!u||u.length===0?null:s.jsx("div",{className:"bg-[#085233] rounded-lg p-1 flex text-xs font-semibold",children:u.map(y=>s.jsx("button",{onClick:()=>f==null?void 0:f(y.value),className:`px-3 py-1 rounded-md transition-all ${m===y.value?"bg-white text-[#0B6D45] shadow-sm":"text-green-100"}`,children:y.label},y.value))}),Ab=({kpis:u})=>{if(!u||u.length===0)return null;const m=u[0],f=u[1],y=u[2];return s.jsxs("div",{className:"mb-2",children:[(m==null?void 0:m.prefix)&&s.jsxs("p",{className:"text-green-100 text-sm",children:[m.prefix," ",s.jsx(Ur,{className:"inline w-3 h-3 ml-1"})]}),s.jsxs("div",{className:"flex justify-between items-end mt-1",children:[m&&s.jsxs("div",{children:[s.jsx("span",{className:"text-3xl font-bold",children:m.value}),s.jsx("p",{className:"text-xs text-green-100 mt-1",children:m.label})]}),f&&s.jsxs("div",{className:"text-center",children:[s.jsx("span",{className:"text-2xl font-bold",children:f.value}),s.jsx("p",{className:"text-xs text-green-100 mt-1",children:f.label})]}),y&&s.jsxs("div",{className:"text-center",children:[s.jsx("span",{className:"text-2xl font-bold",children:y.value}),s.jsx("p",{className:"text-xs text-green-100 mt-1",children:y.label})]})]})]})},S0=({heroTitle:u,heroCount:m,onRefresh:f,toggles:y,kpis:C,periodOptions:w,activePeriod:E,onPeriodChange:T,statCards:N})=>s.jsxs("div",{className:"space-y-4 md:hidden",children:[s.jsxs("div",{className:"bg-[#0B6D45] p-6 rounded-b-3xl text-white shadow-lg -mx-4 -mt-4 mb-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:u}),typeof m<"u"&&s.jsxs("div",{className:"flex items-center gap-2 mt-1 opacity-80",children:[s.jsx("span",{className:"text-2xl font-bold",children:m}),f&&s.jsx(Fr,{className:"w-4 h-4 cursor-pointer",onClick:f})]})]}),y&&s.jsx(Eb,{options:y.options,value:y.value,onChange:y.onChange})]}),s.jsx(Ab,{kpis:C})]}),s.jsx(Cb,{options:w,active:E,onChange:T}),N&&N.length>0&&s.jsx("div",{className:"grid grid-cols-1 min-[360px]:grid-cols-2 gap-3 px-1",children:N.map(v=>s.jsx(Xn,{icon:v.icon,title:v.title,count:v.value,onClick:v.onClick,colorClass:v.colorClass},v.key||v.title))})]}),jb=()=>typeof window>"u"?!1:window.matchMedia("(max-width: 767px)").matches,T0=()=>{const[u,m]=D.useState(jb);return D.useEffect(()=>{if(typeof window>"u")return;const f=window.matchMedia("(max-width: 767px)"),y=()=>{m(f.matches)};return y(),typeof f.addEventListener=="function"?f.addEventListener("change",y):f.addListener(y),window.addEventListener("orientationchange",y),()=>{typeof f.removeEventListener=="function"?f.removeEventListener("change",y):f.removeListener(y),window.removeEventListener("orientationchange",y)}},[]),u},Sb=()=>{const[u,m]=D.useState([]),[f,y]=D.useState([]),[C,w]=D.useState(!0),[E,T]=D.useState(""),[N,v]=D.useState("today"),[A,O]=D.useState(null),{user:R}=Qs(),z=Gs(),P=T0(),F=(R==null?void 0:R.token)||ea(),Z=async()=>{if(!F){T("Unauthorized access. Token missing."),w(!1);return}w(!0),T("");try{const[Ne,M,L]=await Promise.all([fetch("/api/users",{headers:{Authorization:`Bearer ${F}`}}),fetch("/api/orders",{headers:{Authorization:`Bearer ${F}`}}),fetch(`/api/dashboard/ceo?period=${N}`,{headers:{Authorization:`Bearer ${F}`}})]),U=await Ne.json(),V=await M.json(),fe=await L.json();if(!Ne.ok)throw new Error(U.message||"Failed users");if(!M.ok)throw new Error(V.message||"Failed orders");if(!L.ok)throw new Error(fe.message||"Failed stats");m(U),y(V),O(fe.stats)}catch(Ne){T(Ne.message)}finally{w(!1)}};D.useEffect(()=>{F&&Z()},[F,N]);const ne=D.useMemo(()=>{const Ne=u.length,M=f.length,L=f.filter(V=>V.status==="DELIVERED").reduce((V,fe)=>V+Number(fe.amountCollected||fe.codAmount||0),0),U=u.filter(V=>V.role==="RIDER"&&V.status==="ACTIVE").length;return{totalUsers:Ne,totalOrders:M,totalRevenue:L,activeRiders:U}},[u,f]),Y=()=>{const Ne=[];for(let M=6;M>=0;M--){const L=new Date;L.setDate(L.getDate()-M),Ne.push(L)}return Ne},q=D.useMemo(()=>Y().map(M=>{const L=M.toDateString(),U=f.filter(V=>V.status==="DELIVERED"&&new Date(V.deliveredAt||V.createdAt).toDateString()===L).reduce((V,fe)=>V+Number(fe.amountCollected||fe.codAmount||0),0);return{day:M,value:U}}),[f]),oe=D.useMemo(()=>Y().map(M=>{const L=M.toDateString(),U=f.filter(V=>new Date(V.createdAt).toDateString()===L).length;return{day:M,count:U}}),[f]),Q=D.useMemo(()=>{const U=Math.max(...q.map(he=>he.value),1),V=560/(q.length-1),fe=q.map((he,X)=>{const se=20+X*V,Ee=140-he.value/U*120;return`${se},${Ee}`});return fe.length===0?"":"M "+fe.map(he=>he.replace(","," ")).join(" L ")},[q]),te=Ne=>typeof Ne=="number"||typeof Ne=="string"?Ne:"",K=Ne=>{const M=Number(Ne);return Number.isNaN(M)?"":M.toLocaleString()},Te=[{label:"7 DAYS",value:"7days"},{label:"15 DAYS",value:"15days"},{label:"30 DAYS",value:"30days"}],re=N==="month"?"30days":N,le=N==="7days"?"7 Days Orders":N==="15days"?"15 Days Orders":N==="month"?"30 Days Orders":"Today's Orders",Oe=[{key:"totalOrders",icon:gt,title:"Total Orders",value:(A==null?void 0:A.totalOrders)||0,colorClass:"text-gray-600"},{key:"unassignedOrders",icon:gt,title:"Unassigned",value:(A==null?void 0:A.unassignedOrders)||0,colorClass:"text-amber-600"},{key:"assignedOrders",icon:ds,title:"Assigned",value:(A==null?void 0:A.assignedOrders)||0,colorClass:"text-blue-600"},{key:"warehouseOrdersCount",icon:gt,title:"At Warehouse",value:(A==null?void 0:A.warehouseOrdersCount)||0,colorClass:"text-cyan-600"},{key:"completedOrders",icon:ds,title:"Delivered",value:(A==null?void 0:A.completedOrders)||0,colorClass:"text-green-700"},{key:"pendingOrders",icon:bn,title:"Pending",value:(A==null?void 0:A.pendingOrders)||0,colorClass:"text-orange-600"},{key:"totalServiceCharges",icon:Ut,title:"Service Charges",value:`PKR ${K((A==null?void 0:A.totalServiceCharges)||0)}`,colorClass:"text-emerald-600"},{key:"totalCod",icon:Ut,title:"Total COD",value:`PKR ${K((A==null?void 0:A.totalCod)||0)}`,colorClass:"text-green-600"},{key:"totalShippers",icon:gi,title:"Total Shippers",value:(A==null?void 0:A.totalShippers)||0,colorClass:"text-indigo-600"},{key:"totalRiders",icon:ds,title:"Total Riders",value:(A==null?void 0:A.totalRiders)||0,colorClass:"text-purple-600"}],$=()=>s.jsxs("div",{className:"space-y-8",children:[E&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:E}),s.jsx(S0,{heroTitle:le,heroCount:te(A==null?void 0:A.totalOrders),onRefresh:Z,kpis:[{prefix:"PKR",value:K(A==null?void 0:A.totalServiceCharges),label:"Service Charges"},{value:te((A==null?void 0:A.pendingOrders)||0),label:"Pending Orders"},{value:te((A==null?void 0:A.totalOrders)||0),label:"Total Orders"}],periodOptions:Te,activePeriod:re,onPeriodChange:Ne=>{Ne==="7days"?v("7days"):Ne==="15days"?v("15days"):Ne==="30days"&&v("month")},statCards:Oe})]}),ve=()=>s.jsxs("div",{className:"space-y-8",children:[E&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:E}),s.jsx("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-secondary",children:"Warehouse Operations"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Scan parcels to mark as arrived at LLL warehouse"})]}),s.jsxs("button",{onClick:()=>z("/ceo/scanner"),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-hover flex items-center gap-2",children:[s.jsx(Pr,{className:"w-4 h-4"}),"Scan Parcel"]})]})}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"p-6 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:N==="7days"?"Last 7 Days Stats":N==="15days"?"Last 15 Days Stats":N==="month"?"This Month Stats":"Today's Stats"}),s.jsx("button",{onClick:Z,className:"text-gray-400 hover:text-primary",children:s.jsx(Fr,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[s.jsx("button",{onClick:()=>v("today"),className:`px-3 py-1.5 text-xs rounded-full ${N==="today"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"Today"}),s.jsx("button",{onClick:()=>v("7days"),className:`px-3 py-1.5 text-xs rounded-full ${N==="7days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"7 Days"}),s.jsx("button",{onClick:()=>v("15days"),className:`px-3 py-1.5 text-xs rounded-full ${N==="15days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"15 Days"}),s.jsx("button",{onClick:()=>v("month"),className:`px-3 py-1.5 text-xs rounded-full ${N==="month"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"This Month"})]})]}),s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(Jt,{icon:gt,title:"Total Orders",count:(A==null?void 0:A.totalOrders)||0}),s.jsx(Jt,{icon:ds,title:"Completed Orders",count:(A==null?void 0:A.completedOrders)||0}),s.jsx(Jt,{icon:bn,title:"Pending Orders",count:(A==null?void 0:A.pendingOrders)||0}),s.jsx(Jt,{icon:gi,title:"Assigned Orders",count:(A==null?void 0:A.assignedOrders)||0}),s.jsx(Jt,{icon:gt,title:"Unassigned Orders",count:(A==null?void 0:A.unassignedOrders)||0}),s.jsx(Jt,{icon:Ut,title:"Total COD",count:`PKR ${((A==null?void 0:A.totalCod)||0).toLocaleString()}`}),s.jsx(Jt,{icon:Ut,title:"Total Service Charges",count:`PKR ${((A==null?void 0:A.totalServiceCharges)||0).toLocaleString()}`}),s.jsx(Jt,{icon:gt,title:"At LLL Warehouse",count:(A==null?void 0:A.warehouseOrdersCount)||0})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Total Users"}),s.jsx(gi,{className:"w-5 h-5 text-blue-500"})]}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:C?"":ne.totalUsers})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Total Orders"}),s.jsx(gt,{className:"w-5 h-5 text-primary"})]}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:C?"":ne.totalOrders})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Total Revenue"}),s.jsx(Ut,{className:"w-5 h-5 text-emerald-500"})]}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:C?"":`PKR ${ne.totalRevenue.toLocaleString()}`})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Active Riders"}),s.jsx(ds,{className:"w-5 h-5 text-orange-500"})]}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:C?"":ne.activeRiders})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm lg:col-span-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Revenue Analytics"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Last 7 days"})]}),s.jsx("svg",{viewBox:"0 0 600 160",className:"w-full h-40",children:s.jsx("path",{d:Q,fill:"none",stroke:"#14B8A6",strokeWidth:"2"})})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Orders Volume"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Weekly"})]}),s.jsx("div",{className:"flex items-end gap-2 h-40",children:oe.map((Ne,M)=>{const L=Math.max(...oe.map(fe=>fe.count),1),U=Math.round(Ne.count/L*160),V=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];return s.jsxs("div",{className:"flex flex-col items-center justify-end",children:[s.jsx("div",{style:{height:`${U}px`},className:"w-8 bg-secondary/90 rounded"}),s.jsx("span",{className:"mt-1 text-[10px] text-gray-500",children:V[M]})]},M)})})]})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Recent System Activity"})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500",children:[s.jsx("th",{className:"py-2 px-3",children:"User/Order"}),s.jsx("th",{className:"py-2 px-3",children:"Role/Status"}),s.jsx("th",{className:"py-2 px-3",children:"Action"}),s.jsx("th",{className:"py-2 px-3",children:"Date"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:f.flatMap(Ne=>(Ne.statusHistory||[]).map(M=>({bookingId:Ne.bookingId,status:M.status,time:M.timestamp}))).sort((Ne,M)=>new Date(M.time)-new Date(Ne.time)).slice(0,5).map((Ne,M)=>s.jsxs("tr",{children:[s.jsx("td",{className:"py-2 px-3",children:Ne.bookingId}),s.jsx("td",{className:"py-2 px-3",children:Ne.status}),s.jsx("td",{className:"py-2 px-3",children:"Status updated"}),s.jsx("td",{className:"py-2 px-3",children:new Date(Ne.time).toLocaleString()})]},M))})]})})]})]});return P?s.jsx($,{}):s.jsx(ve,{})},Tb=()=>{const[u,m]=D.useState([]),[f,y]=D.useState(!0),[C,w]=D.useState(""),E=typeof window<"u"?localStorage.getItem("token"):null,[T,N]=D.useState({name:"",email:"",phone:"",password:"",confirmPassword:"",role:"SHIPPER",companyName:"",address:"",cnicNumber:"",contactNumber:"",emergencyContact:"",pickupAddress:"",bankAccountDetails:"",vehicleInfo:""}),[v,A]=D.useState({}),[O,R]=D.useState(!1),[z,P]=D.useState(null),[F,Z]=D.useState({newPassword:"",confirmPassword:""}),[ne,Y]=D.useState({}),[q,oe]=D.useState(null),[Q,te]=D.useState([]),[K,Te]=D.useState([]),re=async()=>{y(!0),w("");try{const[M,L]=await Promise.all([fetch("/api/users/shippers",{headers:{Authorization:E?`Bearer ${E}`:""}}),fetch("/api/users/riders",{headers:{Authorization:E?`Bearer ${E}`:""}})]),U=await M.json(),V=await L.json();if(!M.ok)throw new Error(U.message||"Failed to fetch shippers");if(!L.ok)throw new Error(V.message||"Failed to fetch riders");te(U),Te(V),m([...U,...V])}catch(M){w(M.message)}finally{y(!1)}};D.useEffect(()=>{re()},[]);const le=()=>{const M={};return(!T.password||T.password.length<8)&&(M.password="Password must be at least 8 characters"),T.confirmPassword?T.password!==T.confirmPassword&&(M.confirmPassword="Passwords do not match"):M.confirmPassword="Please confirm your password",A(M),Object.keys(M).length===0},Oe=async M=>{if(M.preventDefault(),w(""),A({}),!!le())try{const L={name:T.name,email:T.email,phone:T.phone,password:T.password,role:T.role};if(T.role==="SHIPPER"&&(Object.assign(L,{companyName:T.companyName,address:T.address,cnicNumber:T.cnicNumber,contactNumber:T.contactNumber,emergencyContact:T.emergencyContact,pickupAddress:T.pickupAddress,bankAccountDetails:T.bankAccountDetails}),!T.companyName))throw new Error("Business Name is required for Shipper");if(T.role==="RIDER"&&(Object.assign(L,{vehicleInfo:T.vehicleInfo}),!T.vehicleInfo))throw new Error("Vehicle Info is required for Rider");const U=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:E?`Bearer ${E}`:""},body:JSON.stringify(L)}),V=await U.json();if(!U.ok)throw new Error(V.message||"Failed to create user");N({name:"",email:"",phone:"",password:"",confirmPassword:"",role:T.role,companyName:"",address:"",cnicNumber:"",contactNumber:"",emergencyContact:"",pickupAddress:"",bankAccountDetails:"",vehicleInfo:""}),A({}),R(!1),await re()}catch(L){w(L.message)}},$=()=>{const M={};return(!F.newPassword||F.newPassword.length<8)&&(M.newPassword="Password must be at least 8 characters"),F.confirmPassword?F.newPassword!==F.confirmPassword&&(M.confirmPassword="Passwords do not match"):M.confirmPassword="Please confirm your password",Y(M),Object.keys(M).length===0},ve=async M=>{if(M.preventDefault(),Y({}),oe(null),!!$())try{const L=await fetch(`/api/users/${z._id}/reset-password`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:E?`Bearer ${E}`:""},body:JSON.stringify({newPassword:F.newPassword})}),U=await L.json();if(!L.ok)throw new Error(U.message||"Failed to reset password");oe({message:"Password updated successfully",password:U.password})}catch(L){Y({submit:L.message})}},Ne=async(M,L)=>{try{const U=await fetch(`/api/users/${M}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:E?`Bearer ${E}`:""},body:JSON.stringify({status:L})}),V=await U.json();if(!U.ok)throw new Error(V.message||"Failed to update status");await re()}catch(U){w(U.message)}};return s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(gi,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Users"})]}),s.jsx(as,{onClick:()=>R(!0),children:"Create User"})]})}),C&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:C}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary mb-4",children:"Shippers"}),f?s.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):Q.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No shippers found."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[s.jsx("th",{className:"py-3 px-4",children:"Shipper Name"}),s.jsx("th",{className:"py-3 px-4",children:"Email"}),s.jsx("th",{className:"py-3 px-4",children:"Total Orders"}),s.jsx("th",{className:"py-3 px-4",children:"Total COD"}),s.jsx("th",{className:"py-3 px-4",children:"Status"}),s.jsx("th",{className:"py-3 px-4",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:Q.map(M=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"py-3 px-4 font-medium",children:M.name}),s.jsx("td",{className:"py-3 px-4",children:M.email}),s.jsx("td",{className:"py-3 px-4",children:""}),s.jsx("td",{className:"py-3 px-4",children:""}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${M.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:M.status})}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:()=>Ne(M._id,M.status==="ACTIVE"?"INACTIVE":"ACTIVE"),children:M.status==="ACTIVE"?"Deactivate":"Activate"})})]},M._id))})]})})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary mb-4",children:"Riders"}),f?s.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):K.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No riders found."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[s.jsx("th",{className:"py-3 px-4",children:"Rider Name"}),s.jsx("th",{className:"py-3 px-4",children:"Email"}),s.jsx("th",{className:"py-3 px-4",children:"Assigned Orders"}),s.jsx("th",{className:"py-3 px-4",children:"COD Collected"}),s.jsx("th",{className:"py-3 px-4",children:"Service Charges"}),s.jsx("th",{className:"py-3 px-4",children:"Status"}),s.jsx("th",{className:"py-3 px-4",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:K.map(M=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"py-3 px-4 font-medium",children:M.name}),s.jsx("td",{className:"py-3 px-4",children:M.email}),s.jsx("td",{className:"py-3 px-4",children:""}),s.jsx("td",{className:"py-3 px-4",children:""}),s.jsx("td",{className:"py-3 px-4",children:""}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${M.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:M.status})}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:()=>Ne(M._id,M.status==="ACTIVE"?"INACTIVE":"ACTIVE"),children:M.status==="ACTIVE"?"Deactivate":"Activate"}),s.jsx("button",{className:"px-2 py-1 text-xs border border-blue-200 text-blue-600 rounded hover:bg-blue-50",onClick:()=>{P(M),Z({newPassword:"",confirmPassword:""}),Y({}),oe(null)},children:"Reset Password"})]})})]},M._id))})]})})]}),z&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>{P(null),Z({newPassword:"",confirmPassword:""}),Y({}),oe(null)},children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",onClick:M=>M.stopPropagation(),children:[s.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Reset Password"}),s.jsx("button",{onClick:()=>{P(null),Z({newPassword:"",confirmPassword:""}),Y({}),oe(null)},className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("form",{onSubmit:ve,className:"p-6 space-y-4",children:[s.jsx("div",{children:s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Reset password for ",s.jsx("span",{className:"font-semibold",children:z.name})," (",z.email,")"]})}),q?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 text-green-700 rounded-lg",children:[s.jsx("p",{className:"font-semibold mb-2",children:q.message}),s.jsxs("div",{className:"mt-3",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"New Password (copy this):"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",readOnly:!0,value:q.password,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg bg-gray-50 font-mono"}),s.jsx("button",{type:"button",onClick:()=>{navigator.clipboard.writeText(q.password),alert("Password copied to clipboard!")},className:"px-3 py-2 text-sm bg-primary text-white rounded-lg hover:bg-primary-hover",children:"Copy"})]})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{type:"button",onClick:()=>{P(null),Z({newPassword:"",confirmPassword:""}),Y({}),oe(null)},className:"px-4 py-2 text-sm bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Close"})})]}):s.jsxs(s.Fragment,{children:[ne.submit&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 text-red-600 text-sm rounded",children:ne.submit}),s.jsxs("div",{children:[s.jsx(st,{label:"New Password",type:"password",value:F.newPassword,onChange:M=>Z({...F,newPassword:M.target.value}),required:!0}),ne.newPassword&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:ne.newPassword})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Confirm Password",type:"password",value:F.confirmPassword,onChange:M=>Z({...F,confirmPassword:M.target.value}),required:!0}),ne.confirmPassword&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:ne.confirmPassword})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{type:"button",className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>{P(null),Z({newPassword:"",confirmPassword:""}),Y({}),oe(null)},children:"Cancel"}),s.jsx(as,{type:"submit",children:"Reset Password"})]})]})]})]})}),O&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>R(!1),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden",onClick:M=>M.stopPropagation(),children:[s.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Create User"}),s.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("form",{onSubmit:M=>{Oe(M)},className:"p-6 space-y-3 max-h-[70vh] overflow-y-auto",children:[C&&s.jsx("p",{className:"text-sm text-red-600",children:C}),s.jsx(st,{label:"Name",value:T.name,onChange:M=>N({...T,name:M.target.value}),required:!0}),s.jsx(st,{label:"Email",type:"email",value:T.email,onChange:M=>N({...T,email:M.target.value}),required:!0}),s.jsx(st,{label:"Phone",value:T.phone,onChange:M=>N({...T,phone:M.target.value})}),s.jsxs("div",{children:[s.jsx(st,{label:"Password",type:"password",value:T.password,onChange:M=>N({...T,password:M.target.value}),required:!0}),v.password&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:v.password})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Confirm Password",type:"password",value:T.confirmPassword,onChange:M=>N({...T,confirmPassword:M.target.value}),required:!0}),v.confirmPassword&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:v.confirmPassword})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Role"}),s.jsxs("select",{className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white",value:T.role,onChange:M=>N({...T,role:M.target.value}),children:[s.jsx("option",{value:"SHIPPER",children:"Shipper"}),s.jsx("option",{value:"RIDER",children:"Rider"}),s.jsx("option",{value:"MANAGER",children:"Manager"})]})]}),T.role==="SHIPPER"&&s.jsxs("div",{className:"space-y-3",children:[s.jsx(st,{label:"Business Name",value:T.companyName,onChange:M=>N({...T,companyName:M.target.value}),required:!0}),s.jsx(st,{label:"CNIC Number",value:T.cnicNumber,onChange:M=>N({...T,cnicNumber:M.target.value})}),s.jsx(st,{label:"Contact Number",value:T.contactNumber,onChange:M=>N({...T,contactNumber:M.target.value})}),s.jsx(st,{label:"Emergency Contact",value:T.emergencyContact,onChange:M=>N({...T,emergencyContact:M.target.value})}),s.jsx(st,{label:"Pickup Address",value:T.pickupAddress,onChange:M=>N({...T,pickupAddress:M.target.value})}),s.jsx(st,{label:"Bank Account Details",value:T.bankAccountDetails,onChange:M=>N({...T,bankAccountDetails:M.target.value})}),s.jsx(st,{label:"Business Address",value:T.address,onChange:M=>N({...T,address:M.target.value})})]}),T.role==="RIDER"&&s.jsx(st,{label:"Vehicle Info",value:T.vehicleInfo,onChange:M=>N({...T,vehicleInfo:M.target.value}),required:!0}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{type:"button",className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>R(!1),children:"Cancel"}),s.jsx(as,{type:"submit",children:"Create"})]})]})]})})]})},Rb=()=>{var ve,Ne;const[u,m]=D.useState([]),[f,y]=D.useState([]),[C,w]=D.useState(null),[E,T]=D.useState(!0),[N,v]=D.useState(""),A=typeof window<"u"?localStorage.getItem("token"):null,[O,R]=D.useState(""),[z,P]=D.useState([]),[F,Z]=D.useState(null),[ne,Y]=D.useState(null),[q,oe]=D.useState("date"),[Q,te]=D.useState("desc"),[K,Te]=D.useState("all"),re=async()=>{T(!0),v("");try{const M=new URLSearchParams;if(M.set("sortBy",q==="date"?"date":q),M.set("order",Q),K!=="all"){const V=new Date;let fe=new Date(V),he=new Date(V);if(K==="today")fe.setHours(0,0,0,0),he.setHours(23,59,59,999);else if(K==="week"){const X=V.getDay(),se=X===0?-6:1-X;fe=new Date(V),fe.setDate(V.getDate()+se),fe.setHours(0,0,0,0),he=new Date(fe),he.setDate(fe.getDate()+6),he.setHours(23,59,59,999)}else K==="month"&&(fe=new Date(V.getFullYear(),V.getMonth(),1,0,0,0,0),he=new Date(V.getFullYear(),V.getMonth()+1,0,23,59,59,999));M.set("from",fe.toISOString()),M.set("to",he.toISOString())}const L=await fetch(`/api/orders?${M.toString()}`,{headers:{Authorization:A?`Bearer ${A}`:""}}),U=await L.json();if(!L.ok)throw new Error(U.message||"Failed to fetch orders");m(U)}catch(M){v(M.message)}finally{T(!1)}};D.useEffect(()=>{re()},[]),D.useEffect(()=>{re()},[q,Q,K]);const le=async()=>{try{const M=await fetch("/api/users/riders",{headers:{Authorization:A?`Bearer ${A}`:""}}),L=await M.json();if(!M.ok)throw new Error(L.message||"Failed to fetch riders");y(L)}catch{}};D.useEffect(()=>{le()},[]),D.useEffect(()=>{const M=O.trim().toLowerCase();if(M.length<2){P([]);return}P(u.filter(L=>{var U,V,fe,he;return((U=L.bookingId)==null?void 0:U.toLowerCase().includes(M))||((V=L.trackingId)==null?void 0:V.toLowerCase().includes(M))||((fe=L.consigneeName)==null?void 0:fe.toLowerCase().includes(M))||((he=L.destinationCity)==null?void 0:he.toLowerCase().includes(M))}).slice(0,8))},[O,u]);const Oe=async M=>{if(M&&M.preventDefault(),Z(null),!!O.trim())try{const L=new URLSearchParams;if(L.set("q",O.trim()),L.set("sortBy",q==="date"?"date":q),L.set("order",Q),K!=="all"){const fe=new Date;let he=new Date(fe),X=new Date(fe);if(K==="today")he.setHours(0,0,0,0),X.setHours(23,59,59,999);else if(K==="week"){const se=fe.getDay(),Ee=se===0?-6:1-se;he=new Date(fe),he.setDate(fe.getDate()+Ee),he.setHours(0,0,0,0),X=new Date(he),X.setDate(he.getDate()+6),X.setHours(23,59,59,999)}else K==="month"&&(he=new Date(fe.getFullYear(),fe.getMonth(),1,0,0,0,0),X=new Date(fe.getFullYear(),fe.getMonth()+1,0,23,59,59,999));L.set("from",he.toISOString()),L.set("to",X.toISOString())}const U=await fetch(`/api/orders?${L.toString()}`,{headers:{Authorization:A?`Bearer ${A}`:""}}),V=await U.json();U.ok&&Array.isArray(V)&&V.length>0?Z(V[0]):Z({notFound:!0})}catch{}},$=async(M,L)=>{try{const U=await fetch(`/api/orders/${M}/assign`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:A?`Bearer ${A}`:""},body:JSON.stringify({riderId:L||null})}),V=await U.json();if(!U.ok)throw new Error(V.message||"Failed to assign rider");w(null),await re()}catch(U){v(U.message)}};return D.useEffect(()=>{(async()=>{if(!F||F.notFound){Y(null);return}try{const L=await fetch(`/api/finance/transactions/order/${F._id}`,{headers:{Authorization:A?`Bearer ${A}`:""}}),U=await L.json();L.ok?Y(U):Y(null)}catch{Y(null)}})()},[F]),s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between max-width max-[515px]:flex-col max-[515px]:items-start max-[515px]:gap-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(gt,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"All Orders"})]}),s.jsxs("form",{onSubmit:Oe,className:"flex items-center gap-2 relative",children:[s.jsx("input",{value:O,onChange:M=>R(M.target.value),type:"text",placeholder:"Enter Booking/Tracking ID",className:"pl-3 pr-4 py-1.5 text-sm border border-gray-200 rounded-lg"}),s.jsxs("select",{value:`${q}:${Q}`,onChange:M=>{const[L,U]=M.target.value.split(":");oe(L),te(U)},className:"pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white",children:[s.jsx("option",{value:"date:desc",children:"Sort by Date  Newest First"}),s.jsx("option",{value:"date:asc",children:"Sort by Date  Oldest First"}),s.jsx("option",{value:"cod:desc",children:"Sort by COD  High to Low"}),s.jsx("option",{value:"cod:asc",children:"Sort by COD  Low to High"}),s.jsx("option",{value:"service:desc",children:"Sort by Service  High to Low"}),s.jsx("option",{value:"service:asc",children:"Sort by Service  Low to High"}),s.jsx("option",{value:"weight:desc",children:"Sort by Weight  Heavy to Light"}),s.jsx("option",{value:"weight:asc",children:"Sort by Weight  Light to Heavy"}),s.jsx("option",{value:"status:asc",children:"Sort by Status"})]}),s.jsxs("select",{value:K,onChange:M=>Te(M.target.value),className:"pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white","aria-label":"Filter by Date Range",children:[s.jsx("option",{value:"all",children:"All Orders"}),s.jsx("option",{value:"today",children:"Today"}),s.jsx("option",{value:"week",children:"This Week"}),s.jsx("option",{value:"month",children:"This Month"})]}),z.length>0&&s.jsx("ul",{className:"absolute left-0 top-full mt-1 w-80 bg-white border border-gray-200 rounded-lg shadow z-10",children:z.map(M=>s.jsxs("li",{className:"px-3 py-2 text-sm hover:bg-gray-50 cursor-pointer",onMouseDown:()=>Z(M),children:[s.jsx("span",{className:"font-mono text-xs mr-2",children:M.bookingId}),s.jsx("span",{children:M.consigneeName}),s.jsxs("span",{className:"text-xs text-gray-500",children:["  ",M.destinationCity]})]},M._id))}),s.jsx("button",{className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Search"})]})]})}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[N&&s.jsx("p",{className:"text-sm text-red-600",children:N}),E?s.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"hidden md:block overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left",children:"Order / CN"}),s.jsx("th",{className:"px-4 py-2 text-left",children:"Shipper"}),s.jsx("th",{className:"px-4 py-2 text-left",children:"Consignee"}),s.jsx("th",{className:"px-4 py-2 text-left",children:"Phone"}),s.jsx("th",{className:"px-4 py-2 text-left",children:"Destination"}),s.jsx("th",{className:"px-4 py-2 text-right",children:"Weight (kg)"}),s.jsx("th",{className:"px-4 py-2 text-right",children:"COD"}),s.jsx("th",{className:"px-4 py-2 text-right",children:"Service Charges"}),s.jsx("th",{className:"px-4 py-2 text-left",children:"Status"}),s.jsx("th",{className:"px-4 py-2 text-left",children:"Order Date"}),s.jsx("th",{className:"px-4 py-2 text-left",children:"Assigned Rider"}),s.jsx("th",{className:"px-4 py-2 text-left",children:"Actions"})]})}),s.jsx("tbody",{children:u.map(M=>{var L,U,V;return s.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"font-mono text-xs",children:M.bookingId}),M.trackingId&&s.jsx("span",{className:"font-mono text-[11px] text-gray-500",children:M.trackingId})]})}),s.jsx("td",{className:"px-4 py-3",children:((L=M.shipper)==null?void 0:L.companyName)||((U=M.shipper)==null?void 0:U.name)||"Unknown"}),s.jsx("td",{className:"px-4 py-3",children:M.consigneeName}),s.jsx("td",{className:"px-4 py-3",children:M.consigneePhone}),s.jsx("td",{className:"px-4 py-3",children:M.destinationCity}),s.jsx("td",{className:"px-4 py-3 text-right",children:Number(M.weightKg||0).toFixed(2)}),s.jsxs("td",{className:"px-4 py-3 text-right",children:["Rs ",Number(M.codAmount||0).toLocaleString()]}),s.jsxs("td",{className:"px-4 py-3 text-right",children:["Rs ",Number(M.serviceCharges||0).toLocaleString()]}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded text-xs font-medium ${rx(M.status)}`,children:nx(M.status)})}),s.jsx("td",{className:"px-4 py-3",children:ix(M.createdAt)}),s.jsx("td",{className:"px-4 py-3",children:((V=M.assignedRider)==null?void 0:V.name)||"Not Assigned"}),s.jsx("td",{className:"px-4 py-3",children:(M.status==="CREATED"||M.assignedRider)&&s.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:()=>w(M),children:M.assignedRider?"Change Assignment":"Assign"})})]},M._id)})})]})}),s.jsx("div",{className:"md:hidden space-y-3",children:u.map(M=>{var L,U,V;return s.jsxs("div",{className:"border border-gray-100 rounded-lg p-4 bg-white",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-mono text-xs",children:M.bookingId}),M.trackingId&&s.jsx("div",{className:"font-mono text-[11px] text-gray-500",children:M.trackingId})]}),s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded text-xs font-medium ${rx(M.status)}`,children:nx(M.status)})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 text-xs",children:[s.jsx("div",{className:"text-gray-500",children:"Shipper"}),s.jsx("div",{className:"text-gray-900",children:((L=M.shipper)==null?void 0:L.companyName)||((U=M.shipper)==null?void 0:U.name)||"Unknown"}),s.jsx("div",{className:"text-gray-500",children:"Consignee"}),s.jsx("div",{className:"text-gray-900",children:M.consigneeName}),s.jsx("div",{className:"text-gray-500",children:"Phone"}),s.jsx("div",{className:"text-gray-900",children:M.consigneePhone}),s.jsx("div",{className:"text-gray-500",children:"Destination"}),s.jsx("div",{className:"text-gray-900",children:M.destinationCity}),s.jsx("div",{className:"text-gray-500",children:"Weight"}),s.jsxs("div",{className:"text-gray-900",children:[Number(M.weightKg||0).toFixed(2)," kg"]}),s.jsx("div",{className:"text-gray-500",children:"COD"}),s.jsxs("div",{className:"text-gray-900",children:["Rs ",Number(M.codAmount||0).toLocaleString()]}),s.jsx("div",{className:"text-gray-500",children:"Service"}),s.jsxs("div",{className:"text-gray-900",children:["Rs ",Number(M.serviceCharges||0).toLocaleString()]}),s.jsx("div",{className:"text-gray-500",children:"Date"}),s.jsx("div",{className:"text-gray-900",children:ix(M.createdAt)}),s.jsx("div",{className:"text-gray-500",children:"Rider"}),s.jsx("div",{className:"text-gray-900",children:((V=M.assignedRider)==null?void 0:V.name)||"Not Assigned"})]}),(M.status==="CREATED"||M.assignedRider)&&s.jsx("div",{className:"mt-3",children:s.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:()=>w(M),children:M.assignedRider?"Change Assignment":"Assign"})})]},M._id)})})]}),F&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>Z(null),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden",onClick:M=>M.stopPropagation(),children:[s.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Order Detail"}),s.jsx("button",{onClick:()=>Z(null),className:"text-gray-400 hover:text-gray-600",children:""})]}),s.jsx("div",{className:"p-6 space-y-2 text-sm",children:F.notFound?s.jsx("p",{className:"text-red-600",children:"No order found"}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Business:"})," ",((ve=F.shipper)==null?void 0:ve.companyName)||((Ne=F.shipper)==null?void 0:Ne.name)]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Booking ID:"})," ",s.jsx("span",{className:"font-mono",children:F.bookingId})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Tracking ID:"})," ",s.jsx("span",{className:"font-mono",children:F.trackingId})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Consignee:"})," ",F.consigneeName,"  ",F.destinationCity]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"COD:"})," Rs ",Number(((ne==null?void 0:ne.totalCodCollected)??F.codAmount)||0).toLocaleString()]}),ne&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Rider Commission:"})," Rs ",Number(ne.riderCommission||0).toLocaleString()]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Net Amount:"})," Rs ",Number((ne.totalCodCollected||0)-(ne.riderCommission||0)).toLocaleString()]})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Status: ",F.status]})]})}),s.jsx("div",{className:"p-4 flex justify-end gap-2 border-t border-gray-100",children:s.jsx("button",{className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>Z(null),children:"Close"})})]})})]}),C&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Assign Rider"}),s.jsx("button",{onClick:()=>w(null),className:"text-gray-400 hover:text-gray-600",children:s.jsx(yn,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-2 max-h-80 overflow-y-auto",children:[s.jsxs("button",{onClick:()=>$(C._id,null),className:"w-full flex items-center gap-3 p-3 rounded-lg border border-red-200 hover:border-red-300 hover:bg-red-50 text-left mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-red-100 flex items-center justify-center text-red-600",children:s.jsx(yn,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-red-700",children:"Unassign"}),s.jsx("div",{className:"text-xs text-red-500",children:"Remove rider assignment"})]})]}),f.length===0&&s.jsx("p",{className:"text-sm text-gray-500",children:"No riders found."}),f.map(M=>s.jsxs("button",{onClick:()=>$(C._id,M._id),className:"w-full flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-primary hover:bg-primary/5 text-left",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600",children:s.jsx(ds,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-secondary",children:M.name}),s.jsx("div",{className:"text-xs text-gray-500",children:M.email})]})]},M._id))]})]})})]})},nx=u=>({CREATED:"Booked",ASSIGNED:"Assigned",AT_LLL_WAREHOUSE:"In Warehouse",OUT_FOR_DELIVERY:"Out for Delivery",DELIVERED:"Delivered",RETURNED:"Returned",FAILED:"Failed",FIRST_ATTEMPT:"Attempted (1st)",SECOND_ATTEMPT:"Attempted (2nd)",THIRD_ATTEMPT:"Attempted (3rd)"})[u]||u,rx=u=>{switch(u){case"DELIVERED":return"bg-green-100 text-green-700 border border-green-200";case"OUT_FOR_DELIVERY":return"bg-blue-100 text-blue-700 border border-blue-200";case"AT_LLL_WAREHOUSE":case"ASSIGNED":return"bg-indigo-100 text-indigo-700 border border-indigo-200";case"RETURNED":return"bg-orange-100 text-orange-700 border border-orange-200";case"FAILED":return"bg-red-100 text-red-700 border border-red-200";default:return"bg-yellow-100 text-yellow-700 border border-yellow-200"}},ix=u=>{if(!u)return"";try{return new Date(u).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return""}},Ob=()=>{const[u,m]=D.useState([]),[f,y]=D.useState([]),[C,w]=D.useState(!0),[E,T]=D.useState(""),N=typeof window<"u"?localStorage.getItem("token"):null,v=async()=>{w(!0),T("");try{const[P,F]=await Promise.all([fetch("/api/users/riders",{headers:{Authorization:N?`Bearer ${N}`:""}}),fetch("/api/orders",{headers:{Authorization:N?`Bearer ${N}`:""}})]),Z=await P.json(),ne=await F.json();if(!P.ok)throw new Error(Z.message||"Failed riders");if(!F.ok)throw new Error(ne.message||"Failed orders");m(Z),y(ne)}catch(P){T(P.message)}finally{w(!1)}};D.useEffect(()=>{v()},[]);const A=new Date().toDateString(),O=f.filter(P=>new Date(P.createdAt).toDateString()===A),R=f.filter(P=>P.status==="DELIVERED"&&new Date(P.deliveredAt||P.createdAt).toDateString()===A),z=u.filter(P=>P.status==="ACTIVE");return s.jsxs("div",{className:"space-y-8",children:[E&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:E}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Active Riders"}),s.jsx(ds,{className:"w-5 h-5 text-primary"})]}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:C?"":z.length})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Orders Today"}),s.jsx(gt,{className:"w-5 h-5 text-primary"})]}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:C?"":O.length})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Delivered Today"}),s.jsx(gt,{className:"w-5 h-5 text-emerald-500"})]}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:C?"":R.length})]})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Rider Load"}),s.jsx("button",{onClick:v,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500",children:[s.jsx("th",{className:"py-2 px-3",children:"Rider"}),s.jsx("th",{className:"py-2 px-3",children:"Assigned"}),s.jsx("th",{className:"py-2 px-3",children:"OFD"}),s.jsx("th",{className:"py-2 px-3",children:"Delivered"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:u.map(P=>{const F=f.filter(Y=>Y.assignedRider&&(Y.assignedRider._id===P._id||Y.assignedRider===P._id)),Z=F.filter(Y=>Y.status==="OUT_FOR_DELIVERY"),ne=F.filter(Y=>Y.status==="DELIVERED");return s.jsxs("tr",{children:[s.jsx("td",{className:"py-2 px-3",children:P.name}),s.jsx("td",{className:"py-2 px-3",children:F.length}),s.jsx("td",{className:"py-2 px-3",children:Z.length}),s.jsx("td",{className:"py-2 px-3",children:ne.length})]},P._id)})})]})})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Rider Orders & Status"}),s.jsx("button",{onClick:v,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500",children:[s.jsx("th",{className:"py-2 px-3",children:"Rider"}),s.jsx("th",{className:"py-2 px-3",children:"Booking"}),s.jsx("th",{className:"py-2 px-3",children:"Status"}),s.jsx("th",{className:"py-2 px-3",children:"City"}),s.jsx("th",{className:"py-2 px-3",children:"COD/Collected"}),s.jsx("th",{className:"py-2 px-3",children:"Updated"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:f.filter(P=>!!P.assignedRider&&["OUT_FOR_DELIVERY","DELIVERED","RETURNED","FAILED","ASSIGNED"].includes(P.status)).map(P=>{var F,Z;return s.jsxs("tr",{children:[s.jsx("td",{className:"py-2 px-3",children:typeof P.assignedRider=="object"?(F=P.assignedRider)==null?void 0:F.name:((Z=u.find(ne=>ne._id===P.assignedRider))==null?void 0:Z.name)||""}),s.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:P.bookingId}),s.jsx("td",{className:"py-2 px-3",children:P.status}),s.jsx("td",{className:"py-2 px-3",children:P.destinationCity}),s.jsx("td",{className:"py-2 px-3",children:P.status==="DELIVERED"?`Rs ${Number(P.amountCollected||P.codAmount||0).toLocaleString()}`:`Rs ${Number(P.codAmount||0).toLocaleString()}`}),s.jsx("td",{className:"py-2 px-3 text-xs text-gray-500",children:new Date(P.updatedAt||P.createdAt).toLocaleString()})]},P._id)})})]})})]})]})},Db=()=>{const[u,m]=D.useState(!0),[f,y]=D.useState(!1),[C,w]=D.useState(!1),[E,T]=D.useState(""),[N,v]=D.useState(""),[A,O]=D.useState(""),{user:R}=Qs(),z=(R==null?void 0:R.token)||ea(),[P,F]=D.useState({companyName:"",logoUrl:"",address:{line1:"",city:"",country:""},phone:"",alternatePhone:"",email:"",website:"",ntn:"",strn:"",footerNote:""}),Z=async()=>{if(!z){T("Unauthorized access. Please login."),m(!1);return}try{m(!0),T("");const Q=await fetch("/api/company-profile",{method:"GET",headers:{Authorization:`Bearer ${z}`,"Content-Type":"application/json"}}),te=await Q.json();if(!Q.ok)throw new Error(te.message||"Failed to load company profile");te.success&&te.data&&(F(te.data),O(te.data.logoUrl||""))}catch(Q){console.error("Error loading profile:",Q),T(Q.message)}finally{m(!1)}},ne=async()=>{if(!z){T("Unauthorized access. Please login.");return}if(!P.companyName.trim()){T("Company name is required");return}if(!P.address.line1.trim()||!P.address.city.trim()||!P.address.country.trim()){T("Complete address is required");return}if(!P.phone.trim()){T("Phone number is required");return}if(!P.email.trim()){T("Email is required");return}try{y(!0),T(""),v("");const Q=await fetch("/api/company-profile",{method:"PUT",headers:{Authorization:`Bearer ${z}`,"Content-Type":"application/json"},body:JSON.stringify(P)}),te=await Q.json();if(!Q.ok)throw new Error(te.message||"Failed to save company profile");te.success&&(v("Company profile saved successfully!"),F(te.data),setTimeout(()=>v(""),5e3))}catch(Q){console.error("Error saving profile:",Q),T(Q.message)}finally{y(!1)}},Y=async Q=>{if(!Q)return;if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(Q.type)){T("Please upload a valid image file (PNG, JPG, JPEG, or WEBP)");return}if(Q.size>5*1024*1024){T("File size must be less than 5MB");return}const K=URL.createObjectURL(Q);O(K);try{w(!0),T("");const Te=new FormData;Te.append("logo",Q);const re=await fetch("/api/company-profile/logo",{method:"POST",headers:{Authorization:`Bearer ${z}`},body:Te}),le=await re.json();if(!re.ok)throw URL.revokeObjectURL(K),new Error(le.message||"Failed to upload logo");if(le.success){const Oe=le.data.logoUrl;F($=>({...$,logoUrl:Oe})),O(Oe),v("Logo uploaded successfully!"),setTimeout(()=>v(""),3e3)}}catch(Te){console.error("Error uploading logo:",Te),T(Te.message)}finally{w(!1)}},q=Q=>{const te=Q.target.files[0];te&&Y(te)},oe=(Q,te)=>{if(Q.includes(".")){const[K,Te]=Q.split(".");F(re=>({...re,[K]:{...re[K],[Te]:te}}))}else F(K=>({...K,[Q]:te}))};return D.useEffect(()=>{Z()},[]),u?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(nl,{className:"w-6 h-6 animate-spin text-green-600"}),s.jsx("span",{className:"text-gray-600",children:"Loading company profile..."})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx(rl,{className:"w-8 h-8 text-green-600"}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Company Profile"})]}),s.jsx("p",{className:"text-gray-600",children:"Manage your company information that appears across the platform and on invoices."})]}),E&&s.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-2",children:[s.jsx(Ur,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),s.jsx("span",{className:"text-red-700",children:E})]}),N&&s.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4 flex items-start space-x-2",children:[s.jsx(qn,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),s.jsx("span",{className:"text-green-700",children:N})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 p-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Company Logo"}),s.jsx("div",{className:"mb-4",children:A?s.jsxs("div",{className:"relative inline-block",children:[s.jsx("img",{src:A,alt:"Company Logo",className:"w-32 h-32 object-contain border-2 border-gray-200 rounded-lg bg-gray-50",onError:Q=>{Q.currentTarget.src="/assets/logo.png"}}),s.jsx("button",{onClick:()=>{O(""),F(Q=>({...Q,logoUrl:""}))},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:s.jsx(cm,{className:"w-4 h-4"})})]}):s.jsx("div",{className:"w-32 h-32 bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center mx-auto",children:s.jsx(so,{className:"w-8 h-8 text-gray-400"})})}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"file",id:"logo-upload",className:"hidden",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:q,disabled:C}),s.jsx("label",{htmlFor:"logo-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:C?s.jsxs(s.Fragment,{children:[s.jsx(nl,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Sy,{className:"w-4 h-4 mr-2"}),"Upload Logo"]})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Max 5MB. Supports JPEG, PNG, GIF, WebP"})]})}),s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(rl,{className:"w-5 h-5 mr-2 text-green-600"}),"Basic Information"]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"sm:col-span-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Company Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:P.companyName,onChange:Q=>oe("companyName",Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"LahoreLink Courier Services"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Email ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Bc,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"email",value:P.email,onChange:Q=>oe("email",Q.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"finance@lahorelink.com"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),s.jsxs("div",{className:"relative",children:[s.jsx(sm,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"url",value:P.website,onChange:Q=>oe("website",Q.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"www.lahorelink.com"})]})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(Kn,{className:"w-5 h-5 mr-2 text-green-600"}),"Address Information"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Address Line 1 ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:P.address.line1,onChange:Q=>oe("address.line1",Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Office # 123, Main Boulevard, Gulberg III"})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["City ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:P.address.city,onChange:Q=>oe("address.city",Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Lahore"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Country ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:P.address.country,onChange:Q=>oe("address.country",Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Pakistan"})]})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(Lr,{className:"w-5 h-5 mr-2 text-green-600"}),"Contact Information"]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Primary Phone ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Lr,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"tel",value:P.phone,onChange:Q=>oe("phone",Q.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"+92-42-111-LINK (5465)"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alternate Phone"}),s.jsxs("div",{className:"relative",children:[s.jsx(Lr,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"tel",value:P.alternatePhone,onChange:Q=>oe("alternatePhone",Q.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"+92-42-XXX-XXXX"})]})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Information"}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"NTN (Optional)"}),s.jsx("input",{type:"text",value:P.ntn,onChange:Q=>oe("ntn",Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Enter NTN"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"STRN (Optional)"}),s.jsx("input",{type:"text",value:P.strn,onChange:Q=>oe("strn",Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Enter STRN"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Footer Note"}),s.jsx("textarea",{value:P.footerNote,onChange:Q=>oe("footerNote",Q.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"For support contact: +92-42-111-LINK (5465) | Email: support@lahorelink.com"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This text will appear at the bottom of invoices and other documents"})]})]})]})]}),s.jsx("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50 rounded-b-lg",children:s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:ne,disabled:f,className:"inline-flex items-center px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?s.jsxs(s.Fragment,{children:[s.jsx(nl,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(E0,{className:"w-4 h-4 mr-2"}),"Save Profile"]})})})})]})]})})};var He;(function(u){u[u.QR_CODE=0]="QR_CODE",u[u.AZTEC=1]="AZTEC",u[u.CODABAR=2]="CODABAR",u[u.CODE_39=3]="CODE_39",u[u.CODE_93=4]="CODE_93",u[u.CODE_128=5]="CODE_128",u[u.DATA_MATRIX=6]="DATA_MATRIX",u[u.MAXICODE=7]="MAXICODE",u[u.ITF=8]="ITF",u[u.EAN_13=9]="EAN_13",u[u.EAN_8=10]="EAN_8",u[u.PDF_417=11]="PDF_417",u[u.RSS_14=12]="RSS_14",u[u.RSS_EXPANDED=13]="RSS_EXPANDED",u[u.UPC_A=14]="UPC_A",u[u.UPC_E=15]="UPC_E",u[u.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(He||(He={}));var lx=new Map([[He.QR_CODE,"QR_CODE"],[He.AZTEC,"AZTEC"],[He.CODABAR,"CODABAR"],[He.CODE_39,"CODE_39"],[He.CODE_93,"CODE_93"],[He.CODE_128,"CODE_128"],[He.DATA_MATRIX,"DATA_MATRIX"],[He.MAXICODE,"MAXICODE"],[He.ITF,"ITF"],[He.EAN_13,"EAN_13"],[He.EAN_8,"EAN_8"],[He.PDF_417,"PDF_417"],[He.RSS_14,"RSS_14"],[He.RSS_EXPANDED,"RSS_EXPANDED"],[He.UPC_A,"UPC_A"],[He.UPC_E,"UPC_E"],[He.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),ox;(function(u){u[u.UNKNOWN=0]="UNKNOWN",u[u.URL=1]="URL"})(ox||(ox={}));function _b(u){return Object.values(He).includes(u)}var Pc;(function(u){u[u.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",u[u.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Pc||(Pc={}));var Ib=(function(){function u(){}return u.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",u.SCAN_DEFAULT_FPS=2,u.DEFAULT_DISABLE_FLIP=!1,u.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,u.DEFAULT_SUPPORTED_SCAN_TYPE=[Pc.SCAN_TYPE_CAMERA,Pc.SCAN_TYPE_FILE],u})(),pm=(function(){function u(m,f){this.format=m,this.formatName=f}return u.prototype.toString=function(){return this.formatName},u.create=function(m){if(!lx.has(m))throw"".concat(m," not in html5QrcodeSupportedFormatsTextMap");return new u(m,lx.get(m))},u})(),cx=(function(){function u(){}return u.createFromText=function(m){var f={text:m};return{decodedText:m,result:f}},u.createFromQrcodeResult=function(m){return{decodedText:m.text,result:m}},u})(),p0;(function(u){u[u.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",u[u.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",u[u.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(p0||(p0={}));var Mb=(function(){function u(){}return u.createFrom=function(m){return{errorMessage:m,type:p0.UNKWOWN_ERROR}},u})(),kb=(function(){function u(m){this.verbose=m}return u.prototype.log=function(m){this.verbose&&console.log(m)},u.prototype.warn=function(m){this.verbose&&console.warn(m)},u.prototype.logError=function(m,f){(this.verbose||f===!0)&&console.error(m)},u.prototype.logErrors=function(m){if(m.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(m)},u})();function Yn(u){return typeof u>"u"||u===null}var sl=(function(){function u(){}return u.codeParseError=function(m){return"QR code parse error, error = ".concat(m)},u.errorGettingUserMedia=function(m){return"Error getting userMedia, error = ".concat(m)},u.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},u.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},u.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},u.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},u.scannerPaused=function(){return"Scanner paused"},u})(),ym=(function(){function u(){}return u.isMediaStreamConstraintsValid=function(m,f){if(typeof m!="object"){var y=typeof m;return f.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(y,"."),!0),!1}for(var C=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],w=new Set(C),E=Object.keys(m),T=0,N=E;T<N.length;T++){var v=N[T];if(w.has(v))return f.logError("".concat(v," is not supported videoConstaints."),!0),!1}return!0},u})(),ao={exports:{}},Bb=ao.exports,dx;function Lb(){return dx||(dx=1,(function(u,m){(function(f,y){y(m)})(Bb,(function(f){function y(_){return _==null}var C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,t){_.__proto__=t}||function(_,t){for(var n in t)t.hasOwnProperty(n)&&(_[n]=t[n])};function w(_,t){C(_,t);function n(){this.constructor=_}_.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function E(_,t){var n=Object.setPrototypeOf;n?n(_,t):_.__proto__=t}function T(_,t){t===void 0&&(t=_.constructor);var n=Error.captureStackTrace;n&&n(_,t)}var N=(function(_){w(t,_);function t(n){var r=this.constructor,l=_.call(this,n)||this;return Object.defineProperty(l,"name",{value:r.name,enumerable:!1}),E(l,r.prototype),T(l),l}return t})(Error);class v extends N{constructor(t=void 0){super(t),this.message=t}getKind(){return this.constructor.kind}}v.kind="Exception";class A extends v{}A.kind="ArgumentException";class O extends v{}O.kind="IllegalArgumentException";class R{constructor(t){if(this.binarizer=t,t===null)throw new O("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(t,n){return this.binarizer.getBlackRow(t,n)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(t,n,r,l){const o=this.binarizer.getLuminanceSource().crop(t,n,r,l);return new R(this.binarizer.createBinarizer(o))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const t=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new R(this.binarizer.createBinarizer(t))}rotateCounterClockwise45(){const t=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new R(this.binarizer.createBinarizer(t))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class z extends v{static getChecksumInstance(){return new z}}z.kind="ChecksumException";class P{constructor(t){this.source=t}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class F{static arraycopy(t,n,r,l,o){for(;o--;)r[l++]=t[n++]}static currentTimeMillis(){return Date.now()}}class Z extends v{}Z.kind="IndexOutOfBoundsException";class ne extends Z{constructor(t=void 0,n=void 0){super(n),this.index=t,this.message=n}}ne.kind="ArrayIndexOutOfBoundsException";class Y{static fill(t,n){for(let r=0,l=t.length;r<l;r++)t[r]=n}static fillWithin(t,n,r,l){Y.rangeCheck(t.length,n,r);for(let o=n;o<r;o++)t[o]=l}static rangeCheck(t,n,r){if(n>r)throw new O("fromIndex("+n+") > toIndex("+r+")");if(n<0)throw new ne(n);if(r>t)throw new ne(r)}static asList(...t){return t}static create(t,n,r){return Array.from({length:t}).map(o=>Array.from({length:n}).fill(r))}static createInt32Array(t,n,r){return Array.from({length:t}).map(o=>Int32Array.from({length:n}).fill(r))}static equals(t,n){if(!t||!n||!t.length||!n.length||t.length!==n.length)return!1;for(let r=0,l=t.length;r<l;r++)if(t[r]!==n[r])return!1;return!0}static hashCode(t){if(t===null)return 0;let n=1;for(const r of t)n=31*n+r;return n}static fillUint8Array(t,n){for(let r=0;r!==t.length;r++)t[r]=n}static copyOf(t,n){return t.slice(0,n)}static copyOfUint8Array(t,n){if(t.length<=n){const r=new Uint8Array(n);return r.set(t),r}return t.slice(0,n)}static copyOfRange(t,n,r){const l=r-n,o=new Int32Array(l);return F.arraycopy(t,n,o,0,l),o}static binarySearch(t,n,r){r===void 0&&(r=Y.numberComparator);let l=0,o=t.length-1;for(;l<=o;){const d=o+l>>1,h=r(n,t[d]);if(h>0)l=d+1;else if(h<0)o=d-1;else return d}return-l-1}static numberComparator(t,n){return t-n}}class q{static numberOfTrailingZeros(t){let n;if(t===0)return 32;let r=31;return n=t<<16,n!==0&&(r-=16,t=n),n=t<<8,n!==0&&(r-=8,t=n),n=t<<4,n!==0&&(r-=4,t=n),n=t<<2,n!==0&&(r-=2,t=n),r-(t<<1>>>31)}static numberOfLeadingZeros(t){if(t===0)return 32;let n=1;return t>>>16||(n+=16,t<<=16),t>>>24||(n+=8,t<<=8),t>>>28||(n+=4,t<<=4),t>>>30||(n+=2,t<<=2),n-=t>>>31,n}static toHexString(t){return t.toString(16)}static toBinaryString(t){return String(parseInt(String(t),2))}static bitCount(t){return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),t=t+(t>>>4)&252645135,t=t+(t>>>8),t=t+(t>>>16),t&63}static truncDivision(t,n){return Math.trunc(t/n)}static parseInt(t,n=void 0){return parseInt(t,n)}}q.MIN_VALUE_32_BITS=-2147483648,q.MAX_VALUE=Number.MAX_SAFE_INTEGER;class oe{constructor(t,n){t===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=t,n==null?this.bits=oe.makeArray(t):this.bits=n)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(t){if(t>this.bits.length*32){const n=oe.makeArray(t);F.arraycopy(this.bits,0,n,0,this.bits.length),this.bits=n}}get(t){return(this.bits[Math.floor(t/32)]&1<<(t&31))!==0}set(t){this.bits[Math.floor(t/32)]|=1<<(t&31)}flip(t){this.bits[Math.floor(t/32)]^=1<<(t&31)}getNextSet(t){const n=this.size;if(t>=n)return n;const r=this.bits;let l=Math.floor(t/32),o=r[l];o&=~((1<<(t&31))-1);const d=r.length;for(;o===0;){if(++l===d)return n;o=r[l]}const h=l*32+q.numberOfTrailingZeros(o);return h>n?n:h}getNextUnset(t){const n=this.size;if(t>=n)return n;const r=this.bits;let l=Math.floor(t/32),o=~r[l];o&=~((1<<(t&31))-1);const d=r.length;for(;o===0;){if(++l===d)return n;o=~r[l]}const h=l*32+q.numberOfTrailingZeros(o);return h>n?n:h}setBulk(t,n){this.bits[Math.floor(t/32)]=n}setRange(t,n){if(n<t||t<0||n>this.size)throw new O;if(n===t)return;n--;const r=Math.floor(t/32),l=Math.floor(n/32),o=this.bits;for(let d=r;d<=l;d++){const h=d>r?0:t&31,b=(2<<(d<l?31:n&31))-(1<<h);o[d]|=b}}clear(){const t=this.bits.length,n=this.bits;for(let r=0;r<t;r++)n[r]=0}isRange(t,n,r){if(n<t||t<0||n>this.size)throw new O;if(n===t)return!0;n--;const l=Math.floor(t/32),o=Math.floor(n/32),d=this.bits;for(let h=l;h<=o;h++){const g=h>l?0:t&31,j=(2<<(h<o?31:n&31))-(1<<g)&4294967295;if((d[h]&j)!==(r?j:0))return!1}return!0}appendBit(t){this.ensureCapacity(this.size+1),t&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(t,n){if(n<0||n>32)throw new O("Num bits must be between 0 and 32");this.ensureCapacity(this.size+n);for(let r=n;r>0;r--)this.appendBit((t>>r-1&1)===1)}appendBitArray(t){const n=t.size;this.ensureCapacity(this.size+n);for(let r=0;r<n;r++)this.appendBit(t.get(r))}xor(t){if(this.size!==t.size)throw new O("Sizes don't match");const n=this.bits;for(let r=0,l=n.length;r<l;r++)n[r]^=t.bits[r]}toBytes(t,n,r,l){for(let o=0;o<l;o++){let d=0;for(let h=0;h<8;h++)this.get(t)&&(d|=1<<7-h),t++;n[r+o]=d}}getBitArray(){return this.bits}reverse(){const t=new Int32Array(this.bits.length),n=Math.floor((this.size-1)/32),r=n+1,l=this.bits;for(let o=0;o<r;o++){let d=l[o];d=d>>1&1431655765|(d&1431655765)<<1,d=d>>2&858993459|(d&858993459)<<2,d=d>>4&252645135|(d&252645135)<<4,d=d>>8&16711935|(d&16711935)<<8,d=d>>16&65535|(d&65535)<<16,t[n-o]=d}if(this.size!==r*32){const o=r*32-this.size;let d=t[0]>>>o;for(let h=1;h<r;h++){const g=t[h];d|=g<<32-o,t[h-1]=d,d=g>>>o}t[r-1]=d}this.bits=t}static makeArray(t){return new Int32Array(Math.floor((t+31)/32))}equals(t){if(!(t instanceof oe))return!1;const n=t;return this.size===n.size&&Y.equals(this.bits,n.bits)}hashCode(){return 31*this.size+Y.hashCode(this.bits)}toString(){let t="";for(let n=0,r=this.size;n<r;n++)(n&7)===0&&(t+=" "),t+=this.get(n)?"X":".";return t}clone(){return new oe(this.size,this.bits.slice())}}var Q;(function(_){_[_.OTHER=0]="OTHER",_[_.PURE_BARCODE=1]="PURE_BARCODE",_[_.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",_[_.TRY_HARDER=3]="TRY_HARDER",_[_.CHARACTER_SET=4]="CHARACTER_SET",_[_.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",_[_.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",_[_.ASSUME_GS1=7]="ASSUME_GS1",_[_.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",_[_.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",_[_.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(Q||(Q={}));var te=Q;class K extends v{static getFormatInstance(){return new K}}K.kind="FormatException";var Te;(function(_){_[_.Cp437=0]="Cp437",_[_.ISO8859_1=1]="ISO8859_1",_[_.ISO8859_2=2]="ISO8859_2",_[_.ISO8859_3=3]="ISO8859_3",_[_.ISO8859_4=4]="ISO8859_4",_[_.ISO8859_5=5]="ISO8859_5",_[_.ISO8859_6=6]="ISO8859_6",_[_.ISO8859_7=7]="ISO8859_7",_[_.ISO8859_8=8]="ISO8859_8",_[_.ISO8859_9=9]="ISO8859_9",_[_.ISO8859_10=10]="ISO8859_10",_[_.ISO8859_11=11]="ISO8859_11",_[_.ISO8859_13=12]="ISO8859_13",_[_.ISO8859_14=13]="ISO8859_14",_[_.ISO8859_15=14]="ISO8859_15",_[_.ISO8859_16=15]="ISO8859_16",_[_.SJIS=16]="SJIS",_[_.Cp1250=17]="Cp1250",_[_.Cp1251=18]="Cp1251",_[_.Cp1252=19]="Cp1252",_[_.Cp1256=20]="Cp1256",_[_.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",_[_.UTF8=22]="UTF8",_[_.ASCII=23]="ASCII",_[_.Big5=24]="Big5",_[_.GB18030=25]="GB18030",_[_.EUC_KR=26]="EUC_KR"})(Te||(Te={}));class re{constructor(t,n,r,...l){this.valueIdentifier=t,this.name=r,typeof n=="number"?this.values=Int32Array.from([n]):this.values=n,this.otherEncodingNames=l,re.VALUE_IDENTIFIER_TO_ECI.set(t,this),re.NAME_TO_ECI.set(r,this);const o=this.values;for(let d=0,h=o.length;d!==h;d++){const g=o[d];re.VALUES_TO_ECI.set(g,this)}for(const d of l)re.NAME_TO_ECI.set(d,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(t){if(t<0||t>=900)throw new K("incorect value");const n=re.VALUES_TO_ECI.get(t);if(n===void 0)throw new K("incorect value");return n}static getCharacterSetECIByName(t){const n=re.NAME_TO_ECI.get(t);if(n===void 0)throw new K("incorect value");return n}equals(t){if(!(t instanceof re))return!1;const n=t;return this.getName()===n.getName()}}re.VALUE_IDENTIFIER_TO_ECI=new Map,re.VALUES_TO_ECI=new Map,re.NAME_TO_ECI=new Map,re.Cp437=new re(Te.Cp437,Int32Array.from([0,2]),"Cp437"),re.ISO8859_1=new re(Te.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),re.ISO8859_2=new re(Te.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),re.ISO8859_3=new re(Te.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),re.ISO8859_4=new re(Te.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),re.ISO8859_5=new re(Te.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),re.ISO8859_6=new re(Te.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),re.ISO8859_7=new re(Te.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),re.ISO8859_8=new re(Te.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),re.ISO8859_9=new re(Te.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),re.ISO8859_10=new re(Te.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),re.ISO8859_11=new re(Te.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),re.ISO8859_13=new re(Te.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),re.ISO8859_14=new re(Te.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),re.ISO8859_15=new re(Te.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),re.ISO8859_16=new re(Te.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),re.SJIS=new re(Te.SJIS,20,"SJIS","Shift_JIS"),re.Cp1250=new re(Te.Cp1250,21,"Cp1250","windows-1250"),re.Cp1251=new re(Te.Cp1251,22,"Cp1251","windows-1251"),re.Cp1252=new re(Te.Cp1252,23,"Cp1252","windows-1252"),re.Cp1256=new re(Te.Cp1256,24,"Cp1256","windows-1256"),re.UnicodeBigUnmarked=new re(Te.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),re.UTF8=new re(Te.UTF8,26,"UTF8","UTF-8"),re.ASCII=new re(Te.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),re.Big5=new re(Te.Big5,28,"Big5"),re.GB18030=new re(Te.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),re.EUC_KR=new re(Te.EUC_KR,30,"EUC_KR","EUC-KR");class le extends v{}le.kind="UnsupportedOperationException";class Oe{static decode(t,n){const r=this.encodingName(n);return this.customDecoder?this.customDecoder(t,r):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(r)?this.decodeFallback(t,r):new TextDecoder(r).decode(t)}static shouldDecodeOnFallback(t){return!Oe.isBrowser()&&t==="ISO-8859-1"}static encode(t,n){const r=this.encodingName(n);return this.customEncoder?this.customEncoder(t,r):typeof TextEncoder>"u"?this.encodeFallback(t):new TextEncoder().encode(t)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(t){return typeof t=="string"?t:t.getName()}static encodingCharacterSet(t){return t instanceof re?t:re.getCharacterSetECIByName(t)}static decodeFallback(t,n){const r=this.encodingCharacterSet(n);if(Oe.isDecodeFallbackSupported(r)){let l="";for(let o=0,d=t.length;o<d;o++){let h=t[o].toString(16);h.length<2&&(h="0"+h),l+="%"+h}return decodeURIComponent(l)}if(r.equals(re.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(t.buffer));throw new le(`Encoding ${this.encodingName(n)} not supported by fallback.`)}static isDecodeFallbackSupported(t){return t.equals(re.UTF8)||t.equals(re.ISO8859_1)||t.equals(re.ASCII)}static encodeFallback(t){const r=btoa(unescape(encodeURIComponent(t))).split(""),l=[];for(let o=0;o<r.length;o++)l.push(r[o].charCodeAt(0));return new Uint8Array(l)}}class ${static castAsNonUtf8Char(t,n=null){const r=n?n.getName():this.ISO88591;return Oe.decode(new Uint8Array([t]),r)}static guessEncoding(t,n){if(n!=null&&n.get(te.CHARACTER_SET)!==void 0)return n.get(te.CHARACTER_SET).toString();const r=t.length;let l=!0,o=!0,d=!0,h=0,g=0,b=0,j=0,I=0,k=0,G=0,J=0,ee=0,ue=0,be=0;const Be=t.length>3&&t[0]===239&&t[1]===187&&t[2]===191;for(let Me=0;Me<r&&(l||o||d);Me++){const Ie=t[Me]&255;d&&(h>0?(Ie&128)===0?d=!1:h--:(Ie&128)!==0&&((Ie&64)===0?d=!1:(h++,(Ie&32)===0?g++:(h++,(Ie&16)===0?b++:(h++,(Ie&8)===0?j++:d=!1))))),l&&(Ie>127&&Ie<160?l=!1:Ie>159&&(Ie<192||Ie===215||Ie===247)&&be++),o&&(I>0?Ie<64||Ie===127||Ie>252?o=!1:I--:Ie===128||Ie===160||Ie>239?o=!1:Ie>160&&Ie<224?(k++,J=0,G++,G>ee&&(ee=G)):Ie>127?(I++,G=0,J++,J>ue&&(ue=J)):(G=0,J=0))}return d&&h>0&&(d=!1),o&&I>0&&(o=!1),d&&(Be||g+b+j>0)?$.UTF8:o&&($.ASSUME_SHIFT_JIS||ee>=3||ue>=3)?$.SHIFT_JIS:l&&o?ee===2&&k===2||be*10>=r?$.SHIFT_JIS:$.ISO88591:l?$.ISO88591:o?$.SHIFT_JIS:d?$.UTF8:$.PLATFORM_DEFAULT_ENCODING}static format(t,...n){let r=-1;function l(d,h,g,b,j,I){if(d==="%%")return"%";if(n[++r]===void 0)return;d=b?parseInt(b.substr(1)):void 0;let k=j?parseInt(j.substr(1)):void 0,G;switch(I){case"s":G=n[r];break;case"c":G=n[r][0];break;case"f":G=parseFloat(n[r]).toFixed(d);break;case"p":G=parseFloat(n[r]).toPrecision(d);break;case"e":G=parseFloat(n[r]).toExponential(d);break;case"x":G=parseInt(n[r]).toString(k||16);break;case"d":G=parseFloat(parseInt(n[r],k||10).toPrecision(d)).toFixed(0);break}G=typeof G=="object"?JSON.stringify(G):(+G).toString(k);let J=parseInt(g),ee=g&&g[0]+""=="0"?"0":" ";for(;G.length<J;)G=h!==void 0?G+ee:ee+G;return G}let o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(o,l)}static getBytes(t,n){return Oe.encode(t,n)}static getCharCode(t,n=0){return t.charCodeAt(n)}static getCharAt(t){return String.fromCharCode(t)}}$.SHIFT_JIS=re.SJIS.getName(),$.GB2312="GB2312",$.ISO88591=re.ISO8859_1.getName(),$.EUC_JP="EUC_JP",$.UTF8=re.UTF8.getName(),$.PLATFORM_DEFAULT_ENCODING=$.UTF8,$.ASSUME_SHIFT_JIS=!1;class ve{constructor(t=""){this.value=t}enableDecoding(t){return this.encoding=t,this}append(t){return typeof t=="string"?this.value+=t.toString():this.encoding?this.value+=$.castAsNonUtf8Char(t,this.encoding):this.value+=String.fromCharCode(t),this}appendChars(t,n,r){for(let l=n;n<n+r;l++)this.append(t[l]);return this}length(){return this.value.length}charAt(t){return this.value.charAt(t)}deleteCharAt(t){this.value=this.value.substr(0,t)+this.value.substring(t+1)}setCharAt(t,n){this.value=this.value.substr(0,t)+n+this.value.substr(t+1)}substring(t,n){return this.value.substring(t,n)}setLengthToZero(){this.value=""}toString(){return this.value}insert(t,n){this.value=this.value.substr(0,t)+n+this.value.substr(t+n.length)}}class Ne{constructor(t,n,r,l){if(this.width=t,this.height=n,this.rowSize=r,this.bits=l,n==null&&(n=t),this.height=n,t<1||n<1)throw new O("Both dimensions must be greater than 0");r==null&&(r=Math.floor((t+31)/32)),this.rowSize=r,l==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(t){const n=t.length,r=t[0].length,l=new Ne(r,n);for(let o=0;o<n;o++){const d=t[o];for(let h=0;h<r;h++)d[h]&&l.set(h,o)}return l}static parseFromString(t,n,r){if(t===null)throw new O("stringRepresentation cannot be null");const l=new Array(t.length);let o=0,d=0,h=-1,g=0,b=0;for(;b<t.length;)if(t.charAt(b)===`
`||t.charAt(b)==="\r"){if(o>d){if(h===-1)h=o-d;else if(o-d!==h)throw new O("row lengths do not match");d=o,g++}b++}else if(t.substring(b,b+n.length)===n)b+=n.length,l[o]=!0,o++;else if(t.substring(b,b+r.length)===r)b+=r.length,l[o]=!1,o++;else throw new O("illegal character encountered: "+t.substring(b));if(o>d){if(h===-1)h=o-d;else if(o-d!==h)throw new O("row lengths do not match");g++}const j=new Ne(h,g);for(let I=0;I<o;I++)l[I]&&j.set(Math.floor(I%h),Math.floor(I/h));return j}get(t,n){const r=n*this.rowSize+Math.floor(t/32);return(this.bits[r]>>>(t&31)&1)!==0}set(t,n){const r=n*this.rowSize+Math.floor(t/32);this.bits[r]|=1<<(t&31)&4294967295}unset(t,n){const r=n*this.rowSize+Math.floor(t/32);this.bits[r]&=~(1<<(t&31)&4294967295)}flip(t,n){const r=n*this.rowSize+Math.floor(t/32);this.bits[r]^=1<<(t&31)&4294967295}xor(t){if(this.width!==t.getWidth()||this.height!==t.getHeight()||this.rowSize!==t.getRowSize())throw new O("input matrix dimensions do not match");const n=new oe(Math.floor(this.width/32)+1),r=this.rowSize,l=this.bits;for(let o=0,d=this.height;o<d;o++){const h=o*r,g=t.getRow(o,n).getBitArray();for(let b=0;b<r;b++)l[h+b]^=g[b]}}clear(){const t=this.bits,n=t.length;for(let r=0;r<n;r++)t[r]=0}setRegion(t,n,r,l){if(n<0||t<0)throw new O("Left and top must be nonnegative");if(l<1||r<1)throw new O("Height and width must be at least 1");const o=t+r,d=n+l;if(d>this.height||o>this.width)throw new O("The region must fit inside the matrix");const h=this.rowSize,g=this.bits;for(let b=n;b<d;b++){const j=b*h;for(let I=t;I<o;I++)g[j+Math.floor(I/32)]|=1<<(I&31)&4294967295}}getRow(t,n){n==null||n.getSize()<this.width?n=new oe(this.width):n.clear();const r=this.rowSize,l=this.bits,o=t*r;for(let d=0;d<r;d++)n.setBulk(d*32,l[o+d]);return n}setRow(t,n){F.arraycopy(n.getBitArray(),0,this.bits,t*this.rowSize,this.rowSize)}rotate180(){const t=this.getWidth(),n=this.getHeight();let r=new oe(t),l=new oe(t);for(let o=0,d=Math.floor((n+1)/2);o<d;o++)r=this.getRow(o,r),l=this.getRow(n-1-o,l),r.reverse(),l.reverse(),this.setRow(o,l),this.setRow(n-1-o,r)}getEnclosingRectangle(){const t=this.width,n=this.height,r=this.rowSize,l=this.bits;let o=t,d=n,h=-1,g=-1;for(let b=0;b<n;b++)for(let j=0;j<r;j++){const I=l[b*r+j];if(I!==0){if(b<d&&(d=b),b>g&&(g=b),j*32<o){let k=0;for(;(I<<31-k&4294967295)===0;)k++;j*32+k<o&&(o=j*32+k)}if(j*32+31>h){let k=31;for(;!(I>>>k);)k--;j*32+k>h&&(h=j*32+k)}}}return h<o||g<d?null:Int32Array.from([o,d,h-o+1,g-d+1])}getTopLeftOnBit(){const t=this.rowSize,n=this.bits;let r=0;for(;r<n.length&&n[r]===0;)r++;if(r===n.length)return null;const l=r/t;let o=r%t*32;const d=n[r];let h=0;for(;(d<<31-h&4294967295)===0;)h++;return o+=h,Int32Array.from([o,l])}getBottomRightOnBit(){const t=this.rowSize,n=this.bits;let r=n.length-1;for(;r>=0&&n[r]===0;)r--;if(r<0)return null;const l=Math.floor(r/t);let o=Math.floor(r%t)*32;const d=n[r];let h=31;for(;!(d>>>h);)h--;return o+=h,Int32Array.from([o,l])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(t){if(!(t instanceof Ne))return!1;const n=t;return this.width===n.width&&this.height===n.height&&this.rowSize===n.rowSize&&Y.equals(this.bits,n.bits)}hashCode(){let t=this.width;return t=31*t+this.width,t=31*t+this.height,t=31*t+this.rowSize,t=31*t+Y.hashCode(this.bits),t}toString(t="X ",n="  ",r=`
`){return this.buildToString(t,n,r)}buildToString(t,n,r){let l=new ve;for(let o=0,d=this.height;o<d;o++){for(let h=0,g=this.width;h<g;h++)l.append(this.get(h,o)?t:n);l.append(r)}return l.toString()}clone(){return new Ne(this.width,this.height,this.rowSize,this.bits.slice())}}class M extends v{static getNotFoundInstance(){return new M}}M.kind="NotFoundException";class L extends P{constructor(t){super(t),this.luminances=L.EMPTY,this.buckets=new Int32Array(L.LUMINANCE_BUCKETS)}getBlackRow(t,n){const r=this.getLuminanceSource(),l=r.getWidth();n==null||n.getSize()<l?n=new oe(l):n.clear(),this.initArrays(l);const o=r.getRow(t,this.luminances),d=this.buckets;for(let g=0;g<l;g++)d[(o[g]&255)>>L.LUMINANCE_SHIFT]++;const h=L.estimateBlackPoint(d);if(l<3)for(let g=0;g<l;g++)(o[g]&255)<h&&n.set(g);else{let g=o[0]&255,b=o[1]&255;for(let j=1;j<l-1;j++){const I=o[j+1]&255;(b*4-g-I)/2<h&&n.set(j),g=b,b=I}}return n}getBlackMatrix(){const t=this.getLuminanceSource(),n=t.getWidth(),r=t.getHeight(),l=new Ne(n,r);this.initArrays(n);const o=this.buckets;for(let g=1;g<5;g++){const b=Math.floor(r*g/5),j=t.getRow(b,this.luminances),I=Math.floor(n*4/5);for(let k=Math.floor(n/5);k<I;k++){const G=j[k]&255;o[G>>L.LUMINANCE_SHIFT]++}}const d=L.estimateBlackPoint(o),h=t.getMatrix();for(let g=0;g<r;g++){const b=g*n;for(let j=0;j<n;j++)(h[b+j]&255)<d&&l.set(j,g)}return l}createBinarizer(t){return new L(t)}initArrays(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));const n=this.buckets;for(let r=0;r<L.LUMINANCE_BUCKETS;r++)n[r]=0}static estimateBlackPoint(t){const n=t.length;let r=0,l=0,o=0;for(let j=0;j<n;j++)t[j]>o&&(l=j,o=t[j]),t[j]>r&&(r=t[j]);let d=0,h=0;for(let j=0;j<n;j++){const I=j-l,k=t[j]*I*I;k>h&&(d=j,h=k)}if(l>d){const j=l;l=d,d=j}if(d-l<=n/16)throw new M;let g=d-1,b=-1;for(let j=d-1;j>l;j--){const I=j-l,k=I*I*(d-j)*(r-t[j]);k>b&&(g=j,b=k)}return g<<L.LUMINANCE_SHIFT}}L.LUMINANCE_BITS=5,L.LUMINANCE_SHIFT=8-L.LUMINANCE_BITS,L.LUMINANCE_BUCKETS=1<<L.LUMINANCE_BITS,L.EMPTY=Uint8ClampedArray.from([0]);class U extends L{constructor(t){super(t),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const t=this.getLuminanceSource(),n=t.getWidth(),r=t.getHeight();if(n>=U.MINIMUM_DIMENSION&&r>=U.MINIMUM_DIMENSION){const l=t.getMatrix();let o=n>>U.BLOCK_SIZE_POWER;(n&U.BLOCK_SIZE_MASK)!==0&&o++;let d=r>>U.BLOCK_SIZE_POWER;(r&U.BLOCK_SIZE_MASK)!==0&&d++;const h=U.calculateBlackPoints(l,o,d,n,r),g=new Ne(n,r);U.calculateThresholdForBlock(l,o,d,n,r,h,g),this.matrix=g}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(t){return new U(t)}static calculateThresholdForBlock(t,n,r,l,o,d,h){const g=o-U.BLOCK_SIZE,b=l-U.BLOCK_SIZE;for(let j=0;j<r;j++){let I=j<<U.BLOCK_SIZE_POWER;I>g&&(I=g);const k=U.cap(j,2,r-3);for(let G=0;G<n;G++){let J=G<<U.BLOCK_SIZE_POWER;J>b&&(J=b);const ee=U.cap(G,2,n-3);let ue=0;for(let Be=-2;Be<=2;Be++){const Me=d[k+Be];ue+=Me[ee-2]+Me[ee-1]+Me[ee]+Me[ee+1]+Me[ee+2]}const be=ue/25;U.thresholdBlock(t,J,I,be,l,h)}}}static cap(t,n,r){return t<n?n:t>r?r:t}static thresholdBlock(t,n,r,l,o,d){for(let h=0,g=r*o+n;h<U.BLOCK_SIZE;h++,g+=o)for(let b=0;b<U.BLOCK_SIZE;b++)(t[g+b]&255)<=l&&d.set(n+b,r+h)}static calculateBlackPoints(t,n,r,l,o){const d=o-U.BLOCK_SIZE,h=l-U.BLOCK_SIZE,g=new Array(r);for(let b=0;b<r;b++){g[b]=new Int32Array(n);let j=b<<U.BLOCK_SIZE_POWER;j>d&&(j=d);for(let I=0;I<n;I++){let k=I<<U.BLOCK_SIZE_POWER;k>h&&(k=h);let G=0,J=255,ee=0;for(let be=0,Be=j*l+k;be<U.BLOCK_SIZE;be++,Be+=l){for(let Me=0;Me<U.BLOCK_SIZE;Me++){const Ie=t[Be+Me]&255;G+=Ie,Ie<J&&(J=Ie),Ie>ee&&(ee=Ie)}if(ee-J>U.MIN_DYNAMIC_RANGE)for(be++,Be+=l;be<U.BLOCK_SIZE;be++,Be+=l)for(let Me=0;Me<U.BLOCK_SIZE;Me++)G+=t[Be+Me]&255}let ue=G>>U.BLOCK_SIZE_POWER*2;if(ee-J<=U.MIN_DYNAMIC_RANGE&&(ue=J/2,b>0&&I>0)){const be=(g[b-1][I]+2*g[b][I-1]+g[b-1][I-1])/4;J<be&&(ue=be)}g[b][I]=ue}}return g}}U.BLOCK_SIZE_POWER=3,U.BLOCK_SIZE=1<<U.BLOCK_SIZE_POWER,U.BLOCK_SIZE_MASK=U.BLOCK_SIZE-1,U.MINIMUM_DIMENSION=U.BLOCK_SIZE*5,U.MIN_DYNAMIC_RANGE=24;class V{constructor(t,n){this.width=t,this.height=n}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(t,n,r,l){throw new le("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new le("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new le("This luminance source does not support rotation by 45 degrees.")}toString(){const t=new Uint8ClampedArray(this.width);let n=new ve;for(let r=0;r<this.height;r++){const l=this.getRow(r,t);for(let o=0;o<this.width;o++){const d=l[o]&255;let h;d<64?h="#":d<128?h="+":d<192?h=".":h=" ",n.append(h)}n.append(`
`)}return n.toString()}}class fe extends V{constructor(t){super(t.getWidth(),t.getHeight()),this.delegate=t}getRow(t,n){const r=this.delegate.getRow(t,n),l=this.getWidth();for(let o=0;o<l;o++)r[o]=255-(r[o]&255);return r}getMatrix(){const t=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),r=new Uint8ClampedArray(n);for(let l=0;l<n;l++)r[l]=255-(t[l]&255);return r}isCropSupported(){return this.delegate.isCropSupported()}crop(t,n,r,l){return new fe(this.delegate.crop(t,n,r,l))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new fe(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new fe(this.delegate.rotateCounterClockwise45())}}class he extends V{constructor(t){super(t.width,t.height),this.canvas=t,this.tempCanvasElement=null,this.buffer=he.makeBufferFromCanvasImageData(t)}static makeBufferFromCanvasImageData(t){const n=t.getContext("2d").getImageData(0,0,t.width,t.height);return he.toGrayscaleBuffer(n.data,t.width,t.height)}static toGrayscaleBuffer(t,n,r){const l=new Uint8ClampedArray(n*r);for(let o=0,d=0,h=t.length;o<h;o+=4,d++){let g;if(t[o+3]===0)g=255;else{const j=t[o],I=t[o+1],k=t[o+2];g=306*j+601*I+117*k+512>>10}l[d]=g}return l}getRow(t,n){if(t<0||t>=this.getHeight())throw new O("Requested row is outside the image: "+t);const r=this.getWidth(),l=t*r;return n===null?n=this.buffer.slice(l,l+r):(n.length<r&&(n=new Uint8ClampedArray(r)),n.set(this.buffer.slice(l,l+r))),n}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(t,n,r,l){return super.crop(t,n,r,l),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const t=this.canvas.ownerDocument.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t}return this.tempCanvasElement}rotate(t){const n=this.getTempCanvasElement(),r=n.getContext("2d"),l=t*he.DEGREE_TO_RADIANS,o=this.canvas.width,d=this.canvas.height,h=Math.ceil(Math.abs(Math.cos(l))*o+Math.abs(Math.sin(l))*d),g=Math.ceil(Math.abs(Math.sin(l))*o+Math.abs(Math.cos(l))*d);return n.width=h,n.height=g,r.translate(h/2,g/2),r.rotate(l),r.drawImage(this.canvas,o/-2,d/-2),this.buffer=he.makeBufferFromCanvasImageData(n),this}invert(){return new fe(this)}}he.DEGREE_TO_RADIANS=Math.PI/180;class X{constructor(t,n,r){this.deviceId=t,this.label=n,this.kind="videoinput",this.groupId=r||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var se=(globalThis||Sc||self||window||void 0)&&(globalThis||Sc||self||window||void 0).__awaiter||function(_,t,n,r){function l(o){return o instanceof n?o:new n(function(d){d(o)})}return new(n||(n=Promise))(function(o,d){function h(j){try{b(r.next(j))}catch(I){d(I)}}function g(j){try{b(r.throw(j))}catch(I){d(I)}}function b(j){j.done?o(j.value):l(j.value).then(h,g)}b((r=r.apply(_,t||[])).next())})};class Ee{constructor(t,n=500,r){this.reader=t,this.timeBetweenScansMillis=n,this._hints=r,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(t){this._timeBetweenDecodingAttempts=t<0?0:t}set hints(t){this._hints=t||null}get hints(){return this._hints}listVideoInputDevices(){return se(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const t=yield navigator.mediaDevices.enumerateDevices(),n=[];for(const r of t){const l=r.kind==="video"?"videoinput":r.kind;if(l!=="videoinput")continue;const o=r.deviceId||r.id,d=r.label||`Video device ${n.length+1}`,h=r.groupId,g={deviceId:o,label:d,kind:l,groupId:h};n.push(g)}return n})}getVideoInputDevices(){return se(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(n=>new X(n.deviceId,n.label))})}findDeviceById(t){return se(this,void 0,void 0,function*(){const n=yield this.listVideoInputDevices();return n?n.find(r=>r.deviceId===t):null})}decodeFromInputVideoDevice(t,n){return se(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(t,n)})}decodeOnceFromVideoDevice(t,n){return se(this,void 0,void 0,function*(){this.reset();let r;t?r={deviceId:{exact:t}}:r={facingMode:"environment"};const l={video:r};return yield this.decodeOnceFromConstraints(l,n)})}decodeOnceFromConstraints(t,n){return se(this,void 0,void 0,function*(){const r=yield navigator.mediaDevices.getUserMedia(t);return yield this.decodeOnceFromStream(r,n)})}decodeOnceFromStream(t,n){return se(this,void 0,void 0,function*(){this.reset();const r=yield this.attachStreamToVideo(t,n);return yield this.decodeOnce(r)})}decodeFromInputVideoDeviceContinuously(t,n,r){return se(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(t,n,r)})}decodeFromVideoDevice(t,n,r){return se(this,void 0,void 0,function*(){let l;t?l={deviceId:{exact:t}}:l={facingMode:"environment"};const o={video:l};return yield this.decodeFromConstraints(o,n,r)})}decodeFromConstraints(t,n,r){return se(this,void 0,void 0,function*(){const l=yield navigator.mediaDevices.getUserMedia(t);return yield this.decodeFromStream(l,n,r)})}decodeFromStream(t,n,r){return se(this,void 0,void 0,function*(){this.reset();const l=yield this.attachStreamToVideo(t,n);return yield this.decodeContinuously(l,r)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(t,n){return se(this,void 0,void 0,function*(){const r=this.prepareVideoElement(n);return this.addVideoSource(r,t),this.videoElement=r,this.stream=t,yield this.playVideoOnLoadAsync(r),r})}playVideoOnLoadAsync(t){return new Promise((n,r)=>this.playVideoOnLoad(t,()=>n()))}playVideoOnLoad(t,n){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(t),t.addEventListener("ended",this.videoEndedListener),t.addEventListener("canplay",this.videoCanPlayListener),t.addEventListener("playing",n),this.tryPlayVideo(t)}isVideoPlaying(t){return t.currentTime>0&&!t.paused&&!t.ended&&t.readyState>2}tryPlayVideo(t){return se(this,void 0,void 0,function*(){if(this.isVideoPlaying(t)){console.warn("Trying to play video that is already playing.");return}try{yield t.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(t,n){const r=document.getElementById(t);if(!r)throw new A(`element with id '${t}' not found`);if(r.nodeName.toLowerCase()!==n.toLowerCase())throw new A(`element with id '${t}' must be an ${n} element`);return r}decodeFromImage(t,n){if(!t&&!n)throw new A("either imageElement with a src set or an url must be provided");return n&&!t?this.decodeFromImageUrl(n):this.decodeFromImageElement(t)}decodeFromVideo(t,n){if(!t&&!n)throw new A("Either an element with a src set or an URL must be provided");return n&&!t?this.decodeFromVideoUrl(n):this.decodeFromVideoElement(t)}decodeFromVideoContinuously(t,n,r){if(t===void 0&&n===void 0)throw new A("Either an element with a src set or an URL must be provided");return n&&!t?this.decodeFromVideoUrlContinuously(n,r):this.decodeFromVideoElementContinuously(t,r)}decodeFromImageElement(t){if(!t)throw new A("An image element must be provided.");this.reset();const n=this.prepareImageElement(t);this.imageElement=n;let r;return this.isImageLoaded(n)?r=this.decodeOnce(n,!1,!0):r=this._decodeOnLoadImage(n),r}decodeFromVideoElement(t){const n=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideo(n)}decodeFromVideoElementContinuously(t,n){const r=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideoContinuously(r,n)}_decodeFromVideoElementSetup(t){if(!t)throw new A("A video element must be provided.");this.reset();const n=this.prepareVideoElement(t);return this.videoElement=n,n}decodeFromImageUrl(t){if(!t)throw new A("An URL must be provided.");this.reset();const n=this.prepareImageElement();this.imageElement=n;const r=this._decodeOnLoadImage(n);return n.src=t,r}decodeFromVideoUrl(t){if(!t)throw new A("An URL must be provided.");this.reset();const n=this.prepareVideoElement(),r=this.decodeFromVideoElement(n);return n.src=t,r}decodeFromVideoUrlContinuously(t,n){if(!t)throw new A("An URL must be provided.");this.reset();const r=this.prepareVideoElement(),l=this.decodeFromVideoElementContinuously(r,n);return r.src=t,l}_decodeOnLoadImage(t){return new Promise((n,r)=>{this.imageLoadedListener=()=>this.decodeOnce(t,!1,!0).then(n,r),t.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(t){return se(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(t),yield this.decodeOnce(t)})}_decodeOnLoadVideoContinuously(t,n){return se(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(t),this.decodeContinuously(t,n)})}isImageLoaded(t){return!(!t.complete||t.naturalWidth===0)}prepareImageElement(t){let n;return typeof t>"u"&&(n=document.createElement("img"),n.width=200,n.height=200),typeof t=="string"&&(n=this.getMediaElement(t,"img")),t instanceof HTMLImageElement&&(n=t),n}prepareVideoElement(t){let n;return!t&&typeof document<"u"&&(n=document.createElement("video"),n.width=200,n.height=200),typeof t=="string"&&(n=this.getMediaElement(t,"video")),t instanceof HTMLVideoElement&&(n=t),n.setAttribute("autoplay","true"),n.setAttribute("muted","true"),n.setAttribute("playsinline","true"),n}decodeOnce(t,n=!0,r=!0){this._stopAsyncDecode=!1;const l=(o,d)=>{if(this._stopAsyncDecode){d(new M("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const h=this.decode(t);o(h)}catch(h){const g=n&&h instanceof M,j=(h instanceof z||h instanceof K)&&r;if(g||j)return setTimeout(l,this._timeBetweenDecodingAttempts,o,d);d(h)}};return new Promise((o,d)=>l(o,d))}decodeContinuously(t,n){this._stopContinuousDecode=!1;const r=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const l=this.decode(t);n(l,null),setTimeout(r,this.timeBetweenScansMillis)}catch(l){n(null,l);const o=l instanceof z||l instanceof K,d=l instanceof M;(o||d)&&setTimeout(r,this._timeBetweenDecodingAttempts)}};r()}decode(t){const n=this.createBinaryBitmap(t);return this.decodeBitmap(n)}_isHTMLVideoElement(t){return t.videoWidth!==0}drawFrameOnCanvas(t,n,r){n||(n={sx:0,sy:0,sWidth:t.videoWidth,sHeight:t.videoHeight,dx:0,dy:0,dWidth:t.videoWidth,dHeight:t.videoHeight}),r||(r=this.captureCanvasContext),r.drawImage(t,n.sx,n.sy,n.sWidth,n.sHeight,n.dx,n.dy,n.dWidth,n.dHeight)}drawImageOnCanvas(t,n,r=this.captureCanvasContext){n||(n={sx:0,sy:0,sWidth:t.naturalWidth,sHeight:t.naturalHeight,dx:0,dy:0,dWidth:t.naturalWidth,dHeight:t.naturalHeight}),r||(r=this.captureCanvasContext),r.drawImage(t,n.sx,n.sy,n.sWidth,n.sHeight,n.dx,n.dy,n.dWidth,n.dHeight)}createBinaryBitmap(t){this.getCaptureCanvasContext(t),this._isHTMLVideoElement(t)?this.drawFrameOnCanvas(t):this.drawImageOnCanvas(t);const n=this.getCaptureCanvas(t),r=new he(n),l=new U(r);return new R(l)}getCaptureCanvasContext(t){if(!this.captureCanvasContext){const r=this.getCaptureCanvas(t).getContext("2d");this.captureCanvasContext=r}return this.captureCanvasContext}getCaptureCanvas(t){if(!this.captureCanvas){const n=this.createCaptureCanvas(t);this.captureCanvas=n}return this.captureCanvas}decodeBitmap(t){return this.reader.decode(t,this._hints)}createCaptureCanvas(t){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const n=document.createElement("canvas");let r,l;return typeof t<"u"&&(t instanceof HTMLVideoElement?(r=t.videoWidth,l=t.videoHeight):t instanceof HTMLImageElement&&(r=t.naturalWidth||t.width,l=t.naturalHeight||t.height)),n.style.width=r+"px",n.style.height=l+"px",n.width=r,n.height=l,n}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(t=>t.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(t,n){try{t.srcObject=n}catch{t.src=URL.createObjectURL(n)}}cleanVideoSource(t){try{t.srcObject=null}catch{t.src=""}this.videoElement.removeAttribute("src")}}class ye{constructor(t,n,r=n==null?0:8*n.length,l,o,d=F.currentTimeMillis()){this.text=t,this.rawBytes=n,this.numBits=r,this.resultPoints=l,this.format=o,this.timestamp=d,this.text=t,this.rawBytes=n,r==null?this.numBits=n==null?0:8*n.length:this.numBits=r,this.resultPoints=l,this.format=o,this.resultMetadata=null,d==null?this.timestamp=F.currentTimeMillis():this.timestamp=d}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(t,n){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(t,n)}putAllMetadata(t){t!==null&&(this.resultMetadata===null?this.resultMetadata=t:this.resultMetadata=new Map(t))}addResultPoints(t){const n=this.resultPoints;if(n===null)this.resultPoints=t;else if(t!==null&&t.length>0){const r=new Array(n.length+t.length);F.arraycopy(n,0,r,0,n.length),F.arraycopy(t,0,r,n.length,t.length),this.resultPoints=r}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Ue;(function(_){_[_.AZTEC=0]="AZTEC",_[_.CODABAR=1]="CODABAR",_[_.CODE_39=2]="CODE_39",_[_.CODE_93=3]="CODE_93",_[_.CODE_128=4]="CODE_128",_[_.DATA_MATRIX=5]="DATA_MATRIX",_[_.EAN_8=6]="EAN_8",_[_.EAN_13=7]="EAN_13",_[_.ITF=8]="ITF",_[_.MAXICODE=9]="MAXICODE",_[_.PDF_417=10]="PDF_417",_[_.QR_CODE=11]="QR_CODE",_[_.RSS_14=12]="RSS_14",_[_.RSS_EXPANDED=13]="RSS_EXPANDED",_[_.UPC_A=14]="UPC_A",_[_.UPC_E=15]="UPC_E",_[_.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ue||(Ue={}));var Re=Ue,Ge;(function(_){_[_.OTHER=0]="OTHER",_[_.ORIENTATION=1]="ORIENTATION",_[_.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",_[_.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",_[_.ISSUE_NUMBER=4]="ISSUE_NUMBER",_[_.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",_[_.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",_[_.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",_[_.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",_[_.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",_[_.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Ge||(Ge={}));var et=Ge;class ct{constructor(t,n,r,l,o=-1,d=-1){this.rawBytes=t,this.text=n,this.byteSegments=r,this.ecLevel=l,this.structuredAppendSequenceNumber=o,this.structuredAppendParity=d,this.numBits=t==null?0:8*t.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(t){this.numBits=t}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(t){this.errorsCorrected=t}getErasures(){return this.erasures}setErasures(t){this.erasures=t}getOther(){return this.other}setOther(t){this.other=t}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class ns{exp(t){return this.expTable[t]}log(t){if(t===0)throw new O;return this.logTable[t]}static addOrSubtract(t,n){return t^n}}class Dt{constructor(t,n){if(n.length===0)throw new O;this.field=t;const r=n.length;if(r>1&&n[0]===0){let l=1;for(;l<r&&n[l]===0;)l++;l===r?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(r-l),F.arraycopy(n,l,this.coefficients,0,this.coefficients.length))}else this.coefficients=n}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(t){return this.coefficients[this.coefficients.length-1-t]}evaluateAt(t){if(t===0)return this.getCoefficient(0);const n=this.coefficients;let r;if(t===1){r=0;for(let d=0,h=n.length;d!==h;d++){const g=n[d];r=ns.addOrSubtract(r,g)}return r}r=n[0];const l=n.length,o=this.field;for(let d=1;d<l;d++)r=ns.addOrSubtract(o.multiply(t,r),n[d]);return r}addOrSubtract(t){if(!this.field.equals(t.field))throw new O("GenericGFPolys do not have same GenericGF field");if(this.isZero())return t;if(t.isZero())return this;let n=this.coefficients,r=t.coefficients;if(n.length>r.length){const d=n;n=r,r=d}let l=new Int32Array(r.length);const o=r.length-n.length;F.arraycopy(r,0,l,0,o);for(let d=o;d<r.length;d++)l[d]=ns.addOrSubtract(n[d-o],r[d]);return new Dt(this.field,l)}multiply(t){if(!this.field.equals(t.field))throw new O("GenericGFPolys do not have same GenericGF field");if(this.isZero()||t.isZero())return this.field.getZero();const n=this.coefficients,r=n.length,l=t.coefficients,o=l.length,d=new Int32Array(r+o-1),h=this.field;for(let g=0;g<r;g++){const b=n[g];for(let j=0;j<o;j++)d[g+j]=ns.addOrSubtract(d[g+j],h.multiply(b,l[j]))}return new Dt(h,d)}multiplyScalar(t){if(t===0)return this.field.getZero();if(t===1)return this;const n=this.coefficients.length,r=this.field,l=new Int32Array(n),o=this.coefficients;for(let d=0;d<n;d++)l[d]=r.multiply(o[d],t);return new Dt(r,l)}multiplyByMonomial(t,n){if(t<0)throw new O;if(n===0)return this.field.getZero();const r=this.coefficients,l=r.length,o=new Int32Array(l+t),d=this.field;for(let h=0;h<l;h++)o[h]=d.multiply(r[h],n);return new Dt(d,o)}divide(t){if(!this.field.equals(t.field))throw new O("GenericGFPolys do not have same GenericGF field");if(t.isZero())throw new O("Divide by 0");const n=this.field;let r=n.getZero(),l=this;const o=t.getCoefficient(t.getDegree()),d=n.inverse(o);for(;l.getDegree()>=t.getDegree()&&!l.isZero();){const h=l.getDegree()-t.getDegree(),g=n.multiply(l.getCoefficient(l.getDegree()),d),b=t.multiplyByMonomial(h,g),j=n.buildMonomial(h,g);r=r.addOrSubtract(j),l=l.addOrSubtract(b)}return[r,l]}toString(){let t="";for(let n=this.getDegree();n>=0;n--){let r=this.getCoefficient(n);if(r!==0){if(r<0?(t+=" - ",r=-r):t.length>0&&(t+=" + "),n===0||r!==1){const l=this.field.log(r);l===0?t+="1":l===1?t+="a":(t+="a^",t+=l)}n!==0&&(n===1?t+="x":(t+="x^",t+=n))}}return t}}class Js extends v{}Js.kind="ArithmeticException";class dt extends ns{constructor(t,n,r){super(),this.primitive=t,this.size=n,this.generatorBase=r;const l=new Int32Array(n);let o=1;for(let h=0;h<n;h++)l[h]=o,o*=2,o>=n&&(o^=t,o&=n-1);this.expTable=l;const d=new Int32Array(n);for(let h=0;h<n-1;h++)d[l[h]]=h;this.logTable=d,this.zero=new Dt(this,Int32Array.from([0])),this.one=new Dt(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(t,n){if(t<0)throw new O;if(n===0)return this.zero;const r=new Int32Array(t+1);return r[0]=n,new Dt(this,r)}inverse(t){if(t===0)throw new Js;return this.expTable[this.size-this.logTable[t]-1]}multiply(t,n){return t===0||n===0?0:this.expTable[(this.logTable[t]+this.logTable[n])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+q.toHexString(this.primitive)+","+this.size+")"}equals(t){return t===this}}dt.AZTEC_DATA_12=new dt(4201,4096,1),dt.AZTEC_DATA_10=new dt(1033,1024,1),dt.AZTEC_DATA_6=new dt(67,64,1),dt.AZTEC_PARAM=new dt(19,16,1),dt.QR_CODE_FIELD_256=new dt(285,256,0),dt.DATA_MATRIX_FIELD_256=new dt(301,256,1),dt.AZTEC_DATA_8=dt.DATA_MATRIX_FIELD_256,dt.MAXICODE_FIELD_64=dt.AZTEC_DATA_6;class Ns extends v{}Ns.kind="ReedSolomonException";class Bs extends v{}Bs.kind="IllegalStateException";class us{constructor(t){this.field=t}decode(t,n){const r=this.field,l=new Dt(r,t),o=new Int32Array(n);let d=!0;for(let G=0;G<n;G++){const J=l.evaluateAt(r.exp(G+r.getGeneratorBase()));o[o.length-1-G]=J,J!==0&&(d=!1)}if(d)return;const h=new Dt(r,o),g=this.runEuclideanAlgorithm(r.buildMonomial(n,1),h,n),b=g[0],j=g[1],I=this.findErrorLocations(b),k=this.findErrorMagnitudes(j,I);for(let G=0;G<I.length;G++){const J=t.length-1-r.log(I[G]);if(J<0)throw new Ns("Bad error location");t[J]=dt.addOrSubtract(t[J],k[G])}}runEuclideanAlgorithm(t,n,r){if(t.getDegree()<n.getDegree()){const G=t;t=n,n=G}const l=this.field;let o=t,d=n,h=l.getZero(),g=l.getOne();for(;d.getDegree()>=(r/2|0);){let G=o,J=h;if(o=d,h=g,o.isZero())throw new Ns("r_{i-1} was zero");d=G;let ee=l.getZero();const ue=o.getCoefficient(o.getDegree()),be=l.inverse(ue);for(;d.getDegree()>=o.getDegree()&&!d.isZero();){const Be=d.getDegree()-o.getDegree(),Me=l.multiply(d.getCoefficient(d.getDegree()),be);ee=ee.addOrSubtract(l.buildMonomial(Be,Me)),d=d.addOrSubtract(o.multiplyByMonomial(Be,Me))}if(g=ee.multiply(h).addOrSubtract(J),d.getDegree()>=o.getDegree())throw new Bs("Division algorithm failed to reduce polynomial?")}const b=g.getCoefficient(0);if(b===0)throw new Ns("sigmaTilde(0) was zero");const j=l.inverse(b),I=g.multiplyScalar(j),k=d.multiplyScalar(j);return[I,k]}findErrorLocations(t){const n=t.getDegree();if(n===1)return Int32Array.from([t.getCoefficient(1)]);const r=new Int32Array(n);let l=0;const o=this.field;for(let d=1;d<o.getSize()&&l<n;d++)t.evaluateAt(d)===0&&(r[l]=o.inverse(d),l++);if(l!==n)throw new Ns("Error locator degree does not match number of roots");return r}findErrorMagnitudes(t,n){const r=n.length,l=new Int32Array(r),o=this.field;for(let d=0;d<r;d++){const h=o.inverse(n[d]);let g=1;for(let b=0;b<r;b++)if(d!==b){const j=o.multiply(n[b],h),I=(j&1)===0?j|1:j&-2;g=o.multiply(g,I)}l[d]=o.multiply(t.evaluateAt(h),o.inverse(g)),o.getGeneratorBase()!==0&&(l[d]=o.multiply(l[d],h))}return l}}var Xt;(function(_){_[_.UPPER=0]="UPPER",_[_.LOWER=1]="LOWER",_[_.MIXED=2]="MIXED",_[_.DIGIT=3]="DIGIT",_[_.PUNCT=4]="PUNCT",_[_.BINARY=5]="BINARY"})(Xt||(Xt={}));class Rt{decode(t){this.ddata=t;let n=t.getBits(),r=this.extractBits(n),l=this.correctBits(r),o=Rt.convertBoolArrayToByteArray(l),d=Rt.getEncodedData(l),h=new ct(o,d,null,null);return h.setNumBits(l.length),h}static highLevelDecode(t){return this.getEncodedData(t)}static getEncodedData(t){let n=t.length,r=Xt.UPPER,l=Xt.UPPER,o="",d=0;for(;d<n;)if(l===Xt.BINARY){if(n-d<5)break;let h=Rt.readCode(t,d,5);if(d+=5,h===0){if(n-d<11)break;h=Rt.readCode(t,d,11)+31,d+=11}for(let g=0;g<h;g++){if(n-d<8){d=n;break}const b=Rt.readCode(t,d,8);o+=$.castAsNonUtf8Char(b),d+=8}l=r}else{let h=l===Xt.DIGIT?4:5;if(n-d<h)break;let g=Rt.readCode(t,d,h);d+=h;let b=Rt.getCharacter(l,g);b.startsWith("CTRL_")?(r=l,l=Rt.getTable(b.charAt(5)),b.charAt(6)==="L"&&(r=l)):(o+=b,l=r)}return o}static getTable(t){switch(t){case"L":return Xt.LOWER;case"P":return Xt.PUNCT;case"M":return Xt.MIXED;case"D":return Xt.DIGIT;case"B":return Xt.BINARY;case"U":default:return Xt.UPPER}}static getCharacter(t,n){switch(t){case Xt.UPPER:return Rt.UPPER_TABLE[n];case Xt.LOWER:return Rt.LOWER_TABLE[n];case Xt.MIXED:return Rt.MIXED_TABLE[n];case Xt.PUNCT:return Rt.PUNCT_TABLE[n];case Xt.DIGIT:return Rt.DIGIT_TABLE[n];default:throw new Bs("Bad table")}}correctBits(t){let n,r;this.ddata.getNbLayers()<=2?(r=6,n=dt.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(r=8,n=dt.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(r=10,n=dt.AZTEC_DATA_10):(r=12,n=dt.AZTEC_DATA_12);let l=this.ddata.getNbDatablocks(),o=t.length/r;if(o<l)throw new K;let d=t.length%r,h=new Int32Array(o);for(let k=0;k<o;k++,d+=r)h[k]=Rt.readCode(t,d,r);try{new us(n).decode(h,o-l)}catch(k){throw new K(k)}let g=(1<<r)-1,b=0;for(let k=0;k<l;k++){let G=h[k];if(G===0||G===g)throw new K;(G===1||G===g-1)&&b++}let j=new Array(l*r-b),I=0;for(let k=0;k<l;k++){let G=h[k];if(G===1||G===g-1)j.fill(G>1,I,I+r-1),I+=r-1;else for(let J=r-1;J>=0;--J)j[I++]=(G&1<<J)!==0}return j}extractBits(t){let n=this.ddata.isCompact(),r=this.ddata.getNbLayers(),l=(n?11:14)+r*4,o=new Int32Array(l),d=new Array(this.totalBitsInLayer(r,n));if(n)for(let h=0;h<o.length;h++)o[h]=h;else{let h=l+1+2*q.truncDivision(q.truncDivision(l,2)-1,15),g=l/2,b=q.truncDivision(h,2);for(let j=0;j<g;j++){let I=j+q.truncDivision(j,15);o[g-j-1]=b-I-1,o[g+j]=b+I+1}}for(let h=0,g=0;h<r;h++){let b=(r-h)*4+(n?9:12),j=h*2,I=l-1-j;for(let k=0;k<b;k++){let G=k*2;for(let J=0;J<2;J++)d[g+G+J]=t.get(o[j+J],o[j+k]),d[g+2*b+G+J]=t.get(o[j+k],o[I-J]),d[g+4*b+G+J]=t.get(o[I-J],o[I-k]),d[g+6*b+G+J]=t.get(o[I-k],o[j+J])}g+=b*8}return d}static readCode(t,n,r){let l=0;for(let o=n;o<n+r;o++)l<<=1,t[o]&&(l|=1);return l}static readByte(t,n){let r=t.length-n;return r>=8?Rt.readCode(t,n,8):Rt.readCode(t,n,r)<<8-r}static convertBoolArrayToByteArray(t){let n=new Uint8Array((t.length+7)/8);for(let r=0;r<n.length;r++)n[r]=Rt.readByte(t,8*r);return n}totalBitsInLayer(t,n){return((n?88:112)+16*t)*t}}Rt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Rt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Rt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Rt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Rt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class de{constructor(){}static round(t){return t===NaN?0:t<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:t>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t+(t<0?-.5:.5)|0}static distance(t,n,r,l){const o=t-r,d=n-l;return Math.sqrt(o*o+d*d)}static sum(t){let n=0;for(let r=0,l=t.length;r!==l;r++){const o=t[r];n+=o}return n}}class Le{static floatToIntBits(t){return t}}Le.MAX_VALUE=Number.MAX_SAFE_INTEGER;class _e{constructor(t,n){this.x=t,this.y=n}getX(){return this.x}getY(){return this.y}equals(t){if(t instanceof _e){const n=t;return this.x===n.x&&this.y===n.y}return!1}hashCode(){return 31*Le.floatToIntBits(this.x)+Le.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(t){const n=this.distance(t[0],t[1]),r=this.distance(t[1],t[2]),l=this.distance(t[0],t[2]);let o,d,h;if(r>=n&&r>=l?(d=t[0],o=t[1],h=t[2]):l>=r&&l>=n?(d=t[1],o=t[0],h=t[2]):(d=t[2],o=t[0],h=t[1]),this.crossProductZ(o,d,h)<0){const g=o;o=h,h=g}t[0]=o,t[1]=d,t[2]=h}static distance(t,n){return de.distance(t.x,t.y,n.x,n.y)}static crossProductZ(t,n,r){const l=n.x,o=n.y;return(r.x-l)*(t.y-o)-(r.y-o)*(t.x-l)}}class ie{constructor(t,n){this.bits=t,this.points=n}getBits(){return this.bits}getPoints(){return this.points}}class Fe extends ie{constructor(t,n,r,l,o){super(t,n),this.compact=r,this.nbDatablocks=l,this.nbLayers=o}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Ke{constructor(t,n,r,l){this.image=t,this.height=t.getHeight(),this.width=t.getWidth(),n==null&&(n=Ke.INIT_SIZE),r==null&&(r=t.getWidth()/2|0),l==null&&(l=t.getHeight()/2|0);const o=n/2|0;if(this.leftInit=r-o,this.rightInit=r+o,this.upInit=l-o,this.downInit=l+o,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new M}detect(){let t=this.leftInit,n=this.rightInit,r=this.upInit,l=this.downInit,o=!1,d=!0,h=!1,g=!1,b=!1,j=!1,I=!1;const k=this.width,G=this.height;for(;d;){d=!1;let J=!0;for(;(J||!g)&&n<k;)J=this.containsBlackPoint(r,l,n,!1),J?(n++,d=!0,g=!0):g||n++;if(n>=k){o=!0;break}let ee=!0;for(;(ee||!b)&&l<G;)ee=this.containsBlackPoint(t,n,l,!0),ee?(l++,d=!0,b=!0):b||l++;if(l>=G){o=!0;break}let ue=!0;for(;(ue||!j)&&t>=0;)ue=this.containsBlackPoint(r,l,t,!1),ue?(t--,d=!0,j=!0):j||t--;if(t<0){o=!0;break}let be=!0;for(;(be||!I)&&r>=0;)be=this.containsBlackPoint(t,n,r,!0),be?(r--,d=!0,I=!0):I||r--;if(r<0){o=!0;break}d&&(h=!0)}if(!o&&h){const J=n-t;let ee=null;for(let Me=1;ee===null&&Me<J;Me++)ee=this.getBlackPointOnSegment(t,l-Me,t+Me,l);if(ee==null)throw new M;let ue=null;for(let Me=1;ue===null&&Me<J;Me++)ue=this.getBlackPointOnSegment(t,r+Me,t+Me,r);if(ue==null)throw new M;let be=null;for(let Me=1;be===null&&Me<J;Me++)be=this.getBlackPointOnSegment(n,r+Me,n-Me,r);if(be==null)throw new M;let Be=null;for(let Me=1;Be===null&&Me<J;Me++)Be=this.getBlackPointOnSegment(n,l-Me,n-Me,l);if(Be==null)throw new M;return this.centerEdges(Be,ee,be,ue)}else throw new M}getBlackPointOnSegment(t,n,r,l){const o=de.round(de.distance(t,n,r,l)),d=(r-t)/o,h=(l-n)/o,g=this.image;for(let b=0;b<o;b++){const j=de.round(t+b*d),I=de.round(n+b*h);if(g.get(j,I))return new _e(j,I)}return null}centerEdges(t,n,r,l){const o=t.getX(),d=t.getY(),h=n.getX(),g=n.getY(),b=r.getX(),j=r.getY(),I=l.getX(),k=l.getY(),G=Ke.CORR;return o<this.width/2?[new _e(I-G,k+G),new _e(h+G,g+G),new _e(b-G,j-G),new _e(o+G,d-G)]:[new _e(I+G,k+G),new _e(h+G,g-G),new _e(b-G,j+G),new _e(o-G,d-G)]}containsBlackPoint(t,n,r,l){const o=this.image;if(l){for(let d=t;d<=n;d++)if(o.get(d,r))return!0}else for(let d=t;d<=n;d++)if(o.get(r,d))return!0;return!1}}Ke.INIT_SIZE=10,Ke.CORR=1;class Ye{static checkAndNudgePoints(t,n){const r=t.getWidth(),l=t.getHeight();let o=!0;for(let d=0;d<n.length&&o;d+=2){const h=Math.floor(n[d]),g=Math.floor(n[d+1]);if(h<-1||h>r||g<-1||g>l)throw new M;o=!1,h===-1?(n[d]=0,o=!0):h===r&&(n[d]=r-1,o=!0),g===-1?(n[d+1]=0,o=!0):g===l&&(n[d+1]=l-1,o=!0)}o=!0;for(let d=n.length-2;d>=0&&o;d-=2){const h=Math.floor(n[d]),g=Math.floor(n[d+1]);if(h<-1||h>r||g<-1||g>l)throw new M;o=!1,h===-1?(n[d]=0,o=!0):h===r&&(n[d]=r-1,o=!0),g===-1?(n[d+1]=0,o=!0):g===l&&(n[d+1]=l-1,o=!0)}}}class Pe{constructor(t,n,r,l,o,d,h,g,b){this.a11=t,this.a21=n,this.a31=r,this.a12=l,this.a22=o,this.a32=d,this.a13=h,this.a23=g,this.a33=b}static quadrilateralToQuadrilateral(t,n,r,l,o,d,h,g,b,j,I,k,G,J,ee,ue){const be=Pe.quadrilateralToSquare(t,n,r,l,o,d,h,g);return Pe.squareToQuadrilateral(b,j,I,k,G,J,ee,ue).times(be)}transformPoints(t){const n=t.length,r=this.a11,l=this.a12,o=this.a13,d=this.a21,h=this.a22,g=this.a23,b=this.a31,j=this.a32,I=this.a33;for(let k=0;k<n;k+=2){const G=t[k],J=t[k+1],ee=o*G+g*J+I;t[k]=(r*G+d*J+b)/ee,t[k+1]=(l*G+h*J+j)/ee}}transformPointsWithValues(t,n){const r=this.a11,l=this.a12,o=this.a13,d=this.a21,h=this.a22,g=this.a23,b=this.a31,j=this.a32,I=this.a33,k=t.length;for(let G=0;G<k;G++){const J=t[G],ee=n[G],ue=o*J+g*ee+I;t[G]=(r*J+d*ee+b)/ue,n[G]=(l*J+h*ee+j)/ue}}static squareToQuadrilateral(t,n,r,l,o,d,h,g){const b=t-r+o-h,j=n-l+d-g;if(b===0&&j===0)return new Pe(r-t,o-r,t,l-n,d-l,n,0,0,1);{const I=r-o,k=h-o,G=l-d,J=g-d,ee=I*J-k*G,ue=(b*J-k*j)/ee,be=(I*j-b*G)/ee;return new Pe(r-t+ue*r,h-t+be*h,t,l-n+ue*l,g-n+be*g,n,ue,be,1)}}static quadrilateralToSquare(t,n,r,l,o,d,h,g){return Pe.squareToQuadrilateral(t,n,r,l,o,d,h,g).buildAdjoint()}buildAdjoint(){return new Pe(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(t){return new Pe(this.a11*t.a11+this.a21*t.a12+this.a31*t.a13,this.a11*t.a21+this.a21*t.a22+this.a31*t.a23,this.a11*t.a31+this.a21*t.a32+this.a31*t.a33,this.a12*t.a11+this.a22*t.a12+this.a32*t.a13,this.a12*t.a21+this.a22*t.a22+this.a32*t.a23,this.a12*t.a31+this.a22*t.a32+this.a32*t.a33,this.a13*t.a11+this.a23*t.a12+this.a33*t.a13,this.a13*t.a21+this.a23*t.a22+this.a33*t.a23,this.a13*t.a31+this.a23*t.a32+this.a33*t.a33)}}class ot extends Ye{sampleGrid(t,n,r,l,o,d,h,g,b,j,I,k,G,J,ee,ue,be,Be,Me){const Ie=Pe.quadrilateralToQuadrilateral(l,o,d,h,g,b,j,I,k,G,J,ee,ue,be,Be,Me);return this.sampleGridWithTransform(t,n,r,Ie)}sampleGridWithTransform(t,n,r,l){if(n<=0||r<=0)throw new M;const o=new Ne(n,r),d=new Float32Array(2*n);for(let h=0;h<r;h++){const g=d.length,b=h+.5;for(let j=0;j<g;j+=2)d[j]=j/2+.5,d[j+1]=b;l.transformPoints(d),Ye.checkAndNudgePoints(t,d);try{for(let j=0;j<g;j+=2)t.get(Math.floor(d[j]),Math.floor(d[j+1]))&&o.set(j/2,h)}catch{throw new M}}return o}}class St{static setGridSampler(t){St.gridSampler=t}static getInstance(){return St.gridSampler}}St.gridSampler=new ot;class rt{constructor(t,n){this.x=t,this.y=n}toResultPoint(){return new _e(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class ba{constructor(t){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=t}detect(){return this.detectMirror(!1)}detectMirror(t){let n=this.getMatrixCenter(),r=this.getBullsEyeCorners(n);if(t){let d=r[0];r[0]=r[2],r[2]=d}this.extractParameters(r);let l=this.sampleGrid(this.image,r[this.shift%4],r[(this.shift+1)%4],r[(this.shift+2)%4],r[(this.shift+3)%4]),o=this.getMatrixCornerPoints(r);return new Fe(l,o,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(t){if(!this.isValidPoint(t[0])||!this.isValidPoint(t[1])||!this.isValidPoint(t[2])||!this.isValidPoint(t[3]))throw new M;let n=2*this.nbCenterLayers,r=new Int32Array([this.sampleLine(t[0],t[1],n),this.sampleLine(t[1],t[2],n),this.sampleLine(t[2],t[3],n),this.sampleLine(t[3],t[0],n)]);this.shift=this.getRotation(r,n);let l=0;for(let d=0;d<4;d++){let h=r[(this.shift+d)%4];this.compact?(l<<=7,l+=h>>1&127):(l<<=10,l+=(h>>2&992)+(h>>1&31))}let o=this.getCorrectedParameterData(l,this.compact);this.compact?(this.nbLayers=(o>>6)+1,this.nbDataBlocks=(o&63)+1):(this.nbLayers=(o>>11)+1,this.nbDataBlocks=(o&2047)+1)}getRotation(t,n){let r=0;t.forEach((l,o,d)=>{let h=(l>>n-2<<1)+(l&1);r=(r<<3)+h}),r=((r&1)<<11)+(r>>1);for(let l=0;l<4;l++)if(q.bitCount(r^this.EXPECTED_CORNER_BITS[l])<=2)return l;throw new M}getCorrectedParameterData(t,n){let r,l;n?(r=7,l=2):(r=10,l=4);let o=r-l,d=new Int32Array(r);for(let g=r-1;g>=0;--g)d[g]=t&15,t>>=4;try{new us(dt.AZTEC_PARAM).decode(d,o)}catch{throw new M}let h=0;for(let g=0;g<l;g++)h=(h<<4)+d[g];return h}getBullsEyeCorners(t){let n=t,r=t,l=t,o=t,d=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let I=this.getFirstDifferent(n,d,1,-1),k=this.getFirstDifferent(r,d,1,1),G=this.getFirstDifferent(l,d,-1,1),J=this.getFirstDifferent(o,d,-1,-1);if(this.nbCenterLayers>2){let ee=this.distancePoint(J,I)*this.nbCenterLayers/(this.distancePoint(o,n)*(this.nbCenterLayers+2));if(ee<.75||ee>1.25||!this.isWhiteOrBlackRectangle(I,k,G,J))break}n=I,r=k,l=G,o=J,d=!d}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new M;this.compact=this.nbCenterLayers===5;let h=new _e(n.getX()+.5,n.getY()-.5),g=new _e(r.getX()+.5,r.getY()+.5),b=new _e(l.getX()-.5,l.getY()+.5),j=new _e(o.getX()-.5,o.getY()-.5);return this.expandSquare([h,g,b,j],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let t,n,r,l;try{let h=new Ke(this.image).detect();t=h[0],n=h[1],r=h[2],l=h[3]}catch{let g=this.image.getWidth()/2,b=this.image.getHeight()/2;t=this.getFirstDifferent(new rt(g+7,b-7),!1,1,-1).toResultPoint(),n=this.getFirstDifferent(new rt(g+7,b+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new rt(g-7,b+7),!1,-1,1).toResultPoint(),l=this.getFirstDifferent(new rt(g-7,b-7),!1,-1,-1).toResultPoint()}let o=de.round((t.getX()+l.getX()+n.getX()+r.getX())/4),d=de.round((t.getY()+l.getY()+n.getY()+r.getY())/4);try{let h=new Ke(this.image,15,o,d).detect();t=h[0],n=h[1],r=h[2],l=h[3]}catch{t=this.getFirstDifferent(new rt(o+7,d-7),!1,1,-1).toResultPoint(),n=this.getFirstDifferent(new rt(o+7,d+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new rt(o-7,d+7),!1,-1,1).toResultPoint(),l=this.getFirstDifferent(new rt(o-7,d-7),!1,-1,-1).toResultPoint()}return o=de.round((t.getX()+l.getX()+n.getX()+r.getX())/4),d=de.round((t.getY()+l.getY()+n.getY()+r.getY())/4),new rt(o,d)}getMatrixCornerPoints(t){return this.expandSquare(t,2*this.nbCenterLayers,this.getDimension())}sampleGrid(t,n,r,l,o){let d=St.getInstance(),h=this.getDimension(),g=h/2-this.nbCenterLayers,b=h/2+this.nbCenterLayers;return d.sampleGrid(t,h,h,g,g,b,g,b,b,g,b,n.getX(),n.getY(),r.getX(),r.getY(),l.getX(),l.getY(),o.getX(),o.getY())}sampleLine(t,n,r){let l=0,o=this.distanceResultPoint(t,n),d=o/r,h=t.getX(),g=t.getY(),b=d*(n.getX()-t.getX())/o,j=d*(n.getY()-t.getY())/o;for(let I=0;I<r;I++)this.image.get(de.round(h+I*b),de.round(g+I*j))&&(l|=1<<r-I-1);return l}isWhiteOrBlackRectangle(t,n,r,l){let o=3;t=new rt(t.getX()-o,t.getY()+o),n=new rt(n.getX()-o,n.getY()-o),r=new rt(r.getX()+o,r.getY()-o),l=new rt(l.getX()+o,l.getY()+o);let d=this.getColor(l,t);if(d===0)return!1;let h=this.getColor(t,n);return h!==d||(h=this.getColor(n,r),h!==d)?!1:(h=this.getColor(r,l),h===d)}getColor(t,n){let r=this.distancePoint(t,n),l=(n.getX()-t.getX())/r,o=(n.getY()-t.getY())/r,d=0,h=t.getX(),g=t.getY(),b=this.image.get(t.getX(),t.getY()),j=Math.ceil(r);for(let k=0;k<j;k++)h+=l,g+=o,this.image.get(de.round(h),de.round(g))!==b&&d++;let I=d/r;return I>.1&&I<.9?0:I<=.1===b?1:-1}getFirstDifferent(t,n,r,l){let o=t.getX()+r,d=t.getY()+l;for(;this.isValid(o,d)&&this.image.get(o,d)===n;)o+=r,d+=l;for(o-=r,d-=l;this.isValid(o,d)&&this.image.get(o,d)===n;)o+=r;for(o-=r;this.isValid(o,d)&&this.image.get(o,d)===n;)d+=l;return d-=l,new rt(o,d)}expandSquare(t,n,r){let l=r/(2*n),o=t[0].getX()-t[2].getX(),d=t[0].getY()-t[2].getY(),h=(t[0].getX()+t[2].getX())/2,g=(t[0].getY()+t[2].getY())/2,b=new _e(h+l*o,g+l*d),j=new _e(h-l*o,g-l*d);o=t[1].getX()-t[3].getX(),d=t[1].getY()-t[3].getY(),h=(t[1].getX()+t[3].getX())/2,g=(t[1].getY()+t[3].getY())/2;let I=new _e(h+l*o,g+l*d),k=new _e(h-l*o,g-l*d);return[b,I,j,k]}isValid(t,n){return t>=0&&t<this.image.getWidth()&&n>0&&n<this.image.getHeight()}isValidPoint(t){let n=de.round(t.getX()),r=de.round(t.getY());return this.isValid(n,r)}distancePoint(t,n){return de.distance(t.getX(),t.getY(),n.getX(),n.getY())}distanceResultPoint(t,n){return de.distance(t.getX(),t.getY(),n.getX(),n.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(q.truncDivision(this.nbLayers-4,8)+1)+15}}class wa{decode(t,n=null){let r=null,l=new ba(t.getBlackMatrix()),o=null,d=null;try{let j=l.detectMirror(!1);o=j.getPoints(),this.reportFoundResultPoints(n,o),d=new Rt().decode(j)}catch(j){r=j}if(d==null)try{let j=l.detectMirror(!0);o=j.getPoints(),this.reportFoundResultPoints(n,o),d=new Rt().decode(j)}catch(j){throw r??j}let h=new ye(d.getText(),d.getRawBytes(),d.getNumBits(),o,Re.AZTEC,F.currentTimeMillis()),g=d.getByteSegments();g!=null&&h.putMetadata(et.BYTE_SEGMENTS,g);let b=d.getECLevel();return b!=null&&h.putMetadata(et.ERROR_CORRECTION_LEVEL,b),h}reportFoundResultPoints(t,n){if(t!=null){let r=t.get(te.NEED_RESULT_POINT_CALLBACK);r!=null&&n.forEach((l,o,d)=>{r.foundPossibleResultPoint(l)})}}reset(){}}class an extends Ee{constructor(t=500){super(new wa,t)}}class It{decode(t,n){try{return this.doDecode(t,n)}catch{if(n&&n.get(te.TRY_HARDER)===!0&&t.isRotateSupported()){const o=t.rotateCounterClockwise(),d=this.doDecode(o,n),h=d.getResultMetadata();let g=270;h!==null&&h.get(et.ORIENTATION)===!0&&(g=g+h.get(et.ORIENTATION)%360),d.putMetadata(et.ORIENTATION,g);const b=d.getResultPoints();if(b!==null){const j=o.getHeight();for(let I=0;I<b.length;I++)b[I]=new _e(j-b[I].getY()-1,b[I].getX())}return d}else throw new M}}reset(){}doDecode(t,n){const r=t.getWidth(),l=t.getHeight();let o=new oe(r);const d=n&&n.get(te.TRY_HARDER)===!0,h=Math.max(1,l>>(d?8:5));let g;d?g=l:g=15;const b=Math.trunc(l/2);for(let j=0;j<g;j++){const I=Math.trunc((j+1)/2),k=(j&1)===0,G=b+h*(k?I:-I);if(G<0||G>=l)break;try{o=t.getBlackRow(G,o)}catch{continue}for(let J=0;J<2;J++){if(J===1&&(o.reverse(),n&&n.get(te.NEED_RESULT_POINT_CALLBACK)===!0)){const ee=new Map;n.forEach((ue,be)=>ee.set(be,ue)),ee.delete(te.NEED_RESULT_POINT_CALLBACK),n=ee}try{const ee=this.decodeRow(G,o,n);if(J===1){ee.putMetadata(et.ORIENTATION,180);const ue=ee.getResultPoints();ue!==null&&(ue[0]=new _e(r-ue[0].getX()-1,ue[0].getY()),ue[1]=new _e(r-ue[1].getX()-1,ue[1].getY()))}return ee}catch{}}}throw new M}static recordPattern(t,n,r){const l=r.length;for(let b=0;b<l;b++)r[b]=0;const o=t.getSize();if(n>=o)throw new M;let d=!t.get(n),h=0,g=n;for(;g<o;){if(t.get(g)!==d)r[h]++;else{if(++h===l)break;r[h]=1,d=!d}g++}if(!(h===l||h===l-1&&g===o))throw new M}static recordPatternInReverse(t,n,r){let l=r.length,o=t.get(n);for(;n>0&&l>=0;)t.get(--n)!==o&&(l--,o=!o);if(l>=0)throw new M;It.recordPattern(t,n+1,r)}static patternMatchVariance(t,n,r){const l=t.length;let o=0,d=0;for(let b=0;b<l;b++)o+=t[b],d+=n[b];if(o<d)return Number.POSITIVE_INFINITY;const h=o/d;r*=h;let g=0;for(let b=0;b<l;b++){const j=t[b],I=n[b]*h,k=j>I?j-I:I-j;if(k>r)return Number.POSITIVE_INFINITY;g+=k}return g/o}}class ke extends It{static findStartPattern(t){const n=t.getSize(),r=t.getNextSet(0);let l=0,o=Int32Array.from([0,0,0,0,0,0]),d=r,h=!1;const g=6;for(let b=r;b<n;b++)if(t.get(b)!==h)o[l]++;else{if(l===g-1){let j=ke.MAX_AVG_VARIANCE,I=-1;for(let k=ke.CODE_START_A;k<=ke.CODE_START_C;k++){const G=It.patternMatchVariance(o,ke.CODE_PATTERNS[k],ke.MAX_INDIVIDUAL_VARIANCE);G<j&&(j=G,I=k)}if(I>=0&&t.isRange(Math.max(0,d-(b-d)/2),d,!1))return Int32Array.from([d,b,I]);d+=o[0]+o[1],o=o.slice(2,o.length-1),o[l-1]=0,o[l]=0,l--}else l++;o[l]=1,h=!h}throw new M}static decodeCode(t,n,r){It.recordPattern(t,r,n);let l=ke.MAX_AVG_VARIANCE,o=-1;for(let d=0;d<ke.CODE_PATTERNS.length;d++){const h=ke.CODE_PATTERNS[d],g=this.patternMatchVariance(n,h,ke.MAX_INDIVIDUAL_VARIANCE);g<l&&(l=g,o=d)}if(o>=0)return o;throw new M}decodeRow(t,n,r){const l=r&&r.get(te.ASSUME_GS1)===!0,o=ke.findStartPattern(n),d=o[2];let h=0;const g=new Uint8Array(20);g[h++]=d;let b;switch(d){case ke.CODE_START_A:b=ke.CODE_CODE_A;break;case ke.CODE_START_B:b=ke.CODE_CODE_B;break;case ke.CODE_START_C:b=ke.CODE_CODE_C;break;default:throw new K}let j=!1,I=!1,k="",G=o[0],J=o[1];const ee=Int32Array.from([0,0,0,0,0,0]);let ue=0,be=0,Be=d,Me=0,Ie=!0,mt=!1,it=!1;for(;!j;){const jn=I;switch(I=!1,ue=be,be=ke.decodeCode(n,ee,J),g[h++]=be,be!==ke.CODE_STOP&&(Ie=!0),be!==ke.CODE_STOP&&(Me++,Be+=Me*be),G=J,J+=ee.reduce((Eo,bl)=>Eo+bl,0),be){case ke.CODE_START_A:case ke.CODE_START_B:case ke.CODE_START_C:throw new K}switch(b){case ke.CODE_CODE_A:if(be<64)it===mt?k+=String.fromCharCode(32+be):k+=String.fromCharCode(32+be+128),it=!1;else if(be<96)it===mt?k+=String.fromCharCode(be-64):k+=String.fromCharCode(be+64),it=!1;else switch(be!==ke.CODE_STOP&&(Ie=!1),be){case ke.CODE_FNC_1:l&&(k.length===0?k+="]C1":k+="");break;case ke.CODE_FNC_2:case ke.CODE_FNC_3:break;case ke.CODE_FNC_4_A:!mt&&it?(mt=!0,it=!1):mt&&it?(mt=!1,it=!1):it=!0;break;case ke.CODE_SHIFT:I=!0,b=ke.CODE_CODE_B;break;case ke.CODE_CODE_B:b=ke.CODE_CODE_B;break;case ke.CODE_CODE_C:b=ke.CODE_CODE_C;break;case ke.CODE_STOP:j=!0;break}break;case ke.CODE_CODE_B:if(be<96)it===mt?k+=String.fromCharCode(32+be):k+=String.fromCharCode(32+be+128),it=!1;else switch(be!==ke.CODE_STOP&&(Ie=!1),be){case ke.CODE_FNC_1:l&&(k.length===0?k+="]C1":k+="");break;case ke.CODE_FNC_2:case ke.CODE_FNC_3:break;case ke.CODE_FNC_4_B:!mt&&it?(mt=!0,it=!1):mt&&it?(mt=!1,it=!1):it=!0;break;case ke.CODE_SHIFT:I=!0,b=ke.CODE_CODE_A;break;case ke.CODE_CODE_A:b=ke.CODE_CODE_A;break;case ke.CODE_CODE_C:b=ke.CODE_CODE_C;break;case ke.CODE_STOP:j=!0;break}break;case ke.CODE_CODE_C:if(be<100)be<10&&(k+="0"),k+=be;else switch(be!==ke.CODE_STOP&&(Ie=!1),be){case ke.CODE_FNC_1:l&&(k.length===0?k+="]C1":k+="");break;case ke.CODE_CODE_A:b=ke.CODE_CODE_A;break;case ke.CODE_CODE_B:b=ke.CODE_CODE_B;break;case ke.CODE_STOP:j=!0;break}break}jn&&(b=b===ke.CODE_CODE_A?ke.CODE_CODE_B:ke.CODE_CODE_A)}const ps=J-G;if(J=n.getNextUnset(J),!n.isRange(J,Math.min(n.getSize(),J+(J-G)/2),!1))throw new M;if(Be-=Me*ue,Be%103!==ue)throw new z;const ua=k.length;if(ua===0)throw new M;ua>0&&Ie&&(b===ke.CODE_CODE_C?k=k.substring(0,ua-2):k=k.substring(0,ua-1));const Ys=(o[1]+o[0])/2,Gt=G+ps/2,Us=g.length,ia=new Uint8Array(Us);for(let jn=0;jn<Us;jn++)ia[jn]=g[jn];const dr=[new _e(Ys,t),new _e(Gt,t)];return new ye(k,ia,0,dr,Re.CODE_128,new Date().getTime())}}ke.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],ke.MAX_AVG_VARIANCE=.25,ke.MAX_INDIVIDUAL_VARIANCE=.7,ke.CODE_SHIFT=98,ke.CODE_CODE_C=99,ke.CODE_CODE_B=100,ke.CODE_CODE_A=101,ke.CODE_FNC_1=102,ke.CODE_FNC_2=97,ke.CODE_FNC_3=96,ke.CODE_FNC_4_A=101,ke.CODE_FNC_4_B=100,ke.CODE_START_A=103,ke.CODE_START_B=104,ke.CODE_START_C=105,ke.CODE_STOP=106;class zt extends It{constructor(t=!1,n=!1){super(),this.usingCheckDigit=t,this.extendedMode=n,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(t,n,r){let l=this.counters;l.fill(0),this.decodeRowResult="";let o=zt.findAsteriskPattern(n,l),d=n.getNextSet(o[1]),h=n.getSize(),g,b;do{zt.recordPattern(n,d,l);let ee=zt.toNarrowWidePattern(l);if(ee<0)throw new M;g=zt.patternToChar(ee),this.decodeRowResult+=g,b=d;for(let ue of l)d+=ue;d=n.getNextSet(d)}while(g!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let j=0;for(let ee of l)j+=ee;let I=d-b-j;if(d!==h&&I*2<j)throw new M;if(this.usingCheckDigit){let ee=this.decodeRowResult.length-1,ue=0;for(let be=0;be<ee;be++)ue+=zt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(be));if(this.decodeRowResult.charAt(ee)!==zt.ALPHABET_STRING.charAt(ue%43))throw new z;this.decodeRowResult=this.decodeRowResult.substring(0,ee)}if(this.decodeRowResult.length===0)throw new M;let k;this.extendedMode?k=zt.decodeExtended(this.decodeRowResult):k=this.decodeRowResult;let G=(o[1]+o[0])/2,J=b+j/2;return new ye(k,null,0,[new _e(G,t),new _e(J,t)],Re.CODE_39,new Date().getTime())}static findAsteriskPattern(t,n){let r=t.getSize(),l=t.getNextSet(0),o=0,d=l,h=!1,g=n.length;for(let b=l;b<r;b++)if(t.get(b)!==h)n[o]++;else{if(o===g-1){if(this.toNarrowWidePattern(n)===zt.ASTERISK_ENCODING&&t.isRange(Math.max(0,d-Math.floor((b-d)/2)),d,!1))return[d,b];d+=n[0]+n[1],n.copyWithin(0,2,2+o-1),n[o-1]=0,n[o]=0,o--}else o++;n[o]=1,h=!h}throw new M}static toNarrowWidePattern(t){let n=t.length,r=0,l;do{let o=2147483647;for(let g of t)g<o&&g>r&&(o=g);r=o,l=0;let d=0,h=0;for(let g=0;g<n;g++){let b=t[g];b>r&&(h|=1<<n-1-g,l++,d+=b)}if(l===3){for(let g=0;g<n&&l>0;g++){let b=t[g];if(b>r&&(l--,b*2>=d))return-1}return h}}while(l>3);return-1}static patternToChar(t){for(let n=0;n<zt.CHARACTER_ENCODINGS.length;n++)if(zt.CHARACTER_ENCODINGS[n]===t)return zt.ALPHABET_STRING.charAt(n);if(t===zt.ASTERISK_ENCODING)return"*";throw new M}static decodeExtended(t){let n=t.length,r="";for(let l=0;l<n;l++){let o=t.charAt(l);if(o==="+"||o==="$"||o==="%"||o==="/"){let d=t.charAt(l+1),h="\0";switch(o){case"+":if(d>="A"&&d<="Z")h=String.fromCharCode(d.charCodeAt(0)+32);else throw new K;break;case"$":if(d>="A"&&d<="Z")h=String.fromCharCode(d.charCodeAt(0)-64);else throw new K;break;case"%":if(d>="A"&&d<="E")h=String.fromCharCode(d.charCodeAt(0)-38);else if(d>="F"&&d<="J")h=String.fromCharCode(d.charCodeAt(0)-11);else if(d>="K"&&d<="O")h=String.fromCharCode(d.charCodeAt(0)+16);else if(d>="P"&&d<="T")h=String.fromCharCode(d.charCodeAt(0)+43);else if(d==="U")h="\0";else if(d==="V")h="@";else if(d==="W")h="`";else if(d==="X"||d==="Y"||d==="Z")h="";else throw new K;break;case"/":if(d>="A"&&d<="O")h=String.fromCharCode(d.charCodeAt(0)-32);else if(d==="Z")h=":";else throw new K;break}r+=h,l++}else r+=o}return r}}zt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",zt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],zt.ASTERISK_ENCODING=148;class ut extends It{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(t,n,r){let l=this.decodeStart(n),o=this.decodeEnd(n),d=new ve;ut.decodeMiddle(n,l[1],o[0],d);let h=d.toString(),g=null;r!=null&&(g=r.get(te.ALLOWED_LENGTHS)),g==null&&(g=ut.DEFAULT_ALLOWED_LENGTHS);let b=h.length,j=!1,I=0;for(let J of g){if(b===J){j=!0;break}J>I&&(I=J)}if(!j&&b>I&&(j=!0),!j)throw new K;const k=[new _e(l[1],t),new _e(o[0],t)];return new ye(h,null,0,k,Re.ITF,new Date().getTime())}static decodeMiddle(t,n,r,l){let o=new Int32Array(10),d=new Int32Array(5),h=new Int32Array(5);for(o.fill(0),d.fill(0),h.fill(0);n<r;){It.recordPattern(t,n,o);for(let b=0;b<5;b++){let j=2*b;d[b]=o[j],h[b]=o[j+1]}let g=ut.decodeDigit(d);l.append(g.toString()),g=this.decodeDigit(h),l.append(g.toString()),o.forEach(function(b){n+=b})}}decodeStart(t){let n=ut.skipWhiteSpace(t),r=ut.findGuardPattern(t,n,ut.START_PATTERN);return this.narrowLineWidth=(r[1]-r[0])/4,this.validateQuietZone(t,r[0]),r}validateQuietZone(t,n){let r=this.narrowLineWidth*10;r=r<n?r:n;for(let l=n-1;r>0&&l>=0&&!t.get(l);l--)r--;if(r!==0)throw new M}static skipWhiteSpace(t){const n=t.getSize(),r=t.getNextSet(0);if(r===n)throw new M;return r}decodeEnd(t){t.reverse();try{let n=ut.skipWhiteSpace(t),r;try{r=ut.findGuardPattern(t,n,ut.END_PATTERN_REVERSED[0])}catch(o){o instanceof M&&(r=ut.findGuardPattern(t,n,ut.END_PATTERN_REVERSED[1]))}this.validateQuietZone(t,r[0]);let l=r[0];return r[0]=t.getSize()-r[1],r[1]=t.getSize()-l,r}finally{t.reverse()}}static findGuardPattern(t,n,r){let l=r.length,o=new Int32Array(l),d=t.getSize(),h=!1,g=0,b=n;o.fill(0);for(let j=n;j<d;j++)if(t.get(j)!==h)o[g]++;else{if(g===l-1){if(It.patternMatchVariance(o,r,ut.MAX_INDIVIDUAL_VARIANCE)<ut.MAX_AVG_VARIANCE)return[b,j];b+=o[0]+o[1],F.arraycopy(o,2,o,0,g-1),o[g-1]=0,o[g]=0,g--}else g++;o[g]=1,h=!h}throw new M}static decodeDigit(t){let n=ut.MAX_AVG_VARIANCE,r=-1,l=ut.PATTERNS.length;for(let o=0;o<l;o++){let d=ut.PATTERNS[o],h=It.patternMatchVariance(t,d,ut.MAX_INDIVIDUAL_VARIANCE);h<n?(n=h,r=o):h===n&&(r=-1)}if(r>=0)return r%10;throw new M}}ut.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],ut.MAX_AVG_VARIANCE=.38,ut.MAX_INDIVIDUAL_VARIANCE=.5,ut.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],ut.START_PATTERN=Int32Array.from([1,1,1,1]),ut.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class hs extends It{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(t){let n=!1,r,l=0,o=Int32Array.from([0,0,0]);for(;!n;){o=Int32Array.from([0,0,0]),r=hs.findGuardPattern(t,l,!1,this.START_END_PATTERN,o);let d=r[0];l=r[1];let h=d-(l-d);h>=0&&(n=t.isRange(h,d,!1))}return r}static checkChecksum(t){return hs.checkStandardUPCEANChecksum(t)}static checkStandardUPCEANChecksum(t){let n=t.length;if(n===0)return!1;let r=parseInt(t.charAt(n-1),10);return hs.getStandardUPCEANChecksum(t.substring(0,n-1))===r}static getStandardUPCEANChecksum(t){let n=t.length,r=0;for(let l=n-1;l>=0;l-=2){let o=t.charAt(l).charCodeAt(0)-48;if(o<0||o>9)throw new K;r+=o}r*=3;for(let l=n-2;l>=0;l-=2){let o=t.charAt(l).charCodeAt(0)-48;if(o<0||o>9)throw new K;r+=o}return(1e3-r)%10}static decodeEnd(t,n){return hs.findGuardPattern(t,n,!1,hs.START_END_PATTERN,new Int32Array(hs.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(t,n,r,l){return this.findGuardPattern(t,n,r,l,new Int32Array(l.length))}static findGuardPattern(t,n,r,l,o){let d=t.getSize();n=r?t.getNextUnset(n):t.getNextSet(n);let h=0,g=n,b=l.length,j=r;for(let I=n;I<d;I++)if(t.get(I)!==j)o[h]++;else{if(h===b-1){if(It.patternMatchVariance(o,l,hs.MAX_INDIVIDUAL_VARIANCE)<hs.MAX_AVG_VARIANCE)return Int32Array.from([g,I]);g+=o[0]+o[1];let k=o.slice(2,o.length-1);for(let G=0;G<h-1;G++)o[G]=k[G];o[h-1]=0,o[h]=0,h--}else h++;o[h]=1,j=!j}throw new M}static decodeDigit(t,n,r,l){this.recordPattern(t,r,n);let o=this.MAX_AVG_VARIANCE,d=-1,h=l.length;for(let g=0;g<h;g++){let b=l[g],j=It.patternMatchVariance(n,b,hs.MAX_INDIVIDUAL_VARIANCE);j<o&&(o=j,d=g)}if(d>=0)return d;throw new M}}hs.MAX_AVG_VARIANCE=.48,hs.MAX_INDIVIDUAL_VARIANCE=.7,hs.START_END_PATTERN=Int32Array.from([1,1,1]),hs.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),hs.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),hs.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Vr{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(t,n,r){let l=this.decodeRowStringBuffer,o=this.decodeMiddle(n,r,l),d=l.toString(),h=Vr.parseExtensionString(d),g=[new _e((r[0]+r[1])/2,t),new _e(o,t)],b=new ye(d,null,0,g,Re.UPC_EAN_EXTENSION,new Date().getTime());return h!=null&&b.putAllMetadata(h),b}decodeMiddle(t,n,r){let l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let o=t.getSize(),d=n[1],h=0;for(let b=0;b<5&&d<o;b++){let j=hs.decodeDigit(t,l,d,hs.L_AND_G_PATTERNS);r+=String.fromCharCode(48+j%10);for(let I of l)d+=I;j>=10&&(h|=1<<4-b),b!==4&&(d=t.getNextSet(d),d=t.getNextUnset(d))}if(r.length!==5)throw new M;let g=this.determineCheckDigit(h);if(Vr.extensionChecksum(r.toString())!==g)throw new M;return d}static extensionChecksum(t){let n=t.length,r=0;for(let l=n-2;l>=0;l-=2)r+=t.charAt(l).charCodeAt(0)-48;r*=3;for(let l=n-1;l>=0;l-=2)r+=t.charAt(l).charCodeAt(0)-48;return r*=3,r%10}determineCheckDigit(t){for(let n=0;n<10;n++)if(t===this.CHECK_DIGIT_ENCODINGS[n])return n;throw new M}static parseExtensionString(t){if(t.length!==5)return null;let n=Vr.parseExtension5String(t);return n==null?null:new Map([[et.SUGGESTED_PRICE,n]])}static parseExtension5String(t){let n;switch(t.charAt(0)){case"0":n="";break;case"5":n="$";break;case"9":switch(t){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}n="";break;default:n="";break}let r=parseInt(t.substring(1)),l=(r/100).toString(),o=r%100,d=o<10?"0"+o:o.toString();return n+l+"."+d}}class ol{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(t,n,r){let l=this.decodeRowStringBuffer,o=this.decodeMiddle(n,r,l),d=l.toString(),h=ol.parseExtensionString(d),g=[new _e((r[0]+r[1])/2,t),new _e(o,t)],b=new ye(d,null,0,g,Re.UPC_EAN_EXTENSION,new Date().getTime());return h!=null&&b.putAllMetadata(h),b}decodeMiddle(t,n,r){let l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let o=t.getSize(),d=n[1],h=0;for(let g=0;g<2&&d<o;g++){let b=hs.decodeDigit(t,l,d,hs.L_AND_G_PATTERNS);r+=String.fromCharCode(48+b%10);for(let j of l)d+=j;b>=10&&(h|=1<<1-g),g!==1&&(d=t.getNextSet(d),d=t.getNextUnset(d))}if(r.length!==2)throw new M;if(parseInt(r.toString())%4!==h)throw new M;return d}static parseExtensionString(t){return t.length!==2?null:new Map([[et.ISSUE_NUMBER,parseInt(t)]])}}class Gr{static decodeRow(t,n,r){let l=hs.findGuardPattern(n,r,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Vr().decodeRow(t,n,l)}catch{return new ol().decodeRow(t,n,l)}}}Gr.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Ct extends hs{constructor(){super(),this.decodeRowStringBuffer="",Ct.L_AND_G_PATTERNS=Ct.L_PATTERNS.map(t=>Int32Array.from(t));for(let t=10;t<20;t++){let n=Ct.L_PATTERNS[t-10],r=new Int32Array(n.length);for(let l=0;l<n.length;l++)r[l]=n[n.length-l-1];Ct.L_AND_G_PATTERNS[t]=r}}decodeRow(t,n,r){let l=Ct.findStartGuardPattern(n),o=r==null?null:r.get(te.NEED_RESULT_POINT_CALLBACK);if(o!=null){const Ie=new _e((l[0]+l[1])/2,t);o.foundPossibleResultPoint(Ie)}let d=this.decodeMiddle(n,l,this.decodeRowStringBuffer),h=d.rowOffset,g=d.resultString;if(o!=null){const Ie=new _e(h,t);o.foundPossibleResultPoint(Ie)}let b=this.decodeEnd(n,h);if(o!=null){const Ie=new _e((b[0]+b[1])/2,t);o.foundPossibleResultPoint(Ie)}let j=b[1],I=j+(j-b[0]);if(I>=n.getSize()||!n.isRange(j,I,!1))throw new M;let k=g.toString();if(k.length<8)throw new K;if(!Ct.checkChecksum(k))throw new z;let G=(l[1]+l[0])/2,J=(b[1]+b[0])/2,ee=this.getBarcodeFormat(),ue=[new _e(G,t),new _e(J,t)],be=new ye(k,null,0,ue,ee,new Date().getTime()),Be=0;try{let Ie=Gr.decodeRow(t,n,b[1]);be.putMetadata(et.UPC_EAN_EXTENSION,Ie.getText()),be.putAllMetadata(Ie.getResultMetadata()),be.addResultPoints(Ie.getResultPoints()),Be=Ie.getText().length}catch{}let Me=r==null?null:r.get(te.ALLOWED_EAN_EXTENSIONS);if(Me!=null){let Ie=!1;for(let mt in Me)if(Be.toString()===mt){Ie=!0;break}if(!Ie)throw new M}return be}decodeEnd(t,n){return Ct.findGuardPattern(t,n,!1,Ct.START_END_PATTERN,new Int32Array(Ct.START_END_PATTERN.length).fill(0))}static checkChecksum(t){return Ct.checkStandardUPCEANChecksum(t)}static checkStandardUPCEANChecksum(t){let n=t.length;if(n===0)return!1;let r=parseInt(t.charAt(n-1),10);return Ct.getStandardUPCEANChecksum(t.substring(0,n-1))===r}static getStandardUPCEANChecksum(t){let n=t.length,r=0;for(let l=n-1;l>=0;l-=2){let o=t.charAt(l).charCodeAt(0)-48;if(o<0||o>9)throw new K;r+=o}r*=3;for(let l=n-2;l>=0;l-=2){let o=t.charAt(l).charCodeAt(0)-48;if(o<0||o>9)throw new K;r+=o}return(1e3-r)%10}}class Ma extends Ct{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(t,n,r){let l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let o=t.getSize(),d=n[1],h=0;for(let b=0;b<6&&d<o;b++){let j=Ct.decodeDigit(t,l,d,Ct.L_AND_G_PATTERNS);r+=String.fromCharCode(48+j%10);for(let I of l)d+=I;j>=10&&(h|=1<<5-b)}r=Ma.determineFirstDigit(r,h),d=Ct.findGuardPattern(t,d,!0,Ct.MIDDLE_PATTERN,new Int32Array(Ct.MIDDLE_PATTERN.length).fill(0))[1];for(let b=0;b<6&&d<o;b++){let j=Ct.decodeDigit(t,l,d,Ct.L_PATTERNS);r+=String.fromCharCode(48+j);for(let I of l)d+=I}return{rowOffset:d,resultString:r}}getBarcodeFormat(){return Re.EAN_13}static determineFirstDigit(t,n){for(let r=0;r<10;r++)if(n===this.FIRST_DIGIT_ENCODINGS[r])return t=String.fromCharCode(48+r)+t,t;throw new M}}Ma.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class nn extends Ct{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(t,n,r){const l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let o=t.getSize(),d=n[1];for(let g=0;g<4&&d<o;g++){let b=Ct.decodeDigit(t,l,d,Ct.L_PATTERNS);r+=String.fromCharCode(48+b);for(let j of l)d+=j}d=Ct.findGuardPattern(t,d,!0,Ct.MIDDLE_PATTERN,new Int32Array(Ct.MIDDLE_PATTERN.length).fill(0))[1];for(let g=0;g<4&&d<o;g++){let b=Ct.decodeDigit(t,l,d,Ct.L_PATTERNS);r+=String.fromCharCode(48+b);for(let j of l)d+=j}return{rowOffset:d,resultString:r}}getBarcodeFormat(){return Re.EAN_8}}class Xr extends Ct{constructor(){super(...arguments),this.ean13Reader=new Ma}getBarcodeFormat(){return Re.UPC_A}decode(t,n){return this.maybeReturnResult(this.ean13Reader.decode(t))}decodeRow(t,n,r){return this.maybeReturnResult(this.ean13Reader.decodeRow(t,n,r))}decodeMiddle(t,n,r){return this.ean13Reader.decodeMiddle(t,n,r)}maybeReturnResult(t){let n=t.getText();if(n.charAt(0)==="0"){let r=new ye(n.substring(1),null,null,t.getResultPoints(),Re.UPC_A);return t.getResultMetadata()!=null&&r.putAllMetadata(t.getResultMetadata()),r}else throw new M}reset(){this.ean13Reader.reset()}}class Xs extends Ct{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(t,n,r){const l=this.decodeMiddleCounters.map(b=>b);l[0]=0,l[1]=0,l[2]=0,l[3]=0;const o=t.getSize();let d=n[1],h=0;for(let b=0;b<6&&d<o;b++){const j=Xs.decodeDigit(t,l,d,Xs.L_AND_G_PATTERNS);r+=String.fromCharCode(48+j%10);for(let I of l)d+=I;j>=10&&(h|=1<<5-b)}let g=Xs.determineNumSysAndCheckDigit(r,h);return{rowOffset:d,resultString:g}}decodeEnd(t,n){return Xs.findGuardPatternWithoutCounters(t,n,!0,Xs.MIDDLE_END_PATTERN)}checkChecksum(t){return Ct.checkChecksum(Xs.convertUPCEtoUPCA(t))}static determineNumSysAndCheckDigit(t,n){for(let r=0;r<=1;r++)for(let l=0;l<10;l++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[r][l]){let o=String.fromCharCode(48+r),d=String.fromCharCode(48+l);return o+t+d}throw M.getNotFoundInstance()}getBarcodeFormat(){return Re.UPC_E}static convertUPCEtoUPCA(t){const n=t.slice(1,7).split("").map(o=>o.charCodeAt(0)),r=new ve;r.append(t.charAt(0));let l=n[5];switch(l){case 0:case 1:case 2:r.appendChars(n,0,2),r.append(l),r.append("0000"),r.appendChars(n,2,3);break;case 3:r.appendChars(n,0,3),r.append("00000"),r.appendChars(n,3,2);break;case 4:r.appendChars(n,0,4),r.append("00000"),r.append(n[4]);break;default:r.appendChars(n,0,5),r.append("0000"),r.append(l);break}return t.length>=8&&r.append(t.charAt(7)),r.toString()}}Xs.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Xs.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class cl extends It{constructor(t){super();let n=t==null?null:t.get(te.POSSIBLE_FORMATS),r=[];y(n)?(r.push(new Ma),r.push(new Xr),r.push(new nn),r.push(new Xs)):(n.indexOf(Re.EAN_13)>-1&&r.push(new Ma),n.indexOf(Re.UPC_A)>-1&&r.push(new Xr),n.indexOf(Re.EAN_8)>-1&&r.push(new nn),n.indexOf(Re.UPC_E)>-1&&r.push(new Xs)),this.readers=r}decodeRow(t,n,r){for(let l of this.readers)try{const o=l.decodeRow(t,n,r),d=o.getBarcodeFormat()===Re.EAN_13&&o.getText().charAt(0)==="0",h=r==null?null:r.get(te.POSSIBLE_FORMATS),g=h==null||h.includes(Re.UPC_A);if(d&&g){const b=o.getRawBytes(),j=new ye(o.getText().substring(1),b,b?b.length:null,o.getResultPoints(),Re.UPC_A);return j.putAllMetadata(o.getResultMetadata()),j}return o}catch{}throw new M}reset(){for(let t of this.readers)t.reset()}}class Ls extends It{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(t,n){for(let r=0;r<n.length;r++)if(It.patternMatchVariance(t,n[r],Ls.MAX_INDIVIDUAL_VARIANCE)<Ls.MAX_AVG_VARIANCE)return r;throw new M}static count(t){return de.sum(new Int32Array(t))}static increment(t,n){let r=0,l=n[0];for(let o=1;o<t.length;o++)n[o]>l&&(l=n[o],r=o);t[r]++}static decrement(t,n){let r=0,l=n[0];for(let o=1;o<t.length;o++)n[o]<l&&(l=n[o],r=o);t[r]--}static isFinderPattern(t){let n=t[0]+t[1],r=n+t[2]+t[3],l=n/r;if(l>=Ls.MIN_FINDER_PATTERN_RATIO&&l<=Ls.MAX_FINDER_PATTERN_RATIO){let o=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER;for(let h of t)h>d&&(d=h),h<o&&(o=h);return d<10*o}return!1}}Ls.MAX_AVG_VARIANCE=.2,Ls.MAX_INDIVIDUAL_VARIANCE=.45,Ls.MIN_FINDER_PATTERN_RATIO=9.5/12,Ls.MAX_FINDER_PATTERN_RATIO=12.5/14;class rn{constructor(t,n){this.value=t,this.checksumPortion=n}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(t){if(!(t instanceof rn))return!1;const n=t;return this.value===n.value&&this.checksumPortion===n.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class ln{constructor(t,n,r,l,o){this.value=t,this.startEnd=n,this.value=t,this.startEnd=n,this.resultPoints=new Array,this.resultPoints.push(new _e(r,o)),this.resultPoints.push(new _e(l,o))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(t){if(!(t instanceof ln))return!1;const n=t;return this.value===n.value}hashCode(){return this.value}}class ka{constructor(){}static getRSSvalue(t,n,r){let l=0;for(let g of t)l+=g;let o=0,d=0,h=t.length;for(let g=0;g<h-1;g++){let b;for(b=1,d|=1<<g;b<t[g];b++,d&=~(1<<g)){let j=ka.combins(l-b-1,h-g-2);if(r&&d===0&&l-b-(h-g-1)>=h-g-1&&(j-=ka.combins(l-b-(h-g),h-g-2)),h-g-1>1){let I=0;for(let k=l-b-(h-g-2);k>n;k--)I+=ka.combins(l-b-k-1,h-g-3);j-=I*(h-1-g)}else l-b>n&&j--;o+=j}l-=b}return o}static combins(t,n){let r,l;t-n>n?(l=n,r=t-n):(l=t-n,r=n);let o=1,d=1;for(let h=t;h>r;h--)o*=h,d<=l&&(o/=d,d++);for(;d<=l;)o/=d,d++;return o}}class co{static buildBitArray(t){let n=t.length*2-1;t[t.length-1].getRightChar()==null&&(n-=1);let r=12*n,l=new oe(r),o=0,h=t[0].getRightChar().getValue();for(let g=11;g>=0;--g)(h&1<<g)!=0&&l.set(o),o++;for(let g=1;g<t.length;++g){let b=t[g],j=b.getLeftChar().getValue();for(let I=11;I>=0;--I)(j&1<<I)!=0&&l.set(o),o++;if(b.getRightChar()!=null){let I=b.getRightChar().getValue();for(let k=11;k>=0;--k)(I&1<<k)!=0&&l.set(o),o++}}return l}}class on{constructor(t,n){n?this.decodedInformation=null:(this.finished=t,this.decodedInformation=n)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class pi{constructor(t){this.newPosition=t}getNewPosition(){return this.newPosition}}class Hs extends pi{constructor(t,n){super(t),this.value=n}getValue(){return this.value}isFNC1(){return this.value===Hs.FNC1}}Hs.FNC1="$";class qa extends pi{constructor(t,n,r){super(t),r?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=n}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class ta extends pi{constructor(t,n,r){if(super(t),n<0||n>10||r<0||r>10)throw new K;this.firstDigit=n,this.secondDigit=r}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===ta.FNC1}isSecondDigitFNC1(){return this.secondDigit===ta.FNC1}isAnyFNC1(){return this.firstDigit===ta.FNC1||this.secondDigit===ta.FNC1}}ta.FNC1=10;class ze{constructor(){}static parseFieldsInGeneralPurpose(t){if(!t)return null;if(t.length<2)throw new M;let n=t.substring(0,2);for(let o of ze.TWO_DIGIT_DATA_LENGTH)if(o[0]===n)return o[1]===ze.VARIABLE_LENGTH?ze.processVariableAI(2,o[2],t):ze.processFixedAI(2,o[1],t);if(t.length<3)throw new M;let r=t.substring(0,3);for(let o of ze.THREE_DIGIT_DATA_LENGTH)if(o[0]===r)return o[1]===ze.VARIABLE_LENGTH?ze.processVariableAI(3,o[2],t):ze.processFixedAI(3,o[1],t);for(let o of ze.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(o[0]===r)return o[1]===ze.VARIABLE_LENGTH?ze.processVariableAI(4,o[2],t):ze.processFixedAI(4,o[1],t);if(t.length<4)throw new M;let l=t.substring(0,4);for(let o of ze.FOUR_DIGIT_DATA_LENGTH)if(o[0]===l)return o[1]===ze.VARIABLE_LENGTH?ze.processVariableAI(4,o[2],t):ze.processFixedAI(4,o[1],t);throw new M}static processFixedAI(t,n,r){if(r.length<t)throw new M;let l=r.substring(0,t);if(r.length<t+n)throw new M;let o=r.substring(t,t+n),d=r.substring(t+n),h="("+l+")"+o,g=ze.parseFieldsInGeneralPurpose(d);return g==null?h:h+g}static processVariableAI(t,n,r){let l=r.substring(0,t),o;r.length<t+n?o=r.length:o=t+n;let d=r.substring(t,o),h=r.substring(o),g="("+l+")"+d,b=ze.parseFieldsInGeneralPurpose(h);return b==null?g:g+b}}ze.VARIABLE_LENGTH=[],ze.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",ze.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",ze.VARIABLE_LENGTH,20],["22",ze.VARIABLE_LENGTH,29],["30",ze.VARIABLE_LENGTH,8],["37",ze.VARIABLE_LENGTH,8],["90",ze.VARIABLE_LENGTH,30],["91",ze.VARIABLE_LENGTH,30],["92",ze.VARIABLE_LENGTH,30],["93",ze.VARIABLE_LENGTH,30],["94",ze.VARIABLE_LENGTH,30],["95",ze.VARIABLE_LENGTH,30],["96",ze.VARIABLE_LENGTH,30],["97",ze.VARIABLE_LENGTH,3],["98",ze.VARIABLE_LENGTH,30],["99",ze.VARIABLE_LENGTH,30]],ze.THREE_DIGIT_DATA_LENGTH=[["240",ze.VARIABLE_LENGTH,30],["241",ze.VARIABLE_LENGTH,30],["242",ze.VARIABLE_LENGTH,6],["250",ze.VARIABLE_LENGTH,30],["251",ze.VARIABLE_LENGTH,30],["253",ze.VARIABLE_LENGTH,17],["254",ze.VARIABLE_LENGTH,20],["400",ze.VARIABLE_LENGTH,30],["401",ze.VARIABLE_LENGTH,30],["402",17],["403",ze.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",ze.VARIABLE_LENGTH,20],["421",ze.VARIABLE_LENGTH,15],["422",3],["423",ze.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],ze.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",ze.VARIABLE_LENGTH,15],["391",ze.VARIABLE_LENGTH,18],["392",ze.VARIABLE_LENGTH,15],["393",ze.VARIABLE_LENGTH,18],["703",ze.VARIABLE_LENGTH,30]],ze.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",ze.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",ze.VARIABLE_LENGTH,20],["8003",ze.VARIABLE_LENGTH,30],["8004",ze.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",ze.VARIABLE_LENGTH,30],["8008",ze.VARIABLE_LENGTH,12],["8018",18],["8020",ze.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",ze.VARIABLE_LENGTH,70],["8200",ze.VARIABLE_LENGTH,70]];class sa{constructor(t){this.buffer=new ve,this.information=t}decodeAllCodes(t,n){let r=n,l=null;do{let o=this.decodeGeneralPurposeField(r,l),d=ze.parseFieldsInGeneralPurpose(o.getNewString());if(d!=null&&t.append(d),o.isRemaining()?l=""+o.getRemainingValue():l=null,r===o.getNewPosition())break;r=o.getNewPosition()}while(!0);return t.toString()}isStillNumeric(t){if(t+7>this.information.getSize())return t+4<=this.information.getSize();for(let n=t;n<t+3;++n)if(this.information.get(n))return!0;return this.information.get(t+3)}decodeNumeric(t){if(t+7>this.information.getSize()){let o=this.extractNumericValueFromBitArray(t,4);return o===0?new ta(this.information.getSize(),ta.FNC1,ta.FNC1):new ta(this.information.getSize(),o-1,ta.FNC1)}let n=this.extractNumericValueFromBitArray(t,7),r=(n-8)/11,l=(n-8)%11;return new ta(t+7,r,l)}extractNumericValueFromBitArray(t,n){return sa.extractNumericValueFromBitArray(this.information,t,n)}static extractNumericValueFromBitArray(t,n,r){let l=0;for(let o=0;o<r;++o)t.get(n+o)&&(l|=1<<r-o-1);return l}decodeGeneralPurposeField(t,n){this.buffer.setLengthToZero(),n!=null&&this.buffer.append(n),this.current.setPosition(t);let r=this.parseBlocks();return r!=null&&r.isRemaining()?new qa(this.current.getPosition(),this.buffer.toString(),r.getRemainingValue()):new qa(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let t,n;do{let r=this.current.getPosition();if(this.current.isAlpha()?(n=this.parseAlphaBlock(),t=n.isFinished()):this.current.isIsoIec646()?(n=this.parseIsoIec646Block(),t=n.isFinished()):(n=this.parseNumericBlock(),t=n.isFinished()),!(r!==this.current.getPosition())&&!t)break}while(!t);return n.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let t=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFirstDigitFNC1()){let n;return t.isSecondDigitFNC1()?n=new qa(this.current.getPosition(),this.buffer.toString()):n=new qa(this.current.getPosition(),this.buffer.toString(),t.getSecondDigit()),new on(!0,n)}if(this.buffer.append(t.getFirstDigit()),t.isSecondDigitFNC1()){let n=new qa(this.current.getPosition(),this.buffer.toString());return new on(!0,n)}this.buffer.append(t.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new on(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let t=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){let n=new qa(this.current.getPosition(),this.buffer.toString());return new on(!0,n)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new on(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let t=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){let n=new qa(this.current.getPosition(),this.buffer.toString());return new on(!0,n)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new on(!1)}isStillIsoIec646(t){if(t+5>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(t,5);if(n>=5&&n<16)return!0;if(t+7>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(t,7);if(r>=64&&r<116)return!0;if(t+8>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(t,8);return l>=232&&l<253}decodeIsoIec646(t){let n=this.extractNumericValueFromBitArray(t,5);if(n===15)return new Hs(t+5,Hs.FNC1);if(n>=5&&n<15)return new Hs(t+5,"0"+(n-5));let r=this.extractNumericValueFromBitArray(t,7);if(r>=64&&r<90)return new Hs(t+7,""+(r+1));if(r>=90&&r<116)return new Hs(t+7,""+(r+7));let l=this.extractNumericValueFromBitArray(t,8),o;switch(l){case 232:o="!";break;case 233:o='"';break;case 234:o="%";break;case 235:o="&";break;case 236:o="'";break;case 237:o="(";break;case 238:o=")";break;case 239:o="*";break;case 240:o="+";break;case 241:o=",";break;case 242:o="-";break;case 243:o=".";break;case 244:o="/";break;case 245:o=":";break;case 246:o=";";break;case 247:o="<";break;case 248:o="=";break;case 249:o=">";break;case 250:o="?";break;case 251:o="_";break;case 252:o=" ";break;default:throw new K}return new Hs(t+8,o)}isStillAlpha(t){if(t+5>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(t,5);if(n>=5&&n<16)return!0;if(t+6>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(t,6);return r>=16&&r<63}decodeAlphanumeric(t){let n=this.extractNumericValueFromBitArray(t,5);if(n===15)return new Hs(t+5,Hs.FNC1);if(n>=5&&n<15)return new Hs(t+5,"0"+(n-5));let r=this.extractNumericValueFromBitArray(t,6);if(r>=32&&r<58)return new Hs(t+6,""+(r+33));let l;switch(r){case 58:l="*";break;case 59:l=",";break;case 60:l="-";break;case 61:l=".";break;case 62:l="/";break;default:throw new Bs("Decoding invalid alphanumeric value: "+r)}return new Hs(t+6,l)}isAlphaTo646ToAlphaLatch(t){if(t+1>this.information.getSize())return!1;for(let n=0;n<5&&n+t<this.information.getSize();++n)if(n===2){if(!this.information.get(t+2))return!1}else if(this.information.get(t+n))return!1;return!0}isAlphaOr646ToNumericLatch(t){if(t+3>this.information.getSize())return!1;for(let n=t;n<t+3;++n)if(this.information.get(n))return!1;return!0}isNumericToAlphaNumericLatch(t){if(t+1>this.information.getSize())return!1;for(let n=0;n<4&&n+t<this.information.getSize();++n)if(this.information.get(t+n))return!1;return!0}}class Cs{constructor(t){this.information=t,this.generalDecoder=new sa(t)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Yt extends Cs{constructor(t){super(t)}encodeCompressedGtin(t,n){t.append("(01)");let r=t.length();t.append("9"),this.encodeCompressedGtinWithoutAI(t,n,r)}encodeCompressedGtinWithoutAI(t,n,r){for(let l=0;l<4;++l){let o=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*l,10);o/100===0&&t.append("0"),o/10===0&&t.append("0"),t.append(o)}Yt.appendCheckDigit(t,r)}static appendCheckDigit(t,n){let r=0;for(let l=0;l<13;l++){let o=t.charAt(l+n).charCodeAt(0)-48;r+=(l&1)===0?3*o:o}r=10-r%10,r===10&&(r=0),t.append(r)}}Yt.GTIN_SIZE=40;class va extends Yt{constructor(t){super(t)}parseInformation(){let t=new ve;t.append("(01)");let n=t.length(),r=this.getGeneralDecoder().extractNumericValueFromBitArray(va.HEADER_SIZE,4);return t.append(r),this.encodeCompressedGtinWithoutAI(t,va.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(t,va.HEADER_SIZE+44)}}va.HEADER_SIZE=4;class Qn extends Cs{constructor(t){super(t)}parseInformation(){let t=new ve;return this.getGeneralDecoder().decodeAllCodes(t,Qn.HEADER_SIZE)}}Qn.HEADER_SIZE=5;class yi extends Yt{constructor(t){super(t)}encodeCompressedWeight(t,n,r){let l=this.getGeneralDecoder().extractNumericValueFromBitArray(n,r);this.addWeightCode(t,l);let o=this.checkWeight(l),d=1e5;for(let h=0;h<5;++h)o/d===0&&t.append("0"),d/=10;t.append(o)}}class Ba extends yi{constructor(t){super(t)}parseInformation(){if(this.getInformation().getSize()!=Ba.HEADER_SIZE+yi.GTIN_SIZE+Ba.WEIGHT_SIZE)throw new M;let t=new ve;return this.encodeCompressedGtin(t,Ba.HEADER_SIZE),this.encodeCompressedWeight(t,Ba.HEADER_SIZE+yi.GTIN_SIZE,Ba.WEIGHT_SIZE),t.toString()}}Ba.HEADER_SIZE=5,Ba.WEIGHT_SIZE=15;class uo extends Ba{constructor(t){super(t)}addWeightCode(t,n){t.append("(3103)")}checkWeight(t){return t}}class Yr extends Ba{constructor(t){super(t)}addWeightCode(t,n){n<1e4?t.append("(3202)"):t.append("(3203)")}checkWeight(t){return t<1e4?t:t-1e4}}class oa extends Yt{constructor(t){super(t)}parseInformation(){if(this.getInformation().getSize()<oa.HEADER_SIZE+Yt.GTIN_SIZE)throw new M;let t=new ve;this.encodeCompressedGtin(t,oa.HEADER_SIZE);let n=this.getGeneralDecoder().extractNumericValueFromBitArray(oa.HEADER_SIZE+Yt.GTIN_SIZE,oa.LAST_DIGIT_SIZE);t.append("(392"),t.append(n),t.append(")");let r=this.getGeneralDecoder().decodeGeneralPurposeField(oa.HEADER_SIZE+Yt.GTIN_SIZE+oa.LAST_DIGIT_SIZE,null);return t.append(r.getNewString()),t.toString()}}oa.HEADER_SIZE=8,oa.LAST_DIGIT_SIZE=2;class ms extends Yt{constructor(t){super(t)}parseInformation(){if(this.getInformation().getSize()<ms.HEADER_SIZE+Yt.GTIN_SIZE)throw new M;let t=new ve;this.encodeCompressedGtin(t,ms.HEADER_SIZE);let n=this.getGeneralDecoder().extractNumericValueFromBitArray(ms.HEADER_SIZE+Yt.GTIN_SIZE,ms.LAST_DIGIT_SIZE);t.append("(393"),t.append(n),t.append(")");let r=this.getGeneralDecoder().extractNumericValueFromBitArray(ms.HEADER_SIZE+Yt.GTIN_SIZE+ms.LAST_DIGIT_SIZE,ms.FIRST_THREE_DIGITS_SIZE);r/100==0&&t.append("0"),r/10==0&&t.append("0"),t.append(r);let l=this.getGeneralDecoder().decodeGeneralPurposeField(ms.HEADER_SIZE+Yt.GTIN_SIZE+ms.LAST_DIGIT_SIZE+ms.FIRST_THREE_DIGITS_SIZE,null);return t.append(l.getNewString()),t.toString()}}ms.HEADER_SIZE=8,ms.LAST_DIGIT_SIZE=2,ms.FIRST_THREE_DIGITS_SIZE=10;class Lt extends yi{constructor(t,n,r){super(t),this.dateCode=r,this.firstAIdigits=n}parseInformation(){if(this.getInformation().getSize()!=Lt.HEADER_SIZE+Lt.GTIN_SIZE+Lt.WEIGHT_SIZE+Lt.DATE_SIZE)throw new M;let t=new ve;return this.encodeCompressedGtin(t,Lt.HEADER_SIZE),this.encodeCompressedWeight(t,Lt.HEADER_SIZE+Lt.GTIN_SIZE,Lt.WEIGHT_SIZE),this.encodeCompressedDate(t,Lt.HEADER_SIZE+Lt.GTIN_SIZE+Lt.WEIGHT_SIZE),t.toString()}encodeCompressedDate(t,n){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(n,Lt.DATE_SIZE);if(r==38400)return;t.append("("),t.append(this.dateCode),t.append(")");let l=r%32;r/=32;let o=r%12+1;r/=12;let d=r;d/10==0&&t.append("0"),t.append(d),o/10==0&&t.append("0"),t.append(o),l/10==0&&t.append("0"),t.append(l)}addWeightCode(t,n){t.append("("),t.append(this.firstAIdigits),t.append(n/1e5),t.append(")")}checkWeight(t){return t%1e5}}Lt.HEADER_SIZE=8,Lt.WEIGHT_SIZE=20,Lt.DATE_SIZE=16;function Jn(_){try{if(_.get(1))return new va(_);if(!_.get(2))return new Qn(_);switch(sa.extractNumericValueFromBitArray(_,1,4)){case 4:return new uo(_);case 5:return new Yr(_)}switch(sa.extractNumericValueFromBitArray(_,1,5)){case 12:return new oa(_);case 13:return new ms(_)}switch(sa.extractNumericValueFromBitArray(_,1,7)){case 56:return new Lt(_,"310","11");case 57:return new Lt(_,"320","11");case 58:return new Lt(_,"310","13");case 59:return new Lt(_,"320","13");case 60:return new Lt(_,"310","15");case 61:return new Lt(_,"320","15");case 62:return new Lt(_,"310","17");case 63:return new Lt(_,"320","17")}}catch(t){throw console.log(t),new Bs("unknown decoder: "+_)}}class aa{constructor(t,n,r,l){this.leftchar=t,this.rightchar=n,this.finderpattern=r,this.maybeLast=l}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(t,n){return t instanceof aa?aa.equalsOrNull(t.leftchar,n.leftchar)&&aa.equalsOrNull(t.rightchar,n.rightchar)&&aa.equalsOrNull(t.finderpattern,n.finderpattern):!1}static equalsOrNull(t,n){return t===null?n===null:aa.equals(t,n)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class gs{constructor(t,n,r){this.pairs=t,this.rowNumber=n,this.wasReversed=r}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(t){return this.checkEqualitity(this,t)}toString(){return"{ "+this.pairs+" }"}equals(t,n){return t instanceof gs?this.checkEqualitity(t,n)&&t.wasReversed===n.wasReversed:!1}checkEqualitity(t,n){if(!t||!n)return;let r;return t.forEach((l,o)=>{n.forEach(d=>{l.getLeftChar().getValue()===d.getLeftChar().getValue()&&l.getRightChar().getValue()===d.getRightChar().getValue()&&l.getFinderPatter().getValue()===d.getFinderPatter().getValue()&&(r=!0)})}),r}}class De extends Ls{constructor(t){super(...arguments),this.pairs=new Array(De.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=t===!0}decodeRow(t,n,r){this.pairs.length=0,this.startFromEven=!1;try{return De.constructResult(this.decodeRow2pairs(t,n))}catch(l){this.verbose&&console.log(l)}return this.pairs.length=0,this.startFromEven=!0,De.constructResult(this.decodeRow2pairs(t,n))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(t,n){let r=!1;for(;!r;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,t))}catch(o){if(o instanceof M){if(!this.pairs.length)throw new M;r=!0}}if(this.checkChecksum())return this.pairs;let l;if(this.rows.length?l=!0:l=!1,this.storeRow(t,!1),l){let o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new M}checkRowsBoolean(t){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,t&&(this.rows=this.rows.reverse());let n=null;try{n=this.checkRows(new Array,0)}catch(r){this.verbose&&console.log(r)}return t&&(this.rows=this.rows.reverse()),n}checkRows(t,n){for(let r=n;r<this.rows.length;r++){let l=this.rows[r];this.pairs.length=0;for(let d of t)this.pairs.push(d.getPairs());if(this.pairs.push(l.getPairs()),!De.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let o=new Array(t);o.push(l);try{return this.checkRows(o,r+1)}catch(d){this.verbose&&console.log(d)}}throw new M}static isValidSequence(t){for(let n of De.FINDER_PATTERN_SEQUENCES){if(t.length>n.length)continue;let r=!0;for(let l=0;l<t.length;l++)if(t[l].getFinderPattern().getValue()!=n[l]){r=!1;break}if(r)return!0}return!1}storeRow(t,n){let r=0,l=!1,o=!1;for(;r<this.rows.length;){let d=this.rows[r];if(d.getRowNumber()>t){o=d.isEquivalent(this.pairs);break}l=d.isEquivalent(this.pairs),r++}o||l||De.isPartialRow(this.pairs,this.rows)||(this.rows.push(r,new gs(this.pairs,t,n)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(t,n){for(let r of n)if(r.getPairs().length!==t.length){for(let l of r.getPairs())for(let o of t)if(aa.equals(l,o))break}}static isPartialRow(t,n){for(let r of n){let l=!0;for(let o of t){let d=!1;for(let h of r.getPairs())if(o.equals(h)){d=!0;break}if(!d){l=!1;break}}if(l)return!0}return!1}getRows(){return this.rows}static constructResult(t){let n=co.buildBitArray(t),l=Jn(n).parseInformation(),o=t[0].getFinderPattern().getResultPoints(),d=t[t.length-1].getFinderPattern().getResultPoints(),h=[o[0],o[1],d[0],d[1]];return new ye(l,null,null,h,Re.RSS_EXPANDED,null)}checkChecksum(){let t=this.pairs.get(0),n=t.getLeftChar(),r=t.getRightChar();if(r==null)return!1;let l=r.getChecksumPortion(),o=2;for(let h=1;h<this.pairs.size();++h){let g=this.pairs.get(h);l+=g.getLeftChar().getChecksumPortion(),o++;let b=g.getRightChar();b!=null&&(l+=b.getChecksumPortion(),o++)}return l%=211,211*(o-4)+l==n.getValue()}static getNextSecondBar(t,n){let r;return t.get(n)?(r=t.getNextUnset(n),r=t.getNextSet(r)):(r=t.getNextSet(n),r=t.getNextUnset(r)),r}retrieveNextPair(t,n,r){let l=n.length%2==0;this.startFromEven&&(l=!l);let o,d=!0,h=-1;do this.findNextPair(t,n,h),o=this.parseFoundFinderPattern(t,r,l),o==null?h=De.getNextSecondBar(t,this.startEnd[0]):d=!1;while(d);let g=this.decodeDataCharacter(t,o,l,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new M;let b;try{b=this.decodeDataCharacter(t,o,l,!1)}catch(j){b=null,this.verbose&&console.log(j)}return new aa(g,b,o,!0)}isEmptyPair(t){return t.length===0}findNextPair(t,n,r){let l=this.getDecodeFinderCounters();l[0]=0,l[1]=0,l[2]=0,l[3]=0;let o=t.getSize(),d;r>=0?d=r:this.isEmptyPair(n)?d=0:d=n[n.length-1].getFinderPattern().getStartEnd()[1];let h=n.length%2!=0;this.startFromEven&&(h=!h);let g=!1;for(;d<o&&(g=!t.get(d),!!g);)d++;let b=0,j=d;for(let I=d;I<o;I++)if(t.get(I)!=g)l[b]++;else{if(b==3){if(h&&De.reverseCounters(l),De.isFinderPattern(l)){this.startEnd[0]=j,this.startEnd[1]=I;return}h&&De.reverseCounters(l),j+=l[0]+l[1],l[0]=l[2],l[1]=l[3],l[2]=0,l[3]=0,b--}else b++;l[b]=1,g=!g}throw new M}static reverseCounters(t){let n=t.length;for(let r=0;r<n/2;++r){let l=t[r];t[r]=t[n-r-1],t[n-r-1]=l}}parseFoundFinderPattern(t,n,r){let l,o,d;if(r){let b=this.startEnd[0]-1;for(;b>=0&&!t.get(b);)b--;b++,l=this.startEnd[0]-b,o=b,d=this.startEnd[1]}else o=this.startEnd[0],d=t.getNextUnset(this.startEnd[1]+1),l=d-this.startEnd[1];let h=this.getDecodeFinderCounters();F.arraycopy(h,0,h,1,h.length-1),h[0]=l;let g;try{g=this.parseFinderValue(h,De.FINDER_PATTERNS)}catch{return null}return new ln(g,[o,d],o,d,n)}decodeDataCharacter(t,n,r,l){let o=this.getDataCharacterCounters();for(let Gt=0;Gt<o.length;Gt++)o[Gt]=0;if(l)De.recordPatternInReverse(t,n.getStartEnd()[0],o);else{De.recordPattern(t,n.getStartEnd()[1],o);for(let Gt=0,Us=o.length-1;Gt<Us;Gt++,Us--){let ia=o[Gt];o[Gt]=o[Us],o[Us]=ia}}let d=17,h=de.sum(new Int32Array(o))/d,g=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(h-g)/g>.3)throw new M;let b=this.getOddCounts(),j=this.getEvenCounts(),I=this.getOddRoundingErrors(),k=this.getEvenRoundingErrors();for(let Gt=0;Gt<o.length;Gt++){let Us=1*o[Gt]/h,ia=Us+.5;if(ia<1){if(Us<.3)throw new M;ia=1}else if(ia>8){if(Us>8.7)throw new M;ia=8}let dr=Gt/2;(Gt&1)==0?(b[dr]=ia,I[dr]=Us-ia):(j[dr]=ia,k[dr]=Us-ia)}this.adjustOddEvenCounts(d);let G=4*n.getValue()+(r?0:2)+(l?0:1)-1,J=0,ee=0;for(let Gt=b.length-1;Gt>=0;Gt--){if(De.isNotA1left(n,r,l)){let Us=De.WEIGHTS[G][2*Gt];ee+=b[Gt]*Us}J+=b[Gt]}let ue=0;for(let Gt=j.length-1;Gt>=0;Gt--)if(De.isNotA1left(n,r,l)){let Us=De.WEIGHTS[G][2*Gt+1];ue+=j[Gt]*Us}let be=ee+ue;if((J&1)!=0||J>13||J<4)throw new M;let Be=(13-J)/2,Me=De.SYMBOL_WIDEST[Be],Ie=9-Me,mt=ka.getRSSvalue(b,Me,!0),it=ka.getRSSvalue(j,Ie,!1),ps=De.EVEN_TOTAL_SUBSET[Be],ua=De.GSUM[Be],Ys=mt*ps+it+ua;return new rn(Ys,be)}static isNotA1left(t,n,r){return!(t.getValue()==0&&n&&r)}adjustOddEvenCounts(t){let n=de.sum(new Int32Array(this.getOddCounts())),r=de.sum(new Int32Array(this.getEvenCounts())),l=!1,o=!1;n>13?o=!0:n<4&&(l=!0);let d=!1,h=!1;r>13?h=!0:r<4&&(d=!0);let g=n+r-t,b=(n&1)==1,j=(r&1)==0;if(g==1)if(b){if(j)throw new M;o=!0}else{if(!j)throw new M;h=!0}else if(g==-1)if(b){if(j)throw new M;l=!0}else{if(!j)throw new M;d=!0}else if(g==0){if(b){if(!j)throw new M;n<r?(l=!0,h=!0):(o=!0,d=!0)}else if(j)throw new M}else throw new M;if(l){if(o)throw new M;De.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&De.decrement(this.getOddCounts(),this.getOddRoundingErrors()),d){if(h)throw new M;De.increment(this.getEvenCounts(),this.getOddRoundingErrors())}h&&De.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}De.SYMBOL_WIDEST=[7,5,4,3,1],De.EVEN_TOTAL_SUBSET=[4,20,52,104,204],De.GSUM=[0,348,1388,2948,3988],De.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],De.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],De.FINDER_PAT_A=0,De.FINDER_PAT_B=1,De.FINDER_PAT_C=2,De.FINDER_PAT_D=3,De.FINDER_PAT_E=4,De.FINDER_PAT_F=5,De.FINDER_PATTERN_SEQUENCES=[[De.FINDER_PAT_A,De.FINDER_PAT_A],[De.FINDER_PAT_A,De.FINDER_PAT_B,De.FINDER_PAT_B],[De.FINDER_PAT_A,De.FINDER_PAT_C,De.FINDER_PAT_B,De.FINDER_PAT_D],[De.FINDER_PAT_A,De.FINDER_PAT_E,De.FINDER_PAT_B,De.FINDER_PAT_D,De.FINDER_PAT_C],[De.FINDER_PAT_A,De.FINDER_PAT_E,De.FINDER_PAT_B,De.FINDER_PAT_D,De.FINDER_PAT_D,De.FINDER_PAT_F],[De.FINDER_PAT_A,De.FINDER_PAT_E,De.FINDER_PAT_B,De.FINDER_PAT_D,De.FINDER_PAT_E,De.FINDER_PAT_F,De.FINDER_PAT_F],[De.FINDER_PAT_A,De.FINDER_PAT_A,De.FINDER_PAT_B,De.FINDER_PAT_B,De.FINDER_PAT_C,De.FINDER_PAT_C,De.FINDER_PAT_D,De.FINDER_PAT_D],[De.FINDER_PAT_A,De.FINDER_PAT_A,De.FINDER_PAT_B,De.FINDER_PAT_B,De.FINDER_PAT_C,De.FINDER_PAT_C,De.FINDER_PAT_D,De.FINDER_PAT_E,De.FINDER_PAT_E],[De.FINDER_PAT_A,De.FINDER_PAT_A,De.FINDER_PAT_B,De.FINDER_PAT_B,De.FINDER_PAT_C,De.FINDER_PAT_C,De.FINDER_PAT_D,De.FINDER_PAT_E,De.FINDER_PAT_F,De.FINDER_PAT_F],[De.FINDER_PAT_A,De.FINDER_PAT_A,De.FINDER_PAT_B,De.FINDER_PAT_B,De.FINDER_PAT_C,De.FINDER_PAT_D,De.FINDER_PAT_D,De.FINDER_PAT_E,De.FINDER_PAT_E,De.FINDER_PAT_F,De.FINDER_PAT_F]],De.MAX_PAIRS=11;class ho extends rn{constructor(t,n,r){super(t,n),this.count=0,this.finderPattern=r}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Ht extends Ls{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(t,n,r){const l=this.decodePair(n,!1,t,r);Ht.addOrTally(this.possibleLeftPairs,l),n.reverse();let o=this.decodePair(n,!0,t,r);Ht.addOrTally(this.possibleRightPairs,o),n.reverse();for(let d of this.possibleLeftPairs)if(d.getCount()>1){for(let h of this.possibleRightPairs)if(h.getCount()>1&&Ht.checkChecksum(d,h))return Ht.constructResult(d,h)}throw new M}static addOrTally(t,n){if(n==null)return;let r=!1;for(let l of t)if(l.getValue()===n.getValue()){l.incrementCount(),r=!0;break}r||t.push(n)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(t,n){let r=4537077*t.getValue()+n.getValue(),l=new String(r).toString(),o=new ve;for(let b=13-l.length;b>0;b--)o.append("0");o.append(l);let d=0;for(let b=0;b<13;b++){let j=o.charAt(b).charCodeAt(0)-48;d+=(b&1)===0?3*j:j}d=10-d%10,d===10&&(d=0),o.append(d.toString());let h=t.getFinderPattern().getResultPoints(),g=n.getFinderPattern().getResultPoints();return new ye(o.toString(),null,0,[h[0],h[1],g[0],g[1]],Re.RSS_14,new Date().getTime())}static checkChecksum(t,n){let r=(t.getChecksumPortion()+16*n.getChecksumPortion())%79,l=9*t.getFinderPattern().getValue()+n.getFinderPattern().getValue();return l>72&&l--,l>8&&l--,r===l}decodePair(t,n,r,l){try{let o=this.findFinderPattern(t,n),d=this.parseFoundFinderPattern(t,r,n,o),h=l==null?null:l.get(te.NEED_RESULT_POINT_CALLBACK);if(h!=null){let j=(o[0]+o[1])/2;n&&(j=t.getSize()-1-j),h.foundPossibleResultPoint(new _e(j,r))}let g=this.decodeDataCharacter(t,d,!0),b=this.decodeDataCharacter(t,d,!1);return new ho(1597*g.getValue()+b.getValue(),g.getChecksumPortion()+4*b.getChecksumPortion(),d)}catch{return null}}decodeDataCharacter(t,n,r){let l=this.getDataCharacterCounters();for(let ue=0;ue<l.length;ue++)l[ue]=0;if(r)It.recordPatternInReverse(t,n.getStartEnd()[0],l);else{It.recordPattern(t,n.getStartEnd()[1]+1,l);for(let ue=0,be=l.length-1;ue<be;ue++,be--){let Be=l[ue];l[ue]=l[be],l[be]=Be}}let o=r?16:15,d=de.sum(new Int32Array(l))/o,h=this.getOddCounts(),g=this.getEvenCounts(),b=this.getOddRoundingErrors(),j=this.getEvenRoundingErrors();for(let ue=0;ue<l.length;ue++){let be=l[ue]/d,Be=Math.floor(be+.5);Be<1?Be=1:Be>8&&(Be=8);let Me=Math.floor(ue/2);(ue&1)===0?(h[Me]=Be,b[Me]=be-Be):(g[Me]=Be,j[Me]=be-Be)}this.adjustOddEvenCounts(r,o);let I=0,k=0;for(let ue=h.length-1;ue>=0;ue--)k*=9,k+=h[ue],I+=h[ue];let G=0,J=0;for(let ue=g.length-1;ue>=0;ue--)G*=9,G+=g[ue],J+=g[ue];let ee=k+3*G;if(r){if((I&1)!==0||I>12||I<4)throw new M;let ue=(12-I)/2,be=Ht.OUTSIDE_ODD_WIDEST[ue],Be=9-be,Me=ka.getRSSvalue(h,be,!1),Ie=ka.getRSSvalue(g,Be,!0),mt=Ht.OUTSIDE_EVEN_TOTAL_SUBSET[ue],it=Ht.OUTSIDE_GSUM[ue];return new rn(Me*mt+Ie+it,ee)}else{if((J&1)!==0||J>10||J<4)throw new M;let ue=(10-J)/2,be=Ht.INSIDE_ODD_WIDEST[ue],Be=9-be,Me=ka.getRSSvalue(h,be,!0),Ie=ka.getRSSvalue(g,Be,!1),mt=Ht.INSIDE_ODD_TOTAL_SUBSET[ue],it=Ht.INSIDE_GSUM[ue];return new rn(Ie*mt+Me+it,ee)}}findFinderPattern(t,n){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let l=t.getSize(),o=!1,d=0;for(;d<l&&(o=!t.get(d),n!==o);)d++;let h=0,g=d;for(let b=d;b<l;b++)if(t.get(b)!==o)r[h]++;else{if(h===3){if(Ls.isFinderPattern(r))return[g,b];g+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,h--}else h++;r[h]=1,o=!o}throw new M}parseFoundFinderPattern(t,n,r,l){let o=t.get(l[0]),d=l[0]-1;for(;d>=0&&o!==t.get(d);)d--;d++;const h=l[0]-d,g=this.getDecodeFinderCounters(),b=new Int32Array(g.length);F.arraycopy(g,0,b,1,g.length-1),b[0]=h;const j=this.parseFinderValue(b,Ht.FINDER_PATTERNS);let I=d,k=l[1];return r&&(I=t.getSize()-1-I,k=t.getSize()-1-k),new ln(j,[d,l[1]],I,k,n)}adjustOddEvenCounts(t,n){let r=de.sum(new Int32Array(this.getOddCounts())),l=de.sum(new Int32Array(this.getEvenCounts())),o=!1,d=!1,h=!1,g=!1;t?(r>12?d=!0:r<4&&(o=!0),l>12?g=!0:l<4&&(h=!0)):(r>11?d=!0:r<5&&(o=!0),l>10?g=!0:l<4&&(h=!0));let b=r+l-n,j=(r&1)===(t?1:0),I=(l&1)===1;if(b===1)if(j){if(I)throw new M;d=!0}else{if(!I)throw new M;g=!0}else if(b===-1)if(j){if(I)throw new M;o=!0}else{if(!I)throw new M;h=!0}else if(b===0){if(j){if(!I)throw new M;r<l?(o=!0,g=!0):(d=!0,h=!0)}else if(I)throw new M}else throw new M;if(o){if(d)throw new M;Ls.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&Ls.decrement(this.getOddCounts(),this.getOddRoundingErrors()),h){if(g)throw new M;Ls.increment(this.getEvenCounts(),this.getOddRoundingErrors())}g&&Ls.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ht.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Ht.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Ht.OUTSIDE_GSUM=[0,161,961,2015,2715],Ht.INSIDE_GSUM=[0,336,1036,1516],Ht.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Ht.INSIDE_ODD_WIDEST=[2,4,6,8],Ht.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Na extends It{constructor(t,n){super(),this.readers=[],this.verbose=n===!0;const r=t?t.get(te.POSSIBLE_FORMATS):null,l=t&&t.get(te.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;r?((r.includes(Re.EAN_13)||r.includes(Re.UPC_A)||r.includes(Re.EAN_8)||r.includes(Re.UPC_E))&&this.readers.push(new cl(t)),r.includes(Re.CODE_39)&&this.readers.push(new zt(l)),r.includes(Re.CODE_128)&&this.readers.push(new ke),r.includes(Re.ITF)&&this.readers.push(new ut),r.includes(Re.RSS_14)&&this.readers.push(new Ht),r.includes(Re.RSS_EXPANDED)&&this.readers.push(new De(this.verbose))):(this.readers.push(new cl(t)),this.readers.push(new zt),this.readers.push(new cl(t)),this.readers.push(new ke),this.readers.push(new ut),this.readers.push(new Ht),this.readers.push(new De(this.verbose)))}decodeRow(t,n,r){for(let l=0;l<this.readers.length;l++)try{return this.readers[l].decodeRow(t,n,r)}catch{}throw new M}reset(){this.readers.forEach(t=>t.reset())}}class qc extends Ee{constructor(t=500,n){super(new Na(n),t,n)}}class _t{constructor(t,n,r){this.ecCodewords=t,this.ecBlocks=[n],r&&this.ecBlocks.push(r)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Ot{constructor(t,n){this.count=t,this.dataCodewords=n}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class wt{constructor(t,n,r,l,o,d){this.versionNumber=t,this.symbolSizeRows=n,this.symbolSizeColumns=r,this.dataRegionSizeRows=l,this.dataRegionSizeColumns=o,this.ecBlocks=d;let h=0;const g=d.getECCodewords(),b=d.getECBlocks();for(let j of b)h+=j.getCount()*(j.getDataCodewords()+g);this.totalCodewords=h}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(t,n){if((t&1)!==0||(n&1)!==0)throw new K;for(let r of wt.VERSIONS)if(r.symbolSizeRows===t&&r.symbolSizeColumns===n)return r;throw new K}toString(){return""+this.versionNumber}static buildVersions(){return[new wt(1,10,10,8,8,new _t(5,new Ot(1,3))),new wt(2,12,12,10,10,new _t(7,new Ot(1,5))),new wt(3,14,14,12,12,new _t(10,new Ot(1,8))),new wt(4,16,16,14,14,new _t(12,new Ot(1,12))),new wt(5,18,18,16,16,new _t(14,new Ot(1,18))),new wt(6,20,20,18,18,new _t(18,new Ot(1,22))),new wt(7,22,22,20,20,new _t(20,new Ot(1,30))),new wt(8,24,24,22,22,new _t(24,new Ot(1,36))),new wt(9,26,26,24,24,new _t(28,new Ot(1,44))),new wt(10,32,32,14,14,new _t(36,new Ot(1,62))),new wt(11,36,36,16,16,new _t(42,new Ot(1,86))),new wt(12,40,40,18,18,new _t(48,new Ot(1,114))),new wt(13,44,44,20,20,new _t(56,new Ot(1,144))),new wt(14,48,48,22,22,new _t(68,new Ot(1,174))),new wt(15,52,52,24,24,new _t(42,new Ot(2,102))),new wt(16,64,64,14,14,new _t(56,new Ot(2,140))),new wt(17,72,72,16,16,new _t(36,new Ot(4,92))),new wt(18,80,80,18,18,new _t(48,new Ot(4,114))),new wt(19,88,88,20,20,new _t(56,new Ot(4,144))),new wt(20,96,96,22,22,new _t(68,new Ot(4,174))),new wt(21,104,104,24,24,new _t(56,new Ot(6,136))),new wt(22,120,120,18,18,new _t(68,new Ot(6,175))),new wt(23,132,132,20,20,new _t(62,new Ot(8,163))),new wt(24,144,144,22,22,new _t(62,new Ot(8,156),new Ot(2,155))),new wt(25,8,18,6,16,new _t(7,new Ot(1,5))),new wt(26,8,32,6,14,new _t(11,new Ot(1,10))),new wt(27,12,26,10,24,new _t(14,new Ot(1,16))),new wt(28,12,36,10,16,new _t(18,new Ot(1,22))),new wt(29,16,36,14,16,new _t(24,new Ot(1,32))),new wt(30,16,48,14,22,new _t(28,new Ot(1,49)))]}}wt.VERSIONS=wt.buildVersions();class $n{constructor(t){const n=t.getHeight();if(n<8||n>144||(n&1)!==0)throw new K;this.version=$n.readVersion(t),this.mappingBitMatrix=this.extractDataRegion(t),this.readMappingMatrix=new Ne(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(t){const n=t.getHeight(),r=t.getWidth();return wt.getVersionForDimensions(n,r)}readCodewords(){const t=new Int8Array(this.version.getTotalCodewords());let n=0,r=4,l=0;const o=this.mappingBitMatrix.getHeight(),d=this.mappingBitMatrix.getWidth();let h=!1,g=!1,b=!1,j=!1;do if(r===o&&l===0&&!h)t[n++]=this.readCorner1(o,d)&255,r-=2,l+=2,h=!0;else if(r===o-2&&l===0&&(d&3)!==0&&!g)t[n++]=this.readCorner2(o,d)&255,r-=2,l+=2,g=!0;else if(r===o+4&&l===2&&(d&7)===0&&!b)t[n++]=this.readCorner3(o,d)&255,r-=2,l+=2,b=!0;else if(r===o-2&&l===0&&(d&7)===4&&!j)t[n++]=this.readCorner4(o,d)&255,r-=2,l+=2,j=!0;else{do r<o&&l>=0&&!this.readMappingMatrix.get(l,r)&&(t[n++]=this.readUtah(r,l,o,d)&255),r-=2,l+=2;while(r>=0&&l<d);r+=1,l+=3;do r>=0&&l<d&&!this.readMappingMatrix.get(l,r)&&(t[n++]=this.readUtah(r,l,o,d)&255),r+=2,l-=2;while(r<o&&l>=0);r+=3,l+=1}while(r<o||l<d);if(n!==this.version.getTotalCodewords())throw new K;return t}readModule(t,n,r,l){return t<0&&(t+=r,n+=4-(r+4&7)),n<0&&(n+=l,t+=4-(l+4&7)),this.readMappingMatrix.set(n,t),this.mappingBitMatrix.get(n,t)}readUtah(t,n,r,l){let o=0;return this.readModule(t-2,n-2,r,l)&&(o|=1),o<<=1,this.readModule(t-2,n-1,r,l)&&(o|=1),o<<=1,this.readModule(t-1,n-2,r,l)&&(o|=1),o<<=1,this.readModule(t-1,n-1,r,l)&&(o|=1),o<<=1,this.readModule(t-1,n,r,l)&&(o|=1),o<<=1,this.readModule(t,n-2,r,l)&&(o|=1),o<<=1,this.readModule(t,n-1,r,l)&&(o|=1),o<<=1,this.readModule(t,n,r,l)&&(o|=1),o}readCorner1(t,n){let r=0;return this.readModule(t-1,0,t,n)&&(r|=1),r<<=1,this.readModule(t-1,1,t,n)&&(r|=1),r<<=1,this.readModule(t-1,2,t,n)&&(r|=1),r<<=1,this.readModule(0,n-2,t,n)&&(r|=1),r<<=1,this.readModule(0,n-1,t,n)&&(r|=1),r<<=1,this.readModule(1,n-1,t,n)&&(r|=1),r<<=1,this.readModule(2,n-1,t,n)&&(r|=1),r<<=1,this.readModule(3,n-1,t,n)&&(r|=1),r}readCorner2(t,n){let r=0;return this.readModule(t-3,0,t,n)&&(r|=1),r<<=1,this.readModule(t-2,0,t,n)&&(r|=1),r<<=1,this.readModule(t-1,0,t,n)&&(r|=1),r<<=1,this.readModule(0,n-4,t,n)&&(r|=1),r<<=1,this.readModule(0,n-3,t,n)&&(r|=1),r<<=1,this.readModule(0,n-2,t,n)&&(r|=1),r<<=1,this.readModule(0,n-1,t,n)&&(r|=1),r<<=1,this.readModule(1,n-1,t,n)&&(r|=1),r}readCorner3(t,n){let r=0;return this.readModule(t-1,0,t,n)&&(r|=1),r<<=1,this.readModule(t-1,n-1,t,n)&&(r|=1),r<<=1,this.readModule(0,n-3,t,n)&&(r|=1),r<<=1,this.readModule(0,n-2,t,n)&&(r|=1),r<<=1,this.readModule(0,n-1,t,n)&&(r|=1),r<<=1,this.readModule(1,n-3,t,n)&&(r|=1),r<<=1,this.readModule(1,n-2,t,n)&&(r|=1),r<<=1,this.readModule(1,n-1,t,n)&&(r|=1),r}readCorner4(t,n){let r=0;return this.readModule(t-3,0,t,n)&&(r|=1),r<<=1,this.readModule(t-2,0,t,n)&&(r|=1),r<<=1,this.readModule(t-1,0,t,n)&&(r|=1),r<<=1,this.readModule(0,n-2,t,n)&&(r|=1),r<<=1,this.readModule(0,n-1,t,n)&&(r|=1),r<<=1,this.readModule(1,n-1,t,n)&&(r|=1),r<<=1,this.readModule(2,n-1,t,n)&&(r|=1),r<<=1,this.readModule(3,n-1,t,n)&&(r|=1),r}extractDataRegion(t){const n=this.version.getSymbolSizeRows(),r=this.version.getSymbolSizeColumns();if(t.getHeight()!==n)throw new O("Dimension of bitMatrix must match the version size");const l=this.version.getDataRegionSizeRows(),o=this.version.getDataRegionSizeColumns(),d=n/l|0,h=r/o|0,g=d*l,b=h*o,j=new Ne(b,g);for(let I=0;I<d;++I){const k=I*l;for(let G=0;G<h;++G){const J=G*o;for(let ee=0;ee<l;++ee){const ue=I*(l+2)+1+ee,be=k+ee;for(let Be=0;Be<o;++Be){const Me=G*(o+2)+1+Be;if(t.get(Me,ue)){const Ie=J+Be;j.set(Ie,be)}}}}}return j}}class er{constructor(t,n){this.numDataCodewords=t,this.codewords=n}static getDataBlocks(t,n){const r=n.getECBlocks();let l=0;const o=r.getECBlocks();for(let ee of o)l+=ee.getCount();const d=new Array(l);let h=0;for(let ee of o)for(let ue=0;ue<ee.getCount();ue++){const be=ee.getDataCodewords(),Be=r.getECCodewords()+be;d[h++]=new er(be,new Uint8Array(Be))}const b=d[0].codewords.length-r.getECCodewords(),j=b-1;let I=0;for(let ee=0;ee<j;ee++)for(let ue=0;ue<h;ue++)d[ue].codewords[ee]=t[I++];const k=n.getVersionNumber()===24,G=k?8:h;for(let ee=0;ee<G;ee++)d[ee].codewords[b-1]=t[I++];const J=d[0].codewords.length;for(let ee=b;ee<J;ee++)for(let ue=0;ue<h;ue++){const be=k?(ue+8)%h:ue,Be=k&&be>7?ee-1:ee;d[be].codewords[Be]=t[I++]}if(I!==t.length)throw new O;return d}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Ca{constructor(t){this.bytes=t,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(t){if(t<1||t>32||t>this.available())throw new O(""+t);let n=0,r=this.bitOffset,l=this.byteOffset;const o=this.bytes;if(r>0){const d=8-r,h=t<d?t:d,g=d-h,b=255>>8-h<<g;n=(o[l]&b)>>g,t-=h,r+=h,r===8&&(r=0,l++)}if(t>0){for(;t>=8;)n=n<<8|o[l]&255,l++,t-=8;if(t>0){const d=8-t,h=255>>d<<d;n=n<<t|(o[l]&h)>>d,r+=t}}return this.bitOffset=r,this.byteOffset=l,n}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Mt;(function(_){_[_.PAD_ENCODE=0]="PAD_ENCODE",_[_.ASCII_ENCODE=1]="ASCII_ENCODE",_[_.C40_ENCODE=2]="C40_ENCODE",_[_.TEXT_ENCODE=3]="TEXT_ENCODE",_[_.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",_[_.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",_[_.BASE256_ENCODE=6]="BASE256_ENCODE"})(Mt||(Mt={}));class Ka{static decode(t){const n=new Ca(t),r=new ve,l=new ve,o=new Array;let d=Mt.ASCII_ENCODE;do if(d===Mt.ASCII_ENCODE)d=this.decodeAsciiSegment(n,r,l);else{switch(d){case Mt.C40_ENCODE:this.decodeC40Segment(n,r);break;case Mt.TEXT_ENCODE:this.decodeTextSegment(n,r);break;case Mt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(n,r);break;case Mt.EDIFACT_ENCODE:this.decodeEdifactSegment(n,r);break;case Mt.BASE256_ENCODE:this.decodeBase256Segment(n,r,o);break;default:throw new K}d=Mt.ASCII_ENCODE}while(d!==Mt.PAD_ENCODE&&n.available()>0);return l.length()>0&&r.append(l.toString()),new ct(t,r.toString(),o.length===0?null:o,null)}static decodeAsciiSegment(t,n,r){let l=!1;do{let o=t.readBits(8);if(o===0)throw new K;if(o<=128)return l&&(o+=128),n.append(String.fromCharCode(o-1)),Mt.ASCII_ENCODE;if(o===129)return Mt.PAD_ENCODE;if(o<=229){const d=o-130;d<10&&n.append("0"),n.append(""+d)}else switch(o){case 230:return Mt.C40_ENCODE;case 231:return Mt.BASE256_ENCODE;case 232:n.append("");break;case 233:case 234:break;case 235:l=!0;break;case 236:n.append("[)>05"),r.insert(0,"");break;case 237:n.append("[)>06"),r.insert(0,"");break;case 238:return Mt.ANSIX12_ENCODE;case 239:return Mt.TEXT_ENCODE;case 240:return Mt.EDIFACT_ENCODE;case 241:break;default:if(o!==254||t.available()!==0)throw new K;break}}while(t.available()>0);return Mt.ASCII_ENCODE}static decodeC40Segment(t,n){let r=!1;const l=[];let o=0;do{if(t.available()===8)return;const d=t.readBits(8);if(d===254)return;this.parseTwoBytes(d,t.readBits(8),l);for(let h=0;h<3;h++){const g=l[h];switch(o){case 0:if(g<3)o=g+1;else if(g<this.C40_BASIC_SET_CHARS.length){const b=this.C40_BASIC_SET_CHARS[g];r?(n.append(String.fromCharCode(b.charCodeAt(0)+128)),r=!1):n.append(b)}else throw new K;break;case 1:r?(n.append(String.fromCharCode(g+128)),r=!1):n.append(String.fromCharCode(g)),o=0;break;case 2:if(g<this.C40_SHIFT2_SET_CHARS.length){const b=this.C40_SHIFT2_SET_CHARS[g];r?(n.append(String.fromCharCode(b.charCodeAt(0)+128)),r=!1):n.append(b)}else switch(g){case 27:n.append("");break;case 30:r=!0;break;default:throw new K}o=0;break;case 3:r?(n.append(String.fromCharCode(g+224)),r=!1):n.append(String.fromCharCode(g+96)),o=0;break;default:throw new K}}}while(t.available()>0)}static decodeTextSegment(t,n){let r=!1,l=[],o=0;do{if(t.available()===8)return;const d=t.readBits(8);if(d===254)return;this.parseTwoBytes(d,t.readBits(8),l);for(let h=0;h<3;h++){const g=l[h];switch(o){case 0:if(g<3)o=g+1;else if(g<this.TEXT_BASIC_SET_CHARS.length){const b=this.TEXT_BASIC_SET_CHARS[g];r?(n.append(String.fromCharCode(b.charCodeAt(0)+128)),r=!1):n.append(b)}else throw new K;break;case 1:r?(n.append(String.fromCharCode(g+128)),r=!1):n.append(String.fromCharCode(g)),o=0;break;case 2:if(g<this.TEXT_SHIFT2_SET_CHARS.length){const b=this.TEXT_SHIFT2_SET_CHARS[g];r?(n.append(String.fromCharCode(b.charCodeAt(0)+128)),r=!1):n.append(b)}else switch(g){case 27:n.append("");break;case 30:r=!0;break;default:throw new K}o=0;break;case 3:if(g<this.TEXT_SHIFT3_SET_CHARS.length){const b=this.TEXT_SHIFT3_SET_CHARS[g];r?(n.append(String.fromCharCode(b.charCodeAt(0)+128)),r=!1):n.append(b),o=0}else throw new K;break;default:throw new K}}}while(t.available()>0)}static decodeAnsiX12Segment(t,n){const r=[];do{if(t.available()===8)return;const l=t.readBits(8);if(l===254)return;this.parseTwoBytes(l,t.readBits(8),r);for(let o=0;o<3;o++){const d=r[o];switch(d){case 0:n.append("\r");break;case 1:n.append("*");break;case 2:n.append(">");break;case 3:n.append(" ");break;default:if(d<14)n.append(String.fromCharCode(d+44));else if(d<40)n.append(String.fromCharCode(d+51));else throw new K;break}}}while(t.available()>0)}static parseTwoBytes(t,n,r){let l=(t<<8)+n-1,o=Math.floor(l/1600);r[0]=o,l-=o*1600,o=Math.floor(l/40),r[1]=o,r[2]=l-o*40}static decodeEdifactSegment(t,n){do{if(t.available()<=16)return;for(let r=0;r<4;r++){let l=t.readBits(6);if(l===31){const o=8-t.getBitOffset();o!==8&&t.readBits(o);return}(l&32)===0&&(l|=64),n.append(String.fromCharCode(l))}}while(t.available()>0)}static decodeBase256Segment(t,n,r){let l=1+t.getByteOffset();const o=this.unrandomize255State(t.readBits(8),l++);let d;if(o===0?d=t.available()/8|0:o<250?d=o:d=250*(o-249)+this.unrandomize255State(t.readBits(8),l++),d<0)throw new K;const h=new Uint8Array(d);for(let g=0;g<d;g++){if(t.available()<8)throw new K;h[g]=this.unrandomize255State(t.readBits(8),l++)}r.push(h);try{n.append(Oe.decode(h,$.ISO88591))}catch(g){throw new Bs("Platform does not support required encoding: "+g.message)}}static unrandomize255State(t,n){const r=149*n%255+1,l=t-r;return l>=0?l:l+256}}Ka.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Ka.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Ka.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Ka.TEXT_SHIFT2_SET_CHARS=Ka.C40_SHIFT2_SET_CHARS,Ka.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Kc{constructor(){this.rsDecoder=new us(dt.DATA_MATRIX_FIELD_256)}decode(t){const n=new $n(t),r=n.getVersion(),l=n.readCodewords(),o=er.getDataBlocks(l,r);let d=0;for(let b of o)d+=b.getNumDataCodewords();const h=new Uint8Array(d),g=o.length;for(let b=0;b<g;b++){const j=o[b],I=j.getCodewords(),k=j.getNumDataCodewords();this.correctErrors(I,k);for(let G=0;G<k;G++)h[G*g+b]=I[G]}return Ka.decode(h)}correctErrors(t,n){const r=new Int32Array(t);try{this.rsDecoder.decode(r,t.length-n)}catch{throw new z}for(let l=0;l<n;l++)t[l]=r[l]}}class rs{constructor(t){this.image=t,this.rectangleDetector=new Ke(this.image)}detect(){const t=this.rectangleDetector.detect();let n=this.detectSolid1(t);if(n=this.detectSolid2(n),n[3]=this.correctTopRight(n),!n[3])throw new M;n=this.shiftToModuleCenter(n);const r=n[0],l=n[1],o=n[2],d=n[3];let h=this.transitionsBetween(r,d)+1,g=this.transitionsBetween(o,d)+1;(h&1)===1&&(h+=1),(g&1)===1&&(g+=1),4*h<7*g&&4*g<7*h&&(h=g=Math.max(h,g));let b=rs.sampleGrid(this.image,r,l,o,d,h,g);return new ie(b,[r,l,o,d])}static shiftPoint(t,n,r){let l=(n.getX()-t.getX())/(r+1),o=(n.getY()-t.getY())/(r+1);return new _e(t.getX()+l,t.getY()+o)}static moveAway(t,n,r){let l=t.getX(),o=t.getY();return l<n?l-=1:l+=1,o<r?o-=1:o+=1,new _e(l,o)}detectSolid1(t){let n=t[0],r=t[1],l=t[3],o=t[2],d=this.transitionsBetween(n,r),h=this.transitionsBetween(r,l),g=this.transitionsBetween(l,o),b=this.transitionsBetween(o,n),j=d,I=[o,n,r,l];return j>h&&(j=h,I[0]=n,I[1]=r,I[2]=l,I[3]=o),j>g&&(j=g,I[0]=r,I[1]=l,I[2]=o,I[3]=n),j>b&&(I[0]=l,I[1]=o,I[2]=n,I[3]=r),I}detectSolid2(t){let n=t[0],r=t[1],l=t[2],o=t[3],d=this.transitionsBetween(n,o),h=rs.shiftPoint(r,l,(d+1)*4),g=rs.shiftPoint(l,r,(d+1)*4),b=this.transitionsBetween(h,n),j=this.transitionsBetween(g,o);return b<j?(t[0]=n,t[1]=r,t[2]=l,t[3]=o):(t[0]=r,t[1]=l,t[2]=o,t[3]=n),t}correctTopRight(t){let n=t[0],r=t[1],l=t[2],o=t[3],d=this.transitionsBetween(n,o),h=this.transitionsBetween(r,o),g=rs.shiftPoint(n,r,(h+1)*4),b=rs.shiftPoint(l,r,(d+1)*4);d=this.transitionsBetween(g,o),h=this.transitionsBetween(b,o);let j=new _e(o.getX()+(l.getX()-r.getX())/(d+1),o.getY()+(l.getY()-r.getY())/(d+1)),I=new _e(o.getX()+(n.getX()-r.getX())/(h+1),o.getY()+(n.getY()-r.getY())/(h+1));if(!this.isValid(j))return this.isValid(I)?I:null;if(!this.isValid(I))return j;let k=this.transitionsBetween(g,j)+this.transitionsBetween(b,j),G=this.transitionsBetween(g,I)+this.transitionsBetween(b,I);return k>G?j:I}shiftToModuleCenter(t){let n=t[0],r=t[1],l=t[2],o=t[3],d=this.transitionsBetween(n,o)+1,h=this.transitionsBetween(l,o)+1,g=rs.shiftPoint(n,r,h*4),b=rs.shiftPoint(l,r,d*4);d=this.transitionsBetween(g,o)+1,h=this.transitionsBetween(b,o)+1,(d&1)===1&&(d+=1),(h&1)===1&&(h+=1);let j=(n.getX()+r.getX()+l.getX()+o.getX())/4,I=(n.getY()+r.getY()+l.getY()+o.getY())/4;n=rs.moveAway(n,j,I),r=rs.moveAway(r,j,I),l=rs.moveAway(l,j,I),o=rs.moveAway(o,j,I);let k,G;return g=rs.shiftPoint(n,r,h*4),g=rs.shiftPoint(g,o,d*4),k=rs.shiftPoint(r,n,h*4),k=rs.shiftPoint(k,l,d*4),b=rs.shiftPoint(l,o,h*4),b=rs.shiftPoint(b,r,d*4),G=rs.shiftPoint(o,l,h*4),G=rs.shiftPoint(G,n,d*4),[g,k,b,G]}isValid(t){return t.getX()>=0&&t.getX()<this.image.getWidth()&&t.getY()>0&&t.getY()<this.image.getHeight()}static sampleGrid(t,n,r,l,o,d,h){return St.getInstance().sampleGrid(t,d,h,.5,.5,d-.5,.5,d-.5,h-.5,.5,h-.5,n.getX(),n.getY(),o.getX(),o.getY(),l.getX(),l.getY(),r.getX(),r.getY())}transitionsBetween(t,n){let r=Math.trunc(t.getX()),l=Math.trunc(t.getY()),o=Math.trunc(n.getX()),d=Math.trunc(n.getY()),h=Math.abs(d-l)>Math.abs(o-r);if(h){let ee=r;r=l,l=ee,ee=o,o=d,d=ee}let g=Math.abs(o-r),b=Math.abs(d-l),j=-g/2,I=l<d?1:-1,k=r<o?1:-1,G=0,J=this.image.get(h?l:r,h?r:l);for(let ee=r,ue=l;ee!==o;ee+=k){let be=this.image.get(h?ue:ee,h?ee:ue);if(be!==J&&(G++,J=be),j+=b,j>0){if(ue===d)break;ue+=I,j-=g}}return G}}class Za{constructor(){this.decoder=new Kc}decode(t,n=null){let r,l;if(n!=null&&n.has(te.PURE_BARCODE)){const b=Za.extractPureBits(t.getBlackMatrix());r=this.decoder.decode(b),l=Za.NO_POINTS}else{const b=new rs(t.getBlackMatrix()).detect();r=this.decoder.decode(b.getBits()),l=b.getPoints()}const o=r.getRawBytes(),d=new ye(r.getText(),o,8*o.length,l,Re.DATA_MATRIX,F.currentTimeMillis()),h=r.getByteSegments();h!=null&&d.putMetadata(et.BYTE_SEGMENTS,h);const g=r.getECLevel();return g!=null&&d.putMetadata(et.ERROR_CORRECTION_LEVEL,g),d}reset(){}static extractPureBits(t){const n=t.getTopLeftOnBit(),r=t.getBottomRightOnBit();if(n==null||r==null)throw new M;const l=this.moduleSize(n,t);let o=n[1];const d=r[1];let h=n[0];const b=(r[0]-h+1)/l,j=(d-o+1)/l;if(b<=0||j<=0)throw new M;const I=l/2;o+=I,h+=I;const k=new Ne(b,j);for(let G=0;G<j;G++){const J=o+G*l;for(let ee=0;ee<b;ee++)t.get(h+ee*l,J)&&k.set(ee,G)}return k}static moduleSize(t,n){const r=n.getWidth();let l=t[0];const o=t[1];for(;l<r&&n.get(l,o);)l++;if(l===r)throw new M;const d=l-t[0];if(d===0)throw new M;return d}}Za.NO_POINTS=[];class bi extends Ee{constructor(t=500){super(new Za,t)}}var tr;(function(_){_[_.L=0]="L",_[_.M=1]="M",_[_.Q=2]="Q",_[_.H=3]="H"})(tr||(tr={}));class pt{constructor(t,n,r){this.value=t,this.stringValue=n,this.bits=r,pt.FOR_BITS.set(r,this),pt.FOR_VALUE.set(t,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(t){switch(t){case"L":return pt.L;case"M":return pt.M;case"Q":return pt.Q;case"H":return pt.H;default:throw new A(t+"not available")}}toString(){return this.stringValue}equals(t){if(!(t instanceof pt))return!1;const n=t;return this.value===n.value}static forBits(t){if(t<0||t>=pt.FOR_BITS.size)throw new O;return pt.FOR_BITS.get(t)}}pt.FOR_BITS=new Map,pt.FOR_VALUE=new Map,pt.L=new pt(tr.L,"L",1),pt.M=new pt(tr.M,"M",0),pt.Q=new pt(tr.Q,"Q",3),pt.H=new pt(tr.H,"H",2);class Rs{constructor(t){this.errorCorrectionLevel=pt.forBits(t>>3&3),this.dataMask=t&7}static numBitsDiffering(t,n){return q.bitCount(t^n)}static decodeFormatInformation(t,n){const r=Rs.doDecodeFormatInformation(t,n);return r!==null?r:Rs.doDecodeFormatInformation(t^Rs.FORMAT_INFO_MASK_QR,n^Rs.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(t,n){let r=Number.MAX_SAFE_INTEGER,l=0;for(const o of Rs.FORMAT_INFO_DECODE_LOOKUP){const d=o[0];if(d===t||d===n)return new Rs(o[1]);let h=Rs.numBitsDiffering(t,d);h<r&&(l=o[1],r=h),t!==n&&(h=Rs.numBitsDiffering(n,d),h<r&&(l=o[1],r=h))}return r<=3?new Rs(l):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(t){if(!(t instanceof Rs))return!1;const n=t;return this.errorCorrectionLevel===n.errorCorrectionLevel&&this.dataMask===n.dataMask}}Rs.FORMAT_INFO_MASK_QR=21522,Rs.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class xe{constructor(t,...n){this.ecCodewordsPerBlock=t,this.ecBlocks=n}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let t=0;const n=this.ecBlocks;for(const r of n)t+=r.getCount();return t}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class H{constructor(t,n){this.count=t,this.dataCodewords=n}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Xe{constructor(t,n,...r){this.versionNumber=t,this.alignmentPatternCenters=n,this.ecBlocks=r;let l=0;const o=r[0].getECCodewordsPerBlock(),d=r[0].getECBlocks();for(const h of d)l+=h.getCount()*(h.getDataCodewords()+o);this.totalCodewords=l}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(t){return this.ecBlocks[t.getValue()]}static getProvisionalVersionForDimension(t){if(t%4!==1)throw new K;try{return this.getVersionForNumber((t-17)/4)}catch{throw new K}}static getVersionForNumber(t){if(t<1||t>40)throw new O;return Xe.VERSIONS[t-1]}static decodeVersionInformation(t){let n=Number.MAX_SAFE_INTEGER,r=0;for(let l=0;l<Xe.VERSION_DECODE_INFO.length;l++){const o=Xe.VERSION_DECODE_INFO[l];if(o===t)return Xe.getVersionForNumber(l+7);const d=Rs.numBitsDiffering(t,o);d<n&&(r=l+7,n=d)}return n<=3?Xe.getVersionForNumber(r):null}buildFunctionPattern(){const t=this.getDimensionForVersion(),n=new Ne(t);n.setRegion(0,0,9,9),n.setRegion(t-8,0,8,9),n.setRegion(0,t-8,9,8);const r=this.alignmentPatternCenters.length;for(let l=0;l<r;l++){const o=this.alignmentPatternCenters[l]-2;for(let d=0;d<r;d++)l===0&&(d===0||d===r-1)||l===r-1&&d===0||n.setRegion(this.alignmentPatternCenters[d]-2,o,5,5)}return n.setRegion(6,9,1,t-17),n.setRegion(9,6,t-17,1),this.versionNumber>6&&(n.setRegion(t-11,0,3,6),n.setRegion(0,t-11,6,3)),n}toString(){return""+this.versionNumber}}Xe.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Xe.VERSIONS=[new Xe(1,new Int32Array(0),new xe(7,new H(1,19)),new xe(10,new H(1,16)),new xe(13,new H(1,13)),new xe(17,new H(1,9))),new Xe(2,Int32Array.from([6,18]),new xe(10,new H(1,34)),new xe(16,new H(1,28)),new xe(22,new H(1,22)),new xe(28,new H(1,16))),new Xe(3,Int32Array.from([6,22]),new xe(15,new H(1,55)),new xe(26,new H(1,44)),new xe(18,new H(2,17)),new xe(22,new H(2,13))),new Xe(4,Int32Array.from([6,26]),new xe(20,new H(1,80)),new xe(18,new H(2,32)),new xe(26,new H(2,24)),new xe(16,new H(4,9))),new Xe(5,Int32Array.from([6,30]),new xe(26,new H(1,108)),new xe(24,new H(2,43)),new xe(18,new H(2,15),new H(2,16)),new xe(22,new H(2,11),new H(2,12))),new Xe(6,Int32Array.from([6,34]),new xe(18,new H(2,68)),new xe(16,new H(4,27)),new xe(24,new H(4,19)),new xe(28,new H(4,15))),new Xe(7,Int32Array.from([6,22,38]),new xe(20,new H(2,78)),new xe(18,new H(4,31)),new xe(18,new H(2,14),new H(4,15)),new xe(26,new H(4,13),new H(1,14))),new Xe(8,Int32Array.from([6,24,42]),new xe(24,new H(2,97)),new xe(22,new H(2,38),new H(2,39)),new xe(22,new H(4,18),new H(2,19)),new xe(26,new H(4,14),new H(2,15))),new Xe(9,Int32Array.from([6,26,46]),new xe(30,new H(2,116)),new xe(22,new H(3,36),new H(2,37)),new xe(20,new H(4,16),new H(4,17)),new xe(24,new H(4,12),new H(4,13))),new Xe(10,Int32Array.from([6,28,50]),new xe(18,new H(2,68),new H(2,69)),new xe(26,new H(4,43),new H(1,44)),new xe(24,new H(6,19),new H(2,20)),new xe(28,new H(6,15),new H(2,16))),new Xe(11,Int32Array.from([6,30,54]),new xe(20,new H(4,81)),new xe(30,new H(1,50),new H(4,51)),new xe(28,new H(4,22),new H(4,23)),new xe(24,new H(3,12),new H(8,13))),new Xe(12,Int32Array.from([6,32,58]),new xe(24,new H(2,92),new H(2,93)),new xe(22,new H(6,36),new H(2,37)),new xe(26,new H(4,20),new H(6,21)),new xe(28,new H(7,14),new H(4,15))),new Xe(13,Int32Array.from([6,34,62]),new xe(26,new H(4,107)),new xe(22,new H(8,37),new H(1,38)),new xe(24,new H(8,20),new H(4,21)),new xe(22,new H(12,11),new H(4,12))),new Xe(14,Int32Array.from([6,26,46,66]),new xe(30,new H(3,115),new H(1,116)),new xe(24,new H(4,40),new H(5,41)),new xe(20,new H(11,16),new H(5,17)),new xe(24,new H(11,12),new H(5,13))),new Xe(15,Int32Array.from([6,26,48,70]),new xe(22,new H(5,87),new H(1,88)),new xe(24,new H(5,41),new H(5,42)),new xe(30,new H(5,24),new H(7,25)),new xe(24,new H(11,12),new H(7,13))),new Xe(16,Int32Array.from([6,26,50,74]),new xe(24,new H(5,98),new H(1,99)),new xe(28,new H(7,45),new H(3,46)),new xe(24,new H(15,19),new H(2,20)),new xe(30,new H(3,15),new H(13,16))),new Xe(17,Int32Array.from([6,30,54,78]),new xe(28,new H(1,107),new H(5,108)),new xe(28,new H(10,46),new H(1,47)),new xe(28,new H(1,22),new H(15,23)),new xe(28,new H(2,14),new H(17,15))),new Xe(18,Int32Array.from([6,30,56,82]),new xe(30,new H(5,120),new H(1,121)),new xe(26,new H(9,43),new H(4,44)),new xe(28,new H(17,22),new H(1,23)),new xe(28,new H(2,14),new H(19,15))),new Xe(19,Int32Array.from([6,30,58,86]),new xe(28,new H(3,113),new H(4,114)),new xe(26,new H(3,44),new H(11,45)),new xe(26,new H(17,21),new H(4,22)),new xe(26,new H(9,13),new H(16,14))),new Xe(20,Int32Array.from([6,34,62,90]),new xe(28,new H(3,107),new H(5,108)),new xe(26,new H(3,41),new H(13,42)),new xe(30,new H(15,24),new H(5,25)),new xe(28,new H(15,15),new H(10,16))),new Xe(21,Int32Array.from([6,28,50,72,94]),new xe(28,new H(4,116),new H(4,117)),new xe(26,new H(17,42)),new xe(28,new H(17,22),new H(6,23)),new xe(30,new H(19,16),new H(6,17))),new Xe(22,Int32Array.from([6,26,50,74,98]),new xe(28,new H(2,111),new H(7,112)),new xe(28,new H(17,46)),new xe(30,new H(7,24),new H(16,25)),new xe(24,new H(34,13))),new Xe(23,Int32Array.from([6,30,54,78,102]),new xe(30,new H(4,121),new H(5,122)),new xe(28,new H(4,47),new H(14,48)),new xe(30,new H(11,24),new H(14,25)),new xe(30,new H(16,15),new H(14,16))),new Xe(24,Int32Array.from([6,28,54,80,106]),new xe(30,new H(6,117),new H(4,118)),new xe(28,new H(6,45),new H(14,46)),new xe(30,new H(11,24),new H(16,25)),new xe(30,new H(30,16),new H(2,17))),new Xe(25,Int32Array.from([6,32,58,84,110]),new xe(26,new H(8,106),new H(4,107)),new xe(28,new H(8,47),new H(13,48)),new xe(30,new H(7,24),new H(22,25)),new xe(30,new H(22,15),new H(13,16))),new Xe(26,Int32Array.from([6,30,58,86,114]),new xe(28,new H(10,114),new H(2,115)),new xe(28,new H(19,46),new H(4,47)),new xe(28,new H(28,22),new H(6,23)),new xe(30,new H(33,16),new H(4,17))),new Xe(27,Int32Array.from([6,34,62,90,118]),new xe(30,new H(8,122),new H(4,123)),new xe(28,new H(22,45),new H(3,46)),new xe(30,new H(8,23),new H(26,24)),new xe(30,new H(12,15),new H(28,16))),new Xe(28,Int32Array.from([6,26,50,74,98,122]),new xe(30,new H(3,117),new H(10,118)),new xe(28,new H(3,45),new H(23,46)),new xe(30,new H(4,24),new H(31,25)),new xe(30,new H(11,15),new H(31,16))),new Xe(29,Int32Array.from([6,30,54,78,102,126]),new xe(30,new H(7,116),new H(7,117)),new xe(28,new H(21,45),new H(7,46)),new xe(30,new H(1,23),new H(37,24)),new xe(30,new H(19,15),new H(26,16))),new Xe(30,Int32Array.from([6,26,52,78,104,130]),new xe(30,new H(5,115),new H(10,116)),new xe(28,new H(19,47),new H(10,48)),new xe(30,new H(15,24),new H(25,25)),new xe(30,new H(23,15),new H(25,16))),new Xe(31,Int32Array.from([6,30,56,82,108,134]),new xe(30,new H(13,115),new H(3,116)),new xe(28,new H(2,46),new H(29,47)),new xe(30,new H(42,24),new H(1,25)),new xe(30,new H(23,15),new H(28,16))),new Xe(32,Int32Array.from([6,34,60,86,112,138]),new xe(30,new H(17,115)),new xe(28,new H(10,46),new H(23,47)),new xe(30,new H(10,24),new H(35,25)),new xe(30,new H(19,15),new H(35,16))),new Xe(33,Int32Array.from([6,30,58,86,114,142]),new xe(30,new H(17,115),new H(1,116)),new xe(28,new H(14,46),new H(21,47)),new xe(30,new H(29,24),new H(19,25)),new xe(30,new H(11,15),new H(46,16))),new Xe(34,Int32Array.from([6,34,62,90,118,146]),new xe(30,new H(13,115),new H(6,116)),new xe(28,new H(14,46),new H(23,47)),new xe(30,new H(44,24),new H(7,25)),new xe(30,new H(59,16),new H(1,17))),new Xe(35,Int32Array.from([6,30,54,78,102,126,150]),new xe(30,new H(12,121),new H(7,122)),new xe(28,new H(12,47),new H(26,48)),new xe(30,new H(39,24),new H(14,25)),new xe(30,new H(22,15),new H(41,16))),new Xe(36,Int32Array.from([6,24,50,76,102,128,154]),new xe(30,new H(6,121),new H(14,122)),new xe(28,new H(6,47),new H(34,48)),new xe(30,new H(46,24),new H(10,25)),new xe(30,new H(2,15),new H(64,16))),new Xe(37,Int32Array.from([6,28,54,80,106,132,158]),new xe(30,new H(17,122),new H(4,123)),new xe(28,new H(29,46),new H(14,47)),new xe(30,new H(49,24),new H(10,25)),new xe(30,new H(24,15),new H(46,16))),new Xe(38,Int32Array.from([6,32,58,84,110,136,162]),new xe(30,new H(4,122),new H(18,123)),new xe(28,new H(13,46),new H(32,47)),new xe(30,new H(48,24),new H(14,25)),new xe(30,new H(42,15),new H(32,16))),new Xe(39,Int32Array.from([6,26,54,82,110,138,166]),new xe(30,new H(20,117),new H(4,118)),new xe(28,new H(40,47),new H(7,48)),new xe(30,new H(43,24),new H(22,25)),new xe(30,new H(10,15),new H(67,16))),new Xe(40,Int32Array.from([6,30,58,86,114,142,170]),new xe(30,new H(19,118),new H(6,119)),new xe(28,new H(18,47),new H(31,48)),new xe(30,new H(34,24),new H(34,25)),new xe(30,new H(20,15),new H(61,16)))];var Es;(function(_){_[_.DATA_MASK_000=0]="DATA_MASK_000",_[_.DATA_MASK_001=1]="DATA_MASK_001",_[_.DATA_MASK_010=2]="DATA_MASK_010",_[_.DATA_MASK_011=3]="DATA_MASK_011",_[_.DATA_MASK_100=4]="DATA_MASK_100",_[_.DATA_MASK_101=5]="DATA_MASK_101",_[_.DATA_MASK_110=6]="DATA_MASK_110",_[_.DATA_MASK_111=7]="DATA_MASK_111"})(Es||(Es={}));class na{constructor(t,n){this.value=t,this.isMasked=n}unmaskBitMatrix(t,n){for(let r=0;r<n;r++)for(let l=0;l<n;l++)this.isMasked(r,l)&&t.flip(l,r)}}na.values=new Map([[Es.DATA_MASK_000,new na(Es.DATA_MASK_000,(_,t)=>(_+t&1)===0)],[Es.DATA_MASK_001,new na(Es.DATA_MASK_001,(_,t)=>(_&1)===0)],[Es.DATA_MASK_010,new na(Es.DATA_MASK_010,(_,t)=>t%3===0)],[Es.DATA_MASK_011,new na(Es.DATA_MASK_011,(_,t)=>(_+t)%3===0)],[Es.DATA_MASK_100,new na(Es.DATA_MASK_100,(_,t)=>(Math.floor(_/2)+Math.floor(t/3)&1)===0)],[Es.DATA_MASK_101,new na(Es.DATA_MASK_101,(_,t)=>_*t%6===0)],[Es.DATA_MASK_110,new na(Es.DATA_MASK_110,(_,t)=>_*t%6<3)],[Es.DATA_MASK_111,new na(Es.DATA_MASK_111,(_,t)=>(_+t+_*t%3&1)===0)]]);class sr{constructor(t){const n=t.getHeight();if(n<21||(n&3)!==1)throw new K;this.bitMatrix=t}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let t=0;for(let o=0;o<6;o++)t=this.copyBit(o,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t),t=this.copyBit(8,7,t);for(let o=5;o>=0;o--)t=this.copyBit(8,o,t);const n=this.bitMatrix.getHeight();let r=0;const l=n-7;for(let o=n-1;o>=l;o--)r=this.copyBit(8,o,r);for(let o=n-8;o<n;o++)r=this.copyBit(o,8,r);if(this.parsedFormatInfo=Rs.decodeFormatInformation(t,r),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new K}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const t=this.bitMatrix.getHeight(),n=Math.floor((t-17)/4);if(n<=6)return Xe.getVersionForNumber(n);let r=0;const l=t-11;for(let d=5;d>=0;d--)for(let h=t-9;h>=l;h--)r=this.copyBit(h,d,r);let o=Xe.decodeVersionInformation(r);if(o!==null&&o.getDimensionForVersion()===t)return this.parsedVersion=o,o;r=0;for(let d=5;d>=0;d--)for(let h=t-9;h>=l;h--)r=this.copyBit(d,h,r);if(o=Xe.decodeVersionInformation(r),o!==null&&o.getDimensionForVersion()===t)return this.parsedVersion=o,o;throw new K}copyBit(t,n,r){return(this.isMirror?this.bitMatrix.get(n,t):this.bitMatrix.get(t,n))?r<<1|1:r<<1}readCodewords(){const t=this.readFormatInformation(),n=this.readVersion(),r=na.values.get(t.getDataMask()),l=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,l);const o=n.buildFunctionPattern();let d=!0;const h=new Uint8Array(n.getTotalCodewords());let g=0,b=0,j=0;for(let I=l-1;I>0;I-=2){I===6&&I--;for(let k=0;k<l;k++){const G=d?l-1-k:k;for(let J=0;J<2;J++)o.get(I-J,G)||(j++,b<<=1,this.bitMatrix.get(I-J,G)&&(b|=1),j===8&&(h[g++]=b,j=0,b=0))}d=!d}if(g!==n.getTotalCodewords())throw new K;return h}remask(){if(this.parsedFormatInfo===null)return;const t=na.values[this.parsedFormatInfo.getDataMask()],n=this.bitMatrix.getHeight();t.unmaskBitMatrix(this.bitMatrix,n)}setMirror(t){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=t}mirror(){const t=this.bitMatrix;for(let n=0,r=t.getWidth();n<r;n++)for(let l=n+1,o=t.getHeight();l<o;l++)t.get(n,l)!==t.get(l,n)&&(t.flip(l,n),t.flip(n,l))}}class dl{constructor(t,n){this.numDataCodewords=t,this.codewords=n}static getDataBlocks(t,n,r){if(t.length!==n.getTotalCodewords())throw new O;const l=n.getECBlocksForLevel(r);let o=0;const d=l.getECBlocks();for(const J of d)o+=J.getCount();const h=new Array(o);let g=0;for(const J of d)for(let ee=0;ee<J.getCount();ee++){const ue=J.getDataCodewords(),be=l.getECCodewordsPerBlock()+ue;h[g++]=new dl(ue,new Uint8Array(be))}const b=h[0].codewords.length;let j=h.length-1;for(;j>=0&&h[j].codewords.length!==b;)j--;j++;const I=b-l.getECCodewordsPerBlock();let k=0;for(let J=0;J<I;J++)for(let ee=0;ee<g;ee++)h[ee].codewords[J]=t[k++];for(let J=j;J<g;J++)h[J].codewords[I]=t[k++];const G=h[0].codewords.length;for(let J=I;J<G;J++)for(let ee=0;ee<g;ee++){const ue=ee<j?J:J+1;h[ee].codewords[ue]=t[k++]}return h}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var ra;(function(_){_[_.TERMINATOR=0]="TERMINATOR",_[_.NUMERIC=1]="NUMERIC",_[_.ALPHANUMERIC=2]="ALPHANUMERIC",_[_.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",_[_.BYTE=4]="BYTE",_[_.ECI=5]="ECI",_[_.KANJI=6]="KANJI",_[_.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",_[_.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",_[_.HANZI=9]="HANZI"})(ra||(ra={}));class We{constructor(t,n,r,l){this.value=t,this.stringValue=n,this.characterCountBitsForVersions=r,this.bits=l,We.FOR_BITS.set(l,this),We.FOR_VALUE.set(t,this)}static forBits(t){const n=We.FOR_BITS.get(t);if(n===void 0)throw new O;return n}getCharacterCountBits(t){const n=t.getVersionNumber();let r;return n<=9?r=0:n<=26?r=1:r=2,this.characterCountBitsForVersions[r]}getValue(){return this.value}getBits(){return this.bits}equals(t){if(!(t instanceof We))return!1;const n=t;return this.value===n.value}toString(){return this.stringValue}}We.FOR_BITS=new Map,We.FOR_VALUE=new Map,We.TERMINATOR=new We(ra.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),We.NUMERIC=new We(ra.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),We.ALPHANUMERIC=new We(ra.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),We.STRUCTURED_APPEND=new We(ra.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),We.BYTE=new We(ra.BYTE,"BYTE",Int32Array.from([8,16,16]),4),We.ECI=new We(ra.ECI,"ECI",Int32Array.from([0,0,0]),7),We.KANJI=new We(ra.KANJI,"KANJI",Int32Array.from([8,10,12]),8),We.FNC1_FIRST_POSITION=new We(ra.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),We.FNC1_SECOND_POSITION=new We(ra.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),We.HANZI=new We(ra.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class $t{static decode(t,n,r,l){const o=new Ca(t);let d=new ve;const h=new Array;let g=-1,b=-1;try{let j=null,I=!1,k;do{if(o.available()<4)k=We.TERMINATOR;else{const G=o.readBits(4);k=We.forBits(G)}switch(k){case We.TERMINATOR:break;case We.FNC1_FIRST_POSITION:case We.FNC1_SECOND_POSITION:I=!0;break;case We.STRUCTURED_APPEND:if(o.available()<16)throw new K;g=o.readBits(8),b=o.readBits(8);break;case We.ECI:const G=$t.parseECIValue(o);if(j=re.getCharacterSetECIByValue(G),j===null)throw new K;break;case We.HANZI:const J=o.readBits(4),ee=o.readBits(k.getCharacterCountBits(n));J===$t.GB2312_SUBSET&&$t.decodeHanziSegment(o,d,ee);break;default:const ue=o.readBits(k.getCharacterCountBits(n));switch(k){case We.NUMERIC:$t.decodeNumericSegment(o,d,ue);break;case We.ALPHANUMERIC:$t.decodeAlphanumericSegment(o,d,ue,I);break;case We.BYTE:$t.decodeByteSegment(o,d,ue,j,h,l);break;case We.KANJI:$t.decodeKanjiSegment(o,d,ue);break;default:throw new K}break}}while(k!==We.TERMINATOR)}catch{throw new K}return new ct(t,d.toString(),h.length===0?null:h,r===null?null:r.toString(),g,b)}static decodeHanziSegment(t,n,r){if(r*13>t.available())throw new K;const l=new Uint8Array(2*r);let o=0;for(;r>0;){const d=t.readBits(13);let h=d/96<<8&4294967295|d%96;h<959?h+=41377:h+=42657,l[o]=h>>8&255,l[o+1]=h&255,o+=2,r--}try{n.append(Oe.decode(l,$.GB2312))}catch(d){throw new K(d)}}static decodeKanjiSegment(t,n,r){if(r*13>t.available())throw new K;const l=new Uint8Array(2*r);let o=0;for(;r>0;){const d=t.readBits(13);let h=d/192<<8&4294967295|d%192;h<7936?h+=33088:h+=49472,l[o]=h>>8,l[o+1]=h,o+=2,r--}try{n.append(Oe.decode(l,$.SHIFT_JIS))}catch(d){throw new K(d)}}static decodeByteSegment(t,n,r,l,o,d){if(8*r>t.available())throw new K;const h=new Uint8Array(r);for(let b=0;b<r;b++)h[b]=t.readBits(8);let g;l===null?g=$.guessEncoding(h,d):g=l.getName();try{n.append(Oe.decode(h,g))}catch(b){throw new K(b)}o.push(h)}static toAlphaNumericChar(t){if(t>=$t.ALPHANUMERIC_CHARS.length)throw new K;return $t.ALPHANUMERIC_CHARS[t]}static decodeAlphanumericSegment(t,n,r,l){const o=n.length();for(;r>1;){if(t.available()<11)throw new K;const d=t.readBits(11);n.append($t.toAlphaNumericChar(Math.floor(d/45))),n.append($t.toAlphaNumericChar(d%45)),r-=2}if(r===1){if(t.available()<6)throw new K;n.append($t.toAlphaNumericChar(t.readBits(6)))}if(l)for(let d=o;d<n.length();d++)n.charAt(d)==="%"&&(d<n.length()-1&&n.charAt(d+1)==="%"?n.deleteCharAt(d+1):n.setCharAt(d,""))}static decodeNumericSegment(t,n,r){for(;r>=3;){if(t.available()<10)throw new K;const l=t.readBits(10);if(l>=1e3)throw new K;n.append($t.toAlphaNumericChar(Math.floor(l/100))),n.append($t.toAlphaNumericChar(Math.floor(l/10)%10)),n.append($t.toAlphaNumericChar(l%10)),r-=3}if(r===2){if(t.available()<7)throw new K;const l=t.readBits(7);if(l>=100)throw new K;n.append($t.toAlphaNumericChar(Math.floor(l/10))),n.append($t.toAlphaNumericChar(l%10))}else if(r===1){if(t.available()<4)throw new K;const l=t.readBits(4);if(l>=10)throw new K;n.append($t.toAlphaNumericChar(l))}}static parseECIValue(t){const n=t.readBits(8);if((n&128)===0)return n&127;if((n&192)===128){const r=t.readBits(8);return(n&63)<<8&4294967295|r}if((n&224)===192){const r=t.readBits(16);return(n&31)<<16&4294967295|r}throw new K}}$t.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",$t.GB2312_SUBSET=1;class fo{constructor(t){this.mirrored=t}isMirrored(){return this.mirrored}applyMirroredCorrection(t){if(!this.mirrored||t===null||t.length<3)return;const n=t[0];t[0]=t[2],t[2]=n}}class Zc{constructor(){this.rsDecoder=new us(dt.QR_CODE_FIELD_256)}decodeBooleanArray(t,n){return this.decodeBitMatrix(Ne.parseFromBooleanArray(t),n)}decodeBitMatrix(t,n){const r=new sr(t);let l=null;try{return this.decodeBitMatrixParser(r,n)}catch(o){l=o}try{r.remask(),r.setMirror(!0),r.readVersion(),r.readFormatInformation(),r.mirror();const o=this.decodeBitMatrixParser(r,n);return o.setOther(new fo(!0)),o}catch(o){throw l!==null?l:o}}decodeBitMatrixParser(t,n){const r=t.readVersion(),l=t.readFormatInformation().getErrorCorrectionLevel(),o=t.readCodewords(),d=dl.getDataBlocks(o,r,l);let h=0;for(const j of d)h+=j.getNumDataCodewords();const g=new Uint8Array(h);let b=0;for(const j of d){const I=j.getCodewords(),k=j.getNumDataCodewords();this.correctErrors(I,k);for(let G=0;G<k;G++)g[b++]=I[G]}return $t.decode(g,r,l,n)}correctErrors(t,n){const r=new Int32Array(t);try{this.rsDecoder.decode(r,t.length-n)}catch{throw new z}for(let l=0;l<n;l++)t[l]=r[l]}}class ar extends _e{constructor(t,n,r){super(t,n),this.estimatedModuleSize=r}aboutEquals(t,n,r){if(Math.abs(n-this.getY())<=t&&Math.abs(r-this.getX())<=t){const l=Math.abs(t-this.estimatedModuleSize);return l<=1||l<=this.estimatedModuleSize}return!1}combineEstimate(t,n,r){const l=(this.getX()+n)/2,o=(this.getY()+t)/2,d=(this.estimatedModuleSize+r)/2;return new ar(l,o,d)}}class ca{constructor(t,n,r,l,o,d,h){this.image=t,this.startX=n,this.startY=r,this.width=l,this.height=o,this.moduleSize=d,this.resultPointCallback=h,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const t=this.startX,n=this.height,r=this.width,l=t+r,o=this.startY+n/2,d=new Int32Array(3),h=this.image;for(let g=0;g<n;g++){const b=o+((g&1)===0?Math.floor((g+1)/2):-Math.floor((g+1)/2));d[0]=0,d[1]=0,d[2]=0;let j=t;for(;j<l&&!h.get(j,b);)j++;let I=0;for(;j<l;){if(h.get(j,b))if(I===1)d[1]++;else if(I===2){if(this.foundPatternCross(d)){const k=this.handlePossibleCenter(d,b,j);if(k!==null)return k}d[0]=d[2],d[1]=1,d[2]=0,I=1}else d[++I]++;else I===1&&I++,d[I]++;j++}if(this.foundPatternCross(d)){const k=this.handlePossibleCenter(d,b,l);if(k!==null)return k}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new M}static centerFromEnd(t,n){return n-t[2]-t[1]/2}foundPatternCross(t){const n=this.moduleSize,r=n/2;for(let l=0;l<3;l++)if(Math.abs(n-t[l])>=r)return!1;return!0}crossCheckVertical(t,n,r,l){const o=this.image,d=o.getHeight(),h=this.crossCheckStateCount;h[0]=0,h[1]=0,h[2]=0;let g=t;for(;g>=0&&o.get(n,g)&&h[1]<=r;)h[1]++,g--;if(g<0||h[1]>r)return NaN;for(;g>=0&&!o.get(n,g)&&h[0]<=r;)h[0]++,g--;if(h[0]>r)return NaN;for(g=t+1;g<d&&o.get(n,g)&&h[1]<=r;)h[1]++,g++;if(g===d||h[1]>r)return NaN;for(;g<d&&!o.get(n,g)&&h[2]<=r;)h[2]++,g++;if(h[2]>r)return NaN;const b=h[0]+h[1]+h[2];return 5*Math.abs(b-l)>=2*l?NaN:this.foundPatternCross(h)?ca.centerFromEnd(h,g):NaN}handlePossibleCenter(t,n,r){const l=t[0]+t[1]+t[2],o=ca.centerFromEnd(t,r),d=this.crossCheckVertical(n,o,2*t[1],l);if(!isNaN(d)){const h=(t[0]+t[1]+t[2])/3;for(const b of this.possibleCenters)if(b.aboutEquals(h,d,o))return b.combineEstimate(d,o,h);const g=new ar(o,d,h);this.possibleCenters.push(g),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(g)}return null}}class qr extends _e{constructor(t,n,r,l){super(t,n),this.estimatedModuleSize=r,this.count=l,l===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(t,n,r){if(Math.abs(n-this.getY())<=t&&Math.abs(r-this.getX())<=t){const l=Math.abs(t-this.estimatedModuleSize);return l<=1||l<=this.estimatedModuleSize}return!1}combineEstimate(t,n,r){const l=this.count+1,o=(this.count*this.getX()+n)/l,d=(this.count*this.getY()+t)/l,h=(this.count*this.estimatedModuleSize+r)/l;return new qr(o,d,h,l)}}class ul{constructor(t){this.bottomLeft=t[0],this.topLeft=t[1],this.topRight=t[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class is{constructor(t,n){this.image=t,this.resultPointCallback=n,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=n}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(t){const n=t!=null&&t.get(te.TRY_HARDER)!==void 0,r=t!=null&&t.get(te.PURE_BARCODE)!==void 0,l=this.image,o=l.getHeight(),d=l.getWidth();let h=Math.floor(3*o/(4*is.MAX_MODULES));(h<is.MIN_SKIP||n)&&(h=is.MIN_SKIP);let g=!1;const b=new Int32Array(5);for(let I=h-1;I<o&&!g;I+=h){b[0]=0,b[1]=0,b[2]=0,b[3]=0,b[4]=0;let k=0;for(let G=0;G<d;G++)if(l.get(G,I))(k&1)===1&&k++,b[k]++;else if((k&1)===0)if(k===4)if(is.foundPatternCross(b)){if(this.handlePossibleCenter(b,I,G,r)===!0)if(h=2,this.hasSkipped===!0)g=this.haveMultiplyConfirmedCenters();else{const ee=this.findRowSkip();ee>b[2]&&(I+=ee-b[2]-h,G=d-1)}else{b[0]=b[2],b[1]=b[3],b[2]=b[4],b[3]=1,b[4]=0,k=3;continue}k=0,b[0]=0,b[1]=0,b[2]=0,b[3]=0,b[4]=0}else b[0]=b[2],b[1]=b[3],b[2]=b[4],b[3]=1,b[4]=0,k=3;else b[++k]++;else b[k]++;is.foundPatternCross(b)&&this.handlePossibleCenter(b,I,d,r)===!0&&(h=b[0],this.hasSkipped&&(g=this.haveMultiplyConfirmedCenters()))}const j=this.selectBestPatterns();return _e.orderBestPatterns(j),new ul(j)}static centerFromEnd(t,n){return n-t[4]-t[3]-t[2]/2}static foundPatternCross(t){let n=0;for(let o=0;o<5;o++){const d=t[o];if(d===0)return!1;n+=d}if(n<7)return!1;const r=n/7,l=r/2;return Math.abs(r-t[0])<l&&Math.abs(r-t[1])<l&&Math.abs(3*r-t[2])<3*l&&Math.abs(r-t[3])<l&&Math.abs(r-t[4])<l}getCrossCheckStateCount(){const t=this.crossCheckStateCount;return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t}crossCheckDiagonal(t,n,r,l){const o=this.getCrossCheckStateCount();let d=0;const h=this.image;for(;t>=d&&n>=d&&h.get(n-d,t-d);)o[2]++,d++;if(t<d||n<d)return!1;for(;t>=d&&n>=d&&!h.get(n-d,t-d)&&o[1]<=r;)o[1]++,d++;if(t<d||n<d||o[1]>r)return!1;for(;t>=d&&n>=d&&h.get(n-d,t-d)&&o[0]<=r;)o[0]++,d++;if(o[0]>r)return!1;const g=h.getHeight(),b=h.getWidth();for(d=1;t+d<g&&n+d<b&&h.get(n+d,t+d);)o[2]++,d++;if(t+d>=g||n+d>=b)return!1;for(;t+d<g&&n+d<b&&!h.get(n+d,t+d)&&o[3]<r;)o[3]++,d++;if(t+d>=g||n+d>=b||o[3]>=r)return!1;for(;t+d<g&&n+d<b&&h.get(n+d,t+d)&&o[4]<r;)o[4]++,d++;if(o[4]>=r)return!1;const j=o[0]+o[1]+o[2]+o[3]+o[4];return Math.abs(j-l)<2*l&&is.foundPatternCross(o)}crossCheckVertical(t,n,r,l){const o=this.image,d=o.getHeight(),h=this.getCrossCheckStateCount();let g=t;for(;g>=0&&o.get(n,g);)h[2]++,g--;if(g<0)return NaN;for(;g>=0&&!o.get(n,g)&&h[1]<=r;)h[1]++,g--;if(g<0||h[1]>r)return NaN;for(;g>=0&&o.get(n,g)&&h[0]<=r;)h[0]++,g--;if(h[0]>r)return NaN;for(g=t+1;g<d&&o.get(n,g);)h[2]++,g++;if(g===d)return NaN;for(;g<d&&!o.get(n,g)&&h[3]<r;)h[3]++,g++;if(g===d||h[3]>=r)return NaN;for(;g<d&&o.get(n,g)&&h[4]<r;)h[4]++,g++;if(h[4]>=r)return NaN;const b=h[0]+h[1]+h[2]+h[3]+h[4];return 5*Math.abs(b-l)>=2*l?NaN:is.foundPatternCross(h)?is.centerFromEnd(h,g):NaN}crossCheckHorizontal(t,n,r,l){const o=this.image,d=o.getWidth(),h=this.getCrossCheckStateCount();let g=t;for(;g>=0&&o.get(g,n);)h[2]++,g--;if(g<0)return NaN;for(;g>=0&&!o.get(g,n)&&h[1]<=r;)h[1]++,g--;if(g<0||h[1]>r)return NaN;for(;g>=0&&o.get(g,n)&&h[0]<=r;)h[0]++,g--;if(h[0]>r)return NaN;for(g=t+1;g<d&&o.get(g,n);)h[2]++,g++;if(g===d)return NaN;for(;g<d&&!o.get(g,n)&&h[3]<r;)h[3]++,g++;if(g===d||h[3]>=r)return NaN;for(;g<d&&o.get(g,n)&&h[4]<r;)h[4]++,g++;if(h[4]>=r)return NaN;const b=h[0]+h[1]+h[2]+h[3]+h[4];return 5*Math.abs(b-l)>=l?NaN:is.foundPatternCross(h)?is.centerFromEnd(h,g):NaN}handlePossibleCenter(t,n,r,l){const o=t[0]+t[1]+t[2]+t[3]+t[4];let d=is.centerFromEnd(t,r),h=this.crossCheckVertical(n,Math.floor(d),t[2],o);if(!isNaN(h)&&(d=this.crossCheckHorizontal(Math.floor(d),Math.floor(h),t[2],o),!isNaN(d)&&(!l||this.crossCheckDiagonal(Math.floor(h),Math.floor(d),t[2],o)))){const g=o/7;let b=!1;const j=this.possibleCenters;for(let I=0,k=j.length;I<k;I++){const G=j[I];if(G.aboutEquals(g,h,d)){j[I]=G.combineEstimate(h,d,g),b=!0;break}}if(!b){const I=new qr(d,h,g);j.push(I),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(I)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let n=null;for(const r of this.possibleCenters)if(r.getCount()>=is.CENTER_QUORUM)if(n==null)n=r;else return this.hasSkipped=!0,Math.floor((Math.abs(n.getX()-r.getX())-Math.abs(n.getY()-r.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let t=0,n=0;const r=this.possibleCenters.length;for(const d of this.possibleCenters)d.getCount()>=is.CENTER_QUORUM&&(t++,n+=d.getEstimatedModuleSize());if(t<3)return!1;const l=n/r;let o=0;for(const d of this.possibleCenters)o+=Math.abs(d.getEstimatedModuleSize()-l);return o<=.05*n}selectBestPatterns(){const t=this.possibleCenters.length;if(t<3)throw new M;const n=this.possibleCenters;let r;if(t>3){let l=0,o=0;for(const g of this.possibleCenters){const b=g.getEstimatedModuleSize();l+=b,o+=b*b}r=l/t;let d=Math.sqrt(o/t-r*r);n.sort((g,b)=>{const j=Math.abs(b.getEstimatedModuleSize()-r),I=Math.abs(g.getEstimatedModuleSize()-r);return j<I?-1:j>I?1:0});const h=Math.max(.2*r,d);for(let g=0;g<n.length&&n.length>3;g++){const b=n[g];Math.abs(b.getEstimatedModuleSize()-r)>h&&(n.splice(g,1),g--)}}if(n.length>3){let l=0;for(const o of n)l+=o.getEstimatedModuleSize();r=l/n.length,n.sort((o,d)=>{if(d.getCount()===o.getCount()){const h=Math.abs(d.getEstimatedModuleSize()-r),g=Math.abs(o.getEstimatedModuleSize()-r);return h<g?1:h>g?-1:0}else return d.getCount()-o.getCount()}),n.splice(3)}return[n[0],n[1],n[2]]}}is.CENTER_QUORUM=2,is.MIN_SKIP=3,is.MAX_MODULES=57;class La{constructor(t){this.image=t}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(t){this.resultPointCallback=t==null?null:t.get(te.NEED_RESULT_POINT_CALLBACK);const r=new is(this.image,this.resultPointCallback).find(t);return this.processFinderPatternInfo(r)}processFinderPatternInfo(t){const n=t.getTopLeft(),r=t.getTopRight(),l=t.getBottomLeft(),o=this.calculateModuleSize(n,r,l);if(o<1)throw new M("No pattern found in proccess finder.");const d=La.computeDimension(n,r,l,o),h=Xe.getProvisionalVersionForDimension(d),g=h.getDimensionForVersion()-7;let b=null;if(h.getAlignmentPatternCenters().length>0){const G=r.getX()-n.getX()+l.getX(),J=r.getY()-n.getY()+l.getY(),ee=1-3/g,ue=Math.floor(n.getX()+ee*(G-n.getX())),be=Math.floor(n.getY()+ee*(J-n.getY()));for(let Be=4;Be<=16;Be<<=1)try{b=this.findAlignmentInRegion(o,ue,be,Be);break}catch(Me){if(!(Me instanceof M))throw Me}}const j=La.createTransform(n,r,l,b,d),I=La.sampleGrid(this.image,j,d);let k;return b===null?k=[l,n,r]:k=[l,n,r,b],new ie(I,k)}static createTransform(t,n,r,l,o){const d=o-3.5;let h,g,b,j;return l!==null?(h=l.getX(),g=l.getY(),b=d-3,j=b):(h=n.getX()-t.getX()+r.getX(),g=n.getY()-t.getY()+r.getY(),b=d,j=d),Pe.quadrilateralToQuadrilateral(3.5,3.5,d,3.5,b,j,3.5,d,t.getX(),t.getY(),n.getX(),n.getY(),h,g,r.getX(),r.getY())}static sampleGrid(t,n,r){return St.getInstance().sampleGridWithTransform(t,r,r,n)}static computeDimension(t,n,r,l){const o=de.round(_e.distance(t,n)/l),d=de.round(_e.distance(t,r)/l);let h=Math.floor((o+d)/2)+7;switch(h&3){case 0:h++;break;case 2:h--;break;case 3:throw new M("Dimensions could be not found.")}return h}calculateModuleSize(t,n,r){return(this.calculateModuleSizeOneWay(t,n)+this.calculateModuleSizeOneWay(t,r))/2}calculateModuleSizeOneWay(t,n){const r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(n.getX()),Math.floor(n.getY())),l=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(n.getX()),Math.floor(n.getY()),Math.floor(t.getX()),Math.floor(t.getY()));return isNaN(r)?l/7:isNaN(l)?r/7:(r+l)/14}sizeOfBlackWhiteBlackRunBothWays(t,n,r,l){let o=this.sizeOfBlackWhiteBlackRun(t,n,r,l),d=1,h=t-(r-t);h<0?(d=t/(t-h),h=0):h>=this.image.getWidth()&&(d=(this.image.getWidth()-1-t)/(h-t),h=this.image.getWidth()-1);let g=Math.floor(n-(l-n)*d);return d=1,g<0?(d=n/(n-g),g=0):g>=this.image.getHeight()&&(d=(this.image.getHeight()-1-n)/(g-n),g=this.image.getHeight()-1),h=Math.floor(t+(h-t)*d),o+=this.sizeOfBlackWhiteBlackRun(t,n,h,g),o-1}sizeOfBlackWhiteBlackRun(t,n,r,l){const o=Math.abs(l-n)>Math.abs(r-t);if(o){let G=t;t=n,n=G,G=r,r=l,l=G}const d=Math.abs(r-t),h=Math.abs(l-n);let g=-d/2;const b=t<r?1:-1,j=n<l?1:-1;let I=0;const k=r+b;for(let G=t,J=n;G!==k;G+=b){const ee=o?J:G,ue=o?G:J;if(I===1===this.image.get(ee,ue)){if(I===2)return de.distance(G,J,t,n);I++}if(g+=h,g>0){if(J===l)break;J+=j,g-=d}}return I===2?de.distance(r+b,l,t,n):NaN}findAlignmentInRegion(t,n,r,l){const o=Math.floor(l*t),d=Math.max(0,n-o),h=Math.min(this.image.getWidth()-1,n+o);if(h-d<t*3)throw new M("Alignment top exceeds estimated module size.");const g=Math.max(0,r-o),b=Math.min(this.image.getHeight()-1,r+o);if(b-g<t*3)throw new M("Alignment bottom exceeds estimated module size.");return new ca(this.image,d,g,h-d,b-g,t,this.resultPointCallback).find()}}class Wa{constructor(){this.decoder=new Zc}getDecoder(){return this.decoder}decode(t,n){let r,l;if(n!=null&&n.get(te.PURE_BARCODE)!==void 0){const g=Wa.extractPureBits(t.getBlackMatrix());r=this.decoder.decodeBitMatrix(g,n),l=Wa.NO_POINTS}else{const g=new La(t.getBlackMatrix()).detect(n);r=this.decoder.decodeBitMatrix(g.getBits(),n),l=g.getPoints()}r.getOther()instanceof fo&&r.getOther().applyMirroredCorrection(l);const o=new ye(r.getText(),r.getRawBytes(),void 0,l,Re.QR_CODE,void 0),d=r.getByteSegments();d!==null&&o.putMetadata(et.BYTE_SEGMENTS,d);const h=r.getECLevel();return h!==null&&o.putMetadata(et.ERROR_CORRECTION_LEVEL,h),r.hasStructuredAppend()&&(o.putMetadata(et.STRUCTURED_APPEND_SEQUENCE,r.getStructuredAppendSequenceNumber()),o.putMetadata(et.STRUCTURED_APPEND_PARITY,r.getStructuredAppendParity())),o}reset(){}static extractPureBits(t){const n=t.getTopLeftOnBit(),r=t.getBottomRightOnBit();if(n===null||r===null)throw new M;const l=this.moduleSize(n,t);let o=n[1],d=r[1],h=n[0],g=r[0];if(h>=g||o>=d)throw new M;if(d-o!==g-h&&(g=h+(d-o),g>=t.getWidth()))throw new M;const b=Math.round((g-h+1)/l),j=Math.round((d-o+1)/l);if(b<=0||j<=0)throw new M;if(j!==b)throw new M;const I=Math.floor(l/2);o+=I,h+=I;const k=h+Math.floor((b-1)*l)-g;if(k>0){if(k>I)throw new M;h-=k}const G=o+Math.floor((j-1)*l)-d;if(G>0){if(G>I)throw new M;o-=G}const J=new Ne(b,j);for(let ee=0;ee<j;ee++){const ue=o+Math.floor(ee*l);for(let be=0;be<b;be++)t.get(h+Math.floor(be*l),ue)&&J.set(be,ee)}return J}static moduleSize(t,n){const r=n.getHeight(),l=n.getWidth();let o=t[0],d=t[1],h=!0,g=0;for(;o<l&&d<r;){if(h!==n.get(o,d)){if(++g===5)break;h=!h}o++,d++}if(o===l||d===r)throw new M;return(o-t[0])/7}}Wa.NO_POINTS=new Array;class Je{PDF417Common(){}static getBitCountSum(t){return de.sum(t)}static toIntArray(t){if(t==null||!t.length)return Je.EMPTY_INT_ARRAY;const n=new Int32Array(t.length);let r=0;for(const l of t)n[r++]=l;return n}static getCodeword(t){const n=Y.binarySearch(Je.SYMBOL_TABLE,t&262143);return n<0?-1:(Je.CODEWORD_TABLE[n]-1)%Je.NUMBER_OF_CODEWORDS}}Je.NUMBER_OF_CODEWORDS=929,Je.MAX_CODEWORDS_IN_BARCODE=Je.NUMBER_OF_CODEWORDS-1,Je.MIN_ROWS_IN_BARCODE=3,Je.MAX_ROWS_IN_BARCODE=90,Je.MODULES_IN_CODEWORD=17,Je.MODULES_IN_STOP_PATTERN=18,Je.BARS_IN_MODULE=8,Je.EMPTY_INT_ARRAY=new Int32Array([]),Je.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Je.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class xo{constructor(t,n){this.bits=t,this.points=n}getBits(){return this.bits}getPoints(){return this.points}}class nt{static detectMultiple(t,n,r){let l=t.getBlackMatrix(),o=nt.detect(r,l);return o.length||(l=l.clone(),l.rotate180(),o=nt.detect(r,l)),new xo(l,o)}static detect(t,n){const r=new Array;let l=0,o=0,d=!1;for(;l<n.getHeight();){const h=nt.findVertices(n,l,o);if(h[0]==null&&h[3]==null){if(!d)break;d=!1,o=0;for(const g of r)g[1]!=null&&(l=Math.trunc(Math.max(l,g[1].getY()))),g[3]!=null&&(l=Math.max(l,Math.trunc(g[3].getY())));l+=nt.ROW_STEP;continue}if(d=!0,r.push(h),!t)break;h[2]!=null?(o=Math.trunc(h[2].getX()),l=Math.trunc(h[2].getY())):(o=Math.trunc(h[4].getX()),l=Math.trunc(h[4].getY()))}return r}static findVertices(t,n,r){const l=t.getHeight(),o=t.getWidth(),d=new Array(8);return nt.copyToResult(d,nt.findRowsWithPattern(t,l,o,n,r,nt.START_PATTERN),nt.INDEXES_START_PATTERN),d[4]!=null&&(r=Math.trunc(d[4].getX()),n=Math.trunc(d[4].getY())),nt.copyToResult(d,nt.findRowsWithPattern(t,l,o,n,r,nt.STOP_PATTERN),nt.INDEXES_STOP_PATTERN),d}static copyToResult(t,n,r){for(let l=0;l<r.length;l++)t[r[l]]=n[l]}static findRowsWithPattern(t,n,r,l,o,d){const h=new Array(4);let g=!1;const b=new Int32Array(d.length);for(;l<n;l+=nt.ROW_STEP){let I=nt.findGuardPattern(t,o,l,r,!1,d,b);if(I!=null){for(;l>0;){const k=nt.findGuardPattern(t,o,--l,r,!1,d,b);if(k!=null)I=k;else{l++;break}}h[0]=new _e(I[0],l),h[1]=new _e(I[1],l),g=!0;break}}let j=l+1;if(g){let I=0,k=Int32Array.from([Math.trunc(h[0].getX()),Math.trunc(h[1].getX())]);for(;j<n;j++){const G=nt.findGuardPattern(t,k[0],j,r,!1,d,b);if(G!=null&&Math.abs(k[0]-G[0])<nt.MAX_PATTERN_DRIFT&&Math.abs(k[1]-G[1])<nt.MAX_PATTERN_DRIFT)k=G,I=0;else{if(I>nt.SKIPPED_ROW_COUNT_MAX)break;I++}}j-=I+1,h[2]=new _e(k[0],j),h[3]=new _e(k[1],j)}return j-l<nt.BARCODE_MIN_HEIGHT&&Y.fill(h,null),h}static findGuardPattern(t,n,r,l,o,d,h){Y.fillWithin(h,0,h.length,0);let g=n,b=0;for(;t.get(g,r)&&g>0&&b++<nt.MAX_PIXEL_DRIFT;)g--;let j=g,I=0,k=d.length;for(let G=o;j<l;j++)if(t.get(j,r)!==G)h[I]++;else{if(I===k-1){if(nt.patternMatchVariance(h,d,nt.MAX_INDIVIDUAL_VARIANCE)<nt.MAX_AVG_VARIANCE)return new Int32Array([g,j]);g+=h[0]+h[1],F.arraycopy(h,2,h,0,I-1),h[I-1]=0,h[I]=0,I--}else I++;h[I]=1,G=!G}return I===k-1&&nt.patternMatchVariance(h,d,nt.MAX_INDIVIDUAL_VARIANCE)<nt.MAX_AVG_VARIANCE?new Int32Array([g,j-1]):null}static patternMatchVariance(t,n,r){let l=t.length,o=0,d=0;for(let b=0;b<l;b++)o+=t[b],d+=n[b];if(o<d)return 1/0;let h=o/d;r*=h;let g=0;for(let b=0;b<l;b++){let j=t[b],I=n[b]*h,k=j>I?j-I:I-j;if(k>r)return 1/0;g+=k}return g/o}}nt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),nt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),nt.MAX_AVG_VARIANCE=.42,nt.MAX_INDIVIDUAL_VARIANCE=.8,nt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),nt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),nt.MAX_PIXEL_DRIFT=3,nt.MAX_PATTERN_DRIFT=5,nt.SKIPPED_ROW_COUNT_MAX=25,nt.ROW_STEP=5,nt.BARCODE_MIN_HEIGHT=10;class es{constructor(t,n){if(n.length===0)throw new O;this.field=t;let r=n.length;if(r>1&&n[0]===0){let l=1;for(;l<r&&n[l]===0;)l++;l===r?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(r-l),F.arraycopy(n,l,this.coefficients,0,this.coefficients.length))}else this.coefficients=n}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(t){return this.coefficients[this.coefficients.length-1-t]}evaluateAt(t){if(t===0)return this.getCoefficient(0);if(t===1){let l=0;for(let o of this.coefficients)l=this.field.add(l,o);return l}let n=this.coefficients[0],r=this.coefficients.length;for(let l=1;l<r;l++)n=this.field.add(this.field.multiply(t,n),this.coefficients[l]);return n}add(t){if(!this.field.equals(t.field))throw new O("ModulusPolys do not have same ModulusGF field");if(this.isZero())return t;if(t.isZero())return this;let n=this.coefficients,r=t.coefficients;if(n.length>r.length){let d=n;n=r,r=d}let l=new Int32Array(r.length),o=r.length-n.length;F.arraycopy(r,0,l,0,o);for(let d=o;d<r.length;d++)l[d]=this.field.add(n[d-o],r[d]);return new es(this.field,l)}subtract(t){if(!this.field.equals(t.field))throw new O("ModulusPolys do not have same ModulusGF field");return t.isZero()?this:this.add(t.negative())}multiply(t){return t instanceof es?this.multiplyOther(t):this.multiplyScalar(t)}multiplyOther(t){if(!this.field.equals(t.field))throw new O("ModulusPolys do not have same ModulusGF field");if(this.isZero()||t.isZero())return new es(this.field,new Int32Array([0]));let n=this.coefficients,r=n.length,l=t.coefficients,o=l.length,d=new Int32Array(r+o-1);for(let h=0;h<r;h++){let g=n[h];for(let b=0;b<o;b++)d[h+b]=this.field.add(d[h+b],this.field.multiply(g,l[b]))}return new es(this.field,d)}negative(){let t=this.coefficients.length,n=new Int32Array(t);for(let r=0;r<t;r++)n[r]=this.field.subtract(0,this.coefficients[r]);return new es(this.field,n)}multiplyScalar(t){if(t===0)return new es(this.field,new Int32Array([0]));if(t===1)return this;let n=this.coefficients.length,r=new Int32Array(n);for(let l=0;l<n;l++)r[l]=this.field.multiply(this.coefficients[l],t);return new es(this.field,r)}multiplyByMonomial(t,n){if(t<0)throw new O;if(n===0)return new es(this.field,new Int32Array([0]));let r=this.coefficients.length,l=new Int32Array(r+t);for(let o=0;o<r;o++)l[o]=this.field.multiply(this.coefficients[o],n);return new es(this.field,l)}toString(){let t=new ve;for(let n=this.getDegree();n>=0;n--){let r=this.getCoefficient(n);r!==0&&(r<0?(t.append(" - "),r=-r):t.length()>0&&t.append(" + "),(n===0||r!==1)&&t.append(r),n!==0&&(n===1?t.append("x"):(t.append("x^"),t.append(n))))}return t.toString()}}class hl{add(t,n){return(t+n)%this.modulus}subtract(t,n){return(this.modulus+t-n)%this.modulus}exp(t){return this.expTable[t]}log(t){if(t===0)throw new O;return this.logTable[t]}inverse(t){if(t===0)throw new Js;return this.expTable[this.modulus-this.logTable[t]-1]}multiply(t,n){return t===0||n===0?0:this.expTable[(this.logTable[t]+this.logTable[n])%(this.modulus-1)]}getSize(){return this.modulus}equals(t){return t===this}}class wn extends hl{constructor(t,n){super(),this.modulus=t,this.expTable=new Int32Array(t),this.logTable=new Int32Array(t);let r=1;for(let l=0;l<t;l++)this.expTable[l]=r,r=r*n%t;for(let l=0;l<t-1;l++)this.logTable[this.expTable[l]]=l;this.zero=new es(this,new Int32Array([0])),this.one=new es(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(t,n){if(t<0)throw new O;if(n===0)return this.zero;let r=new Int32Array(t+1);return r[0]=n,new es(this,r)}}wn.PDF417_GF=new wn(Je.NUMBER_OF_CODEWORDS,3);class Qa{constructor(){this.field=wn.PDF417_GF}decode(t,n,r){let l=new es(this.field,t),o=new Int32Array(n),d=!1;for(let J=n;J>0;J--){let ee=l.evaluateAt(this.field.exp(J));o[n-J]=ee,ee!==0&&(d=!0)}if(!d)return 0;let h=this.field.getOne();if(r!=null)for(const J of r){let ee=this.field.exp(t.length-1-J),ue=new es(this.field,new Int32Array([this.field.subtract(0,ee),1]));h=h.multiply(ue)}let g=new es(this.field,o),b=this.runEuclideanAlgorithm(this.field.buildMonomial(n,1),g,n),j=b[0],I=b[1],k=this.findErrorLocations(j),G=this.findErrorMagnitudes(I,j,k);for(let J=0;J<k.length;J++){let ee=t.length-1-this.field.log(k[J]);if(ee<0)throw z.getChecksumInstance();t[ee]=this.field.subtract(t[ee],G[J])}return k.length}runEuclideanAlgorithm(t,n,r){if(t.getDegree()<n.getDegree()){let k=t;t=n,n=k}let l=t,o=n,d=this.field.getZero(),h=this.field.getOne();for(;o.getDegree()>=Math.round(r/2);){let k=l,G=d;if(l=o,d=h,l.isZero())throw z.getChecksumInstance();o=k;let J=this.field.getZero(),ee=l.getCoefficient(l.getDegree()),ue=this.field.inverse(ee);for(;o.getDegree()>=l.getDegree()&&!o.isZero();){let be=o.getDegree()-l.getDegree(),Be=this.field.multiply(o.getCoefficient(o.getDegree()),ue);J=J.add(this.field.buildMonomial(be,Be)),o=o.subtract(l.multiplyByMonomial(be,Be))}h=J.multiply(d).subtract(G).negative()}let g=h.getCoefficient(0);if(g===0)throw z.getChecksumInstance();let b=this.field.inverse(g),j=h.multiply(b),I=o.multiply(b);return[j,I]}findErrorLocations(t){let n=t.getDegree(),r=new Int32Array(n),l=0;for(let o=1;o<this.field.getSize()&&l<n;o++)t.evaluateAt(o)===0&&(r[l]=this.field.inverse(o),l++);if(l!==n)throw z.getChecksumInstance();return r}findErrorMagnitudes(t,n,r){let l=n.getDegree(),o=new Int32Array(l);for(let b=1;b<=l;b++)o[l-b]=this.field.multiply(b,n.getCoefficient(b));let d=new es(this.field,o),h=r.length,g=new Int32Array(h);for(let b=0;b<h;b++){let j=this.field.inverse(r[b]),I=this.field.subtract(0,t.evaluateAt(j)),k=this.field.inverse(d.evaluateAt(j));g[b]=this.field.multiply(I,k)}return g}}class Ja{constructor(t,n,r,l,o){t instanceof Ja?this.constructor_2(t):this.constructor_1(t,n,r,l,o)}constructor_1(t,n,r,l,o){const d=n==null||r==null,h=l==null||o==null;if(d&&h)throw new M;d?(n=new _e(0,l.getY()),r=new _e(0,o.getY())):h&&(l=new _e(t.getWidth()-1,n.getY()),o=new _e(t.getWidth()-1,r.getY())),this.image=t,this.topLeft=n,this.bottomLeft=r,this.topRight=l,this.bottomRight=o,this.minX=Math.trunc(Math.min(n.getX(),r.getX())),this.maxX=Math.trunc(Math.max(l.getX(),o.getX())),this.minY=Math.trunc(Math.min(n.getY(),l.getY())),this.maxY=Math.trunc(Math.max(r.getY(),o.getY()))}constructor_2(t){this.image=t.image,this.topLeft=t.getTopLeft(),this.bottomLeft=t.getBottomLeft(),this.topRight=t.getTopRight(),this.bottomRight=t.getBottomRight(),this.minX=t.getMinX(),this.maxX=t.getMaxX(),this.minY=t.getMinY(),this.maxY=t.getMaxY()}static merge(t,n){return t==null?n:n==null?t:new Ja(t.image,t.topLeft,t.bottomLeft,n.topRight,n.bottomRight)}addMissingRows(t,n,r){let l=this.topLeft,o=this.bottomLeft,d=this.topRight,h=this.bottomRight;if(t>0){let g=r?this.topLeft:this.topRight,b=Math.trunc(g.getY()-t);b<0&&(b=0);let j=new _e(g.getX(),b);r?l=j:d=j}if(n>0){let g=r?this.bottomLeft:this.bottomRight,b=Math.trunc(g.getY()+n);b>=this.image.getHeight()&&(b=this.image.getHeight()-1);let j=new _e(g.getX(),b);r?o=j:h=j}return new Ja(this.image,l,o,d,h)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class wi{constructor(t,n,r,l){this.columnCount=t,this.errorCorrectionLevel=l,this.rowCountUpperPart=n,this.rowCountLowerPart=r,this.rowCount=n+r}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class nr{constructor(){this.buffer=""}static form(t,n){let r=-1;function l(d,h,g,b,j,I){if(d==="%%")return"%";if(n[++r]===void 0)return;d=b?parseInt(b.substr(1)):void 0;let k=j?parseInt(j.substr(1)):void 0,G;switch(I){case"s":G=n[r];break;case"c":G=n[r][0];break;case"f":G=parseFloat(n[r]).toFixed(d);break;case"p":G=parseFloat(n[r]).toPrecision(d);break;case"e":G=parseFloat(n[r]).toExponential(d);break;case"x":G=parseInt(n[r]).toString(k||16);break;case"d":G=parseFloat(parseInt(n[r],k||10).toPrecision(d)).toFixed(0);break}G=typeof G=="object"?JSON.stringify(G):(+G).toString(k);let J=parseInt(g),ee=g&&g[0]+""=="0"?"0":" ";for(;G.length<J;)G=h!==void 0?G+ee:ee+G;return G}let o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(o,l)}format(t,...n){this.buffer+=nr.form(t,n)}toString(){return this.buffer}}class cn{constructor(t){this.boundingBox=new Ja(t),this.codewords=new Array(t.getMaxY()-t.getMinY()+1)}getCodewordNearby(t){let n=this.getCodeword(t);if(n!=null)return n;for(let r=1;r<cn.MAX_NEARBY_DISTANCE;r++){let l=this.imageRowToCodewordIndex(t)-r;if(l>=0&&(n=this.codewords[l],n!=null)||(l=this.imageRowToCodewordIndex(t)+r,l<this.codewords.length&&(n=this.codewords[l],n!=null)))return n}return null}imageRowToCodewordIndex(t){return t-this.boundingBox.getMinY()}setCodeword(t,n){this.codewords[this.imageRowToCodewordIndex(t)]=n}getCodeword(t){return this.codewords[this.imageRowToCodewordIndex(t)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const t=new nr;let n=0;for(const r of this.codewords){if(r==null){t.format("%3d:    |   %n",n++);continue}t.format("%3d: %3d|%3d%n",n++,r.getRowNumber(),r.getValue())}return t.toString()}}cn.MAX_NEARBY_DISTANCE=5;class dn{constructor(){this.values=new Map}setValue(t){t=Math.trunc(t);let n=this.values.get(t);n==null&&(n=0),n++,this.values.set(t,n)}getValue(){let t=-1,n=new Array;for(const[r,l]of this.values.entries()){const o={getKey:()=>r,getValue:()=>l};o.getValue()>t?(t=o.getValue(),n=[],n.push(o.getKey())):o.getValue()===t&&n.push(o.getKey())}return Je.toIntArray(n)}getConfidence(t){return this.values.get(t)}}class fl extends cn{constructor(t,n){super(t),this._isLeft=n}setRowNumbers(){for(let t of this.getCodewords())t!=null&&t.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(t){let n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,t);let r=this.getBoundingBox(),l=this._isLeft?r.getTopLeft():r.getTopRight(),o=this._isLeft?r.getBottomLeft():r.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(l.getY())),h=this.imageRowToCodewordIndex(Math.trunc(o.getY())),g=-1,b=1,j=0;for(let I=d;I<h;I++){if(n[I]==null)continue;let k=n[I],G=k.getRowNumber()-g;if(G===0)j++;else if(G===1)b=Math.max(b,j),j=1,g=k.getRowNumber();else if(G<0||k.getRowNumber()>=t.getRowCount()||G>I)n[I]=null;else{let J;b>2?J=(b-2)*G:J=G;let ee=J>=I;for(let ue=1;ue<=J&&!ee;ue++)ee=n[I-ue]!=null;ee?n[I]=null:(g=k.getRowNumber(),j=1)}}}getRowHeights(){let t=this.getBarcodeMetadata();if(t==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(t);let n=new Int32Array(t.getRowCount());for(let r of this.getCodewords())if(r!=null){let l=r.getRowNumber();if(l>=n.length)continue;n[l]++}return n}adjustIncompleteIndicatorColumnRowNumbers(t){let n=this.getBoundingBox(),r=this._isLeft?n.getTopLeft():n.getTopRight(),l=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(r.getY())),d=this.imageRowToCodewordIndex(Math.trunc(l.getY())),h=this.getCodewords(),g=-1;for(let b=o;b<d;b++){if(h[b]==null)continue;let j=h[b];j.setRowNumberAsRowIndicatorColumn();let I=j.getRowNumber()-g;I===0||(I===1?g=j.getRowNumber():j.getRowNumber()>=t.getRowCount()?h[b]=null:g=j.getRowNumber())}}getBarcodeMetadata(){let t=this.getCodewords(),n=new dn,r=new dn,l=new dn,o=new dn;for(let h of t){if(h==null)continue;h.setRowNumberAsRowIndicatorColumn();let g=h.getValue()%30,b=h.getRowNumber();switch(this._isLeft||(b+=2),b%3){case 0:r.setValue(g*3+1);break;case 1:o.setValue(g/3),l.setValue(g%3);break;case 2:n.setValue(g+1);break}}if(n.getValue().length===0||r.getValue().length===0||l.getValue().length===0||o.getValue().length===0||n.getValue()[0]<1||r.getValue()[0]+l.getValue()[0]<Je.MIN_ROWS_IN_BARCODE||r.getValue()[0]+l.getValue()[0]>Je.MAX_ROWS_IN_BARCODE)return null;let d=new wi(n.getValue()[0],r.getValue()[0],l.getValue()[0],o.getValue()[0]);return this.removeIncorrectCodewords(t,d),d}removeIncorrectCodewords(t,n){for(let r=0;r<t.length;r++){let l=t[r];if(t[r]==null)continue;let o=l.getValue()%30,d=l.getRowNumber();if(d>n.getRowCount()){t[r]=null;continue}switch(this._isLeft||(d+=2),d%3){case 0:o*3+1!==n.getRowCountUpperPart()&&(t[r]=null);break;case 1:(Math.trunc(o/3)!==n.getErrorCorrectionLevel()||o%3!==n.getRowCountLowerPart())&&(t[r]=null);break;case 2:o+1!==n.getColumnCount()&&(t[r]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Os{constructor(t,n){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=t,this.barcodeColumnCount=t.getColumnCount(),this.boundingBox=n,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let t=Je.MAX_CODEWORDS_IN_BARCODE,n;do n=t,t=this.adjustRowNumbersAndGetCount();while(t>0&&t<n);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(t){t!=null&&t.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let t=this.adjustRowNumbersByRow();if(t===0)return 0;for(let n=1;n<this.barcodeColumnCount+1;n++){let r=this.detectionResultColumns[n].getCodewords();for(let l=0;l<r.length;l++)r[l]!=null&&(r[l].hasValidRowNumber()||this.adjustRowNumbers(n,l,r))}return t}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let t=this.detectionResultColumns[0].getCodewords(),n=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<t.length;r++)if(t[r]!=null&&n[r]!=null&&t[r].getRowNumber()===n[r].getRowNumber())for(let l=1;l<=this.barcodeColumnCount;l++){let o=this.detectionResultColumns[l].getCodewords()[r];o!=null&&(o.setRowNumber(t[r].getRowNumber()),o.hasValidRowNumber()||(this.detectionResultColumns[l].getCodewords()[r]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let t=0,n=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<n.length;r++){if(n[r]==null)continue;let l=n[r].getRowNumber(),o=0;for(let d=this.barcodeColumnCount+1;d>0&&o<this.ADJUST_ROW_NUMBER_SKIP;d--){let h=this.detectionResultColumns[d].getCodewords()[r];h!=null&&(o=Os.adjustRowNumberIfValid(l,o,h),h.hasValidRowNumber()||t++)}}return t}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let t=0,n=this.detectionResultColumns[0].getCodewords();for(let r=0;r<n.length;r++){if(n[r]==null)continue;let l=n[r].getRowNumber(),o=0;for(let d=1;d<this.barcodeColumnCount+1&&o<this.ADJUST_ROW_NUMBER_SKIP;d++){let h=this.detectionResultColumns[d].getCodewords()[r];h!=null&&(o=Os.adjustRowNumberIfValid(l,o,h),h.hasValidRowNumber()||t++)}}return t}static adjustRowNumberIfValid(t,n,r){return r==null||r.hasValidRowNumber()||(r.isValidRowNumber(t)?(r.setRowNumber(t),n=0):++n),n}adjustRowNumbers(t,n,r){if(!this.detectionResultColumns[t-1])return;let l=r[n],o=this.detectionResultColumns[t-1].getCodewords(),d=o;this.detectionResultColumns[t+1]!=null&&(d=this.detectionResultColumns[t+1].getCodewords());let h=new Array(14);h[2]=o[n],h[3]=d[n],n>0&&(h[0]=r[n-1],h[4]=o[n-1],h[5]=d[n-1]),n>1&&(h[8]=r[n-2],h[10]=o[n-2],h[11]=d[n-2]),n<r.length-1&&(h[1]=r[n+1],h[6]=o[n+1],h[7]=d[n+1]),n<r.length-2&&(h[9]=r[n+2],h[12]=o[n+2],h[13]=d[n+2]);for(let g of h)if(Os.adjustRowNumber(l,g))return}static adjustRowNumber(t,n){return n==null?!1:n.hasValidRowNumber()&&n.getBucket()===t.getBucket()?(t.setRowNumber(n.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(t){this.boundingBox=t}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(t,n){this.detectionResultColumns[t]=n}getDetectionResultColumn(t){return this.detectionResultColumns[t]}toString(){let t=this.detectionResultColumns[0];t==null&&(t=this.detectionResultColumns[this.barcodeColumnCount+1]);let n=new nr;for(let r=0;r<t.getCodewords().length;r++){n.format("CW %3d:",r);for(let l=0;l<this.barcodeColumnCount+2;l++){if(this.detectionResultColumns[l]==null){n.format("    |   ");continue}let o=this.detectionResultColumns[l].getCodewords()[r];if(o==null){n.format("    |   ");continue}n.format(" %3d|%3d",o.getRowNumber(),o.getValue())}n.format("%n")}return n.toString()}}class Ea{constructor(t,n,r,l){this.rowNumber=Ea.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(t),this.endX=Math.trunc(n),this.bucket=Math.trunc(r),this.value=Math.trunc(l)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(t){return t!==Ea.BARCODE_ROW_UNKNOWN&&this.bucket===t%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(t){this.rowNumber=t}toString(){return this.rowNumber+"|"+this.value}}Ea.BARCODE_ROW_UNKNOWN=-1;class Ps{static initialize(){for(let t=0;t<Je.SYMBOL_TABLE.length;t++){let n=Je.SYMBOL_TABLE[t],r=n&1;for(let l=0;l<Je.BARS_IN_MODULE;l++){let o=0;for(;(n&1)===r;)o+=1,n>>=1;r=n&1,Ps.RATIOS_TABLE[t]||(Ps.RATIOS_TABLE[t]=new Array(Je.BARS_IN_MODULE)),Ps.RATIOS_TABLE[t][Je.BARS_IN_MODULE-l-1]=Math.fround(o/Je.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(t){let n=Ps.getDecodedCodewordValue(Ps.sampleBitCounts(t));return n!==-1?n:Ps.getClosestDecodedValue(t)}static sampleBitCounts(t){let n=de.sum(t),r=new Int32Array(Je.BARS_IN_MODULE),l=0,o=0;for(let d=0;d<Je.MODULES_IN_CODEWORD;d++){let h=n/(2*Je.MODULES_IN_CODEWORD)+d*n/Je.MODULES_IN_CODEWORD;o+t[l]<=h&&(o+=t[l],l++),r[l]++}return r}static getDecodedCodewordValue(t){let n=Ps.getBitValue(t);return Je.getCodeword(n)===-1?-1:n}static getBitValue(t){let n=0;for(let r=0;r<t.length;r++)for(let l=0;l<t[r];l++)n=n<<1|(r%2===0?1:0);return Math.trunc(n)}static getClosestDecodedValue(t){let n=de.sum(t),r=new Array(Je.BARS_IN_MODULE);if(n>1)for(let d=0;d<r.length;d++)r[d]=Math.fround(t[d]/n);let l=Le.MAX_VALUE,o=-1;this.bSymbolTableReady||Ps.initialize();for(let d=0;d<Ps.RATIOS_TABLE.length;d++){let h=0,g=Ps.RATIOS_TABLE[d];for(let b=0;b<Je.BARS_IN_MODULE;b++){let j=Math.fround(g[b]-r[b]);if(h+=Math.fround(j*j),h>=l)break}h<l&&(l=h,o=Je.SYMBOL_TABLE[d])}return o}}Ps.bSymbolTableReady=!1,Ps.RATIOS_TABLE=new Array(Je.SYMBOL_TABLE.length).map(_=>new Array(Je.BARS_IN_MODULE));class rr{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(t){this.segmentIndex=t}getFileId(){return this.fileId}setFileId(t){this.fileId=t}getOptionalData(){return this.optionalData}setOptionalData(t){this.optionalData=t}isLastSegment(){return this.lastSegment}setLastSegment(t){this.lastSegment=t}getSegmentCount(){return this.segmentCount}setSegmentCount(t){this.segmentCount=t}getSender(){return this.sender||null}setSender(t){this.sender=t}getAddressee(){return this.addressee||null}setAddressee(t){this.addressee=t}getFileName(){return this.fileName}setFileName(t){this.fileName=t}getFileSize(){return this.fileSize}setFileSize(t){this.fileSize=t}getChecksum(){return this.checksum}setChecksum(t){this.checksum=t}getTimestamp(){return this.timestamp}setTimestamp(t){this.timestamp=t}}class mo{static parseLong(t,n=void 0){return parseInt(t,n)}}class vi extends v{}vi.kind="NullPointerException";class xl{writeBytes(t){this.writeBytesOffset(t,0,t.length)}writeBytesOffset(t,n,r){if(t==null)throw new vi;if(n<0||n>t.length||r<0||n+r>t.length||n+r<0)throw new Z;if(r===0)return;for(let l=0;l<r;l++)this.write(t[n+l])}flush(){}close(){}}class Kr extends v{}class Ni extends xl{constructor(t=32){if(super(),this.count=0,t<0)throw new O("Negative initial size: "+t);this.buf=new Uint8Array(t)}ensureCapacity(t){t-this.buf.length>0&&this.grow(t)}grow(t){let r=this.buf.length<<1;if(r-t<0&&(r=t),r<0){if(t<0)throw new Kr;r=q.MAX_VALUE}this.buf=Y.copyOfUint8Array(this.buf,r)}write(t){this.ensureCapacity(this.count+1),this.buf[this.count]=t,this.count+=1}writeBytesOffset(t,n,r){if(n<0||n>t.length||r<0||n+r-t.length>0)throw new Z;this.ensureCapacity(this.count+r),F.arraycopy(t,n,this.buf,this.count,r),this.count+=r}writeTo(t){t.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return Y.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(t){return t?typeof t=="string"?this.toString_string(t):this.toString_number(t):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(t){return new String(this.buf).toString()}toString_number(t){return new String(this.buf).toString()}close(){}}var Pt;(function(_){_[_.ALPHA=0]="ALPHA",_[_.LOWER=1]="LOWER",_[_.MIXED=2]="MIXED",_[_.PUNCT=3]="PUNCT",_[_.ALPHA_SHIFT=4]="ALPHA_SHIFT",_[_.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Pt||(Pt={}));function go(){if(typeof window<"u")return window.BigInt||null;if(typeof Sc<"u")return Sc.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Ci;function un(_){if(typeof Ci>"u"&&(Ci=go()),Ci===null)throw new Error("BigInt is not supported!");return Ci(_)}function ml(){let _=[];_[0]=un(1);let t=un(900);_[1]=t;for(let n=2;n<16;n++)_[n]=_[n-1]*t;return _}class we{static decode(t,n){let r=new ve(""),l=re.ISO8859_1;r.enableDecoding(l);let o=1,d=t[o++],h=new rr;for(;o<t[0];){switch(d){case we.TEXT_COMPACTION_MODE_LATCH:o=we.textCompaction(t,o,r);break;case we.BYTE_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:o=we.byteCompaction(d,t,l,o,r);break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[o++]);break;case we.NUMERIC_COMPACTION_MODE_LATCH:o=we.numericCompaction(t,o,r);break;case we.ECI_CHARSET:re.getCharacterSetECIByValue(t[o++]);break;case we.ECI_GENERAL_PURPOSE:o+=2;break;case we.ECI_USER_DEFINED:o++;break;case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:o=we.decodeMacroBlock(t,o,h);break;case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:throw new K;default:o--,o=we.textCompaction(t,o,r);break}if(o<t.length)d=t[o++];else throw K.getFormatInstance()}if(r.length()===0)throw K.getFormatInstance();let g=new ct(null,r.toString(),null,n);return g.setOther(h),g}static decodeMacroBlock(t,n,r){if(n+we.NUMBER_OF_SEQUENCE_CODEWORDS>t[0])throw K.getFormatInstance();let l=new Int32Array(we.NUMBER_OF_SEQUENCE_CODEWORDS);for(let h=0;h<we.NUMBER_OF_SEQUENCE_CODEWORDS;h++,n++)l[h]=t[n];r.setSegmentIndex(q.parseInt(we.decodeBase900toBase10(l,we.NUMBER_OF_SEQUENCE_CODEWORDS)));let o=new ve;n=we.textCompaction(t,n,o),r.setFileId(o.toString());let d=-1;for(t[n]===we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(d=n+1);n<t[0];)switch(t[n]){case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(n++,t[n]){case we.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let h=new ve;n=we.textCompaction(t,n+1,h),r.setFileName(h.toString());break;case we.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let g=new ve;n=we.textCompaction(t,n+1,g),r.setSender(g.toString());break;case we.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let b=new ve;n=we.textCompaction(t,n+1,b),r.setAddressee(b.toString());break;case we.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let j=new ve;n=we.numericCompaction(t,n+1,j),r.setSegmentCount(q.parseInt(j.toString()));break;case we.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let I=new ve;n=we.numericCompaction(t,n+1,I),r.setTimestamp(mo.parseLong(I.toString()));break;case we.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let k=new ve;n=we.numericCompaction(t,n+1,k),r.setChecksum(q.parseInt(k.toString()));break;case we.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let G=new ve;n=we.numericCompaction(t,n+1,G),r.setFileSize(mo.parseLong(G.toString()));break;default:throw K.getFormatInstance()}break;case we.MACRO_PDF417_TERMINATOR:n++,r.setLastSegment(!0);break;default:throw K.getFormatInstance()}if(d!==-1){let h=n-d;r.isLastSegment()&&h--,r.setOptionalData(Y.copyOfRange(t,d,d+h))}return n}static textCompaction(t,n,r){let l=new Int32Array((t[0]-n)*2),o=new Int32Array((t[0]-n)*2),d=0,h=!1;for(;n<t[0]&&!h;){let g=t[n++];if(g<we.TEXT_COMPACTION_MODE_LATCH)l[d]=g/30,l[d+1]=g%30,d+=2;else switch(g){case we.TEXT_COMPACTION_MODE_LATCH:l[d++]=we.TEXT_COMPACTION_MODE_LATCH;break;case we.BYTE_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:case we.NUMERIC_COMPACTION_MODE_LATCH:case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:n--,h=!0;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l[d]=we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,g=t[n++],o[d]=g,d++;break}}return we.decodeTextCompaction(l,o,d,r),n}static decodeTextCompaction(t,n,r,l){let o=Pt.ALPHA,d=Pt.ALPHA,h=0;for(;h<r;){let g=t[h],b="";switch(o){case Pt.ALPHA:if(g<26)b=String.fromCharCode(65+g);else switch(g){case 26:b=" ";break;case we.LL:o=Pt.LOWER;break;case we.ML:o=Pt.MIXED;break;case we.PS:d=o,o=Pt.PUNCT_SHIFT;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(n[h]);break;case we.TEXT_COMPACTION_MODE_LATCH:o=Pt.ALPHA;break}break;case Pt.LOWER:if(g<26)b=String.fromCharCode(97+g);else switch(g){case 26:b=" ";break;case we.AS:d=o,o=Pt.ALPHA_SHIFT;break;case we.ML:o=Pt.MIXED;break;case we.PS:d=o,o=Pt.PUNCT_SHIFT;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(n[h]);break;case we.TEXT_COMPACTION_MODE_LATCH:o=Pt.ALPHA;break}break;case Pt.MIXED:if(g<we.PL)b=we.MIXED_CHARS[g];else switch(g){case we.PL:o=Pt.PUNCT;break;case 26:b=" ";break;case we.LL:o=Pt.LOWER;break;case we.AL:o=Pt.ALPHA;break;case we.PS:d=o,o=Pt.PUNCT_SHIFT;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(n[h]);break;case we.TEXT_COMPACTION_MODE_LATCH:o=Pt.ALPHA;break}break;case Pt.PUNCT:if(g<we.PAL)b=we.PUNCT_CHARS[g];else switch(g){case we.PAL:o=Pt.ALPHA;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(n[h]);break;case we.TEXT_COMPACTION_MODE_LATCH:o=Pt.ALPHA;break}break;case Pt.ALPHA_SHIFT:if(o=d,g<26)b=String.fromCharCode(65+g);else switch(g){case 26:b=" ";break;case we.TEXT_COMPACTION_MODE_LATCH:o=Pt.ALPHA;break}break;case Pt.PUNCT_SHIFT:if(o=d,g<we.PAL)b=we.PUNCT_CHARS[g];else switch(g){case we.PAL:o=Pt.ALPHA;break;case we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(n[h]);break;case we.TEXT_COMPACTION_MODE_LATCH:o=Pt.ALPHA;break}break}b!==""&&l.append(b),h++}}static byteCompaction(t,n,r,l,o){let d=new Ni,h=0,g=0,b=!1;switch(t){case we.BYTE_COMPACTION_MODE_LATCH:let j=new Int32Array(6),I=n[l++];for(;l<n[0]&&!b;)switch(j[h++]=I,g=900*g+I,I=n[l++],I){case we.TEXT_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH:case we.NUMERIC_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:l--,b=!0;break;default:if(h%5===0&&h>0){for(let k=0;k<6;++k)d.write(Number(un(g)>>un(8*(5-k))));g=0,h=0}break}l===n[0]&&I<we.TEXT_COMPACTION_MODE_LATCH&&(j[h++]=I);for(let k=0;k<h;k++)d.write(j[k]);break;case we.BYTE_COMPACTION_MODE_LATCH_6:for(;l<n[0]&&!b;){let k=n[l++];if(k<we.TEXT_COMPACTION_MODE_LATCH)h++,g=900*g+k;else switch(k){case we.TEXT_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH:case we.NUMERIC_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:l--,b=!0;break}if(h%5===0&&h>0){for(let G=0;G<6;++G)d.write(Number(un(g)>>un(8*(5-G))));g=0,h=0}}break}return o.append(Oe.decode(d.toByteArray(),r)),l}static numericCompaction(t,n,r){let l=0,o=!1,d=new Int32Array(we.MAX_NUMERIC_CODEWORDS);for(;n<t[0]&&!o;){let h=t[n++];if(n===t[0]&&(o=!0),h<we.TEXT_COMPACTION_MODE_LATCH)d[l]=h,l++;else switch(h){case we.TEXT_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH:case we.BYTE_COMPACTION_MODE_LATCH_6:case we.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case we.MACRO_PDF417_TERMINATOR:n--,o=!0;break}(l%we.MAX_NUMERIC_CODEWORDS===0||h===we.NUMERIC_COMPACTION_MODE_LATCH||o)&&l>0&&(r.append(we.decodeBase900toBase10(d,l)),l=0)}return n}static decodeBase900toBase10(t,n){let r=un(0);for(let o=0;o<n;o++)r+=we.EXP900[n-o-1]*un(t[o]);let l=r.toString();if(l.charAt(0)!=="1")throw new K;return l.substring(1)}}we.TEXT_COMPACTION_MODE_LATCH=900,we.BYTE_COMPACTION_MODE_LATCH=901,we.NUMERIC_COMPACTION_MODE_LATCH=902,we.BYTE_COMPACTION_MODE_LATCH_6=924,we.ECI_USER_DEFINED=925,we.ECI_GENERAL_PURPOSE=926,we.ECI_CHARSET=927,we.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,we.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,we.MACRO_PDF417_TERMINATOR=922,we.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,we.MAX_NUMERIC_CODEWORDS=15,we.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,we.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,we.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,we.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,we.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,we.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,we.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,we.PL=25,we.LL=27,we.AS=27,we.ML=28,we.AL=28,we.PS=29,we.PAL=29,we.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,we.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",we.EXP900=go()?ml():[],we.NUMBER_OF_SEQUENCE_CODEWORDS=2;class ft{constructor(){}static decode(t,n,r,l,o,d,h){let g=new Ja(t,n,r,l,o),b=null,j=null,I;for(let J=!0;;J=!1){if(n!=null&&(b=ft.getRowIndicatorColumn(t,g,n,!0,d,h)),l!=null&&(j=ft.getRowIndicatorColumn(t,g,l,!1,d,h)),I=ft.merge(b,j),I==null)throw M.getNotFoundInstance();let ee=I.getBoundingBox();if(J&&ee!=null&&(ee.getMinY()<g.getMinY()||ee.getMaxY()>g.getMaxY()))g=ee;else break}I.setBoundingBox(g);let k=I.getBarcodeColumnCount()+1;I.setDetectionResultColumn(0,b),I.setDetectionResultColumn(k,j);let G=b!=null;for(let J=1;J<=k;J++){let ee=G?J:k-J;if(I.getDetectionResultColumn(ee)!==void 0)continue;let ue;ee===0||ee===k?ue=new fl(g,ee===0):ue=new cn(g),I.setDetectionResultColumn(ee,ue);let be=-1,Be=be;for(let Me=g.getMinY();Me<=g.getMaxY();Me++){if(be=ft.getStartColumn(I,ee,Me,G),be<0||be>g.getMaxX()){if(Be===-1)continue;be=Be}let Ie=ft.detectCodeword(t,g.getMinX(),g.getMaxX(),G,be,Me,d,h);Ie!=null&&(ue.setCodeword(Me,Ie),Be=be,d=Math.min(d,Ie.getWidth()),h=Math.max(h,Ie.getWidth()))}}return ft.createDecoderResult(I)}static merge(t,n){if(t==null&&n==null)return null;let r=ft.getBarcodeMetadata(t,n);if(r==null)return null;let l=Ja.merge(ft.adjustBoundingBox(t),ft.adjustBoundingBox(n));return new Os(r,l)}static adjustBoundingBox(t){if(t==null)return null;let n=t.getRowHeights();if(n==null)return null;let r=ft.getMax(n),l=0;for(let h of n)if(l+=r-h,h>0)break;let o=t.getCodewords();for(let h=0;l>0&&o[h]==null;h++)l--;let d=0;for(let h=n.length-1;h>=0&&(d+=r-n[h],!(n[h]>0));h--);for(let h=o.length-1;d>0&&o[h]==null;h--)d--;return t.getBoundingBox().addMissingRows(l,d,t.isLeft())}static getMax(t){let n=-1;for(let r of t)n=Math.max(n,r);return n}static getBarcodeMetadata(t,n){let r;if(t==null||(r=t.getBarcodeMetadata())==null)return n==null?null:n.getBarcodeMetadata();let l;return n==null||(l=n.getBarcodeMetadata())==null?r:r.getColumnCount()!==l.getColumnCount()&&r.getErrorCorrectionLevel()!==l.getErrorCorrectionLevel()&&r.getRowCount()!==l.getRowCount()?null:r}static getRowIndicatorColumn(t,n,r,l,o,d){let h=new fl(n,l);for(let g=0;g<2;g++){let b=g===0?1:-1,j=Math.trunc(Math.trunc(r.getX()));for(let I=Math.trunc(Math.trunc(r.getY()));I<=n.getMaxY()&&I>=n.getMinY();I+=b){let k=ft.detectCodeword(t,0,t.getWidth(),l,j,I,o,d);k!=null&&(h.setCodeword(I,k),l?j=k.getStartX():j=k.getEndX())}}return h}static adjustCodewordCount(t,n){let r=n[0][1],l=r.getValue(),o=t.getBarcodeColumnCount()*t.getBarcodeRowCount()-ft.getNumberOfECCodeWords(t.getBarcodeECLevel());if(l.length===0){if(o<1||o>Je.MAX_CODEWORDS_IN_BARCODE)throw M.getNotFoundInstance();r.setValue(o)}else l[0]!==o&&r.setValue(o)}static createDecoderResult(t){let n=ft.createBarcodeMatrix(t);ft.adjustCodewordCount(t,n);let r=new Array,l=new Int32Array(t.getBarcodeRowCount()*t.getBarcodeColumnCount()),o=[],d=new Array;for(let g=0;g<t.getBarcodeRowCount();g++)for(let b=0;b<t.getBarcodeColumnCount();b++){let j=n[g][b+1].getValue(),I=g*t.getBarcodeColumnCount()+b;j.length===0?r.push(I):j.length===1?l[I]=j[0]:(d.push(I),o.push(j))}let h=new Array(o.length);for(let g=0;g<h.length;g++)h[g]=o[g];return ft.createDecoderResultFromAmbiguousValues(t.getBarcodeECLevel(),l,Je.toIntArray(r),Je.toIntArray(d),h)}static createDecoderResultFromAmbiguousValues(t,n,r,l,o){let d=new Int32Array(l.length),h=100;for(;h-- >0;){for(let g=0;g<d.length;g++)n[l[g]]=o[g][d[g]];try{return ft.decodeCodewords(n,t,r)}catch(g){if(!(g instanceof z))throw g}if(d.length===0)throw z.getChecksumInstance();for(let g=0;g<d.length;g++)if(d[g]<o[g].length-1){d[g]++;break}else if(d[g]=0,g===d.length-1)throw z.getChecksumInstance()}throw z.getChecksumInstance()}static createBarcodeMatrix(t){let n=Array.from({length:t.getBarcodeRowCount()},()=>new Array(t.getBarcodeColumnCount()+2));for(let l=0;l<n.length;l++)for(let o=0;o<n[l].length;o++)n[l][o]=new dn;let r=0;for(let l of t.getDetectionResultColumns()){if(l!=null){for(let o of l.getCodewords())if(o!=null){let d=o.getRowNumber();if(d>=0){if(d>=n.length)continue;n[d][r].setValue(o.getValue())}}}r++}return n}static isValidBarcodeColumn(t,n){return n>=0&&n<=t.getBarcodeColumnCount()+1}static getStartColumn(t,n,r,l){let o=l?1:-1,d=null;if(ft.isValidBarcodeColumn(t,n-o)&&(d=t.getDetectionResultColumn(n-o).getCodeword(r)),d!=null)return l?d.getEndX():d.getStartX();if(d=t.getDetectionResultColumn(n).getCodewordNearby(r),d!=null)return l?d.getStartX():d.getEndX();if(ft.isValidBarcodeColumn(t,n-o)&&(d=t.getDetectionResultColumn(n-o).getCodewordNearby(r)),d!=null)return l?d.getEndX():d.getStartX();let h=0;for(;ft.isValidBarcodeColumn(t,n-o);){n-=o;for(let g of t.getDetectionResultColumn(n).getCodewords())if(g!=null)return(l?g.getEndX():g.getStartX())+o*h*(g.getEndX()-g.getStartX());h++}return l?t.getBoundingBox().getMinX():t.getBoundingBox().getMaxX()}static detectCodeword(t,n,r,l,o,d,h,g){o=ft.adjustCodewordStartColumn(t,n,r,l,o,d);let b=ft.getModuleBitCount(t,n,r,l,o,d);if(b==null)return null;let j,I=de.sum(b);if(l)j=o+I;else{for(let J=0;J<b.length/2;J++){let ee=b[J];b[J]=b[b.length-1-J],b[b.length-1-J]=ee}j=o,o=j-I}if(!ft.checkCodewordSkew(I,h,g))return null;let k=Ps.getDecodedValue(b),G=Je.getCodeword(k);return G===-1?null:new Ea(o,j,ft.getCodewordBucketNumber(k),G)}static getModuleBitCount(t,n,r,l,o,d){let h=o,g=new Int32Array(8),b=0,j=l?1:-1,I=l;for(;(l?h<r:h>=n)&&b<g.length;)t.get(h,d)===I?(g[b]++,h+=j):(b++,I=!I);return b===g.length||h===(l?r:n)&&b===g.length-1?g:null}static getNumberOfECCodeWords(t){return 2<<t}static adjustCodewordStartColumn(t,n,r,l,o,d){let h=o,g=l?-1:1;for(let b=0;b<2;b++){for(;(l?h>=n:h<r)&&l===t.get(h,d);){if(Math.abs(o-h)>ft.CODEWORD_SKEW_SIZE)return o;h+=g}g=-g,l=!l}return h}static checkCodewordSkew(t,n,r){return n-ft.CODEWORD_SKEW_SIZE<=t&&t<=r+ft.CODEWORD_SKEW_SIZE}static decodeCodewords(t,n,r){if(t.length===0)throw K.getFormatInstance();let l=1<<n+1,o=ft.correctErrors(t,r,l);ft.verifyCodewordCount(t,l);let d=we.decode(t,""+n);return d.setErrorsCorrected(o),d.setErasures(r.length),d}static correctErrors(t,n,r){if(n!=null&&n.length>r/2+ft.MAX_ERRORS||r<0||r>ft.MAX_EC_CODEWORDS)throw z.getChecksumInstance();return ft.errorCorrection.decode(t,r,n)}static verifyCodewordCount(t,n){if(t.length<4)throw K.getFormatInstance();let r=t[0];if(r>t.length)throw K.getFormatInstance();if(r===0)if(n<t.length)t[0]=t.length-n;else throw K.getFormatInstance()}static getBitCountForCodeword(t){let n=new Int32Array(8),r=0,l=n.length-1;for(;!((t&1)!==r&&(r=t&1,l--,l<0));)n[l]++,t>>=1;return n}static getCodewordBucketNumber(t){return t instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(t):this.getCodewordBucketNumber_number(t)}static getCodewordBucketNumber_number(t){return ft.getCodewordBucketNumber(ft.getBitCountForCodeword(t))}static getCodewordBucketNumber_Int32Array(t){return(t[0]-t[2]+t[4]-t[6]+9)%9}static toString(t){let n=new nr;for(let r=0;r<t.length;r++){n.format("Row %2d: ",r);for(let l=0;l<t[r].length;l++){let o=t[r][l];o.getValue().length===0?n.format("        ",null):n.format("%4d(%2d)",o.getValue()[0],o.getConfidence(o.getValue()[0]))}n.format("%n")}return n.toString()}}ft.CODEWORD_SKEW_SIZE=2,ft.MAX_ERRORS=3,ft.MAX_EC_CODEWORDS=512,ft.errorCorrection=new Qa;class Fs{decode(t,n=null){let r=Fs.decode(t,n,!1);if(r==null||r.length===0||r[0]==null)throw M.getNotFoundInstance();return r[0]}decodeMultiple(t,n=null){try{return Fs.decode(t,n,!0)}catch(r){throw r instanceof K||r instanceof z?M.getNotFoundInstance():r}}static decode(t,n,r){const l=new Array,o=nt.detectMultiple(t,n,r);for(const d of o.getPoints()){const h=ft.decode(o.getBits(),d[4],d[5],d[6],d[7],Fs.getMinCodewordWidth(d),Fs.getMaxCodewordWidth(d)),g=new ye(h.getText(),h.getRawBytes(),void 0,d,Re.PDF_417);g.putMetadata(et.ERROR_CORRECTION_LEVEL,h.getECLevel());const b=h.getOther();b!=null&&g.putMetadata(et.PDF417_EXTRA_METADATA,b),l.push(g)}return l.map(d=>d)}static getMaxWidth(t,n){return t==null||n==null?0:Math.trunc(Math.abs(t.getX()-n.getX()))}static getMinWidth(t,n){return t==null||n==null?q.MAX_VALUE:Math.trunc(Math.abs(t.getX()-n.getX()))}static getMaxCodewordWidth(t){return Math.floor(Math.max(Math.max(Fs.getMaxWidth(t[0],t[4]),Fs.getMaxWidth(t[6],t[2])*Je.MODULES_IN_CODEWORD/Je.MODULES_IN_STOP_PATTERN),Math.max(Fs.getMaxWidth(t[1],t[5]),Fs.getMaxWidth(t[7],t[3])*Je.MODULES_IN_CODEWORD/Je.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(t){return Math.floor(Math.min(Math.min(Fs.getMinWidth(t[0],t[4]),Fs.getMinWidth(t[6],t[2])*Je.MODULES_IN_CODEWORD/Je.MODULES_IN_STOP_PATTERN),Math.min(Fs.getMinWidth(t[1],t[5]),Fs.getMinWidth(t[7],t[3])*Je.MODULES_IN_CODEWORD/Je.MODULES_IN_STOP_PATTERN)))}reset(){}}class Ei extends v{}Ei.kind="ReaderException";class po{constructor(t,n){this.verbose=t===!0,n&&this.setHints(n)}decode(t,n){return n&&this.setHints(n),this.decodeInternal(t)}decodeWithState(t){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(t)}setHints(t){this.hints=t;const n=!y(t)&&t.get(te.TRY_HARDER)===!0,r=y(t)?null:t.get(te.POSSIBLE_FORMATS),l=new Array;if(!y(r)){const o=r.some(d=>d===Re.UPC_A||d===Re.UPC_E||d===Re.EAN_13||d===Re.EAN_8||d===Re.CODABAR||d===Re.CODE_39||d===Re.CODE_93||d===Re.CODE_128||d===Re.ITF||d===Re.RSS_14||d===Re.RSS_EXPANDED);o&&!n&&l.push(new Na(t,this.verbose)),r.includes(Re.QR_CODE)&&l.push(new Wa),r.includes(Re.DATA_MATRIX)&&l.push(new Za),r.includes(Re.AZTEC)&&l.push(new wa),r.includes(Re.PDF_417)&&l.push(new Fs),o&&n&&l.push(new Na(t,this.verbose))}l.length===0&&(n||l.push(new Na(t,this.verbose)),l.push(new Wa),l.push(new Za),l.push(new wa),l.push(new Fs),n&&l.push(new Na(t,this.verbose))),this.readers=l}reset(){if(this.readers!==null)for(const t of this.readers)t.reset()}decodeInternal(t){if(this.readers===null)throw new Ei("No readers where selected, nothing can be read.");for(const n of this.readers)try{return n.decode(t,this.hints)}catch(r){if(r instanceof Ei)continue}throw new M("No MultiFormat Readers were able to detect the code.")}}class yo extends Ee{constructor(t=null,n=500){const r=new po;r.setHints(t),super(r,n)}decodeBitmap(t){return this.reader.decodeWithState(t)}}class Wc extends Ee{constructor(t=500){super(new Fs,t)}}class Qc extends Ee{constructor(t=500){super(new Wa,t)}}var gl;(function(_){_[_.ERROR_CORRECTION=0]="ERROR_CORRECTION",_[_.CHARACTER_SET=1]="CHARACTER_SET",_[_.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",_[_.MIN_SIZE=3]="MIN_SIZE",_[_.MAX_SIZE=4]="MAX_SIZE",_[_.MARGIN=5]="MARGIN",_[_.PDF417_COMPACT=6]="PDF417_COMPACT",_[_.PDF417_COMPACTION=7]="PDF417_COMPACTION",_[_.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",_[_.AZTEC_LAYERS=9]="AZTEC_LAYERS",_[_.QR_VERSION=10]="QR_VERSION"})(gl||(gl={}));var As=gl;class Zr{constructor(t){this.field=t,this.cachedGenerators=[],this.cachedGenerators.push(new Dt(t,Int32Array.from([1])))}buildGenerator(t){const n=this.cachedGenerators;if(t>=n.length){let r=n[n.length-1];const l=this.field;for(let o=n.length;o<=t;o++){const d=r.multiply(new Dt(l,Int32Array.from([1,l.exp(o-1+l.getGeneratorBase())])));n.push(d),r=d}}return n[t]}encode(t,n){if(n===0)throw new O("No error correction bytes");const r=t.length-n;if(r<=0)throw new O("No data bytes provided");const l=this.buildGenerator(n),o=new Int32Array(r);F.arraycopy(t,0,o,0,r);let d=new Dt(this.field,o);d=d.multiplyByMonomial(n,1);const g=d.divide(l)[1].getCoefficients(),b=n-g.length;for(let j=0;j<b;j++)t[r+j]=0;F.arraycopy(g,0,t,r+b,g.length)}}class fs{constructor(){}static applyMaskPenaltyRule1(t){return fs.applyMaskPenaltyRule1Internal(t,!0)+fs.applyMaskPenaltyRule1Internal(t,!1)}static applyMaskPenaltyRule2(t){let n=0;const r=t.getArray(),l=t.getWidth(),o=t.getHeight();for(let d=0;d<o-1;d++){const h=r[d];for(let g=0;g<l-1;g++){const b=h[g];b===h[g+1]&&b===r[d+1][g]&&b===r[d+1][g+1]&&n++}}return fs.N2*n}static applyMaskPenaltyRule3(t){let n=0;const r=t.getArray(),l=t.getWidth(),o=t.getHeight();for(let d=0;d<o;d++)for(let h=0;h<l;h++){const g=r[d];h+6<l&&g[h]===1&&g[h+1]===0&&g[h+2]===1&&g[h+3]===1&&g[h+4]===1&&g[h+5]===0&&g[h+6]===1&&(fs.isWhiteHorizontal(g,h-4,h)||fs.isWhiteHorizontal(g,h+7,h+11))&&n++,d+6<o&&r[d][h]===1&&r[d+1][h]===0&&r[d+2][h]===1&&r[d+3][h]===1&&r[d+4][h]===1&&r[d+5][h]===0&&r[d+6][h]===1&&(fs.isWhiteVertical(r,h,d-4,d)||fs.isWhiteVertical(r,h,d+7,d+11))&&n++}return n*fs.N3}static isWhiteHorizontal(t,n,r){n=Math.max(n,0),r=Math.min(r,t.length);for(let l=n;l<r;l++)if(t[l]===1)return!1;return!0}static isWhiteVertical(t,n,r,l){r=Math.max(r,0),l=Math.min(l,t.length);for(let o=r;o<l;o++)if(t[o][n]===1)return!1;return!0}static applyMaskPenaltyRule4(t){let n=0;const r=t.getArray(),l=t.getWidth(),o=t.getHeight();for(let g=0;g<o;g++){const b=r[g];for(let j=0;j<l;j++)b[j]===1&&n++}const d=t.getHeight()*t.getWidth();return Math.floor(Math.abs(n*2-d)*10/d)*fs.N4}static getDataMaskBit(t,n,r){let l,o;switch(t){case 0:l=r+n&1;break;case 1:l=r&1;break;case 2:l=n%3;break;case 3:l=(r+n)%3;break;case 4:l=Math.floor(r/2)+Math.floor(n/3)&1;break;case 5:o=r*n,l=(o&1)+o%3;break;case 6:o=r*n,l=(o&1)+o%3&1;break;case 7:o=r*n,l=o%3+(r+n&1)&1;break;default:throw new O("Invalid mask pattern: "+t)}return l===0}static applyMaskPenaltyRule1Internal(t,n){let r=0;const l=n?t.getHeight():t.getWidth(),o=n?t.getWidth():t.getHeight(),d=t.getArray();for(let h=0;h<l;h++){let g=0,b=-1;for(let j=0;j<o;j++){const I=n?d[h][j]:d[j][h];I===b?g++:(g>=5&&(r+=fs.N1+(g-5)),g=1,b=I)}g>=5&&(r+=fs.N1+(g-5))}return r}}fs.N1=3,fs.N2=3,fs.N3=40,fs.N4=10;class Ai{constructor(t,n){this.width=t,this.height=n;const r=new Array(n);for(let l=0;l!==n;l++)r[l]=new Uint8Array(t);this.bytes=r}getHeight(){return this.height}getWidth(){return this.width}get(t,n){return this.bytes[n][t]}getArray(){return this.bytes}setNumber(t,n,r){this.bytes[n][t]=r}setBoolean(t,n,r){this.bytes[n][t]=r?1:0}clear(t){for(const n of this.bytes)Y.fill(n,t)}equals(t){if(!(t instanceof Ai))return!1;const n=t;if(this.width!==n.width||this.height!==n.height)return!1;for(let r=0,l=this.height;r<l;++r){const o=this.bytes[r],d=n.bytes[r];for(let h=0,g=this.width;h<g;++h)if(o[h]!==d[h])return!1}return!0}toString(){const t=new ve;for(let n=0,r=this.height;n<r;++n){const l=this.bytes[n];for(let o=0,d=this.width;o<d;++o)switch(l[o]){case 0:t.append(" 0");break;case 1:t.append(" 1");break;default:t.append("  ");break}t.append(`
`)}return t.toString()}}class vn{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const t=new ve;return t.append(`<<
`),t.append(" mode: "),t.append(this.mode?this.mode.toString():"null"),t.append(`
 ecLevel: `),t.append(this.ecLevel?this.ecLevel.toString():"null"),t.append(`
 version: `),t.append(this.version?this.version.toString():"null"),t.append(`
 maskPattern: `),t.append(this.maskPattern.toString()),this.matrix?(t.append(`
 matrix:
`),t.append(this.matrix.toString())):t.append(`
 matrix: null
`),t.append(`>>
`),t.toString()}setMode(t){this.mode=t}setECLevel(t){this.ecLevel=t}setVersion(t){this.version=t}setMaskPattern(t){this.maskPattern=t}setMatrix(t){this.matrix=t}static isValidMaskPattern(t){return t>=0&&t<vn.NUM_MASK_PATTERNS}}vn.NUM_MASK_PATTERNS=8;class Vt extends v{}Vt.kind="WriterException";class $e{constructor(){}static clearMatrix(t){t.clear(255)}static buildMatrix(t,n,r,l,o){$e.clearMatrix(o),$e.embedBasicPatterns(r,o),$e.embedTypeInfo(n,l,o),$e.maybeEmbedVersionInfo(r,o),$e.embedDataBits(t,l,o)}static embedBasicPatterns(t,n){$e.embedPositionDetectionPatternsAndSeparators(n),$e.embedDarkDotAtLeftBottomCorner(n),$e.maybeEmbedPositionAdjustmentPatterns(t,n),$e.embedTimingPatterns(n)}static embedTypeInfo(t,n,r){const l=new oe;$e.makeTypeInfoBits(t,n,l);for(let o=0,d=l.getSize();o<d;++o){const h=l.get(l.getSize()-1-o),g=$e.TYPE_INFO_COORDINATES[o],b=g[0],j=g[1];if(r.setBoolean(b,j,h),o<8){const I=r.getWidth()-o-1;r.setBoolean(I,8,h)}else{const k=r.getHeight()-7+(o-8);r.setBoolean(8,k,h)}}}static maybeEmbedVersionInfo(t,n){if(t.getVersionNumber()<7)return;const r=new oe;$e.makeVersionInfoBits(t,r);let l=17;for(let o=0;o<6;++o)for(let d=0;d<3;++d){const h=r.get(l);l--,n.setBoolean(o,n.getHeight()-11+d,h),n.setBoolean(n.getHeight()-11+d,o,h)}}static embedDataBits(t,n,r){let l=0,o=-1,d=r.getWidth()-1,h=r.getHeight()-1;for(;d>0;){for(d===6&&(d-=1);h>=0&&h<r.getHeight();){for(let g=0;g<2;++g){const b=d-g;if(!$e.isEmpty(r.get(b,h)))continue;let j;l<t.getSize()?(j=t.get(l),++l):j=!1,n!==255&&fs.getDataMaskBit(n,b,h)&&(j=!j),r.setBoolean(b,h,j)}h+=o}o=-o,h+=o,d-=2}if(l!==t.getSize())throw new Vt("Not all bits consumed: "+l+"/"+t.getSize())}static findMSBSet(t){return 32-q.numberOfLeadingZeros(t)}static calculateBCHCode(t,n){if(n===0)throw new O("0 polynomial");const r=$e.findMSBSet(n);for(t<<=r-1;$e.findMSBSet(t)>=r;)t^=n<<$e.findMSBSet(t)-r;return t}static makeTypeInfoBits(t,n,r){if(!vn.isValidMaskPattern(n))throw new Vt("Invalid mask pattern");const l=t.getBits()<<3|n;r.appendBits(l,5);const o=$e.calculateBCHCode(l,$e.TYPE_INFO_POLY);r.appendBits(o,10);const d=new oe;if(d.appendBits($e.TYPE_INFO_MASK_PATTERN,15),r.xor(d),r.getSize()!==15)throw new Vt("should not happen but we got: "+r.getSize())}static makeVersionInfoBits(t,n){n.appendBits(t.getVersionNumber(),6);const r=$e.calculateBCHCode(t.getVersionNumber(),$e.VERSION_INFO_POLY);if(n.appendBits(r,12),n.getSize()!==18)throw new Vt("should not happen but we got: "+n.getSize())}static isEmpty(t){return t===255}static embedTimingPatterns(t){for(let n=8;n<t.getWidth()-8;++n){const r=(n+1)%2;$e.isEmpty(t.get(n,6))&&t.setNumber(n,6,r),$e.isEmpty(t.get(6,n))&&t.setNumber(6,n,r)}}static embedDarkDotAtLeftBottomCorner(t){if(t.get(8,t.getHeight()-8)===0)throw new Vt;t.setNumber(8,t.getHeight()-8,1)}static embedHorizontalSeparationPattern(t,n,r){for(let l=0;l<8;++l){if(!$e.isEmpty(r.get(t+l,n)))throw new Vt;r.setNumber(t+l,n,0)}}static embedVerticalSeparationPattern(t,n,r){for(let l=0;l<7;++l){if(!$e.isEmpty(r.get(t,n+l)))throw new Vt;r.setNumber(t,n+l,0)}}static embedPositionAdjustmentPattern(t,n,r){for(let l=0;l<5;++l){const o=$e.POSITION_ADJUSTMENT_PATTERN[l];for(let d=0;d<5;++d)r.setNumber(t+d,n+l,o[d])}}static embedPositionDetectionPattern(t,n,r){for(let l=0;l<7;++l){const o=$e.POSITION_DETECTION_PATTERN[l];for(let d=0;d<7;++d)r.setNumber(t+d,n+l,o[d])}}static embedPositionDetectionPatternsAndSeparators(t){const n=$e.POSITION_DETECTION_PATTERN[0].length;$e.embedPositionDetectionPattern(0,0,t),$e.embedPositionDetectionPattern(t.getWidth()-n,0,t),$e.embedPositionDetectionPattern(0,t.getWidth()-n,t);const r=8;$e.embedHorizontalSeparationPattern(0,r-1,t),$e.embedHorizontalSeparationPattern(t.getWidth()-r,r-1,t),$e.embedHorizontalSeparationPattern(0,t.getWidth()-r,t);const l=7;$e.embedVerticalSeparationPattern(l,0,t),$e.embedVerticalSeparationPattern(t.getHeight()-l-1,0,t),$e.embedVerticalSeparationPattern(l,t.getHeight()-l,t)}static maybeEmbedPositionAdjustmentPatterns(t,n){if(t.getVersionNumber()<2)return;const r=t.getVersionNumber()-1,l=$e.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[r];for(let o=0,d=l.length;o!==d;o++){const h=l[o];if(h>=0)for(let g=0;g!==d;g++){const b=l[g];b>=0&&$e.isEmpty(n.get(b,h))&&$e.embedPositionAdjustmentPattern(b-2,h-2,n)}}}}$e.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),$e.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),$e.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),$e.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),$e.VERSION_INFO_POLY=7973,$e.TYPE_INFO_POLY=1335,$e.TYPE_INFO_MASK_PATTERN=21522;class Jc{constructor(t,n){this.dataBytes=t,this.errorCorrectionBytes=n}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class ts{constructor(){}static calculateMaskPenalty(t){return fs.applyMaskPenaltyRule1(t)+fs.applyMaskPenaltyRule2(t)+fs.applyMaskPenaltyRule3(t)+fs.applyMaskPenaltyRule4(t)}static encode(t,n,r=null){let l=ts.DEFAULT_BYTE_MODE_ENCODING;const o=r!==null&&r.get(As.CHARACTER_SET)!==void 0;o&&(l=r.get(As.CHARACTER_SET).toString());const d=this.chooseMode(t,l),h=new oe;if(d===We.BYTE&&(o||ts.DEFAULT_BYTE_MODE_ENCODING!==l)){const Me=re.getCharacterSetECIByName(l);Me!==void 0&&this.appendECI(Me,h)}this.appendModeInfo(d,h);const g=new oe;this.appendBytes(t,d,g,l);let b;if(r!==null&&r.get(As.QR_VERSION)!==void 0){const Me=Number.parseInt(r.get(As.QR_VERSION).toString(),10);b=Xe.getVersionForNumber(Me);const Ie=this.calculateBitsNeeded(d,h,g,b);if(!this.willFit(Ie,b,n))throw new Vt("Data too big for requested version")}else b=this.recommendVersion(n,d,h,g);const j=new oe;j.appendBitArray(h);const I=d===We.BYTE?g.getSizeInBytes():t.length;this.appendLengthInfo(I,b,d,j),j.appendBitArray(g);const k=b.getECBlocksForLevel(n),G=b.getTotalCodewords()-k.getTotalECCodewords();this.terminateBits(G,j);const J=this.interleaveWithECBytes(j,b.getTotalCodewords(),G,k.getNumBlocks()),ee=new vn;ee.setECLevel(n),ee.setMode(d),ee.setVersion(b);const ue=b.getDimensionForVersion(),be=new Ai(ue,ue),Be=this.chooseMaskPattern(J,n,b,be);return ee.setMaskPattern(Be),$e.buildMatrix(J,n,b,Be,be),ee.setMatrix(be),ee}static recommendVersion(t,n,r,l){const o=this.calculateBitsNeeded(n,r,l,Xe.getVersionForNumber(1)),d=this.chooseVersion(o,t),h=this.calculateBitsNeeded(n,r,l,d);return this.chooseVersion(h,t)}static calculateBitsNeeded(t,n,r,l){return n.getSize()+t.getCharacterCountBits(l)+r.getSize()}static getAlphanumericCode(t){return t<ts.ALPHANUMERIC_TABLE.length?ts.ALPHANUMERIC_TABLE[t]:-1}static chooseMode(t,n=null){if(re.SJIS.getName()===n&&this.isOnlyDoubleByteKanji(t))return We.KANJI;let r=!1,l=!1;for(let o=0,d=t.length;o<d;++o){const h=t.charAt(o);if(ts.isDigit(h))r=!0;else if(this.getAlphanumericCode(h.charCodeAt(0))!==-1)l=!0;else return We.BYTE}return l?We.ALPHANUMERIC:r?We.NUMERIC:We.BYTE}static isOnlyDoubleByteKanji(t){let n;try{n=Oe.encode(t,re.SJIS)}catch{return!1}const r=n.length;if(r%2!==0)return!1;for(let l=0;l<r;l+=2){const o=n[l]&255;if((o<129||o>159)&&(o<224||o>235))return!1}return!0}static chooseMaskPattern(t,n,r,l){let o=Number.MAX_SAFE_INTEGER,d=-1;for(let h=0;h<vn.NUM_MASK_PATTERNS;h++){$e.buildMatrix(t,n,r,h,l);let g=this.calculateMaskPenalty(l);g<o&&(o=g,d=h)}return d}static chooseVersion(t,n){for(let r=1;r<=40;r++){const l=Xe.getVersionForNumber(r);if(ts.willFit(t,l,n))return l}throw new Vt("Data too big")}static willFit(t,n,r){const l=n.getTotalCodewords(),d=n.getECBlocksForLevel(r).getTotalECCodewords(),h=l-d,g=(t+7)/8;return h>=g}static terminateBits(t,n){const r=t*8;if(n.getSize()>r)throw new Vt("data bits cannot fit in the QR Code"+n.getSize()+" > "+r);for(let d=0;d<4&&n.getSize()<r;++d)n.appendBit(!1);const l=n.getSize()&7;if(l>0)for(let d=l;d<8;d++)n.appendBit(!1);const o=t-n.getSizeInBytes();for(let d=0;d<o;++d)n.appendBits((d&1)===0?236:17,8);if(n.getSize()!==r)throw new Vt("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(t,n,r,l,o,d){if(l>=r)throw new Vt("Block ID too large");const h=t%r,g=r-h,b=Math.floor(t/r),j=b+1,I=Math.floor(n/r),k=I+1,G=b-I,J=j-k;if(G!==J)throw new Vt("EC bytes mismatch");if(r!==g+h)throw new Vt("RS blocks mismatch");if(t!==(I+G)*g+(k+J)*h)throw new Vt("Total bytes mismatch");l<g?(o[0]=I,d[0]=G):(o[0]=k,d[0]=J)}static interleaveWithECBytes(t,n,r,l){if(t.getSizeInBytes()!==r)throw new Vt("Number of bits and data bytes does not match");let o=0,d=0,h=0;const g=new Array;for(let j=0;j<l;++j){const I=new Int32Array(1),k=new Int32Array(1);ts.getNumDataBytesAndNumECBytesForBlockID(n,r,l,j,I,k);const G=I[0],J=new Uint8Array(G);t.toBytes(8*o,J,0,G);const ee=ts.generateECBytes(J,k[0]);g.push(new Jc(J,ee)),d=Math.max(d,G),h=Math.max(h,ee.length),o+=I[0]}if(r!==o)throw new Vt("Data bytes does not match offset");const b=new oe;for(let j=0;j<d;++j)for(const I of g){const k=I.getDataBytes();j<k.length&&b.appendBits(k[j],8)}for(let j=0;j<h;++j)for(const I of g){const k=I.getErrorCorrectionBytes();j<k.length&&b.appendBits(k[j],8)}if(n!==b.getSizeInBytes())throw new Vt("Interleaving error: "+n+" and "+b.getSizeInBytes()+" differ.");return b}static generateECBytes(t,n){const r=t.length,l=new Int32Array(r+n);for(let d=0;d<r;d++)l[d]=t[d]&255;new Zr(dt.QR_CODE_FIELD_256).encode(l,n);const o=new Uint8Array(n);for(let d=0;d<n;d++)o[d]=l[r+d];return o}static appendModeInfo(t,n){n.appendBits(t.getBits(),4)}static appendLengthInfo(t,n,r,l){const o=r.getCharacterCountBits(n);if(t>=1<<o)throw new Vt(t+" is bigger than "+((1<<o)-1));l.appendBits(t,o)}static appendBytes(t,n,r,l){switch(n){case We.NUMERIC:ts.appendNumericBytes(t,r);break;case We.ALPHANUMERIC:ts.appendAlphanumericBytes(t,r);break;case We.BYTE:ts.append8BitBytes(t,r,l);break;case We.KANJI:ts.appendKanjiBytes(t,r);break;default:throw new Vt("Invalid mode: "+n)}}static getDigit(t){return t.charCodeAt(0)-48}static isDigit(t){const n=ts.getDigit(t);return n>=0&&n<=9}static appendNumericBytes(t,n){const r=t.length;let l=0;for(;l<r;){const o=ts.getDigit(t.charAt(l));if(l+2<r){const d=ts.getDigit(t.charAt(l+1)),h=ts.getDigit(t.charAt(l+2));n.appendBits(o*100+d*10+h,10),l+=3}else if(l+1<r){const d=ts.getDigit(t.charAt(l+1));n.appendBits(o*10+d,7),l+=2}else n.appendBits(o,4),l++}}static appendAlphanumericBytes(t,n){const r=t.length;let l=0;for(;l<r;){const o=ts.getAlphanumericCode(t.charCodeAt(l));if(o===-1)throw new Vt;if(l+1<r){const d=ts.getAlphanumericCode(t.charCodeAt(l+1));if(d===-1)throw new Vt;n.appendBits(o*45+d,11),l+=2}else n.appendBits(o,6),l++}}static append8BitBytes(t,n,r){let l;try{l=Oe.encode(t,r)}catch(o){throw new Vt(o)}for(let o=0,d=l.length;o!==d;o++){const h=l[o];n.appendBits(h,8)}}static appendKanjiBytes(t,n){let r;try{r=Oe.encode(t,re.SJIS)}catch(o){throw new Vt(o)}const l=r.length;for(let o=0;o<l;o+=2){const d=r[o]&255,h=r[o+1]&255,g=d<<8&4294967295|h;let b=-1;if(g>=33088&&g<=40956?b=g-33088:g>=57408&&g<=60351&&(b=g-49472),b===-1)throw new Vt("Invalid byte sequence");const j=(b>>8)*192+(b&255);n.appendBits(j,13)}}static appendECI(t,n){n.appendBits(We.ECI.getBits(),4),n.appendBits(t.getValue(),8)}}ts.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),ts.DEFAULT_BYTE_MODE_ENCODING=re.UTF8.getName();class Nn{write(t,n,r,l=null){if(t.length===0)throw new O("Found empty contents");if(n<0||r<0)throw new O("Requested dimensions are too small: "+n+"x"+r);let o=pt.L,d=Nn.QUIET_ZONE_SIZE;l!==null&&(l.get(As.ERROR_CORRECTION)!==void 0&&(o=pt.fromString(l.get(As.ERROR_CORRECTION).toString())),l.get(As.MARGIN)!==void 0&&(d=Number.parseInt(l.get(As.MARGIN).toString(),10)));const h=ts.encode(t,o,l);return this.renderResult(h,n,r,d)}writeToDom(t,n,r,l,o=null){typeof t=="string"&&(t=document.querySelector(t));const d=this.write(n,r,l,o);t&&t.appendChild(d)}renderResult(t,n,r,l){const o=t.getMatrix();if(o===null)throw new Bs;const d=o.getWidth(),h=o.getHeight(),g=d+l*2,b=h+l*2,j=Math.max(n,g),I=Math.max(r,b),k=Math.min(Math.floor(j/g),Math.floor(I/b)),G=Math.floor((j-d*k)/2),J=Math.floor((I-h*k)/2),ee=this.createSVGElement(j,I);for(let ue=0,be=J;ue<h;ue++,be+=k)for(let Be=0,Me=G;Be<d;Be++,Me+=k)if(o.get(Be,ue)===1){const Ie=this.createSvgRectElement(Me,be,k,k);ee.appendChild(Ie)}return ee}createSVGElement(t,n){const r=document.createElementNS(Nn.SVG_NS,"svg");return r.setAttributeNS(null,"height",t.toString()),r.setAttributeNS(null,"width",n.toString()),r}createSvgRectElement(t,n,r,l){const o=document.createElementNS(Nn.SVG_NS,"rect");return o.setAttributeNS(null,"x",t.toString()),o.setAttributeNS(null,"y",n.toString()),o.setAttributeNS(null,"height",r.toString()),o.setAttributeNS(null,"width",l.toString()),o.setAttributeNS(null,"fill","#000000"),o}}Nn.QUIET_ZONE_SIZE=4,Nn.SVG_NS="http://www.w3.org/2000/svg";class ir{encode(t,n,r,l,o){if(t.length===0)throw new O("Found empty contents");if(n!==Re.QR_CODE)throw new O("Can only encode QR_CODE, but got "+n);if(r<0||l<0)throw new O(`Requested dimensions are too small: ${r}x${l}`);let d=pt.L,h=ir.QUIET_ZONE_SIZE;o!==null&&(o.get(As.ERROR_CORRECTION)!==void 0&&(d=pt.fromString(o.get(As.ERROR_CORRECTION).toString())),o.get(As.MARGIN)!==void 0&&(h=Number.parseInt(o.get(As.MARGIN).toString(),10)));const g=ts.encode(t,d,o);return ir.renderResult(g,r,l,h)}static renderResult(t,n,r,l){const o=t.getMatrix();if(o===null)throw new Bs;const d=o.getWidth(),h=o.getHeight(),g=d+l*2,b=h+l*2,j=Math.max(n,g),I=Math.max(r,b),k=Math.min(Math.floor(j/g),Math.floor(I/b)),G=Math.floor((j-d*k)/2),J=Math.floor((I-h*k)/2),ee=new Ne(j,I);for(let ue=0,be=J;ue<h;ue++,be+=k)for(let Be=0,Me=G;Be<d;Be++,Me+=k)o.get(Be,ue)===1&&ee.setRegion(Me,be,k,k);return ee}}ir.QUIET_ZONE_SIZE=4;class $c{encode(t,n,r,l,o){let d;switch(n){case Re.QR_CODE:d=new ir;break;default:throw new O("No encoder available for format "+n)}return d.encode(t,n,r,l,o)}}class Pa extends V{constructor(t,n,r,l,o,d,h,g){if(super(d,h),this.yuvData=t,this.dataWidth=n,this.dataHeight=r,this.left=l,this.top=o,l+d>n||o+h>r)throw new O("Crop rectangle does not fit within image data.");g&&this.reverseHorizontal(d,h)}getRow(t,n){if(t<0||t>=this.getHeight())throw new O("Requested row is outside the image: "+t);const r=this.getWidth();(n==null||n.length<r)&&(n=new Uint8ClampedArray(r));const l=(t+this.top)*this.dataWidth+this.left;return F.arraycopy(this.yuvData,l,n,0,r),n}getMatrix(){const t=this.getWidth(),n=this.getHeight();if(t===this.dataWidth&&n===this.dataHeight)return this.yuvData;const r=t*n,l=new Uint8ClampedArray(r);let o=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return F.arraycopy(this.yuvData,o,l,0,r),l;for(let d=0;d<n;d++){const h=d*t;F.arraycopy(this.yuvData,o,l,h,t),o+=this.dataWidth}return l}isCropSupported(){return!0}crop(t,n,r,l){return new Pa(this.yuvData,this.dataWidth,this.dataHeight,this.left+t,this.top+n,r,l,!1)}renderThumbnail(){const t=this.getWidth()/Pa.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/Pa.THUMBNAIL_SCALE_FACTOR,r=new Int32Array(t*n),l=this.yuvData;let o=this.top*this.dataWidth+this.left;for(let d=0;d<n;d++){const h=d*t;for(let g=0;g<t;g++){const b=l[o+g*Pa.THUMBNAIL_SCALE_FACTOR]&255;r[h+g]=4278190080|b*65793}o+=this.dataWidth*Pa.THUMBNAIL_SCALE_FACTOR}return r}getThumbnailWidth(){return this.getWidth()/Pa.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Pa.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(t,n){const r=this.yuvData;for(let l=0,o=this.top*this.dataWidth+this.left;l<n;l++,o+=this.dataWidth){const d=o+t/2;for(let h=o,g=o+t-1;h<d;h++,g--){const b=r[h];r[h]=r[g],r[g]=b}}}invert(){return new fe(this)}}Pa.THUMBNAIL_SCALE_FACTOR=2;class pl extends V{constructor(t,n,r,l,o,d,h){if(super(n,r),this.dataWidth=l,this.dataHeight=o,this.left=d,this.top=h,t.BYTES_PER_ELEMENT===4){const g=n*r,b=new Uint8ClampedArray(g);for(let j=0;j<g;j++){const I=t[j],k=I>>16&255,G=I>>7&510,J=I&255;b[j]=(k+G+J)/4&255}this.luminances=b}else this.luminances=t;if(l===void 0&&(this.dataWidth=n),o===void 0&&(this.dataHeight=r),d===void 0&&(this.left=0),h===void 0&&(this.top=0),this.left+n>this.dataWidth||this.top+r>this.dataHeight)throw new O("Crop rectangle does not fit within image data.")}getRow(t,n){if(t<0||t>=this.getHeight())throw new O("Requested row is outside the image: "+t);const r=this.getWidth();(n==null||n.length<r)&&(n=new Uint8ClampedArray(r));const l=(t+this.top)*this.dataWidth+this.left;return F.arraycopy(this.luminances,l,n,0,r),n}getMatrix(){const t=this.getWidth(),n=this.getHeight();if(t===this.dataWidth&&n===this.dataHeight)return this.luminances;const r=t*n,l=new Uint8ClampedArray(r);let o=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return F.arraycopy(this.luminances,o,l,0,r),l;for(let d=0;d<n;d++){const h=d*t;F.arraycopy(this.luminances,o,l,h,t),o+=this.dataWidth}return l}isCropSupported(){return!0}crop(t,n,r,l){return new pl(this.luminances,r,l,this.dataWidth,this.dataHeight,this.left+t,this.top+n)}invert(){return new fe(this)}}class bo extends re{static forName(t){return this.getCharacterSetECIByName(t)}}class Wr{}Wr.ISO_8859_1=re.ISO8859_1;class lr{isCompact(){return this.compact}setCompact(t){this.compact=t}getSize(){return this.size}setSize(t){this.size=t}getLayers(){return this.layers}setLayers(t){this.layers=t}getCodeWords(){return this.codeWords}setCodeWords(t){this.codeWords=t}getMatrix(){return this.matrix}setMatrix(t){this.matrix=t}}class wo{static singletonList(t){return[t]}static min(t,n){return t.sort(n)[0]}}class vo{constructor(t){this.previous=t}getPrevious(){return this.previous}}class Cn extends vo{constructor(t,n,r){super(t),this.value=n,this.bitCount=r}appendTo(t,n){t.appendBits(this.value,this.bitCount)}add(t,n){return new Cn(this,t,n)}addBinaryShift(t,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Cn(this,t,n)}toString(){let t=this.value&(1<<this.bitCount)-1;return t|=1<<this.bitCount,"<"+q.toBinaryString(t|1<<this.bitCount).substring(1)+">"}}class ji extends Cn{constructor(t,n,r){super(t,0,0),this.binaryShiftStart=n,this.binaryShiftByteCount=r}appendTo(t,n){for(let r=0;r<this.binaryShiftByteCount;r++)(r===0||r===31&&this.binaryShiftByteCount<=62)&&(t.appendBits(31,5),this.binaryShiftByteCount>62?t.appendBits(this.binaryShiftByteCount-31,16):r===0?t.appendBits(Math.min(this.binaryShiftByteCount,31),5):t.appendBits(this.binaryShiftByteCount-31,5)),t.appendBits(n[this.binaryShiftStart+r],8)}addBinaryShift(t,n){return new ji(this,t,n)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function No(_,t,n){return new ji(_,t,n)}function or(_,t,n){return new Cn(_,t,n)}const cr=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],hn=0,Si=1,da=2,yl=3,Aa=4,Qr=new Cn(null,0,0),En=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function ed(_){for(let t of _)Y.fill(t,-1);return _[hn][Aa]=0,_[Si][Aa]=0,_[Si][hn]=28,_[yl][Aa]=0,_[da][Aa]=0,_[da][hn]=15,_}const Jr=ed(Y.createInt32Array(6,6));class ja{constructor(t,n,r,l){this.token=t,this.mode=n,this.binaryShiftByteCount=r,this.bitCount=l}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(t,n){let r=this.bitCount,l=this.token;if(t!==this.mode){let d=En[this.mode][t];l=or(l,d&65535,d>>16),r+=d>>16}let o=t===da?4:5;return l=or(l,n,o),new ja(l,t,0,r+o)}shiftAndAppend(t,n){let r=this.token,l=this.mode===da?4:5;return r=or(r,Jr[this.mode][t],l),r=or(r,n,5),new ja(r,this.mode,0,this.bitCount+l+5)}addBinaryShiftChar(t){let n=this.token,r=this.mode,l=this.bitCount;if(this.mode===Aa||this.mode===da){let h=En[r][hn];n=or(n,h&65535,h>>16),l+=h>>16,r=hn}let o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,d=new ja(n,r,this.binaryShiftByteCount+1,l+o);return d.binaryShiftByteCount===2078&&(d=d.endBinaryShift(t+1)),d}endBinaryShift(t){if(this.binaryShiftByteCount===0)return this;let n=this.token;return n=No(n,t-this.binaryShiftByteCount,this.binaryShiftByteCount),new ja(n,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(t){let n=this.bitCount+(En[this.mode][t.mode]>>16);return this.binaryShiftByteCount<t.binaryShiftByteCount?n+=ja.calculateBinaryShiftCost(t)-ja.calculateBinaryShiftCost(this):this.binaryShiftByteCount>t.binaryShiftByteCount&&t.binaryShiftByteCount>0&&(n+=10),n<=t.bitCount}toBitArray(t){let n=[];for(let l=this.endBinaryShift(t.length).token;l!==null;l=l.getPrevious())n.unshift(l);let r=new oe;for(const l of n)l.appendTo(r,t);return r}toString(){return $.format("%s bits=%d bytes=%d",cr[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(t){return t.binaryShiftByteCount>62?21:t.binaryShiftByteCount>31?20:t.binaryShiftByteCount>0?10:0}}ja.INITIAL_STATE=new ja(Qr,hn,0,0);function Co(_){const t=$.getCharCode(" "),n=$.getCharCode("."),r=$.getCharCode(",");_[hn][t]=1;const l=$.getCharCode("Z"),o=$.getCharCode("A");for(let k=o;k<=l;k++)_[hn][k]=k-o+2;_[Si][t]=1;const d=$.getCharCode("z"),h=$.getCharCode("a");for(let k=h;k<=d;k++)_[Si][k]=k-h+2;_[da][t]=1;const g=$.getCharCode("9"),b=$.getCharCode("0");for(let k=b;k<=g;k++)_[da][k]=k-b+2;_[da][r]=12,_[da][n]=13;const j=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let k=0;k<j.length;k++)_[yl][$.getCharCode(j[k])]=k;const I=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let k=0;k<I.length;k++)$.getCharCode(I[k])>0&&(_[Aa][$.getCharCode(I[k])]=k);return _}const $r=Co(Y.createInt32Array(5,256));class An{constructor(t){this.text=t}encode(){const t=$.getCharCode(" "),n=$.getCharCode(`
`);let r=wo.singletonList(ja.INITIAL_STATE);for(let o=0;o<this.text.length;o++){let d,h=o+1<this.text.length?this.text[o+1]:0;switch(this.text[o]){case $.getCharCode("\r"):d=h===n?2:0;break;case $.getCharCode("."):d=h===t?3:0;break;case $.getCharCode(","):d=h===t?4:0;break;case $.getCharCode(":"):d=h===t?5:0;break;default:d=0}d>0?(r=An.updateStateListForPair(r,o,d),o++):r=this.updateStateListForChar(r,o)}return wo.min(r,(o,d)=>o.getBitCount()-d.getBitCount()).toBitArray(this.text)}updateStateListForChar(t,n){const r=[];for(let l of t)this.updateStateForChar(l,n,r);return An.simplifyStates(r)}updateStateForChar(t,n,r){let l=this.text[n]&255,o=$r[t.getMode()][l]>0,d=null;for(let h=0;h<=Aa;h++){let g=$r[h][l];if(g>0){if(d==null&&(d=t.endBinaryShift(n)),!o||h===t.getMode()||h===da){const b=d.latchAndAppend(h,g);r.push(b)}if(!o&&Jr[t.getMode()][h]>=0){const b=d.shiftAndAppend(h,g);r.push(b)}}}if(t.getBinaryShiftByteCount()>0||$r[t.getMode()][l]===0){let h=t.addBinaryShiftChar(n);r.push(h)}}static updateStateListForPair(t,n,r){const l=[];for(let o of t)this.updateStateForPair(o,n,r,l);return this.simplifyStates(l)}static updateStateForPair(t,n,r,l){let o=t.endBinaryShift(n);if(l.push(o.latchAndAppend(Aa,r)),t.getMode()!==Aa&&l.push(o.shiftAndAppend(Aa,r)),r===3||r===4){let d=o.latchAndAppend(da,16-r).latchAndAppend(da,1);l.push(d)}if(t.getBinaryShiftByteCount()>0){let d=t.addBinaryShiftChar(n).addBinaryShiftChar(n+1);l.push(d)}}static simplifyStates(t){let n=[];for(const r of t){let l=!0;for(const o of n){if(o.isBetterThanOrEqualTo(r)){l=!1;break}r.isBetterThanOrEqualTo(o)&&(n=n.filter(d=>d!==o))}l&&n.push(r)}return n}}class Et{constructor(){}static encodeBytes(t){return Et.encode(t,Et.DEFAULT_EC_PERCENT,Et.DEFAULT_AZTEC_LAYERS)}static encode(t,n,r){let l=new An(t).encode(),o=q.truncDivision(l.getSize()*n,100)+11,d=l.getSize()+o,h,g,b,j,I;if(r!==Et.DEFAULT_AZTEC_LAYERS){if(h=r<0,g=Math.abs(r),g>(h?Et.MAX_NB_BITS_COMPACT:Et.MAX_NB_BITS))throw new O($.format("Illegal value %s for layers",r));b=Et.totalBitsInLayer(g,h),j=Et.WORD_SIZE[g];let Ie=b-b%j;if(I=Et.stuffBits(l,j),I.getSize()+o>Ie)throw new O("Data to large for user specified layer");if(h&&I.getSize()>j*64)throw new O("Data to large for user specified layer")}else{j=0,I=null;for(let Ie=0;;Ie++){if(Ie>Et.MAX_NB_BITS)throw new O("Data too large for an Aztec code");if(h=Ie<=3,g=h?Ie+1:Ie,b=Et.totalBitsInLayer(g,h),d>b)continue;(I==null||j!==Et.WORD_SIZE[g])&&(j=Et.WORD_SIZE[g],I=Et.stuffBits(l,j));let mt=b-b%j;if(!(h&&I.getSize()>j*64)&&I.getSize()+o<=mt)break}}let k=Et.generateCheckWords(I,b,j),G=I.getSize()/j,J=Et.generateModeMessage(h,g,G),ee=(h?11:14)+g*4,ue=new Int32Array(ee),be;if(h){be=ee;for(let Ie=0;Ie<ue.length;Ie++)ue[Ie]=Ie}else{be=ee+1+2*q.truncDivision(q.truncDivision(ee,2)-1,15);let Ie=q.truncDivision(ee,2),mt=q.truncDivision(be,2);for(let it=0;it<Ie;it++){let ps=it+q.truncDivision(it,15);ue[Ie-it-1]=mt-ps-1,ue[Ie+it]=mt+ps+1}}let Be=new Ne(be);for(let Ie=0,mt=0;Ie<g;Ie++){let it=(g-Ie)*4+(h?9:12);for(let ps=0;ps<it;ps++){let ua=ps*2;for(let Ys=0;Ys<2;Ys++)k.get(mt+ua+Ys)&&Be.set(ue[Ie*2+Ys],ue[Ie*2+ps]),k.get(mt+it*2+ua+Ys)&&Be.set(ue[Ie*2+ps],ue[ee-1-Ie*2-Ys]),k.get(mt+it*4+ua+Ys)&&Be.set(ue[ee-1-Ie*2-Ys],ue[ee-1-Ie*2-ps]),k.get(mt+it*6+ua+Ys)&&Be.set(ue[ee-1-Ie*2-ps],ue[Ie*2+Ys])}mt+=it*8}if(Et.drawModeMessage(Be,h,be,J),h)Et.drawBullsEye(Be,q.truncDivision(be,2),5);else{Et.drawBullsEye(Be,q.truncDivision(be,2),7);for(let Ie=0,mt=0;Ie<q.truncDivision(ee,2)-1;Ie+=15,mt+=16)for(let it=q.truncDivision(be,2)&1;it<be;it+=2)Be.set(q.truncDivision(be,2)-mt,it),Be.set(q.truncDivision(be,2)+mt,it),Be.set(it,q.truncDivision(be,2)-mt),Be.set(it,q.truncDivision(be,2)+mt)}let Me=new lr;return Me.setCompact(h),Me.setSize(be),Me.setLayers(g),Me.setCodeWords(G),Me.setMatrix(Be),Me}static drawBullsEye(t,n,r){for(let l=0;l<r;l+=2)for(let o=n-l;o<=n+l;o++)t.set(o,n-l),t.set(o,n+l),t.set(n-l,o),t.set(n+l,o);t.set(n-r,n-r),t.set(n-r+1,n-r),t.set(n-r,n-r+1),t.set(n+r,n-r),t.set(n+r,n-r+1),t.set(n+r,n+r-1)}static generateModeMessage(t,n,r){let l=new oe;return t?(l.appendBits(n-1,2),l.appendBits(r-1,6),l=Et.generateCheckWords(l,28,4)):(l.appendBits(n-1,5),l.appendBits(r-1,11),l=Et.generateCheckWords(l,40,4)),l}static drawModeMessage(t,n,r,l){let o=q.truncDivision(r,2);if(n)for(let d=0;d<7;d++){let h=o-3+d;l.get(d)&&t.set(h,o-5),l.get(d+7)&&t.set(o+5,h),l.get(20-d)&&t.set(h,o+5),l.get(27-d)&&t.set(o-5,h)}else for(let d=0;d<10;d++){let h=o-5+d+q.truncDivision(d,5);l.get(d)&&t.set(h,o-7),l.get(d+10)&&t.set(o+7,h),l.get(29-d)&&t.set(h,o+7),l.get(39-d)&&t.set(o-7,h)}}static generateCheckWords(t,n,r){let l=t.getSize()/r,o=new Zr(Et.getGF(r)),d=q.truncDivision(n,r),h=Et.bitsToWords(t,r,d);o.encode(h,d-l);let g=n%r,b=new oe;b.appendBits(0,g);for(const j of Array.from(h))b.appendBits(j,r);return b}static bitsToWords(t,n,r){let l=new Int32Array(r),o,d;for(o=0,d=t.getSize()/n;o<d;o++){let h=0;for(let g=0;g<n;g++)h|=t.get(o*n+g)?1<<n-g-1:0;l[o]=h}return l}static getGF(t){switch(t){case 4:return dt.AZTEC_PARAM;case 6:return dt.AZTEC_DATA_6;case 8:return dt.AZTEC_DATA_8;case 10:return dt.AZTEC_DATA_10;case 12:return dt.AZTEC_DATA_12;default:throw new O("Unsupported word size "+t)}}static stuffBits(t,n){let r=new oe,l=t.getSize(),o=(1<<n)-2;for(let d=0;d<l;d+=n){let h=0;for(let g=0;g<n;g++)(d+g>=l||t.get(d+g))&&(h|=1<<n-1-g);(h&o)===o?(r.appendBits(h&o,n),d--):(h&o)===0?(r.appendBits(h|1,n),d--):r.appendBits(h,n)}return r}static totalBitsInLayer(t,n){return((n?88:112)+16*t)*t}}Et.DEFAULT_EC_PERCENT=33,Et.DEFAULT_AZTEC_LAYERS=0,Et.MAX_NB_BITS=32,Et.MAX_NB_BITS_COMPACT=4,Et.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class ei{encode(t,n,r,l){return this.encodeWithHints(t,n,r,l,null)}encodeWithHints(t,n,r,l,o){let d=Wr.ISO_8859_1,h=Et.DEFAULT_EC_PERCENT,g=Et.DEFAULT_AZTEC_LAYERS;return o!=null&&(o.has(As.CHARACTER_SET)&&(d=bo.forName(o.get(As.CHARACTER_SET).toString())),o.has(As.ERROR_CORRECTION)&&(h=q.parseInt(o.get(As.ERROR_CORRECTION).toString())),o.has(As.AZTEC_LAYERS)&&(g=q.parseInt(o.get(As.AZTEC_LAYERS).toString()))),ei.encodeLayers(t,n,r,l,d,h,g)}static encodeLayers(t,n,r,l,o,d,h){if(n!==Re.AZTEC)throw new O("Can only encode AZTEC, but got "+n);let g=Et.encode($.getBytes(t,o),d,h);return ei.renderResult(g,r,l)}static renderResult(t,n,r){let l=t.getMatrix();if(l==null)throw new Bs;let o=l.getWidth(),d=l.getHeight(),h=Math.max(n,o),g=Math.max(r,d),b=Math.min(h/o,g/d),j=(h-o*b)/2,I=(g-d*b)/2,k=new Ne(h,g);for(let G=0,J=I;G<d;G++,J+=b)for(let ee=0,ue=j;ee<o;ee++,ue+=b)l.get(ee,G)&&k.setRegion(ue,J,b,b);return k}}f.AbstractExpandedDecoder=Cs,f.ArgumentException=A,f.ArithmeticException=Js,f.AztecCode=lr,f.AztecCodeReader=wa,f.AztecCodeWriter=ei,f.AztecDecoder=Rt,f.AztecDetector=ba,f.AztecDetectorResult=Fe,f.AztecEncoder=Et,f.AztecHighLevelEncoder=An,f.AztecPoint=rt,f.BarcodeFormat=Re,f.Binarizer=P,f.BinaryBitmap=R,f.BitArray=oe,f.BitMatrix=Ne,f.BitSource=Ca,f.BrowserAztecCodeReader=an,f.BrowserBarcodeReader=qc,f.BrowserCodeReader=Ee,f.BrowserDatamatrixCodeReader=bi,f.BrowserMultiFormatReader=yo,f.BrowserPDF417Reader=Wc,f.BrowserQRCodeReader=Qc,f.BrowserQRCodeSvgWriter=Nn,f.CharacterSetECI=re,f.ChecksumException=z,f.Code128Reader=ke,f.Code39Reader=zt,f.DataMatrixDecodedBitStreamParser=Ka,f.DataMatrixReader=Za,f.DecodeHintType=te,f.DecoderResult=ct,f.DefaultGridSampler=ot,f.DetectorResult=ie,f.EAN13Reader=Ma,f.EncodeHintType=As,f.Exception=v,f.FormatException=K,f.GenericGF=dt,f.GenericGFPoly=Dt,f.GlobalHistogramBinarizer=L,f.GridSampler=Ye,f.GridSamplerInstance=St,f.HTMLCanvasElementLuminanceSource=he,f.HybridBinarizer=U,f.ITFReader=ut,f.IllegalArgumentException=O,f.IllegalStateException=Bs,f.InvertedLuminanceSource=fe,f.LuminanceSource=V,f.MathUtils=de,f.MultiFormatOneDReader=Na,f.MultiFormatReader=po,f.MultiFormatWriter=$c,f.NotFoundException=M,f.OneDReader=It,f.PDF417DecodedBitStreamParser=we,f.PDF417DecoderErrorCorrection=Qa,f.PDF417Reader=Fs,f.PDF417ResultMetadata=rr,f.PerspectiveTransform=Pe,f.PlanarYUVLuminanceSource=Pa,f.QRCodeByteMatrix=Ai,f.QRCodeDataMask=na,f.QRCodeDecodedBitStreamParser=$t,f.QRCodeDecoderErrorCorrectionLevel=pt,f.QRCodeDecoderFormatInformation=Rs,f.QRCodeEncoder=ts,f.QRCodeEncoderQRCode=vn,f.QRCodeMaskUtil=fs,f.QRCodeMatrixUtil=$e,f.QRCodeMode=We,f.QRCodeReader=Wa,f.QRCodeVersion=Xe,f.QRCodeWriter=ir,f.RGBLuminanceSource=pl,f.RSS14Reader=Ht,f.RSSExpandedReader=De,f.ReaderException=Ei,f.ReedSolomonDecoder=us,f.ReedSolomonEncoder=Zr,f.ReedSolomonException=Ns,f.Result=ye,f.ResultMetadataType=et,f.ResultPoint=_e,f.StringUtils=$,f.UnsupportedOperationException=le,f.VideoInputDevice=X,f.WhiteRectangleDetector=Ke,f.WriterException=Vt,f.ZXingArrays=Y,f.ZXingCharset=bo,f.ZXingInteger=q,f.ZXingStandardCharsets=Wr,f.ZXingStringBuilder=ve,f.ZXingStringEncoding=Oe,f.ZXingSystem=F,f.createAbstractExpandedDecoder=Jn,Object.defineProperty(f,"__esModule",{value:!0})}))})(ao,ao.exports)),ao.exports}var cs=Lb();const Pb=zc(cs),Fb=Vx({__proto__:null,default:Pb},[cs]);var ux=(function(){function u(m,f,y){if(this.formatMap=new Map([[He.QR_CODE,cs.BarcodeFormat.QR_CODE],[He.AZTEC,cs.BarcodeFormat.AZTEC],[He.CODABAR,cs.BarcodeFormat.CODABAR],[He.CODE_39,cs.BarcodeFormat.CODE_39],[He.CODE_93,cs.BarcodeFormat.CODE_93],[He.CODE_128,cs.BarcodeFormat.CODE_128],[He.DATA_MATRIX,cs.BarcodeFormat.DATA_MATRIX],[He.MAXICODE,cs.BarcodeFormat.MAXICODE],[He.ITF,cs.BarcodeFormat.ITF],[He.EAN_13,cs.BarcodeFormat.EAN_13],[He.EAN_8,cs.BarcodeFormat.EAN_8],[He.PDF_417,cs.BarcodeFormat.PDF_417],[He.RSS_14,cs.BarcodeFormat.RSS_14],[He.RSS_EXPANDED,cs.BarcodeFormat.RSS_EXPANDED],[He.UPC_A,cs.BarcodeFormat.UPC_A],[He.UPC_E,cs.BarcodeFormat.UPC_E],[He.UPC_EAN_EXTENSION,cs.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!Fb)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=f,this.logger=y;var C=this.createZXingFormats(m),w=new Map;w.set(cs.DecodeHintType.POSSIBLE_FORMATS,C),w.set(cs.DecodeHintType.TRY_HARDER,!1),this.hints=w}return u.prototype.decodeAsync=function(m){var f=this;return new Promise(function(y,C){try{y(f.decode(m))}catch(w){C(w)}})},u.prototype.decode=function(m){var f=new cs.MultiFormatReader(this.verbose,this.hints),y=new cs.HTMLCanvasElementLuminanceSource(m),C=new cs.BinaryBitmap(new cs.HybridBinarizer(y)),w=f.decode(C);return{text:w.text,format:pm.create(this.toHtml5QrcodeSupportedFormats(w.format)),debugData:this.createDebugData()}},u.prototype.createReverseFormatMap=function(){var m=new Map;return this.formatMap.forEach(function(f,y,C){m.set(f,y)}),m},u.prototype.toHtml5QrcodeSupportedFormats=function(m){if(!this.reverseFormatMap.has(m))throw"reverseFormatMap doesn't have ".concat(m);return this.reverseFormatMap.get(m)},u.prototype.createZXingFormats=function(m){for(var f=[],y=0,C=m;y<C.length;y++){var w=C[y];this.formatMap.has(w)?f.push(this.formatMap.get(w)):this.logger.logError("".concat(w," is not supported by")+"ZXingHtml5QrcodeShim")}return f},u.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},u})(),Ub=function(u,m,f,y){function C(w){return w instanceof f?w:new f(function(E){E(w)})}return new(f||(f=Promise))(function(w,E){function T(A){try{v(y.next(A))}catch(O){E(O)}}function N(A){try{v(y.throw(A))}catch(O){E(O)}}function v(A){A.done?w(A.value):C(A.value).then(T,N)}v((y=y.apply(u,m||[])).next())})},zb=function(u,m){var f={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},y,C,w,E;return E={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function T(v){return function(A){return N([v,A])}}function N(v){if(y)throw new TypeError("Generator is already executing.");for(;E&&(E=0,v[0]&&(f=0)),f;)try{if(y=1,C&&(w=v[0]&2?C.return:v[0]?C.throw||((w=C.return)&&w.call(C),0):C.next)&&!(w=w.call(C,v[1])).done)return w;switch(C=0,w&&(v=[v[0]&2,w.value]),v[0]){case 0:case 1:w=v;break;case 4:return f.label++,{value:v[1],done:!1};case 5:f.label++,C=v[1],v=[0];continue;case 7:v=f.ops.pop(),f.trys.pop();continue;default:if(w=f.trys,!(w=w.length>0&&w[w.length-1])&&(v[0]===6||v[0]===2)){f=0;continue}if(v[0]===3&&(!w||v[1]>w[0]&&v[1]<w[3])){f.label=v[1];break}if(v[0]===6&&f.label<w[1]){f.label=w[1],w=v;break}if(w&&f.label<w[2]){f.label=w[2],f.ops.push(v);break}w[2]&&f.ops.pop(),f.trys.pop();continue}v=m.call(u,f)}catch(A){v=[6,A],C=0}finally{y=w=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},hx=(function(){function u(m,f,y){if(this.formatMap=new Map([[He.QR_CODE,"qr_code"],[He.AZTEC,"aztec"],[He.CODABAR,"codabar"],[He.CODE_39,"code_39"],[He.CODE_93,"code_93"],[He.CODE_128,"code_128"],[He.DATA_MATRIX,"data_matrix"],[He.ITF,"itf"],[He.EAN_13,"ean_13"],[He.EAN_8,"ean_8"],[He.PDF_417,"pdf417"],[He.UPC_A,"upc_a"],[He.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!u.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=f,this.logger=y;var C=this.createBarcodeDetectorFormats(m);if(this.detector=new BarcodeDetector(C),!this.detector)throw"BarcodeDetector detector not supported"}return u.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var m=new BarcodeDetector({formats:["qr_code"]});return typeof m<"u"},u.prototype.decodeAsync=function(m){return Ub(this,void 0,void 0,function(){var f,y;return zb(this,function(C){switch(C.label){case 0:return[4,this.detector.detect(m)];case 1:if(f=C.sent(),!f||f.length===0)throw"No barcode or QR code detected.";return y=this.selectLargestBarcode(f),[2,{text:y.rawValue,format:pm.create(this.toHtml5QrcodeSupportedFormats(y.format)),debugData:this.createDebugData()}]}})})},u.prototype.selectLargestBarcode=function(m){for(var f=null,y=0,C=0,w=m;C<w.length;C++){var E=w[C],T=E.boundingBox.width*E.boundingBox.height;T>y&&(y=T,f=E)}if(!f)throw"No largest barcode found";return f},u.prototype.createBarcodeDetectorFormats=function(m){for(var f=[],y=0,C=m;y<C.length;y++){var w=C[y];this.formatMap.has(w)?f.push(this.formatMap.get(w)):this.logger.warn("".concat(w," is not supported by")+"BarcodeDetectorDelegate")}return{formats:f}},u.prototype.toHtml5QrcodeSupportedFormats=function(m){if(!this.reverseFormatMap.has(m))throw"reverseFormatMap doesn't have ".concat(m);return this.reverseFormatMap.get(m)},u.prototype.createReverseFormatMap=function(){var m=new Map;return this.formatMap.forEach(function(f,y,C){m.set(f,y)}),m},u.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},u})(),fx=function(u,m,f,y){function C(w){return w instanceof f?w:new f(function(E){E(w)})}return new(f||(f=Promise))(function(w,E){function T(A){try{v(y.next(A))}catch(O){E(O)}}function N(A){try{v(y.throw(A))}catch(O){E(O)}}function v(A){A.done?w(A.value):C(A.value).then(T,N)}v((y=y.apply(u,m||[])).next())})},xx=function(u,m){var f={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},y,C,w,E;return E={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function T(v){return function(A){return N([v,A])}}function N(v){if(y)throw new TypeError("Generator is already executing.");for(;E&&(E=0,v[0]&&(f=0)),f;)try{if(y=1,C&&(w=v[0]&2?C.return:v[0]?C.throw||((w=C.return)&&w.call(C),0):C.next)&&!(w=w.call(C,v[1])).done)return w;switch(C=0,w&&(v=[v[0]&2,w.value]),v[0]){case 0:case 1:w=v;break;case 4:return f.label++,{value:v[1],done:!1};case 5:f.label++,C=v[1],v=[0];continue;case 7:v=f.ops.pop(),f.trys.pop();continue;default:if(w=f.trys,!(w=w.length>0&&w[w.length-1])&&(v[0]===6||v[0]===2)){f=0;continue}if(v[0]===3&&(!w||v[1]>w[0]&&v[1]<w[3])){f.label=v[1];break}if(v[0]===6&&f.label<w[1]){f.label=w[1],w=v;break}if(w&&f.label<w[2]){f.label=w[2],f.ops.push(v);break}w[2]&&f.ops.pop(),f.trys.pop();continue}v=m.call(u,f)}catch(A){v=[6,A],C=0}finally{y=w=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},Hb=(function(){function u(m,f,y,C){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=y,f&&hx.isSupported()?(this.primaryDecoder=new hx(m,y,C),this.secondaryDecoder=new ux(m,y,C)):this.primaryDecoder=new ux(m,y,C)}return u.prototype.decodeAsync=function(m){return fx(this,void 0,void 0,function(){var f;return xx(this,function(y){switch(y.label){case 0:f=performance.now(),y.label=1;case 1:return y.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(m)];case 2:return[2,y.sent()];case 3:return this.possiblyLogPerformance(f),[7];case 4:return[2]}})})},u.prototype.decodeRobustlyAsync=function(m){return fx(this,void 0,void 0,function(){var f,y;return xx(this,function(C){switch(C.label){case 0:f=performance.now(),C.label=1;case 1:return C.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(m)];case 2:return[2,C.sent()];case 3:if(y=C.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(m)];throw y;case 4:return this.possiblyLogPerformance(f),[7];case 5:return[2]}})})},u.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},u.prototype.possiblyLogPerformance=function(m){if(this.verbose){var f=performance.now()-m;this.executionResults.push(f),this.executions++,this.possiblyFlushPerformanceReport()}},u.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var m=0,f=0,y=this.executionResults;f<y.length;f++){var C=y[f];m+=C}var w=m/this.executionResults.length;console.log("".concat(w," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},u})(),R0=(function(){var u=function(m,f){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,C){y.__proto__=C}||function(y,C){for(var w in C)Object.prototype.hasOwnProperty.call(C,w)&&(y[w]=C[w])},u(m,f)};return function(m,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");u(m,f);function y(){this.constructor=m}m.prototype=f===null?Object.create(f):(y.prototype=f.prototype,new y)}})(),Fc=function(u,m,f,y){function C(w){return w instanceof f?w:new f(function(E){E(w)})}return new(f||(f=Promise))(function(w,E){function T(A){try{v(y.next(A))}catch(O){E(O)}}function N(A){try{v(y.throw(A))}catch(O){E(O)}}function v(A){A.done?w(A.value):C(A.value).then(T,N)}v((y=y.apply(u,m||[])).next())})},Uc=function(u,m){var f={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},y,C,w,E;return E={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function T(v){return function(A){return N([v,A])}}function N(v){if(y)throw new TypeError("Generator is already executing.");for(;E&&(E=0,v[0]&&(f=0)),f;)try{if(y=1,C&&(w=v[0]&2?C.return:v[0]?C.throw||((w=C.return)&&w.call(C),0):C.next)&&!(w=w.call(C,v[1])).done)return w;switch(C=0,w&&(v=[v[0]&2,w.value]),v[0]){case 0:case 1:w=v;break;case 4:return f.label++,{value:v[1],done:!1};case 5:f.label++,C=v[1],v=[0];continue;case 7:v=f.ops.pop(),f.trys.pop();continue;default:if(w=f.trys,!(w=w.length>0&&w[w.length-1])&&(v[0]===6||v[0]===2)){f=0;continue}if(v[0]===3&&(!w||v[1]>w[0]&&v[1]<w[3])){f.label=v[1];break}if(v[0]===6&&f.label<w[1]){f.label=w[1],w=v;break}if(w&&f.label<w[2]){f.label=w[2],f.ops.push(v);break}w[2]&&f.ops.pop(),f.trys.pop();continue}v=m.call(u,f)}catch(A){v=[6,A],C=0}finally{y=w=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},bm=(function(){function u(m,f){this.name=m,this.track=f}return u.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},u.prototype.apply=function(m){var f={};f[this.name]=m;var y={advanced:[f]};return this.track.applyConstraints(y)},u.prototype.value=function(){var m=this.track.getSettings();if(this.name in m){var f=m[this.name];return f}return null},u})(),Vb=(function(u){R0(m,u);function m(f,y){return u.call(this,f,y)||this}return m.prototype.min=function(){return this.getCapabilities().min},m.prototype.max=function(){return this.getCapabilities().max},m.prototype.step=function(){return this.getCapabilities().step},m.prototype.apply=function(f){var y={};y[this.name]=f;var C={advanced:[y]};return this.track.applyConstraints(C)},m.prototype.getCapabilities=function(){this.failIfNotSupported();var f=this.track.getCapabilities(),y=f[this.name];return{min:y.min,max:y.max,step:y.step}},m.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},m})(bm),Gb=(function(u){R0(m,u);function m(f){return u.call(this,"zoom",f)||this}return m})(Vb),Xb=(function(u){R0(m,u);function m(f){return u.call(this,"torch",f)||this}return m})(bm),Yb=(function(){function u(m){this.track=m}return u.prototype.zoomFeature=function(){return new Gb(this.track)},u.prototype.torchFeature=function(){return new Xb(this.track)},u})(),qb=(function(){function u(m,f,y){this.isClosed=!1,this.parentElement=m,this.mediaStream=f,this.callbacks=y,this.surface=this.createVideoElement(this.parentElement.clientWidth),m.append(this.surface)}return u.prototype.createVideoElement=function(m){var f=document.createElement("video");return f.style.width="".concat(m,"px"),f.style.display="block",f.muted=!0,f.setAttribute("muted","true"),f.playsInline=!0,f},u.prototype.setupSurface=function(){var m=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var f=function(){var y=m.surface.clientWidth,C=m.surface.clientHeight;m.callbacks.onRenderSurfaceReady(y,C),m.surface.removeEventListener("playing",f)};this.surface.addEventListener("playing",f),this.surface.srcObject=this.mediaStream,this.surface.play()},u.create=function(m,f,y,C){return Fc(this,void 0,void 0,function(){var w,E;return Uc(this,function(T){switch(T.label){case 0:return w=new u(m,f,C),y.aspectRatio?(E={aspectRatio:y.aspectRatio},[4,w.getFirstTrackOrFail().applyConstraints(E)]):[3,2];case 1:T.sent(),T.label=2;case 2:return w.setupSurface(),[2,w]}})})},u.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},u.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},u.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},u.prototype.resume=function(m){this.failIfClosed();var f=this,y=function(){setTimeout(m,200),f.surface.removeEventListener("playing",y)};this.surface.addEventListener("playing",y),this.surface.play()},u.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},u.prototype.getSurface=function(){return this.failIfClosed(),this.surface},u.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},u.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},u.prototype.applyVideoConstraints=function(m){return Fc(this,void 0,void 0,function(){return Uc(this,function(f){if("aspectRatio"in m)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(m)]})})},u.prototype.close=function(){if(this.isClosed)return Promise.resolve();var m=this;return new Promise(function(f,y){var C=m.mediaStream.getVideoTracks(),w=C.length,E=0;m.mediaStream.getVideoTracks().forEach(function(T){m.mediaStream.removeTrack(T),T.stop(),++E,E>=w&&(m.isClosed=!0,m.parentElement.removeChild(m.surface),f())})})},u.prototype.getCapabilities=function(){return new Yb(this.getFirstTrackOrFail())},u})(),Kb=(function(){function u(m){this.mediaStream=m}return u.prototype.render=function(m,f,y){return Fc(this,void 0,void 0,function(){return Uc(this,function(C){return[2,qb.create(m,this.mediaStream,f,y)]})})},u.create=function(m){return Fc(this,void 0,void 0,function(){var f,y;return Uc(this,function(C){switch(C.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return f={audio:!1,video:m},[4,navigator.mediaDevices.getUserMedia(f)];case 1:return y=C.sent(),[2,new u(y)]}})})},u})(),mx=function(u,m,f,y){function C(w){return w instanceof f?w:new f(function(E){E(w)})}return new(f||(f=Promise))(function(w,E){function T(A){try{v(y.next(A))}catch(O){E(O)}}function N(A){try{v(y.throw(A))}catch(O){E(O)}}function v(A){A.done?w(A.value):C(A.value).then(T,N)}v((y=y.apply(u,m||[])).next())})},gx=function(u,m){var f={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},y,C,w,E;return E={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function T(v){return function(A){return N([v,A])}}function N(v){if(y)throw new TypeError("Generator is already executing.");for(;E&&(E=0,v[0]&&(f=0)),f;)try{if(y=1,C&&(w=v[0]&2?C.return:v[0]?C.throw||((w=C.return)&&w.call(C),0):C.next)&&!(w=w.call(C,v[1])).done)return w;switch(C=0,w&&(v=[v[0]&2,w.value]),v[0]){case 0:case 1:w=v;break;case 4:return f.label++,{value:v[1],done:!1};case 5:f.label++,C=v[1],v=[0];continue;case 7:v=f.ops.pop(),f.trys.pop();continue;default:if(w=f.trys,!(w=w.length>0&&w[w.length-1])&&(v[0]===6||v[0]===2)){f=0;continue}if(v[0]===3&&(!w||v[1]>w[0]&&v[1]<w[3])){f.label=v[1];break}if(v[0]===6&&f.label<w[1]){f.label=w[1],w=v;break}if(w&&f.label<w[2]){f.label=w[2],f.ops.push(v);break}w[2]&&f.ops.pop(),f.trys.pop();continue}v=m.call(u,f)}catch(A){v=[6,A],C=0}finally{y=w=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},Zb=(function(){function u(){}return u.failIfNotSupported=function(){return mx(this,void 0,void 0,function(){return gx(this,function(m){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new u]})})},u.prototype.create=function(m){return mx(this,void 0,void 0,function(){return gx(this,function(f){return[2,Kb.create(m)]})})},u})(),Wb=function(u,m,f,y){function C(w){return w instanceof f?w:new f(function(E){E(w)})}return new(f||(f=Promise))(function(w,E){function T(A){try{v(y.next(A))}catch(O){E(O)}}function N(A){try{v(y.throw(A))}catch(O){E(O)}}function v(A){A.done?w(A.value):C(A.value).then(T,N)}v((y=y.apply(u,m||[])).next())})},Qb=function(u,m){var f={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},y,C,w,E;return E={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function T(v){return function(A){return N([v,A])}}function N(v){if(y)throw new TypeError("Generator is already executing.");for(;E&&(E=0,v[0]&&(f=0)),f;)try{if(y=1,C&&(w=v[0]&2?C.return:v[0]?C.throw||((w=C.return)&&w.call(C),0):C.next)&&!(w=w.call(C,v[1])).done)return w;switch(C=0,w&&(v=[v[0]&2,w.value]),v[0]){case 0:case 1:w=v;break;case 4:return f.label++,{value:v[1],done:!1};case 5:f.label++,C=v[1],v=[0];continue;case 7:v=f.ops.pop(),f.trys.pop();continue;default:if(w=f.trys,!(w=w.length>0&&w[w.length-1])&&(v[0]===6||v[0]===2)){f=0;continue}if(v[0]===3&&(!w||v[1]>w[0]&&v[1]<w[3])){f.label=v[1];break}if(v[0]===6&&f.label<w[1]){f.label=w[1],w=v;break}if(w&&f.label<w[2]){f.label=w[2],f.ops.push(v);break}w[2]&&f.ops.pop(),f.trys.pop();continue}v=m.call(u,f)}catch(A){v=[6,A],C=0}finally{y=w=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}},Jb=(function(){function u(){}return u.retrieve=function(){if(navigator.mediaDevices)return u.getCamerasFromMediaDevices();var m=MediaStreamTrack;return MediaStreamTrack&&m.getSources?u.getCamerasFromMediaStreamTrack():u.rejectWithError()},u.rejectWithError=function(){var m=sl.unableToQuerySupportedDevices();return u.isHttpsOrLocalhost()||(m=sl.insecureContextCameraQueryError()),Promise.reject(m)},u.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var m=location.host.split(":")[0];return m==="127.0.0.1"||m==="localhost"},u.getCamerasFromMediaDevices=function(){return Wb(this,void 0,void 0,function(){var m,f,y,C,w,E,T;return Qb(this,function(N){switch(N.label){case 0:return m=function(v){for(var A=v.getVideoTracks(),O=0,R=A;O<R.length;O++){var z=R[O];z.enabled=!1,z.stop(),v.removeTrack(z)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return f=N.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(y=N.sent(),C=[],w=0,E=y;w<E.length;w++)T=E[w],T.kind==="videoinput"&&C.push({id:T.deviceId,label:T.label});return m(f),[2,C]}})})},u.getCamerasFromMediaStreamTrack=function(){return new Promise(function(m,f){var y=function(w){for(var E=[],T=0,N=w;T<N.length;T++){var v=N[T];v.kind==="video"&&E.push({id:v.id,label:v.label})}m(E)},C=MediaStreamTrack;C.getSources(y)})},u})(),ws;(function(u){u[u.UNKNOWN=0]="UNKNOWN",u[u.NOT_STARTED=1]="NOT_STARTED",u[u.SCANNING=2]="SCANNING",u[u.PAUSED=3]="PAUSED"})(ws||(ws={}));var $b=(function(){function u(){this.state=ws.NOT_STARTED,this.onGoingTransactionNewState=ws.UNKNOWN}return u.prototype.directTransition=function(m){this.failIfTransitionOngoing(),this.validateTransition(m),this.state=m},u.prototype.startTransition=function(m){return this.failIfTransitionOngoing(),this.validateTransition(m),this.onGoingTransactionNewState=m,this},u.prototype.execute=function(){if(this.onGoingTransactionNewState===ws.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var m=this.onGoingTransactionNewState;this.onGoingTransactionNewState=ws.UNKNOWN,this.directTransition(m)},u.prototype.cancel=function(){if(this.onGoingTransactionNewState===ws.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=ws.UNKNOWN},u.prototype.getState=function(){return this.state},u.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==ws.UNKNOWN)throw"Cannot transition to a new state, already under transition"},u.prototype.validateTransition=function(m){switch(this.state){case ws.UNKNOWN:throw"Transition from unknown is not allowed";case ws.NOT_STARTED:this.failIfNewStateIs(m,[ws.PAUSED]);break;case ws.SCANNING:break;case ws.PAUSED:break}},u.prototype.failIfNewStateIs=function(m,f){for(var y=0,C=f;y<C.length;y++){var w=C[y];if(m===w)throw"Cannot transition from ".concat(this.state," to ").concat(m)}},u})(),ew=(function(){function u(m){this.stateManager=m}return u.prototype.startTransition=function(m){return this.stateManager.startTransition(m)},u.prototype.directTransition=function(m){this.stateManager.directTransition(m)},u.prototype.getState=function(){return this.stateManager.getState()},u.prototype.canScanFile=function(){return this.stateManager.getState()===ws.NOT_STARTED},u.prototype.isScanning=function(){return this.stateManager.getState()!==ws.NOT_STARTED},u.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===ws.SCANNING},u.prototype.isPaused=function(){return this.stateManager.getState()===ws.PAUSED},u})(),tw=(function(){function u(){}return u.create=function(){return new ew(new $b)},u})(),sw=(function(){var u=function(m,f){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,C){y.__proto__=C}||function(y,C){for(var w in C)Object.prototype.hasOwnProperty.call(C,w)&&(y[w]=C[w])},u(m,f)};return function(m,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");u(m,f);function y(){this.constructor=m}m.prototype=f===null?Object.create(f):(y.prototype=f.prototype,new y)}})(),Ia=(function(u){sw(m,u);function m(){return u!==null&&u.apply(this,arguments)||this}return m.DEFAULT_WIDTH=300,m.DEFAULT_WIDTH_OFFSET=2,m.FILE_SCAN_MIN_HEIGHT=300,m.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,m.MIN_QR_BOX_SIZE=50,m.SHADED_LEFT=1,m.SHADED_RIGHT=2,m.SHADED_TOP=3,m.SHADED_BOTTOM=4,m.SHADED_REGION_ELEMENT_ID="qr-shaded-region",m.VERBOSE=!1,m.BORDER_SHADER_DEFAULT_COLOR="#ffffff",m.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",m})(Ib),aw=(function(){function u(m,f){this.logger=f,this.fps=Ia.SCAN_DEFAULT_FPS,m?(m.fps&&(this.fps=m.fps),this.disableFlip=m.disableFlip===!0,this.qrbox=m.qrbox,this.aspectRatio=m.aspectRatio,this.videoConstraints=m.videoConstraints):this.disableFlip=Ia.DEFAULT_DISABLE_FLIP}return u.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?ym.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},u.prototype.isShadedBoxEnabled=function(){return!Yn(this.qrbox)},u.create=function(m,f){return new u(m,f)},u})(),nw=(function(){function u(m,f){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(m))throw"HTML Element with id=".concat(m," not found");this.elementId=m,this.verbose=!1;var y;typeof f=="boolean"?this.verbose=f===!0:f&&(y=f,this.verbose=y.verbose===!0,y.experimentalFeatures),this.logger=new kb(this.verbose),this.qrcode=new Hb(this.getSupportedFormats(f),this.getUseBarCodeDetectorIfSupported(y),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=tw.create()}return u.prototype.start=function(m,f,y,C){var w=this;if(!m)throw"cameraIdOrConfig is required";if(!y||typeof y!="function")throw"qrCodeSuccessCallback is required and should be a function.";var E;C?E=C:E=this.verbose?this.logger.log:function(){};var T=aw.create(f,this.logger);this.clearElement();var N=!1;T.videoConstraints&&(T.isMediaStreamConstraintsValid()?N=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var v=N,A=document.getElementById(this.elementId);A.clientWidth?A.clientWidth:Ia.DEFAULT_WIDTH,A.style.position="relative",this.shouldScan=!0,this.element=A;var O=this,R=this.stateManagerProxy.startTransition(ws.SCANNING);return new Promise(function(z,P){var F=v?T.videoConstraints:O.createVideoConstraints(m);if(!F){R.cancel(),P("videoConstraints should be defined");return}var Z={};(!v||T.aspectRatio)&&(Z.aspectRatio=T.aspectRatio);var ne={onRenderSurfaceReady:function(Y,q){O.setupUi(Y,q,T),O.isScanning=!0,O.foreverScan(T,y,E)}};Zb.failIfNotSupported().then(function(Y){Y.create(F).then(function(q){return q.render(w.element,Z,ne).then(function(oe){O.renderedCamera=oe,R.execute(),z(null)}).catch(function(oe){R.cancel(),P(oe)})}).catch(function(q){R.cancel(),P(sl.errorGettingUserMedia(q))})}).catch(function(Y){R.cancel(),P(sl.cameraStreamingNotSupported())})})},u.prototype.pause=function(m){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(ws.PAUSED),this.showPausedState(),(Yn(m)||m!==!0)&&(m=!1),m&&this.renderedCamera&&this.renderedCamera.pause()},u.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var m=this,f=function(){m.stateManagerProxy.directTransition(ws.SCANNING),m.hidePausedState()};if(!this.renderedCamera.isPaused()){f();return}this.renderedCamera.resume(function(){f()})},u.prototype.getState=function(){return this.stateManagerProxy.getState()},u.prototype.stop=function(){var m=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var f=this.stateManagerProxy.startTransition(ws.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var y=function(){if(m.element){var w=document.getElementById(Ia.SHADED_REGION_ELEMENT_ID);w&&m.element.removeChild(w)}},C=this;return this.renderedCamera.close().then(function(){return C.renderedCamera=null,C.element&&(C.element.removeChild(C.canvasElement),C.canvasElement=null),y(),C.qrRegion&&(C.qrRegion=null),C.context&&(C.context=null),f.execute(),C.hidePausedState(),C.isScanning=!1,Promise.resolve()})},u.prototype.scanFile=function(m,f){return this.scanFileV2(m,f).then(function(y){return y.decodedText})},u.prototype.scanFileV2=function(m,f){var y=this;if(!m||!(m instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Yn(f)&&(f=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(C,w){y.possiblyCloseLastScanImageFile(),y.clearElement(),y.lastScanImageFile=URL.createObjectURL(m);var E=new Image;E.onload=function(){var T=E.width,N=E.height,v=document.getElementById(y.elementId),A=v.clientWidth?v.clientWidth:Ia.DEFAULT_WIDTH,O=Math.max(v.clientHeight?v.clientHeight:N,Ia.FILE_SCAN_MIN_HEIGHT),R=y.computeCanvasDrawConfig(T,N,A,O);if(f){var z=y.createCanvasElement(A,O,"qr-canvas-visible");z.style.display="inline-block",v.appendChild(z);var P=z.getContext("2d");if(!P)throw"Unable to get 2d context from canvas";P.canvas.width=A,P.canvas.height=O,P.drawImage(E,0,0,T,N,R.x,R.y,R.width,R.height)}var F=Ia.FILE_SCAN_HIDDEN_CANVAS_PADDING,Z=Math.max(E.width,R.width),ne=Math.max(E.height,R.height),Y=Z+2*F,q=ne+2*F,oe=y.createCanvasElement(Y,q);v.appendChild(oe);var Q=oe.getContext("2d");if(!Q)throw"Unable to get 2d context from canvas";Q.canvas.width=Y,Q.canvas.height=q,Q.drawImage(E,0,0,T,N,F,F,Z,ne);try{y.qrcode.decodeRobustlyAsync(oe).then(function(te){C(cx.createFromQrcodeResult(te))}).catch(w)}catch(te){w("QR code parse error, error = ".concat(te))}},E.onerror=w,E.onabort=w,E.onstalled=w,E.onsuspend=w,E.src=URL.createObjectURL(m)})},u.prototype.clear=function(){this.clearElement()},u.getCameras=function(){return Jb.retrieve()},u.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},u.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},u.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},u.prototype.applyVideoConstraints=function(m){if(m){if(!ym.isMediaStreamConstraintsValid(m,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(m)},u.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},u.prototype.getSupportedFormats=function(m){var f=[He.QR_CODE,He.AZTEC,He.CODABAR,He.CODE_39,He.CODE_93,He.CODE_128,He.DATA_MATRIX,He.MAXICODE,He.ITF,He.EAN_13,He.EAN_8,He.PDF_417,He.RSS_14,He.RSS_EXPANDED,He.UPC_A,He.UPC_E,He.UPC_EAN_EXTENSION];if(!m||typeof m=="boolean"||!m.formatsToSupport)return f;if(!Array.isArray(m.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(m.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var y=[],C=0,w=m.formatsToSupport;C<w.length;C++){var E=w[C];_b(E)?y.push(E):this.logger.warn("Invalid format: ".concat(E," passed in config, ignoring."))}if(y.length===0)throw"None of formatsToSupport match supported values.";return y},u.prototype.getUseBarCodeDetectorIfSupported=function(m){if(Yn(m))return!0;if(!Yn(m.useBarCodeDetectorIfSupported))return m.useBarCodeDetectorIfSupported!==!1;if(Yn(m.experimentalFeatures))return!0;var f=m.experimentalFeatures;return Yn(f.useBarCodeDetectorIfSupported)?!0:f.useBarCodeDetectorIfSupported!==!1},u.prototype.validateQrboxSize=function(m,f,y){var C=this,w=y.qrbox;this.validateQrboxConfig(w);var E=this.toQrdimensions(m,f,w),T=function(v){if(v<Ia.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Ia.MIN_QR_BOX_SIZE,"px.")},N=function(v){return v>m&&(C.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),v=m),v};T(E.width),T(E.height),E.width=N(E.width)},u.prototype.validateQrboxConfig=function(m){if(typeof m!="number"&&typeof m!="function"&&(m.width===void 0||m.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},u.prototype.toQrdimensions=function(m,f,y){if(typeof y=="number")return{width:y,height:y};if(typeof y=="function")try{return y(m,f)}catch(C){throw new Error("qrbox config was passed as a function but it failed with unknown error"+C)}return y},u.prototype.setupUi=function(m,f,y){y.isShadedBoxEnabled()&&this.validateQrboxSize(m,f,y);var C=Yn(y.qrbox)?{width:m,height:f}:y.qrbox;this.validateQrboxConfig(C);var w=this.toQrdimensions(m,f,C);w.height>f&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var E=y.isShadedBoxEnabled()&&w.height<=f,T={x:0,y:0,width:m,height:f},N=E?this.getShadedRegionBounds(m,f,w):T,v=this.createCanvasElement(N.width,N.height),A={willReadFrequently:!0},O=v.getContext("2d",A);O.canvas.width=N.width,O.canvas.height=N.height,this.element.append(v),E&&this.possiblyInsertShadingElement(this.element,m,f,w),this.createScannerPausedUiElement(this.element),this.qrRegion=N,this.context=O,this.canvasElement=v},u.prototype.createScannerPausedUiElement=function(m){var f=document.createElement("div");f.innerText=sl.scannerPaused(),f.style.display="none",f.style.position="absolute",f.style.top="0px",f.style.zIndex="1",f.style.background="rgba(9, 9, 9, 0.46)",f.style.color="#FFECEC",f.style.textAlign="center",f.style.width="100%",m.appendChild(f),this.scannerPausedUiElement=f},u.prototype.scanContext=function(m,f){var y=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(C){return m(C.text,cx.createFromQrcodeResult(C)),y.possiblyUpdateShaders(!0),!0}).catch(function(C){y.possiblyUpdateShaders(!1);var w=sl.codeParseError(C);return f(w,Mb.createFrom(w)),!1})},u.prototype.foreverScan=function(m,f,y){var C=this;if(this.shouldScan&&this.renderedCamera){var w=this.renderedCamera.getSurface(),E=w.videoWidth/w.clientWidth,T=w.videoHeight/w.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var N=this.qrRegion.width*E,v=this.qrRegion.height*T,A=this.qrRegion.x*E,O=this.qrRegion.y*T;this.context.drawImage(w,A,O,N,v,0,0,this.qrRegion.width,this.qrRegion.height);var R=function(){C.foreverScanTimeout=setTimeout(function(){C.foreverScan(m,f,y)},C.getTimeoutFps(m.fps))};this.scanContext(f,y).then(function(z){!z&&m.disableFlip!==!0?(C.context.translate(C.context.canvas.width,0),C.context.scale(-1,1),C.scanContext(f,y).finally(function(){R()})):R()}).catch(function(z){C.logger.logError("Error happend while scanning context",z),R()})}},u.prototype.createVideoConstraints=function(m){if(typeof m=="string")return{deviceId:{exact:m}};if(typeof m=="object"){var f="facingMode",y="deviceId",C={user:!0,environment:!0},w="exact",E=function(P){if(P in C)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(P,"'")},T=Object.keys(m);if(T.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(T.length," keys");var N=Object.keys(m)[0];if(N!==f&&N!==y)throw"Only '".concat(f,"' and '").concat(y,"' ")+" are supported for 'cameraIdOrConfig'";if(N===f){var v=m.facingMode;if(typeof v=="string"){if(E(v))return{facingMode:v}}else if(typeof v=="object")if(w in v){if(E(v["".concat(w)]))return{facingMode:{exact:v["".concat(w)]}}}else throw"'facingMode' should be string or object with"+" ".concat(w," as key.");else{var A=typeof v;throw"Invalid type of 'facingMode' = ".concat(A)}}else{var O=m.deviceId;if(typeof O=="string")return{deviceId:O};if(typeof O=="object"){if(w in O)return{deviceId:{exact:O["".concat(w)]}};throw"'deviceId' should be string or object with"+" ".concat(w," as key.")}else{var R=typeof O;throw"Invalid type of 'deviceId' = ".concat(R)}}}var z=typeof m;throw"Invalid type of 'cameraIdOrConfig' = ".concat(z)},u.prototype.computeCanvasDrawConfig=function(m,f,y,C){if(m<=y&&f<=C){var w=(y-m)/2,E=(C-f)/2;return{x:w,y:E,width:m,height:f}}else{var T=m,N=f;return m>y&&(f=y/m*f,m=y),f>C&&(m=C/f*m,f=C),this.logger.log("Image downsampled from "+"".concat(T,"X").concat(N)+" to ".concat(m,"X").concat(f,".")),this.computeCanvasDrawConfig(m,f,y,C)}},u.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var m=document.getElementById(this.elementId);m&&(m.innerHTML="")},u.prototype.possiblyUpdateShaders=function(m){this.qrMatch!==m&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(f){f.style.backgroundColor=m?Ia.BORDER_SHADER_MATCH_COLOR:Ia.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=m)},u.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},u.prototype.createCanvasElement=function(m,f,y){var C=m,w=f,E=document.createElement("canvas");return E.style.width="".concat(C,"px"),E.style.height="".concat(w,"px"),E.style.display="none",E.id=Yn(y)?"qr-canvas":y,E},u.prototype.getShadedRegionBounds=function(m,f,y){if(y.width>m||y.height>f)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(m-y.width)/2,y:(f-y.height)/2,width:y.width,height:y.height}},u.prototype.possiblyInsertShadingElement=function(m,f,y,C){if(!(f-C.width<1||y-C.height<1)){var w=document.createElement("div");w.style.position="absolute";var E=(f-C.width)/2,T=(y-C.height)/2;if(w.style.borderLeft="".concat(E,"px solid rgba(0, 0, 0, 0.48)"),w.style.borderRight="".concat(E,"px solid rgba(0, 0, 0, 0.48)"),w.style.borderTop="".concat(T,"px solid rgba(0, 0, 0, 0.48)"),w.style.borderBottom="".concat(T,"px solid rgba(0, 0, 0, 0.48)"),w.style.boxSizing="border-box",w.style.top="0px",w.style.bottom="0px",w.style.left="0px",w.style.right="0px",w.id="".concat(Ia.SHADED_REGION_ELEMENT_ID),f-C.width<11||y-C.height<11)this.hasBorderShaders=!1;else{var N=5,v=40;this.insertShaderBorders(w,v,N,-N,null,0,!0),this.insertShaderBorders(w,v,N,-N,null,0,!1),this.insertShaderBorders(w,v,N,null,-N,0,!0),this.insertShaderBorders(w,v,N,null,-N,0,!1),this.insertShaderBorders(w,N,v+N,-N,null,-N,!0),this.insertShaderBorders(w,N,v+N,null,-N,-N,!0),this.insertShaderBorders(w,N,v+N,-N,null,-N,!1),this.insertShaderBorders(w,N,v+N,null,-N,-N,!1),this.hasBorderShaders=!0}m.append(w)}},u.prototype.insertShaderBorders=function(m,f,y,C,w,E,T){var N=document.createElement("div");N.style.position="absolute",N.style.backgroundColor=Ia.BORDER_SHADER_DEFAULT_COLOR,N.style.width="".concat(f,"px"),N.style.height="".concat(y,"px"),C!==null&&(N.style.top="".concat(C,"px")),w!==null&&(N.style.bottom="".concat(w,"px")),T?N.style.left="".concat(E,"px"):N.style.right="".concat(E,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(N),m.appendChild(N)},u.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},u.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},u.prototype.getTimeoutFps=function(m){return 1e3/m},u})(),px;(function(u){u[u.STATUS_DEFAULT=0]="STATUS_DEFAULT",u[u.STATUS_SUCCESS=1]="STATUS_SUCCESS",u[u.STATUS_WARNING=2]="STATUS_WARNING",u[u.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(px||(px={}));const rw=`
  #qr-scanner-container #html5-qrcode-button-camera-permission,
  #qr-scanner-container #html5-qrcode-button-file-selection,
  #qr-scanner-container select,
  #qr-scanner-container button:not(.custom-scanner-button),
  #qr-scanner-container .html5-qrcode-element button,
  #qr-scanner-container div[style*="text-align: center"] button,
  #qr-scanner-container div[style*="text-align:center"] button {
    display: none !important;
  }

  #qr-scanner-container > div > div:last-child {
    display: none !important;
  }
`,Yc=({onScan:u,onError:m,isActive:f=!0,className:y="",showManualInput:C=!0})=>{const[w,E]=D.useState("camera"),[T,N]=D.useState(""),[v,A]=D.useState(!1),[O,R]=D.useState(""),[z,P]=D.useState(!1),[F,Z]=D.useState(!1),[ne,Y]=D.useState({active:!1,width:0,height:0,constraints:null}),q=D.useRef(null),oe=D.useRef(null),Q=D.useRef(null),te=D.useRef(null);D.useEffect(()=>{const ve=document.createElement("style");return ve.textContent=rw,document.head.appendChild(ve),()=>{document.head.contains(ve)&&document.head.removeChild(ve)}},[]),D.useEffect(()=>()=>{Te()},[]);const K=async()=>{try{if(A(!0),R(""),P(!1),Z(!0),Y({active:!1,width:0,height:0,constraints:null}),console.log(" Starting camera initialization..."),q.current&&(await q.current.stop(),q.current=null),te.current&&(te.current.getTracks().forEach(V=>V.stop()),te.current=null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Camera is not supported in this browser. Please use manual input.");if(console.log(" getUserMedia available"),!(window.isSecureContext||window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.protocol==="https:"))throw new Error("Camera requires HTTPS connection or localhost. Please use HTTPS or manual input.");console.log(" Secure context verified");let Ne=null,M=null;try{console.log(" Trying back camera (environment)..."),M={video:{facingMode:{ideal:"environment"},width:{ideal:1280,min:640},height:{ideal:720,min:480}},audio:!1},Ne=await navigator.mediaDevices.getUserMedia(M),console.log(" Back camera successful")}catch(V){console.log(" Back camera failed:",V.message);try{console.log(" Trying front camera (user)..."),M={video:{facingMode:"user",width:{ideal:1280,min:640},height:{ideal:720,min:480}},audio:!1},Ne=await navigator.mediaDevices.getUserMedia(M),console.log(" Front camera successful")}catch(fe){console.log(" Front camera failed:",fe.message),console.log(" Trying any camera..."),M={video:{width:{ideal:1280,min:640},height:{ideal:720,min:480}},audio:!1},Ne=await navigator.mediaDevices.getUserMedia(M),console.log(" Any camera successful")}}if(!Ne)throw new Error("No camera stream available");console.log(" Stream obtained:",{active:Ne.active,tracks:Ne.getTracks().length,videoTracks:Ne.getVideoTracks().length}),te.current=Ne;const L=Ne.getVideoTracks()[0];if(L){const V=L.getSettings();console.log(" Video track settings:",V),Y({active:!0,width:V.width||0,height:V.height||0,constraints:M})}if(console.log(" Waiting for DOM container..."),await new Promise(V=>{const fe=()=>{document.getElementById("qr-scanner-container")?(console.log(" DOM container found"),V()):setTimeout(fe,50)};fe()}),Q.current){Q.current.srcObject=Ne,await new Promise(V=>{Q.current.onloadedmetadata=()=>{console.log(" Video metadata loaded"),V()}});try{await Q.current.play(),console.log(" Video playback started")}catch(V){throw console.error(" Video playback error:",V),new Error("Failed to start video playback")}}console.log(" Initializing QR scanner...");const U={fps:10,qrbox:{width:250,height:250},aspectRatio:1,disableFlip:!1};q.current=new nw("qr-scanner-container"),await q.current.start({deviceId:{exact:L.getSettings().deviceId}},U,V=>{console.log(" QR Code detected:",V),re(V)},V=>{!V.includes("No MultiFormat Readers")&&!V.includes("NotFoundException")&&!V.includes("No QR code found")&&console.warn("QR scan error:",V)}),console.log(" Scanner initialization complete"),P(!0),A(!1)}catch(ve){console.error(" Scanner initialization error:",ve);let Ne=ve.message||"Failed to initialize camera scanner.";ve.name==="NotAllowedError"?Ne="Camera access denied. Please allow camera permissions and refresh the page.":ve.name==="NotFoundError"?Ne="No camera found. Please connect a camera and try again.":ve.name==="NotReadableError"?Ne="Camera is already in use by another application.":ve.name==="OverconstrainedError"&&(Ne="Camera constraints not supported. Please try manual input."),R(Ne),A(!1),Z(!1),Y({active:!1,width:0,height:0,constraints:null}),te.current&&(te.current.getTracks().forEach(M=>M.stop()),te.current=null),q.current&&(await q.current.stop(),q.current=null),m&&m(Ne)}},Te=async()=>{try{console.log(" Stopping scanner..."),q.current&&(await q.current.stop(),q.current=null),te.current&&(te.current.getTracks().forEach(ve=>{ve.stop(),console.log(" Stopped track:",ve.kind)}),te.current=null),P(!1),A(!1),R(""),Z(!1),Y({active:!1,width:0,height:0,constraints:null}),console.log(" Scanner stopped")}catch(ve){console.error("Error stopping scanner:",ve),P(!1),A(!1),Z(!1),Y({active:!1,width:0,height:0,constraints:null})}},re=ve=>{u&&u(ve.trim())},le=ve=>{ve.preventDefault();const Ne=T.trim();Ne&&u&&(u(Ne),N(""))},Oe=()=>{E("camera"),N("")},$=()=>{E("manual"),Te()};return s.jsxs("div",{className:`w-full ${y}`,children:[s.jsxs("div",{className:"flex space-x-2 mb-4",children:[s.jsxs("button",{onClick:Oe,className:`flex items-center px-4 py-2 rounded-lg border transition-colors ${w==="camera"?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,disabled:v,children:[s.jsx(so,{className:"w-4 h-4 mr-2"}),"Camera Scan"]}),C&&s.jsxs("button",{onClick:$,className:`flex items-center px-4 py-2 rounded-lg border transition-colors ${w==="manual"?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:[s.jsx(Ku,{className:"w-4 h-4 mr-2"}),"Manual Input"]})]}),w==="camera"?s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:s.jsxs("div",{className:"relative",children:[!F&&s.jsxs("div",{className:"min-h-[320px] bg-gray-50 rounded-lg flex flex-col items-center justify-center border-2 border-dashed border-gray-300",children:[s.jsx(so,{className:"w-16 h-16 text-gray-400 mb-4"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Ready to scan QR codes"}),s.jsxs("button",{onClick:K,disabled:v,className:"inline-flex items-center px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium disabled:opacity-50",children:[s.jsx(nm,{className:"w-5 h-5 mr-2"}),"Start Scanning"]})]}),v&&s.jsxs("div",{className:"min-h-[320px] bg-gray-50 rounded-lg flex flex-col items-center justify-center",children:[s.jsx(nl,{className:"w-8 h-8 mb-4 animate-spin text-green-600"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Initializing camera..."})]}),O&&F&&s.jsxs("div",{className:"min-h-[320px] bg-gray-50 rounded-lg flex flex-col items-center justify-center border-2 border-dashed border-red-300",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:s.jsx(w2,{className:"w-8 h-8 text-red-600"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Camera Unavailable"}),s.jsx("p",{className:"text-sm text-gray-600 mb-6 text-center max-w-md",children:O}),s.jsxs("div",{className:"flex flex-col space-y-3",children:[s.jsxs("div",{className:"flex space-x-3 justify-center",children:[s.jsxs("button",{onClick:K,className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[s.jsx(so,{className:"w-4 h-4 mr-2"}),"Try Again"]}),C&&s.jsxs("button",{onClick:$,className:"inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[s.jsx(Ku,{className:"w-4 h-4 mr-2"}),"Manual Input"]})]}),s.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[s.jsx("p",{className:"mb-1",children:"Troubleshooting:"}),s.jsx("p",{children:" Refresh the page and allow camera permissions"}),s.jsx("p",{children:" Make sure no other app is using the camera"}),s.jsx("p",{children:" Try using HTTPS instead of HTTP"})]})]})]}),F&&!O&&s.jsxs("div",{className:"relative",children:[s.jsxs("div",{id:"qr-scanner-container",ref:oe,className:"rounded-lg overflow-hidden bg-gray-900 relative",style:{height:"320px"},children:[s.jsx("video",{ref:Q,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 z-10",children:s.jsxs("button",{onClick:Te,className:"inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium shadow-lg",children:[s.jsx(by,{className:"w-4 h-4 mr-2"}),"Stop Scanning"]})})]}),ne.active&&s.jsx("div",{className:"mt-2 p-2 bg-gray-100 rounded text-xs text-gray-600",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{children:["Stream: Active (",ne.width,"",ne.height,")"]}),s.jsx("span",{className:"text-green-600",children:""})]})}),s.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(so,{className:"w-5 h-5 text-blue-600 mr-2"}),s.jsx("p",{className:"text-sm text-blue-800",children:"Position the QR code within the scan area above"})]})})]})]})}):s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Ku,{className:"w-8 h-8 text-green-600"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Manual Input"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Enter the Booking ID manually if camera scanning is not available"})]}),s.jsxs("form",{onSubmit:le,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"manual-booking-id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Booking ID"}),s.jsx("input",{id:"manual-booking-id",type:"text",value:T,onChange:ve=>N(ve.target.value),placeholder:"Enter booking ID (e.g., LLL12345)",className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500 text-lg font-mono",autoComplete:"off"})]}),s.jsxs("button",{type:"submit",disabled:!T.trim(),className:"w-full flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[s.jsx(qn,{className:"w-5 h-5 mr-2"}),"Scan Order"]})]})]})]})},yx=()=>{const[u,m]=D.useState(""),[f,y]=D.useState([]),[C,w]=D.useState(null),[E,T]=D.useState(""),[N,v]=D.useState(!1),[A,O]=D.useState(!1),[R,z]=D.useState([]),{user:P}=Qs(),F=(P==null?void 0:P.token)||ea();D.useEffect(()=>{(async()=>{try{const te=await fetch("/api/users/riders",{headers:{Authorization:`Bearer ${F}`}}),K=await te.json();te.ok&&y(K.filter(Te=>Te.status==="ACTIVE"))}catch(te){console.error("Failed to fetch riders:",te)}})()},[F]);const Z=async Q=>{if(!Q||!Q.trim()){T("Please enter or scan a booking ID"),bt("Booking ID required");return}if(!u){T("Please select a rider first"),bt("Select a rider first");return}v(!0),T(""),w(null);let te=ya("Fetching order details...");try{const K=await fetch(`/api/orders/details/${encodeURIComponent(Q.trim())}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F}`}}),Te=K.headers.get("content-type");if(!Te||!Te.includes("application/json")){const le=await K.text();throw new Error(`Server returned non-JSON response: ${le.substring(0,100)}`)}const re=await K.json();if(!K.ok)throw new Error(re.message||"Failed to fetch order details");w(re),ks("Order loaded")}catch(K){T(K.message),w(null),bt(K.message||"Failed to fetch order details")}finally{v(!1),te&&pa(te)}},ne=async()=>{if(!C||!u){T("Please select a rider and scan an order"),bt("Select rider and scan order");return}O(!0),T("");let Q=ya("Assigning order...");try{const te=await fetch("/api/orders/assign-by-scan",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F}`},body:JSON.stringify({bookingId:C.bookingId,assignedRiderId:u})}),K=te.headers.get("content-type");if(!K||!K.includes("application/json")){const le=await te.text();throw new Error(`Server returned non-JSON response: ${le.substring(0,100)}`)}const Te=await te.json();if(!te.ok)throw new Error(Te.message||"Failed to assign order");const re=f.find(le=>le._id===u);z(le=>[{bookingId:C.bookingId,riderName:(re==null?void 0:re.name)||"Unknown",timestamp:new Date().toLocaleString()},...le.slice(0,9)]),w(null),T(""),ks(`Assigned to ${(re==null?void 0:re.name)||"Rider"}`)}catch(te){T(te.message),bt(te.message||"Failed to assign order")}finally{O(!1),Q&&pa(Q)}},Y=Q=>{Z(Q)},q=Q=>{T(Q),bt(Q)},oe=f.find(Q=>Q._id===u);return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Pr,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Assign Orders by QR Scan"})]}),s.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Select a rider and scan QR codes to assign orders. Orders will be automatically marked as Out for Delivery."})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(io,{className:"w-4 h-4 inline mr-2"}),"Select Rider (Required)"]}),s.jsxs("select",{value:u,onChange:Q=>{m(Q.target.value),w(null),T("")},className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white focus:ring-2 focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"",children:"-- Select a Rider --"}),f.map(Q=>s.jsxs("option",{value:Q._id,children:[Q.name," ",Q.email?`(${Q.email})`:""]},Q._id))]}),oe&&s.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",s.jsx("span",{className:"font-semibold",children:oe.name}),oe.phone&&s.jsxs("span",{className:"ml-2",children:["- ",oe.phone]})]})]}),u&&s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsx(Yc,{onScan:Y,onError:q})}),N&&s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-600",children:[s.jsx("div",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Fetching order details..."})]})}),E&&s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"p-4 bg-red-50 border border-red-100 text-red-600 rounded-lg flex items-center gap-2",children:[s.jsx(yn,{className:"w-5 h-5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Error"}),s.jsx("p",{className:"text-sm",children:E})]})]})}),C&&u&&s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-100 text-blue-700 rounded-lg mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(gt,{className:"w-5 h-5"}),s.jsx("p",{className:"font-semibold",children:"Order Preview"})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:"Booking ID:"}),s.jsx("span",{className:"font-mono",children:C.bookingId})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:"Tracking ID:"}),s.jsx("span",{className:"font-mono",children:C.trackingId})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:"Consignee:"}),s.jsx("span",{children:C.consigneeName})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Kn,{className:"w-4 h-4"}),s.jsx("span",{className:"font-medium",children:"Address:"}),s.jsxs("span",{children:[C.consigneeAddress,", ",C.destinationCity]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:"Phone:"}),s.jsx("span",{children:C.consigneePhone})]}),C.codAmount>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ut,{className:"w-4 h-4"}),s.jsx("span",{className:"font-medium",children:"COD Amount:"}),s.jsxs("span",{children:["PKR ",Number(C.codAmount).toLocaleString()]})]}),s.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200",children:[s.jsx("span",{className:"font-medium",children:"Current Status:"}),s.jsx("span",{className:"ml-2 px-2 py-1 bg-blue-200 text-blue-800 rounded text-xs font-semibold",children:C.status})]}),C.assignedRider&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-200",children:[s.jsx("span",{className:"font-medium",children:"Currently Assigned:"}),s.jsx("span",{className:"ml-2",children:C.assignedRider.name})]})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(as,{onClick:ne,disabled:A,className:"flex-1",children:A?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Assigning..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ds,{className:"w-4 h-4 mr-2"}),"Assign to ",oe==null?void 0:oe.name]})}),s.jsx("button",{onClick:()=>{w(null),T("")},className:"px-4 py-2 text-sm bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Cancel"})]})]}),R.length>0&&s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("h4",{className:"text-md font-bold text-secondary mb-4",children:"Recent Assignments"}),s.jsx("div",{className:"space-y-2",children:R.map((Q,te)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-100 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(qn,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium",children:Q.bookingId}),s.jsxs("span",{className:"text-sm text-gray-600",children:[" ",Q.riderName]})]}),s.jsx("span",{className:"text-xs text-gray-500",children:Q.timestamp})]},te))})]})]})},iw=()=>{const[u,m]=D.useState([]),[f,y]=D.useState([]),[C,w]=D.useState(!0),[E,T]=D.useState(""),[N,v]=D.useState(""),[A,O]=D.useState("ALL"),R=typeof window<"u"?localStorage.getItem("token"):null,[z,P]=D.useState(null),[F,Z]=D.useState({newPassword:"",confirmPassword:""}),[ne,Y]=D.useState({}),[q,oe]=D.useState(null),[Q,te]=D.useState(""),[K,Te]=D.useState(null);D.useEffect(()=>{re()},[]),D.useEffect(()=>{le()},[u,N,A]);const re=async()=>{w(!0),T("");try{const L=await fetch("/api/users/riders",{headers:{Authorization:R?`Bearer ${R}`:""}}),U=await L.json();if(!L.ok)throw new Error(U.message||"Failed to fetch riders");m(U)}catch(L){T(L.message)}finally{w(!1)}},le=()=>{let L=[...u];if(A!=="ALL"&&(L=L.filter(U=>U.status===A)),N.trim()){const U=N.toLowerCase();L=L.filter(V=>{var fe,he,X;return((fe=V.name)==null?void 0:fe.toLowerCase().includes(U))||((he=V.email)==null?void 0:he.toLowerCase().includes(U))||((X=V.phone)==null?void 0:X.toLowerCase().includes(U))})}y(L)},Oe=()=>{const L={};return(!F.newPassword||F.newPassword.length<8)&&(L.newPassword="Password must be at least 8 characters"),F.confirmPassword?F.newPassword!==F.confirmPassword&&(L.confirmPassword="Passwords do not match"):L.confirmPassword="Please confirm your password",Y(L),Object.keys(L).length===0},$=async L=>{if(L.preventDefault(),Y({}),oe(null),te(""),!!Oe())try{const U=await fetch(`/api/users/${z._id}/reset-password`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:R?`Bearer ${R}`:""},body:JSON.stringify({newPassword:F.newPassword})}),V=await U.json();if(!U.ok)throw new Error(V.message||"Failed to reset password");oe({message:"Password updated successfully!",password:V.password,isTemporary:V.isTemporary}),te(V.password),Z({newPassword:"",confirmPassword:""})}catch(U){Y({submit:U.message})}},ve=async L=>{try{const U=await fetch(`/api/users/${L._id}/reset-password`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:R?`Bearer ${R}`:""},body:JSON.stringify({})}),V=await U.json();if(!U.ok)throw new Error(V.message||"Failed to generate password");P(L),oe({message:"Temporary password generated successfully!",password:V.password,isTemporary:!0}),te(V.password),Z({newPassword:"",confirmPassword:""})}catch(U){Y({submit:U.message})}},Ne=L=>{navigator.clipboard.writeText(L),alert("Password copied to clipboard!")},M=async(L,U)=>{try{const V=await fetch(`/api/users/${L}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:R?`Bearer ${R}`:""},body:JSON.stringify({status:U})}),fe=await V.json();if(!V.ok)throw new Error(fe.message||"Failed to update status");await re()}catch(V){T(V.message)}};return s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(ds,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Riders Management"})]})})}),E&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:E}),s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(A0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search by name, email, or phone...",value:N,onChange:L=>v(L.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),s.jsxs("select",{value:A,onChange:L=>O(L.target.value),className:"px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",children:[s.jsx("option",{value:"ALL",children:"All Status"}),s.jsx("option",{value:"ACTIVE",children:"Active"}),s.jsx("option",{value:"INACTIVE",children:"Inactive"})]})]})}),s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:C?s.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):f.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No riders found."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[s.jsx("th",{className:"py-3 px-4",children:"Rider Name"}),s.jsx("th",{className:"py-3 px-4",children:"Email"}),s.jsx("th",{className:"py-3 px-4",children:"Phone"}),s.jsx("th",{className:"py-3 px-4",children:"Assigned Orders"}),s.jsx("th",{className:"py-3 px-4",children:"COD Collected"}),s.jsx("th",{className:"py-3 px-4",children:"Status"}),s.jsx("th",{className:"py-3 px-4",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:f.map(L=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"py-3 px-4 font-medium",children:L.name}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Bc,{className:"w-3 h-3 text-gray-400"}),L.email||"N/A"]})}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Lr,{className:"w-3 h-3 text-gray-400"}),L.phone||"N/A"]})}),s.jsx("td",{className:"py-3 px-4",children:L.assignedOrders||0}),s.jsxs("td",{className:"py-3 px-4",children:["PKR ",Number(L.codCollected||0).toLocaleString()]}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${L.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:L.status})}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:()=>M(L._id,L.status==="ACTIVE"?"INACTIVE":"ACTIVE"),children:L.status==="ACTIVE"?"Deactivate":"Activate"}),s.jsxs("button",{className:"px-2 py-1 text-xs border border-blue-200 text-blue-600 rounded hover:bg-blue-50 flex items-center gap-1",onClick:()=>{P(L),Z({newPassword:"",confirmPassword:""}),Y({}),oe(null),te("")},children:[s.jsx(q2,{className:"w-3 h-3"}),"Reset Password"]}),s.jsxs("button",{className:"px-2 py-1 text-xs border border-green-200 text-green-600 rounded hover:bg-green-50 flex items-center gap-1",onClick:()=>ve(L),children:[s.jsx(uy,{className:"w-3 h-3"}),"Generate Temp"]}),s.jsxs("button",{className:"px-2 py-1 text-xs border border-purple-200 text-purple-600 rounded hover:bg-purple-50",onClick:()=>Te(L),children:[s.jsx(io,{className:"w-3 h-3 inline"})," Details"]})]})})]},L._id))})]})})}),z&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>{P(null),Z({newPassword:"",confirmPassword:""}),Y({}),oe(null),te("")},children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",onClick:L=>L.stopPropagation(),children:[s.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-bold text-secondary",children:["Reset Password for ",z.name]}),s.jsx("button",{onClick:()=>{P(null),Z({newPassword:"",confirmPassword:""}),Y({}),oe(null),te("")},className:"text-gray-400 hover:text-gray-600",children:s.jsx(yn,{className:"w-5 h-5"})})]}),s.jsx("form",{onSubmit:$,className:"p-6 space-y-4",children:q?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 text-green-700 rounded-lg",children:[s.jsx("p",{className:"font-semibold mb-2",children:q.message}),s.jsxs("div",{className:"mt-3",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:q.isTemporary?"Temporary Password (copy this):":"New Password (copy this):"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",readOnly:!0,value:q.password,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg bg-gray-50 font-mono"}),s.jsxs("button",{type:"button",onClick:()=>Ne(q.password),className:"px-3 py-2 text-sm bg-primary text-white rounded-lg hover:bg-primary-hover flex items-center gap-1",children:[s.jsx(_2,{className:"w-4 h-4"}),"Copy"]})]})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{type:"button",onClick:()=>{P(null),Z({newPassword:"",confirmPassword:""}),Y({}),oe(null),te("")},className:"px-4 py-2 text-sm bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Close"})})]}):s.jsxs(s.Fragment,{children:[ne.submit&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 text-red-600 text-sm rounded",children:ne.submit}),s.jsxs("div",{children:[s.jsx(st,{label:"New Password",type:"password",value:F.newPassword,onChange:L=>Z({...F,newPassword:L.target.value}),required:!0}),ne.newPassword&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:ne.newPassword})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Confirm Password",type:"password",value:F.confirmPassword,onChange:L=>Z({...F,confirmPassword:L.target.value}),required:!0}),ne.confirmPassword&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:ne.confirmPassword})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{type:"button",className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>{P(null),Z({newPassword:"",confirmPassword:""}),Y({}),oe(null),te("")},children:"Cancel"}),s.jsx(as,{type:"submit",children:"Reset Password"})]})]})})]})}),K&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>Te(null),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden",onClick:L=>L.stopPropagation(),children:[s.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Rider Details"}),s.jsx("button",{onClick:()=>Te(null),className:"text-gray-400 hover:text-gray-600",children:s.jsx(yn,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Name"}),s.jsx("p",{className:"text-sm font-semibold",children:K.name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Email"}),s.jsx("p",{className:"text-sm",children:K.email||"N/A"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Phone"}),s.jsx("p",{className:"text-sm",children:K.phone||"N/A"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Status"}),s.jsx("p",{className:"text-sm",children:s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${K.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:K.status})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Vehicle Info"}),s.jsx("p",{className:"text-sm",children:K.vehicleInfo||"N/A"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Assigned Orders"}),s.jsx("p",{className:"text-sm font-semibold",children:K.assignedOrders||0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"COD Collected"}),s.jsxs("p",{className:"text-sm font-semibold",children:["PKR ",Number(K.codCollected||0).toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Service Charges"}),s.jsxs("p",{className:"text-sm font-semibold",children:["PKR ",Number(K.serviceCharges||0).toLocaleString()]})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:()=>Te(null),className:"px-4 py-2 text-sm bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Close"})})]})]})})]})},bx=()=>{var le,Oe;const[u,m]=D.useState(!1),[f,y]=D.useState(""),[C,w]=D.useState(""),[E,T]=D.useState(null),[N,v]=D.useState(!1),[A,O]=D.useState(""),[R,z]=D.useState(!1),[P,F]=D.useState(!1),[Z,ne]=D.useState([]),{user:Y}=Qs(),q=(Y==null?void 0:Y.token)||ea();D.useEffect(()=>{const $=localStorage.getItem("warehouseScanHistory");if($)try{ne(JSON.parse($))}catch(ve){console.error("Failed to load scan history:",ve)}},[]);const oe=$=>{const Ne=[{bookingId:$.bookingId,consigneeName:$.consigneeName,scannedAt:new Date().toISOString(),scannedBy:(Y==null?void 0:Y.name)||"Unknown",weightKg:$.weightKg,status:$.status},...Z.slice(0,9)];ne(Ne),localStorage.setItem("warehouseScanHistory",JSON.stringify(Ne))},Q=async $=>{y(""),w("");let ve,Ne=$;if($.includes("|")){const M=$.split("|");M.length===2&&M[0]==="LLL"&&(Ne=M[1])}try{m(!0),ve=ya("Fetching order details...");const M=await fetch(`/api/orders/${Ne}/scan-preview`,{method:"GET",headers:{Authorization:`Bearer ${q}`,"Content-Type":"application/json"}}),L=await M.json();if(!M.ok){L.code==="ORDER_NOT_FOUND"?(y(`Order "${Ne}" not found. Please check the booking ID.`),bt("Order not found")):L.code==="INVALID_STATUS"?(y(`Cannot scan order: ${L.message}`),bt(L.message||"Invalid status")):(y(L.message||"Failed to fetch order details"),bt(L.message||"Failed to fetch order details")),ve&&pa(ve);return}if(L.success){const U=L.data.order;T(U),O(U.weightKg.toString()),z(!1),v(!0),ks("Order loaded")}}catch(M){console.error("Error scanning order:",M),y("Network error. Please check your connection and try again."),bt("Network error")}finally{m(!1),ve&&pa(ve)}},te=async()=>{if(!E)return;let $;try{F(!0),y(""),$=ya("Processing scan...");const ve={};if(R&&A!==E.weightKg.toString()){const L=parseFloat(A);if(isNaN(L)||L<=0){y("Please enter a valid weight greater than 0"),bt("Enter a valid weight > 0");return}if(L>50){y("Weight cannot exceed 50kg"),bt("Weight cannot exceed 50kg");return}ve.scannedWeightKg=L}const Ne=await fetch(`/api/orders/${E.bookingId}/warehouse-scan`,{method:"POST",headers:{Authorization:`Bearer ${q}`,"Content-Type":"application/json"},body:JSON.stringify(ve)}),M=await Ne.json();if(!Ne.ok){M.code==="ORDER_INVOICED"?(y("This order has already been paid and cannot be modified."),bt("Order is already paid")):M.code==="INVALID_WEIGHT"?(y(M.message),bt(M.message||"Invalid weight")):(y(M.message||"Failed to process warehouse scan"),bt(M.message||"Failed to process warehouse scan")),$&&pa($);return}if(M.success){const L=M.data.order,U=M.data.changes;oe(L);let V="Order successfully scanned into warehouse!";U.weightChanged&&(V+=` Weight updated from ${U.oldWeight}kg to ${U.newWeight}kg.`),U.serviceChargesRecalculated&&(V+=" Service charges recalculated."),w(V),v(!1),T(null),ks("Warehouse scan processed")}}catch(ve){console.error("Error processing scan:",ve),y("Network error. Please try again."),bt("Network error")}finally{F(!1),$&&pa($)}},K=$=>$?new Date($).toLocaleString():"Not set",Te=$=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0}).format($||0),re=$=>{const ve={CREATED:{bg:"bg-gray-100",text:"text-gray-800",label:"Created"},ASSIGNED:{bg:"bg-blue-100",text:"text-blue-800",label:"Assigned"},AT_LLL_WAREHOUSE:{bg:"bg-green-100",text:"text-green-800",label:"At Warehouse"},OUT_FOR_DELIVERY:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Out for Delivery"},DELIVERED:{bg:"bg-green-100",text:"text-green-800",label:"Delivered"},RETURNED:{bg:"bg-red-100",text:"text-red-800",label:"Returned"},FAILED:{bg:"bg-red-100",text:"text-red-800",label:"Failed"}},Ne=ve[$]||ve.CREATED;return s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Ne.bg} ${Ne.text}`,children:Ne.label})};return s.jsx("div",{className:"min-h-screen bg-gray-50 p-4 lg:p-8",children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:s.jsx(gt,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Warehouse Scanner"}),s.jsx("p",{className:"text-gray-600",children:"Scan parcels to mark arrival and verify weight"})]})]})}),f&&s.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-2",children:[s.jsx(Cy,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),s.jsx("span",{className:"text-red-700",children:f})]}),C&&s.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4 flex items-start space-x-2",children:[s.jsx(qn,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),s.jsx("span",{className:"text-green-700",children:C})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsx("div",{className:"lg:col-span-2",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(gt,{className:"w-6 h-6 mr-2 text-green-600"}),"Scan Parcel QR Code"]}),s.jsx(Yc,{onScan:Q,onError:y,isActive:!N,showManualInput:!0}),u&&s.jsxs("div",{className:"mt-6 text-center py-4",children:[s.jsx(nl,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-green-600"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Loading order details..."})]})]})}),s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(bn,{className:"w-5 h-5 mr-2 text-gray-600"}),"Recent Scans"]}),Z.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(gt,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"No scans yet"})]}):s.jsx("div",{className:"space-y-3",children:Z.map(($,ve)=>{var Ne;return s.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"font-medium text-sm text-gray-900",children:$.bookingId}),s.jsx("span",{className:"text-xs text-gray-500",children:(Ne=K($.scannedAt).split(",")[1])==null?void 0:Ne.trim()})]}),s.jsx("p",{className:"text-xs text-gray-600 truncate",children:$.consigneeName}),s.jsxs("div",{className:"flex items-center justify-between mt-2",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:[$.weightKg,"kg"]}),re($.status)]})]},ve)})})]})})]}),N&&E&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[s.jsx(gt,{className:"w-6 h-6 mr-2 text-green-600"}),"Confirm Warehouse Scan"]}),s.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600",disabled:P,children:s.jsx(cm,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Booking ID"}),s.jsx("p",{className:"text-lg font-mono font-semibold text-gray-900",children:E.bookingId})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Consignee"}),s.jsx("p",{className:"text-gray-900",children:E.consigneeName})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination"}),s.jsxs("div",{className:"flex items-center text-gray-900",children:[s.jsx(Kn,{className:"w-4 h-4 mr-1 text-gray-500"}),E.destinationCity]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shipper"}),s.jsxs("div",{className:"flex items-center text-gray-900",children:[s.jsx(io,{className:"w-4 h-4 mr-1 text-gray-500"}),((le=E.shipper)==null?void 0:le.name)||((Oe=E.shipper)==null?void 0:Oe.companyName)||"Unknown"]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Status"}),re(E.status)]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"COD Amount"}),s.jsxs("div",{className:"flex items-center text-gray-900",children:[s.jsx(Ut,{className:"w-4 h-4 mr-1 text-gray-500"}),Te(E.codAmount)]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Service Charges"}),s.jsxs("div",{className:"flex items-center text-gray-900",children:[s.jsx(Ut,{className:"w-4 h-4 mr-1 text-gray-500"}),Te(E.serviceCharges)]})]}),E.assignedRider&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned Rider"}),s.jsxs("div",{className:"flex items-center text-gray-900",children:[s.jsx(ds,{className:"w-4 h-4 mr-1 text-gray-500"}),E.assignedRider.name]})]})]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 mb-6",children:[s.jsxs("h4",{className:"font-medium text-gray-900 mb-4 flex items-center",children:[s.jsx(tx,{className:"w-5 h-5 mr-2 text-green-600"}),"Weight Verification"]}),E.isInvoiced&&s.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(X2,{className:"w-5 h-5 text-yellow-600 mr-2"}),s.jsx("span",{className:"text-sm text-yellow-800",children:"This order is already paid. Weight cannot be changed."})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Current Weight: ",s.jsxs("span",{className:"font-semibold",children:[E.weightKg," kg"]})]}),E.weightSource&&s.jsxs("p",{className:"text-xs text-gray-500",children:["Source: ",E.weightSource.replace("_"," ").toLowerCase(),E.weightVerifiedAt&&`  Verified: ${K(E.weightVerifiedAt)}`]})]}),!E.isInvoiced&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",id:"override-weight",checked:R,onChange:$=>z($.target.checked),className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"}),s.jsx("label",{htmlFor:"override-weight",className:"text-sm font-medium text-gray-700",children:"Verify/Override weight at warehouse"})]}),R&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Actual Weight (kg)"}),s.jsxs("div",{className:"relative",children:[s.jsx(tx,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"number",value:A,onChange:$=>O($.target.value),step:"0.1",min:"0.1",max:"50",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Enter actual weight"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This will recalculate service charges based on the new weight"})]})]})]})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>v(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:P,children:"Cancel"}),s.jsx("button",{onClick:te,disabled:P,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:P?s.jsxs(s.Fragment,{children:[s.jsx(nl,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(E0,{className:"w-4 h-4 mr-2"}),"Confirm Scan"]})})]})]})})})]})})},lw=()=>{const[u,m]=D.useState([]),[f,y]=D.useState(!0),[C,w]=D.useState(""),[E,T]=D.useState(null),[N,v]=D.useState("today"),[A,O]=D.useState(null),{user:R}=Qs(),z=Gs(),P=T0(),F=(R==null?void 0:R.token)||ea();D.useEffect(()=>{F&&(Z(),ne(),Y())},[F,N]);const Z=async()=>{y(!0),w("");try{const $=await fetch("/api/orders",{headers:{Authorization:`Bearer ${F}`}}),ve=await $.json();if(!$.ok)throw new Error(ve.message||"Failed to fetch orders");m(ve)}catch($){w($.message)}finally{y(!1)}},ne=async()=>{try{const $=await fetch("/api/orders/summary/manager",{headers:{Authorization:`Bearer ${F}`}}),ve=await $.json();$.ok&&T(ve)}catch{}},Y=async()=>{try{const $=await fetch(`/api/dashboard/manager?period=${N}`,{headers:{Authorization:`Bearer ${F}`}}),ve=await $.json();$.ok&&O(ve.stats)}catch{}},q=$=>typeof $=="number"||typeof $=="string"?$:"",oe=$=>{const ve=Number($);return Number.isNaN(ve)?"":ve.toLocaleString()},Q=[{label:"7 DAYS",value:"7days"},{label:"15 DAYS",value:"15days"},{label:"30 DAYS",value:"30days"}],te=N==="month"?"30days":N,K=N==="7days"?"7 Days Orders":N==="15days"?"15 Days Orders":N==="month"?"30 Days Orders":"Today's Orders",Te=[{key:"totalOrders",icon:gt,title:"Total Orders",value:(A==null?void 0:A.totalOrders)||0,colorClass:"text-gray-600"},{key:"unassignedOrders",icon:gt,title:"Unassigned",value:(A==null?void 0:A.unassignedOrders)||0,colorClass:"text-amber-600"},{key:"assignedOrders",icon:gi,title:"Assigned",value:(A==null?void 0:A.assignedOrders)||0,colorClass:"text-blue-600"},{key:"warehouseOrdersCount",icon:gt,title:"At Warehouse",value:(A==null?void 0:A.warehouseOrdersCount)||0,colorClass:"text-cyan-600"},{key:"completedOrders",icon:ds,title:"Delivered",value:(A==null?void 0:A.completedOrders)||0,colorClass:"text-green-700"},{key:"pendingOrders",icon:bn,title:"Pending",value:(A==null?void 0:A.pendingOrders)||0,colorClass:"text-orange-600"},{key:"totalCod",icon:Ut,title:"Total COD",value:`PKR ${oe((A==null?void 0:A.totalCod)||0)}`,colorClass:"text-green-600"},{key:"totalServiceCharges",icon:Ut,title:"Service Charges",value:`PKR ${oe((A==null?void 0:A.totalServiceCharges)||0)}`,colorClass:"text-emerald-600"}],re=()=>{Z(),ne(),Y()},le=()=>s.jsxs("div",{className:"space-y-8",children:[C&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:C}),s.jsx(S0,{heroTitle:K,heroCount:q(A==null?void 0:A.totalOrders),onRefresh:re,kpis:[{prefix:"PKR",value:oe(A==null?void 0:A.totalServiceCharges),label:"Service Charges"},{value:q((A==null?void 0:A.pendingOrders)||0),label:"Pending Orders"},{value:q((A==null?void 0:A.totalOrders)||0),label:"Total Orders"}],periodOptions:Q,activePeriod:te,onPeriodChange:$=>{$==="7days"?v("7days"):$==="15days"?v("15days"):$==="30days"&&v("month")},statCards:Te})]}),Oe=()=>s.jsxs("div",{className:"space-y-8",children:[C&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:C}),s.jsx("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-secondary",children:"Warehouse Operations"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Scan parcels to mark as arrived at LLL warehouse"})]}),s.jsxs("button",{onClick:()=>z("/manager/scanner"),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-hover flex items-center gap-2",children:[s.jsx(Pr,{className:"w-4 h-4"}),"Scan Parcel"]})]})}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(gt,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Manager Dashboard"})]}),s.jsx("button",{onClick:()=>{Z(),ne(),Y()},className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]}),s.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Overview of orders and riders."})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"p-6 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:N==="7days"?"Last 7 Days Stats":N==="15days"?"Last 15 Days Stats":N==="month"?"This Month Stats":"Today's Stats"}),s.jsx("button",{onClick:Y,className:"text-gray-400 hover:text-primary",children:s.jsx(Fr,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[s.jsx("button",{onClick:()=>v("today"),className:`px-3 py-1.5 text-xs rounded-full ${N==="today"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"Today"}),s.jsx("button",{onClick:()=>v("7days"),className:`px-3 py-1.5 text-xs rounded-full ${N==="7days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"7 Days"}),s.jsx("button",{onClick:()=>v("15days"),className:`px-3 py-1.5 text-xs rounded-full ${N==="15days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"15 Days"}),s.jsx("button",{onClick:()=>v("month"),className:`px-3 py-1.5 text-xs rounded-full ${N==="month"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"This Month"})]})]}),s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(Jt,{icon:gt,title:"Total Orders",count:(A==null?void 0:A.totalOrders)||0}),s.jsx(Jt,{icon:ds,title:"Completed Orders",count:(A==null?void 0:A.completedOrders)||0}),s.jsx(Jt,{icon:bn,title:"Pending Orders",count:(A==null?void 0:A.pendingOrders)||0}),s.jsx(Jt,{icon:gi,title:"Assigned Orders",count:(A==null?void 0:A.assignedOrders)||0}),s.jsx(Jt,{icon:gt,title:"Unassigned Orders",count:(A==null?void 0:A.unassignedOrders)||0}),s.jsx(Jt,{icon:Ut,title:"Total COD",count:`PKR ${((A==null?void 0:A.totalCod)||0).toLocaleString()}`}),s.jsx(Jt,{icon:Ut,title:"Total Service Charges",count:`PKR ${((A==null?void 0:A.totalServiceCharges)||0).toLocaleString()}`}),s.jsx(Jt,{icon:gt,title:"At LLL Warehouse",count:(A==null?void 0:A.warehouseOrdersCount)||0})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Today orders"}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:E?E.todayReceived:"-"})]}),s.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Booked"}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:E?E.todayBooked:"-"})]}),s.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Unbooked"}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:E?E.todayUnbooked:"-"})]}),s.jsx("div",{className:"bg-white p-5 rounded-xl border border-gray-100 md:col-span-3",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:"In LLL Warehouse"}),s.jsx("h3",{className:"text-xl font-bold text-secondary",children:E?E.warehouseCount:"-"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Out for delivery"}),s.jsx("h3",{className:"text-xl font-bold text-secondary",children:E?E.outForDeliveryCount:"-"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Returned"}),s.jsx("h3",{className:"text-xl font-bold text-secondary",children:E?E.returnedCount:"-"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Delivery under review"}),s.jsx("h3",{className:"text-xl font-bold text-secondary",children:E?E.deliveryUnderReviewCount:"-"})]})]})})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Recent Orders"}),s.jsx(_c,{to:"/manager/orders",className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"View All Orders"})]}),s.jsx("div",{className:"p-6",children:f?s.jsx("p",{className:"text-sm text-gray-500",children:"Loading recent orders..."}):u.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No recent orders found."}):s.jsx("ul",{className:"space-y-3",children:u.slice(0,5).map($=>{var ve,Ne;return s.jsxs("li",{className:"border border-gray-100 rounded-lg p-4",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-700",children:((ve=$.shipper)==null?void 0:ve.companyName)||((Ne=$.shipper)==null?void 0:Ne.name)||"Unknown"}),s.jsx("span",{className:"font-mono text-xs",children:$.bookingId})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s.jsxs("span",{children:["Created: ",new Date($.createdAt).toLocaleString()]}),$.assignedRider&&s.jsxs("span",{className:"ml-3",children:["Assigned to: ",$.assignedRider.name]})]}),s.jsx("div",{className:"flex items-center justify-between mt-1",children:s.jsx("div",{className:"text-xs text-gray-500",children:$.status})})]},$._id)})})})]})]});return P?s.jsx(le,{}):s.jsx(Oe,{})},ow=()=>{var K,Te,re;const[u,m]=D.useState([]),[f,y]=D.useState([]),[C,w]=D.useState(null),[E,T]=D.useState(!0),[N,v]=D.useState(""),[A,O]=D.useState(""),[R,z]=D.useState([]),[P,F]=D.useState(null),[Z,ne]=D.useState(null),Y=typeof window<"u"?localStorage.getItem("token"):null,q=async()=>{T(!0),v("");try{const le=await fetch("/api/orders",{headers:{Authorization:Y?`Bearer ${Y}`:""}}),Oe=await le.json();if(!le.ok)throw new Error(Oe.message||"Failed to fetch orders");m(Oe)}catch(le){v(le.message)}finally{T(!1)}},oe=async le=>{if(le&&le.preventDefault(),F(null),!!A.trim())try{const Oe=await fetch(`/api/orders?q=${encodeURIComponent(A.trim())}`,{headers:{Authorization:Y?`Bearer ${Y}`:""}}),$=await Oe.json();Oe.ok&&Array.isArray($)&&$.length>0?F($[0]):F({notFound:!0})}catch{}};D.useEffect(()=>{(async()=>{if(!P||P.notFound){ne(null);return}try{const Oe=await fetch(`/api/finance/transactions/order/${P._id}`,{headers:{Authorization:Y?`Bearer ${Y}`:""}}),$=await Oe.json();Oe.ok?ne($):ne(null)}catch{ne(null)}})()},[P]);const Q=async()=>{try{const le=await fetch("/api/users/riders",{headers:{Authorization:Y?`Bearer ${Y}`:""}}),Oe=await le.json();if(!le.ok)throw new Error(Oe.message||"Failed to fetch riders");y(Oe)}catch{}};D.useEffect(()=>{q(),Q()},[]),D.useEffect(()=>{const le=A.trim().toLowerCase();if(le.length<2){z([]);return}z(u.filter(Oe=>{var $,ve,Ne,M;return(($=Oe.bookingId)==null?void 0:$.toLowerCase().includes(le))||((ve=Oe.trackingId)==null?void 0:ve.toLowerCase().includes(le))||((Ne=Oe.consigneeName)==null?void 0:Ne.toLowerCase().includes(le))||((M=Oe.destinationCity)==null?void 0:M.toLowerCase().includes(le))}).slice(0,8))},[A,u]);const te=async(le,Oe)=>{try{const $=await fetch(`/api/orders/${le}/assign`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:Y?`Bearer ${Y}`:""},body:JSON.stringify({riderId:Oe||null})}),ve=await $.json();if(!$.ok)throw new Error(ve.message||"Failed to assign rider");w(null),await q()}catch($){v($.message)}};return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"All Orders"}),s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("form",{onSubmit:oe,className:"relative",children:[s.jsx(A0,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),s.jsx("input",{value:A,onChange:le=>O(le.target.value),type:"text",placeholder:"Enter Booking/Tracking ID",className:"pl-9 pr-4 py-1.5 text-sm border border-gray-200 rounded-lg"}),R.length>0&&s.jsx("ul",{className:"absolute left-0 top-full mt-1 w-80 bg-white border border-gray-200 rounded-lg shadow z-10",children:R.map(le=>s.jsxs("li",{className:"px-3 py-2 text-sm hover:bg-gray-50 cursor-pointer",onMouseDown:()=>F(le),children:[s.jsx("span",{className:"font-mono text-xs mr-2",children:le.bookingId}),s.jsx("span",{children:le.consigneeName}),s.jsxs("span",{className:"text-xs text-gray-500",children:[" "," ",le.destinationCity]})]},le._id))})]})})]}),s.jsxs("div",{className:"p-6",children:[N&&s.jsx("p",{className:"text-sm text-red-600",children:N}),E?s.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):u.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No orders found."}):s.jsx("ul",{className:"space-y-3",children:u.map(le=>{var Oe,$;return s.jsxs("li",{className:"border border-gray-100 rounded-lg p-4",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-700",children:((Oe=le.shipper)==null?void 0:Oe.companyName)||(($=le.shipper)==null?void 0:$.name)||"Unknown"}),s.jsx("span",{className:"font-mono text-xs",children:le.bookingId})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s.jsxs("span",{children:["Created: ",new Date(le.createdAt).toLocaleString()]}),le.assignedRider&&s.jsxs("span",{className:"ml-3",children:["Assigned to: ",le.assignedRider.name]})]}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsx("div",{className:"text-xs text-gray-500",children:le.status}),s.jsxs("div",{className:"flex items-center gap-2",children:[(le.status==="CREATED"||le.assignedRider)&&s.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:()=>w(le),children:le.assignedRider?"Change Assignment":"Assign"}),s.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:()=>F(le),children:"View Details"})]})]})]},le._id)})})]})]}),P&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>F(null),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden",onClick:le=>le.stopPropagation(),children:[s.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Order Detail"}),s.jsx("button",{onClick:()=>F(null),className:"text-gray-400 hover:text-gray-600",children:s.jsx(yn,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"p-6 space-y-3 text-sm max-h-96 overflow-y-auto",children:P.notFound?s.jsx("p",{className:"text-red-600",children:"No order found"}):s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Order ID:"})," ",s.jsx("span",{className:"font-mono",children:P.bookingId})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Tracking ID:"})," ",s.jsx("span",{className:"font-mono",children:P.trackingId})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Shipper:"})," ",((K=P.shipper)==null?void 0:K.companyName)||((Te=P.shipper)==null?void 0:Te.name)||"Unknown"]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Status:"})," ",s.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded text-xs",children:P.status})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Consignee Name:"})," ",P.consigneeName]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Phone:"})," ",P.consigneePhone]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"City:"})," ",P.destinationCity]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Address:"})," ",P.consigneeAddress]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"COD Amount:"})," ","PKR ",Number(P.codAmount||0).toLocaleString()]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Pieces:"})," ",P.pieces||1]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Fragile:"})," ",P.fragile?"Yes":"No"]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Weight:"})," ",P.weightKg||P.weight||"N/A"," kg"]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Service Charges:"})," ","PKR ",Number(P.serviceCharges||0).toLocaleString()]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Total Charges:"})," ","PKR"," ",Number(P.totalAmount||(P.codAmount||0)+(P.serviceCharges||0)).toLocaleString()]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Remarks:"})," ",P.remarks||"N/A"]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Assigned Rider:"})," ",((re=P.assignedRider)==null?void 0:re.name)||"Unassigned"]}),Z&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Rider Commission:"})," ","PKR ",Number(Z.riderCommission||0).toLocaleString()]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Net Amount:"})," ","PKR"," ",Number((Z.totalCodCollected||0)-(Z.riderCommission||0)).toLocaleString()]})]})]})}),s.jsx("div",{className:"p-4 flex justify-end gap-2 border-t border-gray-100",children:s.jsx("button",{className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>F(null),children:"Close"})})]})}),C&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[s.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Assign Rider"}),s.jsx("button",{onClick:()=>w(null),className:"text-gray-400 hover:text-gray-600",children:s.jsx(yn,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-2 max-h-80 overflow-y-auto",children:[s.jsxs("button",{onClick:()=>te(C._id,null),className:"w-full flex items-center gap-3 p-3 rounded-lg border border-red-200 hover:border-red-300 hover:bg-red-50 text-left mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-red-100 flex items-center justify-center text-red-600",children:s.jsx(yn,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-red-700",children:"Unassign"}),s.jsx("div",{className:"text-xs text-red-500",children:"Remove rider assignment"})]})]}),f.length===0&&s.jsx("p",{className:"text-sm text-gray-500",children:"No riders found."}),f.map(le=>s.jsxs("button",{onClick:()=>te(C._id,le._id),className:"w-full flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-primary hover:bg-primary/5 text-left",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600",children:s.jsx(ds,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-secondary",children:le.name}),s.jsx("div",{className:"text-xs text-gray-500",children:le.email})]})]},le._id))]})]})})]})},cw=()=>{const[u,m]=D.useState([]),[f,y]=D.useState(!0),[C,w]=D.useState(""),[E,T]=D.useState(null),[N,v]=D.useState(new Date().toISOString().split("T")[0]),{user:A}=Qs(),O=(A==null?void 0:A.token)||ea(),R=async()=>{y(!0),w("");try{const F=await fetch("/api/riders/finance",{headers:{Authorization:`Bearer ${O}`}}),Z=await F.json();if(!F.ok)throw new Error(Z.message||"Failed to fetch riders");m(Z)}catch(F){w(F.message)}finally{y(!1)}},z=async(F,Z)=>{try{const ne=Z==="paid"?"unpaid":"paid",Y=await fetch(`/api/riders/${F}/service-charges-status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${O}`},body:JSON.stringify({status:ne})});if(Y.ok)await R();else{const q=await Y.json();w(q.message||"Failed to update status")}}catch(ne){w(ne.message)}},P=async(F,Z)=>{try{const ne=await fetch(`/api/riders/${F}/daily-report?date=${N}`,{headers:{Authorization:`Bearer ${O}`}});if(!ne.ok)throw new Error("Failed to download report");const Y=await ne.blob(),q=window.URL.createObjectURL(Y),oe=document.createElement("a");oe.href=q,oe.download=`rider-${Z}-${N}.xlsx`,document.body.appendChild(oe),oe.click(),window.URL.revokeObjectURL(q),document.body.removeChild(oe)}catch(ne){w(ne.message)}};return D.useEffect(()=>{O&&R()},[O]),s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(ds,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Riders Finance"})]})}),C&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:C}),s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:f?s.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[s.jsx("th",{className:"py-3 px-4",children:"Rider Name"}),s.jsx("th",{className:"py-3 px-4",children:"Assigned Orders"}),s.jsx("th",{className:"py-3 px-4",children:"COD Collected"}),s.jsx("th",{className:"py-3 px-4",children:"Service Charges"}),s.jsx("th",{className:"py-3 px-4",children:"Status"}),s.jsx("th",{className:"py-3 px-4",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:u.map(F=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:F.name}),s.jsx("div",{className:"text-xs text-gray-500",children:F.email})]})}),s.jsx("td",{className:"py-3 px-4",children:F.assignedOrders||0}),s.jsxs("td",{className:"py-3 px-4",children:["PKR ",Number(F.codCollected||0).toLocaleString()]}),s.jsxs("td",{className:"py-3 px-4",children:["PKR ",Number(F.serviceCharges||0).toLocaleString()]}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${F.serviceChargeStatus==="paid"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:F.serviceChargeStatus==="paid"?"Paid":"Unpaid"})}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>z(F._id,F.serviceChargeStatus),className:`px-3 py-1 text-xs rounded ${F.serviceChargeStatus==="paid"?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-primary text-white hover:bg-primary-hover"}`,children:F.serviceChargeStatus==="paid"?"Mark Unpaid":"Mark Paid"}),s.jsxs("button",{onClick:()=>P(F._id,F.name),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 flex items-center gap-1",children:[s.jsx(kc,{className:"w-3 h-3"}),"Report"]})]})})]},F._id))})]})})}),E&&s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("h4",{className:"font-bold mb-4",children:"Download Daily Report"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("input",{type:"date",value:N,onChange:F=>v(F.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg"}),s.jsxs(as,{onClick:()=>P(E._id,E.name),children:[s.jsx(kc,{className:"w-4 h-4"})," Download"]})]})]})]})},wx=()=>{const[u,m]=D.useState([]),[f,y]=D.useState([]),[C,w]=D.useState([]),[E,T]=D.useState([]),[N,v]=D.useState(!0),[A,O]=D.useState(""),[R,z]=D.useState(!1),[P,F]=D.useState(""),[Z,ne]=D.useState({commissionType:"PERCENTAGE",commissionValue:""}),[Y,q]=D.useState({type:"PERCENTAGE",value:"",weightBrackets:[{minKg:0,maxKg:1,charge:100}]}),[oe,Q]=D.useState({riderId:"",rules:[{status:"DELIVERED",type:"FLAT",value:""},{status:"RETURNED",type:"FLAT",value:""},{status:"FAILED",type:"FLAT",value:""}]}),te=typeof window<"u"?localStorage.getItem("token"):null,K=async()=>{v(!0),O("");try{const[U,V,fe,he]=await Promise.all([fetch("/api/users/shippers",{headers:{Authorization:te?`Bearer ${te}`:""}}),fetch("/api/users/riders",{headers:{Authorization:te?`Bearer ${te}`:""}}),fetch("/api/commission",{headers:{Authorization:te?`Bearer ${te}`:""}}),fetch("/api/commission/rider",{headers:{Authorization:te?`Bearer ${te}`:""}})]),X=await U.json(),se=await V.json(),Ee=await fe.json(),ye=await he.json();if(!U.ok)throw new Error(X.message||"Failed to fetch shippers");if(!V.ok)throw new Error(se.message||"Failed to fetch riders");if(!fe.ok)throw new Error(Ee.message||"Failed to fetch commissions");if(!he.ok)throw new Error(ye.message||"Failed to fetch rider commissions");const Ue=(X||[]).filter(Ge=>Ge.role==="SHIPPER"),Re=(se||[]).filter(Ge=>Ge.role==="RIDER");m(Ue),w(Re),y(Ee),T(ye),Ue.length&&!P&&F(Ue[0]._id),Re.length&&!oe.riderId&&Q(Ge=>({...Ge,riderId:Re[0]._id}))}catch(U){O(U.message)}finally{v(!1)}},Te=u.find(U=>U._id===P);D.useEffect(()=>{Te&&ne({commissionType:Te.commissionType||"PERCENTAGE",commissionValue:Te.commissionValue!==null&&Te.commissionValue!==void 0?String(Te.commissionValue):""})},[P]);const re=async U=>{if(U)try{O("");const V=await fetch(`/api/commission/${U}`,{headers:{Authorization:te?`Bearer ${te}`:""}});if(V.ok){const fe=await V.json();q({type:fe.type||"PERCENTAGE",value:fe.value||"",weightBrackets:fe.weightBrackets&&fe.weightBrackets.length>0?fe.weightBrackets:[{minKg:0,maxKg:1,charge:100}]}),z(!1)}else if(V.status===404)q({type:"PERCENTAGE",value:"",weightBrackets:[{minKg:0,maxKg:1,charge:100}]}),z(!1);else{const fe=await V.json();throw new Error(fe.message||"Failed to load config")}}catch(V){O(V.message)}};D.useEffect(()=>{K()},[]),D.useEffect(()=>{P&&re(P)},[P]);const le=U=>{if(!Array.isArray(U)||U.length===0)return{valid:!1,message:"At least one weight bracket is required",errors:[]};const V=U.map(()=>({})),fe=U.map((X,se)=>({idx:se,minKg:Number(X.minKg),maxKg:X.maxKg===void 0||X.maxKg===null||X.maxKg===""?null:Number(X.maxKg),charge:Number(X.charge)})).sort((X,se)=>X.minKg-se.minKg);for(let X=0;X<fe.length;X++){const se=fe[X],Ee={};if((Number.isNaN(se.minKg)||se.minKg<0)&&(Ee.minKg="Minimum weight must be >= 0"),(Number.isNaN(se.charge)||se.charge<=0)&&(Ee.charge="Charge must be > 0"),se.maxKg!=null&&(Number.isNaN(se.maxKg)?Ee.maxKg="Maximum weight must be a valid number":!Number.isNaN(se.minKg)&&se.maxKg<=se.minKg&&(Ee.maxKg="Maximum weight must be greater than minimum weight")),se.maxKg==null&&X!==fe.length-1&&(Ee.maxKg="Only the last bracket can have unlimited maximum weight"),X>0){const ye=fe[X-1];ye.maxKg!=null&&!Number.isNaN(ye.maxKg)&&!Number.isNaN(se.minKg)&&se.minKg<ye.maxKg&&(Ee.minKg="Weight brackets overlap. Please adjust ranges.")}V[se.idx]=Ee}const he=V.some(X=>Object.keys(X).length>0);return{valid:!he,message:he?"Please fix validation errors before saving.":"",errors:V}},Oe=async()=>{try{O(""),z(!0);const U=ya("Saving commission..."),V=le(Y.weightBrackets);if(!V.valid){O(V.message),bt(V.message);const se=V.errors.findIndex(Ee=>Ee&&Object.keys(Ee).length>0);if(se>=0){const Ee=document.getElementById(`weight-bracket-${se}`);Ee&&typeof Ee.scrollIntoView=="function"&&Ee.scrollIntoView({behavior:"smooth",block:"center"})}return}const fe={type:Y.type,value:Number(Y.value),weightBrackets:Y.weightBrackets.map(se=>({minKg:Number(se.minKg),maxKg:se.maxKg===""||se.maxKg==null?null:Number(se.maxKg),charge:Number(se.charge)}))},he=await fetch(`/api/commission/${P}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:te?`Bearer ${te}`:""},body:JSON.stringify(fe)}),X=await he.json();if(!he.ok)throw new Error(X.message||"Failed to save commission");await K(),ks("Commission saved")}catch(U){O(U.message),bt(U.message||"Failed to save commission")}},$=async()=>{try{O("");const U=ya("Saving rider commission..."),V={riderId:oe.riderId,rules:oe.rules.map(X=>({...X,value:Number(X.value)}))},fe=await fetch("/api/commission/rider",{method:"POST",headers:{"Content-Type":"application/json",Authorization:te?`Bearer ${te}`:""},body:JSON.stringify(V)}),he=await fe.json();if(!fe.ok)throw new Error(he.message||"Failed to save rider commission");await K(),ks("Rider commission saved")}catch(U){O(U.message),bt(U.message||"Failed to save rider commission")}},ve=()=>{const U=Y.weightBrackets[Y.weightBrackets.length-1],V=U&&U.maxKg!=null?U.maxKg:0;q(fe=>({...fe,weightBrackets:[...fe.weightBrackets,{minKg:V,maxKg:V+1,charge:0}]})),ks("Bracket added")},Ne=U=>{if(Y.weightBrackets.length<=1){O("At least one weight bracket is required"),bt("At least one weight bracket is required");return}q(V=>({...V,weightBrackets:V.weightBrackets.filter((fe,he)=>he!==U)})),ks("Bracket removed")},M=(U,V,fe)=>{q(he=>({...he,weightBrackets:he.weightBrackets.map((X,se)=>se===U?{...X,[V]:fe}:X)}))},L=R?le(Y.weightBrackets):{valid:!0,message:"",errors:[]};return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Dy,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Set weight-based service charges for this shipper"})]}),s.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Define weight brackets and charges. Shipper portal access is automatic: at least one bracket enables access."})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm max-w-4xl",children:[A&&s.jsx("p",{className:"text-sm text-red-600 mb-4",children:A}),s.jsx("div",{className:"grid grid-cols-1 gap-4 mb-6",children:s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Shipper"}),s.jsx("select",{value:P,onChange:U=>F(U.target.value),className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white",children:u.map(U=>s.jsxs("option",{value:U._id,children:[U.name," (",U.email,")"]},U._id))})]})}),s.jsxs("div",{className:"mt-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h4",{className:"text-md font-semibold text-secondary",children:"Weight-Based Service Charges"}),s.jsxs("button",{onClick:ve,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-primary hover:bg-primary-hover text-white rounded-lg",children:[s.jsx(f0,{className:"w-4 h-4"}),"Add Bracket"]})]}),s.jsx("div",{className:"space-y-3",children:Y.weightBrackets.map((U,V)=>{var fe,he,X,se,Ee,ye,Ue,Re,Ge,et,ct,ns;return s.jsxs("div",{id:`weight-bracket-${V}`,className:"grid grid-cols-1 md:grid-cols-5 gap-3 items-start p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Weight (kg)"}),s.jsx("input",{type:"number",step:"0.1",min:"0",value:U.minKg||"",onChange:Dt=>M(V,"minKg",Dt.target.value),className:`w-full px-3 py-2 rounded-lg border bg-white text-sm ${R&&((he=(fe=L==null?void 0:L.errors)==null?void 0:fe[V])!=null&&he.minKg)?"border-red-400":"border-gray-200"}`,placeholder:"0"}),s.jsx("div",{className:"mt-1 min-h-[16px]",children:R&&((se=(X=L==null?void 0:L.errors)==null?void 0:X[V])==null?void 0:se.minKg)&&s.jsx("p",{className:"text-xs text-red-600",children:L.errors[V].minKg})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Weight (kg)"}),s.jsx("input",{type:"number",step:"0.1",min:"0",value:U.maxKg||"",onChange:Dt=>M(V,"maxKg",Dt.target.value),className:`w-full px-3 py-2 rounded-lg border bg-white text-sm ${R&&((ye=(Ee=L==null?void 0:L.errors)==null?void 0:Ee[V])!=null&&ye.maxKg)?"border-red-400":"border-gray-200"}`,placeholder:"Leave empty for "}),s.jsx("div",{className:"mt-1 min-h-[16px]",children:R&&((Re=(Ue=L==null?void 0:L.errors)==null?void 0:Ue[V])==null?void 0:Re.maxKg)&&s.jsx("p",{className:"text-xs text-red-600",children:L.errors[V].maxKg})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Charge (PKR)"}),s.jsx("input",{type:"number",min:"0",value:U.charge||"",onChange:Dt=>M(V,"charge",Dt.target.value),className:`w-full px-3 py-2 rounded-lg border bg-white text-sm ${R&&((et=(Ge=L==null?void 0:L.errors)==null?void 0:Ge[V])!=null&&et.charge)?"border-red-400":"border-gray-200"}`,placeholder:"0"}),s.jsx("div",{className:"mt-1 min-h-[16px]",children:R&&((ns=(ct=L==null?void 0:L.errors)==null?void 0:ct[V])==null?void 0:ns.charge)&&s.jsx("p",{className:"text-xs text-red-600",children:L.errors[V].charge})})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{className:"h-[20px] mb-1"}),s.jsxs("div",{className:"flex-1 flex items-center text-sm text-gray-600",children:[U.minKg||0,"kg - ",U.maxKg||"","kg"]}),s.jsx("div",{className:"mt-1 min-h-[16px]"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{className:"h-[20px] mb-1"}),s.jsx("div",{className:"flex-1 flex items-center justify-end",children:s.jsx("button",{onClick:()=>Ne(V),disabled:Y.weightBrackets.length<=1,className:`p-2 rounded-lg ${Y.weightBrackets.length<=1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-red-100 hover:bg-red-200 text-red-600"}`,children:s.jsx(lm,{className:"w-4 h-4"})})}),s.jsx("div",{className:"mt-1 min-h-[16px]"})]})]},V)})}),R&&!L.valid&&s.jsx("p",{className:"text-sm text-red-600 mt-2",children:L.message})]}),s.jsx("div",{className:"flex justify-end gap-3 mt-6",children:s.jsx("button",{onClick:Oe,disabled:R&&!L.valid||!P,className:`px-6 py-2 rounded-lg text-sm ${R&&!L.valid||!P?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-primary hover:bg-primary-hover text-white"}`,children:"Save Configuration"})})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm max-w-2xl",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx(ds,{className:"w-5 h-5 text-primary"}),s.jsx("h4",{className:"text-md font-semibold text-secondary",children:"Rider Commission by Status"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Rider"}),s.jsx("select",{value:oe.riderId,onChange:U=>Q({...oe,riderId:U.target.value}),className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white",children:C.map(U=>s.jsxs("option",{value:U._id,children:[U.name," (",U.email,")"]},U._id))})]}),oe.rules.map((U,V)=>s.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Status"}),s.jsx("input",{value:U.status,readOnly:!0,className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Type"}),s.jsxs("select",{value:U.type,onChange:fe=>{const he=fe.target.value;Q(X=>({...X,rules:X.rules.map((se,Ee)=>Ee===V?{...se,type:he}:se)}))},className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white",children:[s.jsx("option",{value:"FLAT",children:"FLAT"}),s.jsx("option",{value:"PERCENTAGE",children:"PERCENTAGE"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Value"}),s.jsx("input",{type:"number",value:U.value,onChange:fe=>{const he=fe.target.value;Q(X=>({...X,rules:X.rules.map((se,Ee)=>Ee===V?{...se,value:he}:se)}))},className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white",placeholder:U.type==="PERCENTAGE"?"5 for 5%":"100 for PKR 100"})]})]},U.status))]}),s.jsx("div",{className:"flex justify-end gap-3 mt-4",children:s.jsx("button",{onClick:$,className:"px-4 py-2 rounded-lg bg-primary hover:bg-primary-hover text-white text-sm",children:"Save Rider Rules"})})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Current Configurations"}),s.jsx("button",{onClick:K,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500",children:[s.jsx("th",{className:"py-2 px-3",children:"Shipper"}),s.jsx("th",{className:"py-2 px-3",children:"Commission Type"}),s.jsx("th",{className:"py-2 px-3",children:"Commission Value"}),s.jsx("th",{className:"py-2 px-3",children:"Weight Brackets"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:f.map(U=>{var V;return s.jsxs("tr",{children:[s.jsx("td",{className:"py-2 px-3",children:((V=U.shipper)==null?void 0:V.name)||U.shipper}),s.jsx("td",{className:"py-2 px-3",children:U.type}),s.jsx("td",{className:"py-2 px-3",children:U.type==="PERCENTAGE"?`${U.value}%`:`PKR ${Number(U.value||0).toLocaleString()}`}),s.jsx("td",{className:"py-2 px-3",children:U.weightBrackets&&U.weightBrackets.length>0?s.jsx("div",{className:"space-y-1",children:U.weightBrackets.map((fe,he)=>s.jsxs("div",{className:"text-xs text-gray-600",children:[fe.minKg,"kg - ",fe.maxKg||"","kg: PKR"," ",fe.charge]},he))}):s.jsx("span",{className:"text-gray-400",children:"No brackets"})})]},U._id)})})]})})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Current Rider Commissions"})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500",children:[s.jsx("th",{className:"py-2 px-3",children:"Rider"}),s.jsx("th",{className:"py-2 px-3",children:"Type"}),s.jsx("th",{className:"py-2 px-3",children:"Value"}),s.jsx("th",{className:"py-2 px-3",children:"Rules"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:E.map(U=>{var V;return s.jsxs("tr",{children:[s.jsx("td",{className:"py-2 px-3",children:((V=U.rider)==null?void 0:V.name)||U.rider}),s.jsx("td",{className:"py-2 px-3",children:U.type}),s.jsx("td",{className:"py-2 px-3",children:U.type==="PERCENTAGE"?`${U.value}%`:`PKR ${Number(U.value||0).toLocaleString()}`}),s.jsx("td",{className:"py-2 px-3",children:Array.isArray(U.rules)&&U.rules.length?s.jsx("div",{className:"space-y-1",children:U.rules.map(fe=>s.jsxs("div",{className:"text-xs text-gray-600",children:[fe.status,":"," ",fe.type==="PERCENTAGE"?`${fe.value}%`:`PKR ${Number(fe.value||0).toLocaleString()}`]},fe.status))}):""})]},U._id)})})]})})]})]})},Vn=({children:u,className:m=""})=>s.jsx("div",{className:`bg-white border border-gray-200 rounded-xl shadow-sm ${m}`,children:u}),el=({children:u,className:m=""})=>s.jsx("h3",{className:`text-lg font-semibold text-gray-900 ${m}`,children:u}),xi=({label:u,value:m,icon:f})=>s.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[f&&s.jsx(f,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),s.jsxs("div",{children:[s.jsxs("span",{className:"text-gray-600",children:[u,":"]}),s.jsx("span",{className:"text-gray-900 font-medium ml-2",children:m})]})]}),eo=({label:u,value:m,type:f="default",children:y})=>s.jsxs("div",{className:`flex justify-between items-center py-3 px-0 ${f==="total"?"border-t-2 border-gray-300 pt-4 mt-2":"border-b border-gray-100"}`,children:[s.jsxs("span",{className:`text-sm ${f==="total"?"font-bold text-gray-900":"text-gray-700"}`,children:[u,":"]}),y||s.jsx("span",{className:`text-sm ${f==="total"?"text-lg font-bold text-green-600":"font-semibold text-gray-900"}`,children:m})]}),vx=({status:u,invoiced:m})=>{if(m)return s.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium bg-green-100 text-green-800",children:[s.jsx(qn,{className:"w-3 h-3 mr-1"}),"Paid"]});const f={CREATED:{bg:"bg-blue-100",text:"text-blue-800",icon:bn},DELIVERED:{bg:"bg-green-100",text:"text-green-800",icon:qn},IN_TRANSIT:{bg:"bg-yellow-100",text:"text-yellow-800",icon:bn},FAILED:{bg:"bg-red-100",text:"text-red-800",icon:Ur}},y=f[u]||f.CREATED,C=y.icon;return s.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium ${y.bg} ${y.text}`,children:[s.jsx(C,{className:"w-3 h-3 mr-1"}),u||"Unpaid"]})},Nx=()=>{const[u,m]=D.useState(!1),[f,y]=D.useState(""),[C,w]=D.useState(""),[E,T]=D.useState(null),[N,v]=D.useState(""),[A,O]=D.useState(""),[R,z]=D.useState(""),[P,F]=D.useState(""),[Z,ne]=D.useState(new Date().toISOString().split("T")[0]),[Y,q]=D.useState(""),[oe,Q]=D.useState(""),[te,K]=D.useState("unpaid"),[Te,re]=D.useState("100"),[le,Oe]=D.useState(0),[$,ve]=D.useState(0),[Ne,M]=D.useState([]),[L,U]=D.useState([]),[V,fe]=D.useState(null),[he,X]=D.useState(new Set),[se,Ee]=D.useState(null),[ye,Ue]=D.useState(!0),Re=localStorage.getItem("token");D.useEffect(()=>{et(),ct()},[]),D.useEffect(()=>{N&&Y&&oe&&ns()},[N,Y,oe,te]);const Ge=Ne.find(ie=>ie._id===N),et=async()=>{try{const ie=await fetch("/api/invoice/shippers",{headers:{Authorization:`Bearer ${Re}`}}),Fe=await ie.json();ie.ok&&Array.isArray(Fe)&&M(Fe)}catch{y("Failed to load customers")}},ct=async()=>{try{Ue(!0);const ie=await fetch("/api/company-profile/public"),Fe=await ie.json();ie.ok&&Fe.success?Ee(Fe.data):(console.warn("Failed to load company profile, using defaults"),Ee({companyName:"LahoreLink Courier Services",logoUrl:"",address:{line1:"Office # 123, Main Boulevard, Gulberg III",city:"Lahore",country:"Pakistan"},phone:"+92-42-111-LINK (5465)",email:"finance@lahorelink.com",website:"www.lahorelink.com",footerNote:"For support contact: +92-42-111-LINK (5465) | Email: support@lahorelink.com"}))}catch(ie){console.error("Error loading company profile:",ie),Ee({companyName:"LahoreLink Courier Services",logoUrl:"",address:{line1:"Office # 123, Main Boulevard, Gulberg III",city:"Lahore",country:"Pakistan"},phone:"+92-42-111-LINK (5465)",email:"finance@lahorelink.com",website:"www.lahorelink.com",footerNote:"For support contact: +92-42-111-LINK (5465) | Email: support@lahorelink.com"})}finally{Ue(!1)}},ns=async()=>{try{m(!0);const ie=ya("Loading orders..."),Fe=new URLSearchParams({shipperId:N,from:Y,to:oe,paymentStatus:te}),Ke=await fetch(`/api/invoice/orders?${Fe}`,{headers:{Authorization:`Bearer ${Re}`}}),Ye=await Ke.json();let Pe=Array.isArray(Ye.orders)?Ye.orders:Array.isArray(Ye)?Ye:[],ot=Ye.stats||null;if(Ke.ok&&Array.isArray(Pe)){const St=Pe.map(rt=>({...rt,_id:rt._id||rt.id,invoice:rt.invoice||null,bookingId:rt.bookingId||rt.trackingId||"N/A",serviceCharges:Number(rt.serviceCharges||0),codAmount:Number(rt.codAmount||0),weightKg:Number(rt.weightKg||0)}));U(St),fe(ot),X(new Set),ks("Orders loaded")}else console.error("Failed to load orders:",Ye),U([]),y(Ye.message||"Failed to load orders"),bt(Ye.message||"Failed to load orders")}catch{y("Failed to load orders"),bt("Failed to load orders")}finally{m(!1),pa(tId)}},Dt=ie=>{const Fe=L.find(Ke=>Ke._id===ie);if(!Fe){console.error("Order not found:",ie);return}console.log(" Order details:",{id:Fe._id,bookingId:Fe.bookingId,invoice:Fe.invoice,isInvoiced:Fe.invoice!==null&&Fe.invoice!==void 0}),!(Fe.invoice!==null&&Fe.invoice!==void 0)&&X(Ke=>{const Ye=new Set(Ke);return Ye.has(ie)?Ye.delete(ie):Ye.add(ie),Ye})},Js=()=>{console.log(" SELECT ALL BUTTON CLICKED");const ie=L.filter(Pe=>Pe.invoice===null||Pe.invoice===void 0);if(console.log(" Select all analysis:"),console.log("  - Total orders:",L.length),console.log("  - Unpaid orders:",ie.length),console.log("  - Current selection size:",he.size),ie.length===0){console.log(" No unpaid orders to select");return}const Fe=ie.map(Pe=>Pe._id),Ke=Fe.filter(Pe=>he.has(Pe)),Ye=Ke.length===Fe.length;console.log(" Selection details:"),console.log("  - Unpaid IDs:",Fe),console.log("  - Currently selected unpaid:",Ke),console.log("  - All currently selected:",Ye),X(Pe=>{console.log(" SELECT ALL - Previous state:",Array.from(Pe));const ot=new Set(Pe);return Ye?(console.log(" Deselecting all visible orders"),Fe.forEach(St=>ot.delete(St))):(console.log(" Selecting all visible orders"),Fe.forEach(St=>ot.add(St))),console.log(" SELECT ALL - New state:",Array.from(ot)),console.log(" SELECT ALL - New selection size:",ot.size),ot})},dt=L.filter(ie=>he.has(ie._id)&&!ie._id.startsWith("TEST-")),Ns=dt.reduce((ie,Fe)=>ie+(Fe.codAmount||0),0),Bs=dt.reduce((ie,Fe)=>ie+(Fe.serviceCharges||0),0),us=Bs-(Number(le)+Number($)),Xt=ie=>`PKR ${Number(ie||0).toLocaleString()}`,Rt=async()=>{var Fe;const ie=Array.from(he).filter(Ke=>!Ke.startsWith("TEST-"));if(!N||!R||ie.length===0){y("Please fill all required fields and select at least one order"),bt("Fill required fields and select orders");return}try{m(!0),y("");const Ke=ya("Saving invoice..."),Ye={shipperId:N,accountName:R,accountNumber:P,invoiceDate:Z,parcelFrom:Y,parcelTo:oe,selectedOrderIds:ie,whtIt:Number(le),whtSt:Number($)},Pe=await fetch("/api/invoice",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Re}`},body:JSON.stringify(Ye)}),ot=await Pe.json();Pe.ok?(w("Invoice created successfully!"),T(ot.invoice._id),(Fe=ot==null?void 0:ot.invoice)!=null&&Fe.invoiceNumber&&O(ot.invoice.invoiceNumber),X(new Set),Oe(0),ve(0),N&&Y&&oe&&ns(),ks("Invoice created")):(y(ot.message||"Failed to create invoice"),bt(ot.message||"Failed to create invoice"))}catch{y("Failed to create invoice"),bt("Failed to create invoice")}finally{m(!1),pa(tId)}},de=()=>{E?window.open(`/invoice-print/${E}`,"_blank"):(y("Please save the invoice first before printing"),bt("Save invoice before printing"))},Le=async()=>{if(!E){y("Please save the invoice first before exporting"),bt("Save invoice before exporting");return}try{m(!0),y("");const ie=ya("Exporting Excel..."),Fe=await fetch(`/api/invoice/${E}/export.xlsx`,{method:"GET",headers:{Authorization:`Bearer ${Re}`}});if(!Fe.ok)throw new Error("Failed to export Excel file");const Ke=await Fe.blob(),Ye=window.URL.createObjectURL(Ke),Pe=document.createElement("a");Pe.href=Ye,Pe.download=`Invoice_${A}.xlsx`,document.body.appendChild(Pe),Pe.click(),document.body.removeChild(Pe),window.URL.revokeObjectURL(Ye),w("Excel file downloaded successfully!"),ks("Excel downloaded")}catch(ie){y("Failed to export Excel file"),console.error("Export error:",ie),bt("Failed to export Excel")}finally{m(!1),pa(tId)}},_e=({order:ie})=>s.jsx(Vn,{className:"mb-3 overflow-hidden",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",checked:he.has(ie._id),onChange:Fe=>{console.log(" Mobile Checkbox onChange fired for:",ie._id),console.log(" Event target checked:",Fe.target.checked),console.log(" Current state has ID:",he.has(ie._id)),Fe.stopPropagation(),Dt(ie._id)},onClick:Fe=>{console.log(" Mobile Checkbox onClick fired for:",ie._id)},disabled:ie.invoice!==null&&ie.invoice!==void 0,className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-mono text-sm font-semibold text-gray-900",children:ie.bookingId||ie.trackingId}),s.jsx("div",{className:"text-xs text-gray-500",children:new Date(ie.createdAt).toLocaleDateString()})]})]}),s.jsx(vx,{status:ie.status,invoiced:ie.invoice!==null&&ie.invoice!==void 0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Consignee:"}),s.jsx("div",{className:"font-medium text-gray-900",children:ie.consigneeName})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Destination:"}),s.jsx("div",{className:"font-medium text-gray-900",children:ie.destinationCity})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Weight:"}),s.jsxs("div",{className:"font-medium text-gray-900",children:[ie.weightKg," kg"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"COD Amount:"}),s.jsx("div",{className:"font-medium text-gray-900",children:Xt(ie.codAmount)})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-600",children:"Service Charges:"}),s.jsx("div",{className:"font-medium text-gray-900",children:Xt(ie.serviceCharges)})]})]})]})});return s.jsxs("div",{className:"min-h-screen bg-gray-50 print:bg-white",children:[s.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-50 print:relative print:border-b-2",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between py-4",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2 sm:mb-0",children:[s.jsx("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:s.jsx(rl,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"LahoreLink Logistics"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Payment Invoice"})]})]}),s.jsxs("div",{className:"text-right sm:text-left",children:[s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["Invoice No: ",s.jsx("span",{className:"font-mono",children:A})]}),s.jsxs("div",{className:"text-xs text-gray-600",children:["Date: ",new Date(Z).toLocaleDateString()]})]})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[s.jsxs(Vn,{className:"mb-6 p-6",children:[s.jsx(el,{className:"mb-6",children:"Invoice Setup"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-5 gap-4",children:[s.jsxs("div",{className:"xl:col-span-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Customer ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{value:N,onChange:ie=>{v(ie.target.value);const Fe=Ne.find(Ke=>Ke._id===ie.target.value);z((Fe==null?void 0:Fe.companyName)||(Fe==null?void 0:Fe.name)||"")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",children:[s.jsx("option",{value:"",children:"Select Customer"}),Ne.map(ie=>s.jsx("option",{value:ie._id,children:ie.companyName||ie.name},ie._id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Invoice Number"}),s.jsx("input",{type:"text",value:A,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm bg-gray-50 text-gray-600"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:R,onChange:ie=>z(ie.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Number"}),s.jsx("input",{type:"text",value:P,onChange:ie=>F(ie.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500"})]}),s.jsxs("div",{className:"md:col-span-2 xl:col-span-1",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Invoice Date"}),s.jsx("input",{type:"date",value:Z,onChange:ie=>ne(ie.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500"})]})]})]}),L.length>0&&s.jsxs(Vn,{className:"p-4 mb-6 bg-blue-50 border-blue-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:" Order Status Information"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"bg-white p-3 rounded border",children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Total Orders"}),s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:V?V.totalOrders:L.length})]}),s.jsxs("div",{className:"bg-white p-3 rounded border",children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Unpaid"}),s.jsx("div",{className:"text-2xl font-bold text-green-600",children:V?V.unpaidCount:L.filter(ie=>ie.invoice===null||ie.invoice===void 0).length})]}),s.jsxs("div",{className:"bg-white p-3 rounded border",children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Paid"}),s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:V?V.paidCount:L.filter(ie=>ie.invoice!==null&&ie.invoice!==void 0).length})]})]}),V&&V.unpaidCount===0&&s.jsx("div",{className:"mt-4 p-3 bg-orange-100 border border-orange-300 rounded-lg",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ur,{className:"w-5 h-5 text-orange-600"}),s.jsxs("div",{className:"text-orange-800",children:[s.jsx("strong",{children:"No unpaid orders found."})," All orders in this date range have already been paid. Try selecting a different date range or customer to find unpaid orders."]})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[s.jsxs(Vn,{className:"p-6",children:[s.jsxs(el,{className:"mb-4 flex items-center",children:[s.jsx(rl,{className:"w-5 h-5 mr-2 text-green-600"}),"Company Information"]}),ye?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-green-600"}),s.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading company info..."})]}):se?s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[se.logoUrl&&s.jsx("img",{src:se.logoUrl,alt:"Company Logo",className:"w-12 h-12 object-contain",onError:ie=>{ie.currentTarget.src="/assets/logo.png"}}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold text-gray-900",children:se.companyName}),s.jsx("div",{className:"text-sm text-gray-600",children:"Professional Logistics Solutions"})]})]}),s.jsx(xi,{icon:Kn,label:"Address",value:`${se.address.line1}, ${se.address.city}, ${se.address.country}`}),s.jsx(xi,{icon:Bc,label:"Email",value:se.email}),s.jsx(xi,{icon:Lr,label:"Phone",value:se.phone}),se.website&&s.jsx(xi,{icon:sm,label:"Website",value:se.website})]}):s.jsxs("div",{className:"text-center py-4",children:[s.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Company profile not set"}),s.jsx("p",{className:"text-xs text-gray-400",children:"Set company profile from CEO dashboard"})]})]}),s.jsxs(Vn,{className:"p-6",children:[s.jsxs(el,{className:"mb-4 flex items-center",children:[s.jsx(io,{className:"w-5 h-5 mr-2 text-blue-600"}),"Customer Information"]}),Ge?s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{children:s.jsx("div",{className:"font-semibold text-gray-900",children:Ge.companyName||Ge.name})}),Ge.address&&s.jsx(xi,{icon:Kn,label:"Address",value:Ge.address}),s.jsx(xi,{icon:Bc,label:"Email",value:Ge.email}),Ge.phone&&s.jsx(xi,{icon:Lr,label:"Phone",value:Ge.phone})]}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(io,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),s.jsx("p",{children:"Please select a customer to view details"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"xl:col-span-3 space-y-6",children:[s.jsxs(Vn,{className:"p-6",children:[s.jsx(el,{className:"mb-4",children:"Parcel Filters"}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Parcel From"}),s.jsx("input",{type:"date",value:Y,onChange:ie=>q(ie.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Parcel To"}),s.jsx("input",{type:"date",value:oe,onChange:ie=>Q(ie.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status Filter"}),s.jsxs("select",{value:te,onChange:ie=>K(ie.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",children:[s.jsx("option",{value:"all",children:"All Parcels"}),s.jsx("option",{value:"unpaid",children:"Unpaid"}),s.jsx("option",{value:"paid",children:"Paid"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Limit"}),s.jsx("input",{type:"number",value:Te,onChange:ie=>re(ie.target.value),min:"1",max:"1000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500"})]}),s.jsx("div",{className:"sm:col-span-2 lg:col-span-4 xl:col-span-1 flex items-end",children:s.jsxs("button",{onClick:ns,disabled:!N||u,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-lg shadow-sm transition-colors flex items-center justify-center space-x-2",children:[s.jsx(C0,{className:"w-4 h-4"}),s.jsx("span",{children:u?"Loading...":"Filter"})]})})]})]}),s.jsxs(Vn,{className:"overflow-hidden",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[s.jsx(el,{children:"Parcel List"}),L.length>0&&s.jsxs("div",{className:"flex items-center space-x-4 mt-4 sm:mt-0",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:[L.filter(ie=>he.has(ie._id)&&!ie._id.startsWith("TEST-")&&(ie.invoice===null||ie.invoice===void 0)).length," ","of"," ",L.filter(ie=>ie.invoice===null||ie.invoice===void 0).length," ","selected"]}),s.jsx("button",{onClick:ie=>{console.log(" Select All BUTTON clicked"),Js()},className:"text-sm font-medium text-green-600 hover:text-green-700 px-3 py-1 border border-green-300 rounded-md hover:bg-green-50 transition-colors",children:(()=>{const ie=L.filter(Ke=>Ke.invoice===null||Ke.invoice===void 0);return ie.filter(Ke=>he.has(Ke._id)&&!Ke._id.startsWith("TEST-")).length===ie.length&&ie.length>0?"Deselect All":"Select All"})()})]})]})}),u?s.jsx("div",{className:"p-12 text-center",children:s.jsx("div",{className:"text-gray-500",children:"Loading parcels..."})}):L.length===0?s.jsxs("div",{className:"p-12 text-center text-gray-500",children:[s.jsx("div",{className:"mb-2",children:"No parcels found for selected filters"}),s.jsx("div",{className:"text-sm",children:"Try adjusting your customer selection and date range"})]}):s.jsxs(s.Fragment,{children:[te==="unpaid"&&L.filter(ie=>ie.invoice===null||ie.invoice===void 0).length===0&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(gt,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),s.jsx("div",{className:"text-lg font-medium mb-2",children:"No unpaid parcels found"}),s.jsxs("div",{className:"text-sm",children:["All parcels in this date range have already been paid.",s.jsx("br",{}),"Try selecting a different date range to find unpaid parcels."]})]}),s.jsx("div",{className:"hidden md:block overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left",children:s.jsx("input",{type:"checkbox",checked:(()=>{const ie=L.filter(Ye=>Ye.invoice===null||Ye.invoice===void 0),Fe=ie.filter(Ye=>he.has(Ye._id)&&!Ye._id.startsWith("TEST-")),Ke=ie.length>0&&Fe.length===ie.length;return console.log(" Header checkbox state:",{uninvoicedCount:ie.length,selectedUninvoicedCount:Fe.length,isChecked:Ke}),Ke})(),onChange:ie=>{console.log(" Header checkbox onChange:",ie.target.checked),Js()},className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"})}),s.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-900",children:"CN/Booking ID"}),s.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-900",children:"Date"}),s.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-900",children:"Consignee"}),s.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-900",children:"Destination"}),s.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-900",children:"Weight"}),s.jsx("th",{className:"px-6 py-3 text-right font-semibold text-gray-900",children:"COD Amount"}),s.jsx("th",{className:"px-6 py-3 text-right font-semibold text-gray-900",children:"Service Charges"}),s.jsx("th",{className:"px-6 py-3 text-center font-semibold text-gray-900",children:"Status"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:L.map(ie=>s.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${he.has(ie._id)?"bg-green-50":""}`,children:[s.jsx("td",{className:"px-6 py-4",children:s.jsx("input",{type:"checkbox",checked:he.has(ie._id),onChange:Fe=>{console.log(" Checkbox onChange fired for:",ie._id),console.log(" Event target checked:",Fe.target.checked),console.log(" Current state has ID:",he.has(ie._id)),Fe.stopPropagation(),Dt(ie._id)},onClick:Fe=>{console.log(" Checkbox onClick fired for:",ie._id)},disabled:ie.invoice!==null&&ie.invoice!==void 0,className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed"})}),s.jsx("td",{className:"px-6 py-4 font-mono text-sm font-medium text-gray-900",children:ie.bookingId||ie.trackingId}),s.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:new Date(ie.createdAt).toLocaleDateString()}),s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ie.consigneeName}),s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ie.destinationCity}),s.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[ie.weightKg," kg"]}),s.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 text-right",children:Xt(ie.codAmount)}),s.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 text-right",children:Xt(ie.serviceCharges)}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx(vx,{status:ie.status,invoiced:ie.invoice!==null&&ie.invoice!==void 0})})]},ie._id))})]})}),s.jsx("div",{className:"md:hidden p-4 space-y-4",children:L.map(ie=>s.jsx(_e,{order:ie},ie._id))})]})]})]}),s.jsx("div",{className:"xl:col-span-1",children:s.jsxs(Vn,{className:"p-6 xl:sticky xl:top-24",children:[s.jsx(el,{className:"mb-6",children:"Invoice Summary"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(eo,{label:"COD Total",value:Xt(Ns)}),s.jsx(eo,{label:"Service Charges",value:Xt(Bs)}),s.jsx(eo,{label:"WHT IT u/s 6A of ITO, 2001 (2.0%)",children:s.jsx("input",{type:"number",min:"0",step:"0.01",value:le,onChange:ie=>Oe(Math.max(0,parseFloat(ie.target.value)||0)),className:"w-24 px-3 py-1 text-sm text-right border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"0.00"})}),s.jsx(eo,{label:"WHT ST u/s 3 of STA, 1990 (2.0%)",children:s.jsx("input",{type:"number",min:"0",step:"0.01",value:$,onChange:ie=>ve(Math.max(0,parseFloat(ie.target.value)||0)),className:"w-24 px-3 py-1 text-sm text-right border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"0.00"})}),s.jsx(eo,{label:"Net Payable",value:Xt(us),type:"total"})]})]})})]}),s.jsx(Vn,{className:"p-6 mt-6 print:hidden",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-4",children:[s.jsxs("button",{onClick:Rt,disabled:u||Array.from(he).filter(ie=>!ie.startsWith("TEST-")).length===0||!N||!R,className:"px-6 py-3 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-semibold rounded-lg shadow-sm transition-colors flex items-center justify-center space-x-2",children:[s.jsx(E0,{className:"w-5 h-5"}),s.jsx("span",{children:u?"Saving Invoice...":"Save Invoice"})]}),s.jsxs("button",{onClick:de,disabled:!E,className:"px-6 py-3 border border-gray-300 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed text-gray-700 font-semibold rounded-lg shadow-sm transition-colors flex items-center justify-center space-x-2",children:[s.jsx(rm,{className:"w-5 h-5"}),s.jsx("span",{children:"Print Invoice"})]}),s.jsxs("button",{onClick:Le,disabled:!E||u,className:"px-6 py-3 border border-gray-300 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed text-gray-700 font-semibold rounded-lg shadow-sm transition-colors flex items-center justify-center space-x-2",children:[s.jsx(kc,{className:"w-5 h-5"}),s.jsx("span",{children:u?"Exporting...":"Export Excel"})]})]})})]}),f&&s.jsx("div",{className:"fixed bottom-4 right-4 z-50 max-w-md",children:s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg shadow-lg",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:f}),s.jsx("button",{onClick:()=>y(""),className:"ml-4 text-red-600 hover:text-red-800 font-bold text-lg leading-none",children:""})]})})}),C&&s.jsx("div",{className:"fixed bottom-4 right-4 z-50 max-w-md",children:s.jsx("div",{className:"bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg shadow-lg",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:C}),s.jsx("button",{onClick:()=>w(""),className:"ml-4 text-green-600 hover:text-green-800 font-bold text-lg leading-none",children:""})]})})})]})},dw=()=>{const[u,m]=D.useState([]),[f,y]=D.useState([]),[C,w]=D.useState(""),E=typeof window<"u"?localStorage.getItem("token"):null,T=async()=>{w("");try{const[N,v]=await Promise.all([fetch("/api/users/riders/assigned-counts",{headers:{Authorization:E?`Bearer ${E}`:""}}),fetch("/api/orders",{headers:{Authorization:E?`Bearer ${E}`:""}})]),A=await N.json(),O=await v.json();if(!N.ok)throw new Error(A.message||"Failed riders");if(!v.ok)throw new Error(O.message||"Failed orders");m(A),y(O)}catch(N){w(N.message)}};return D.useEffect(()=>{T()},[]),s.jsxs("div",{className:"space-y-8",children:[C&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:C}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Logistics"}),s.jsx("button",{onClick:T,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500",children:[s.jsx("th",{className:"py-2 px-3",children:"Rider"}),s.jsx("th",{className:"py-2 px-3",children:"Assigned"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:u.map(N=>s.jsxs("tr",{children:[s.jsxs("td",{className:"py-2 px-3 flex items-center gap-2",children:[s.jsx(ds,{className:"w-4 h-4"})," ",N.name]}),s.jsx("td",{className:"py-2 px-3",children:Number(N.assignedCount||0)})]},N._id))})]})})]}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Rider Orders & Status"}),s.jsx("button",{onClick:T,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500",children:[s.jsx("th",{className:"py-2 px-3",children:"Rider"}),s.jsx("th",{className:"py-2 px-3",children:"Booking"}),s.jsx("th",{className:"py-2 px-3",children:"Status"}),s.jsx("th",{className:"py-2 px-3",children:"City"}),s.jsx("th",{className:"py-2 px-3",children:"COD/Collected"}),s.jsx("th",{className:"py-2 px-3",children:"Updated"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:f.filter(N=>!!N.assignedRider&&["OUT_FOR_DELIVERY","DELIVERED","RETURNED","FAILED","ASSIGNED"].includes(N.status)).map(N=>{var v,A;return s.jsxs("tr",{children:[s.jsx("td",{className:"py-2 px-3",children:typeof N.assignedRider=="object"?(v=N.assignedRider)==null?void 0:v.name:((A=u.find(O=>O._id===N.assignedRider))==null?void 0:A.name)||""}),s.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:N.bookingId}),s.jsx("td",{className:"py-2 px-3",children:N.status}),s.jsx("td",{className:"py-2 px-3",children:N.destinationCity}),s.jsx("td",{className:"py-2 px-3",children:N.status==="DELIVERED"?`Rs ${Number(N.amountCollected||N.codAmount||0).toLocaleString()}`:`Rs ${Number(N.codAmount||0).toLocaleString()}`}),s.jsx("td",{className:"py-2 px-3 text-xs text-gray-500",children:new Date(N.updatedAt||N.createdAt).toLocaleString()})]},N._id)})})]})})]})]})},uw=()=>{var F,Z,ne,Y,q,oe,Q;const{id:u}=Vc(),m=Gs(),[f,y]=D.useState(null),[C,w]=D.useState(!0),[E,T]=D.useState(""),[N,v]=D.useState(null),A=localStorage.getItem("token");D.useEffect(()=>{u&&O(),R()},[u]),D.useEffect(()=>{f&&!C&&setTimeout(()=>{try{window.print()}catch(te){console.error("Print failed:",te)}},500)},[f,C]);const O=async()=>{try{w(!0);const te=await fetch(`/api/invoice/${u}`,{headers:{Authorization:`Bearer ${A}`}});if(!te.ok)throw new Error("Failed to load invoice");const K=await te.json();y(K)}catch(te){T(te.message)}finally{w(!1)}},R=async()=>{try{const te=await fetch("/api/company-profile/public"),K=await te.json();te.ok&&K.success?v(K.data):v({companyName:"LahoreLink Courier Services",logoUrl:"",address:{line1:"Office # 123, Main Boulevard, Gulberg III",city:"Lahore",country:"Pakistan"},phone:"+92-42-111-LINK (5465)",email:"finance@lahorelink.com",website:"www.lahorelink.com",footerNote:"For support contact: +92-42-111-LINK (5465) | Email: support@lahorelink.com"})}catch(te){console.error("Error loading company profile:",te),v({companyName:"LahoreLink Courier Services",logoUrl:"",address:{line1:"Office # 123, Main Boulevard, Gulberg III",city:"Lahore",country:"Pakistan"},phone:"+92-42-111-LINK (5465)",email:"finance@lahorelink.com",website:"www.lahorelink.com",footerNote:"For support contact: +92-42-111-LINK (5465) | Email: support@lahorelink.com"})}},z=te=>`PKR ${Number(te||0).toLocaleString()}`,P=te=>new Date(te).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return C?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"text-lg",children:"Loading invoice..."})}):E||!f?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-red-600 text-lg mb-4",children:E||"Invoice not found"}),s.jsx("button",{onClick:()=>m(-1),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Go Back"})]})}):s.jsxs(s.Fragment,{children:[s.jsx("style",{children:`
        @media print {
          body { margin: 0; padding: 0; }
          .no-print { display: none !important; }
          .print-page {
            width: 100% !important;
            max-width: none !important;
            margin: 0 !important;
            padding: 20px !important;
            box-shadow: none !important;
          }
          @page { size: A4; margin: 15mm; }
        }
        .invoice-table th, .invoice-table td {
          border: 1px solid #e5e7eb;
          padding: 8px;
          text-align: left;
        }
        .invoice-table {
          border-collapse: collapse;
          width: 100%;
        }
      `}),s.jsxs("div",{className:"no-print flex justify-between items-center p-4 bg-white border-b",children:[s.jsx("button",{onClick:()=>m(-1),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Back"}),s.jsx("button",{onClick:()=>window.print(),className:"px-4 py-2 bg-primary hover:bg-primary-hover text-white rounded",children:"Print Invoice"})]}),s.jsxs("div",{className:"print-page max-w-4xl mx-auto bg-white p-8",children:[s.jsxs("div",{className:"flex justify-between items-start mb-8",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[(N==null?void 0:N.logoUrl)&&s.jsx("img",{src:N.logoUrl,alt:"Company Logo",className:"w-16 h-16 object-contain",onError:te=>{te.currentTarget.src="/assets/logo.png"}}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:(N==null?void 0:N.companyName)||"LahoreLink Courier Services"}),s.jsx("p",{className:"text-lg text-gray-600",children:"Payment Invoice"})]})]}),s.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[s.jsxs("div",{children:["Email: ",(N==null?void 0:N.email)||"info@lahorelink.com"]}),(N==null?void 0:N.website)&&s.jsxs("div",{children:["Website: ",N.website]}),s.jsxs("div",{children:["Phone: ",(N==null?void 0:N.phone)||"+92-42-111-LINK (5465)"]}),s.jsxs("div",{children:["Address:"," ",N!=null&&N.address?`${N.address.line1}, ${N.address.city}, ${N.address.country}`:"Lahore, Pakistan"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-2xl font-bold text-gray-900 mb-2",children:["Inv.No# ",f.invoiceNumber]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["Date: ",P(f.invoiceDate)]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 print:grid-cols-2 gap-8 mb-8",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3 border-b border-gray-300 pb-2",children:"Bill To:"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Company:"})," ",f.accountName]}),f.accountNumber&&s.jsxs("div",{children:[s.jsx("strong",{children:"Account No:"})," ",f.accountNumber]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Customer:"})," ",((F=f.shipper)==null?void 0:F.companyName)||((Z=f.shipper)==null?void 0:Z.name)]}),((ne=f.shipper)==null?void 0:ne.address)&&s.jsxs("div",{children:[s.jsx("strong",{children:"Address:"})," ",f.shipper.address]}),((Y=f.shipper)==null?void 0:Y.email)&&s.jsxs("div",{children:[s.jsx("strong",{children:"Email:"})," ",f.shipper.email]}),((q=f.shipper)==null?void 0:q.phone)&&s.jsxs("div",{children:[s.jsx("strong",{children:"Phone:"})," ",f.shipper.phone]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3 border-b border-gray-300 pb-2",children:"Invoice Details:"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Invoice Date:"})," ",P(f.invoiceDate)]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Period:"})," ",P(f.parcelFrom)," -"," ",P(f.parcelTo)]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Total Orders:"})," ",((oe=f.orders)==null?void 0:oe.length)||0]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Status:"})," ",s.jsx("span",{className:"text-green-600 font-medium",children:f.status})]})]})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 border-b border-gray-300 pb-2",children:"Order Details:"}),s.jsxs("table",{className:"invoice-table text-sm",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{children:"CN/Booking ID"}),s.jsx("th",{children:"Date"}),s.jsx("th",{children:"Consignee"}),s.jsx("th",{children:"Destination"}),s.jsx("th",{children:"Weight (kg)"}),s.jsx("th",{className:"text-right",children:"COD Amount"}),s.jsx("th",{className:"text-right",children:"Service Charges"}),s.jsx("th",{children:"Status"})]})}),s.jsxs("tbody",{children:[(Q=f.orders)==null?void 0:Q.map(te=>s.jsxs("tr",{children:[s.jsx("td",{className:"font-mono text-xs",children:te.bookingId}),s.jsx("td",{children:P(te.createdAt)}),s.jsx("td",{children:te.consigneeName}),s.jsx("td",{children:te.destinationCity}),s.jsx("td",{children:te.weightKg}),s.jsx("td",{className:"text-right",children:z(te.codAmount)}),s.jsx("td",{className:"text-right",children:z(te.serviceCharges)}),s.jsx("td",{children:s.jsx("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full",children:te.status})})]},te._id)),(!f.orders||f.orders.length===0)&&s.jsx("tr",{children:s.jsx("td",{colSpan:"8",className:"text-center text-gray-500 py-4",children:"No orders found"})})]})]})]}),s.jsx("div",{className:"flex justify-end mb-8",children:s.jsx("div",{className:"w-64",children:s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200",children:[s.jsx("span",{className:"text-gray-600",children:"COD Total:"}),s.jsx("span",{className:"font-medium",children:z(f.codTotal)})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200",children:[s.jsx("span",{className:"text-gray-600",children:"Service Charges:"}),s.jsx("span",{className:"font-medium",children:z(f.serviceChargesTotal)})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200",children:[s.jsx("span",{className:"text-gray-600",children:"WHT IT u/s 6A of ITO, 2001 (2.0%):"}),s.jsx("span",{className:"font-medium",children:z(f.whtIt||0)})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200",children:[s.jsx("span",{className:"text-gray-600",children:"WHT ST u/s 3 of STA, 1990 (2.0%):"}),s.jsx("span",{className:"font-medium",children:z(f.whtSt||0)})]}),s.jsxs("div",{className:"flex justify-between items-center py-3 border-t-2 border-gray-400 mt-4",children:[s.jsx("span",{className:"text-lg font-bold text-gray-900",children:"Net Payable:"}),s.jsx("span",{className:"text-lg font-bold text-primary",children:z(f.netPayable)})]})]})})}),s.jsxs("div",{className:"mt-12 pt-8 border-t border-gray-300",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Payment Terms:"}),s.jsx("p",{children:"Payment is due within 30 days of invoice date."}),s.jsx("p",{children:"Late payments may incur additional charges."})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Contact Information:"}),s.jsx("p",{children:"For any queries regarding this invoice, please contact:"}),s.jsxs("p",{children:["Email: ",(N==null?void 0:N.email)||"finance@lahorelink.com"]}),s.jsxs("p",{children:["Phone: ",(N==null?void 0:N.phone)||"+92-42-111-LINK (5465)"]})]})]}),s.jsxs("div",{className:"mt-8 pt-4 border-t border-gray-200 text-center text-xs text-gray-500",children:[(N==null?void 0:N.footerNote)&&s.jsx("p",{className:"mb-2",children:N.footerNote}),s.jsx("p",{children:"This is a computer generated invoice. No signature required."}),s.jsxs("p",{children:["Generated on ",new Date().toLocaleDateString()," by"," ",(N==null?void 0:N.companyName)||"LahoreLink Logistics"," Management System"]})]})]})]})]})},Zu=()=>{const u=sn(),[m,f]=D.useState("dashboard"),[y,C]=D.useState([]),[w,E]=D.useState([]),[T,N]=D.useState(""),[v,A]=D.useState("date:desc"),[O,R]=D.useState("all"),[z,P]=D.useState(!1),[F,Z]=D.useState(""),[ne,Y]=D.useState(null),[q,oe]=D.useState({pendingCod:0,pendingPrepaid:0,totalOrders:0,lllWarehouse:0,outForDelivery:0}),[Q,te]=D.useState("COD"),[K,Te]=D.useState("today"),[re,le]=D.useState({consigneeName:"",consigneePhone:"",consigneeAddress:"",destinationCity:"Lahore",serviceType:"SAME_DAY",codAmount:"",productDescription:"",pieces:"1",fragile:!1,weightKg:"",remarks:""}),{user:Oe}=Qs(),$=(Oe==null?void 0:Oe.token)||ea(),ve=Gs(),[Ne,M]=D.useState(""),[L,U]=D.useState([]),[V,fe]=D.useState(!1),[he,X]=D.useState([]),se=async()=>{try{const de=await fetch("/api/orders",{headers:{Authorization:$?`Bearer ${$}`:""}});if(console.log("DEBUG fetchOrders response status:",de.status,"ok:",de.ok),de.ok){const Le=await de.json();console.log("DEBUG fetchOrders data count:",Le.length),C(Le),E(Le),new Date().setHours(0,0,0,0);let ie=new Date;ie.setHours(0,0,0,0),K==="7days"?ie.setDate(ie.getDate()-6):K==="15days"?ie.setDate(ie.getDate()-14):K==="30days"&&ie.setDate(ie.getDate()-29);const Fe=Le.filter(Pe=>{const ot=new Date(Pe.createdAt);return ot.setHours(0,0,0,0),ot.getTime()>=ie.getTime()}),Ke=Fe.filter(Pe=>Pe.paymentType==="COD"&&!["DELIVERED","RETURNED","FAILED"].includes(Pe.status)).reduce((Pe,ot)=>Pe+Number(ot.codAmount||0),0),Ye=Fe.filter(Pe=>Pe.paymentType!=="COD"&&!["DELIVERED","RETURNED","FAILED"].includes(Pe.status)).reduce((Pe,ot)=>Pe+Number(ot.codAmount||0),0);oe({pendingCod:Ke,pendingPrepaid:Ye,totalOrders:Fe.length,lllWarehouse:Fe.filter(Pe=>Pe.status==="CREATED"||Pe.status==="ASSIGNED"||Pe.status==="AT_LLL_WAREHOUSE").length,outForDelivery:Fe.filter(Pe=>Pe.status==="OUT_FOR_DELIVERY").length})}else if(de.status===401){const Le="Session expired. Please login again.";console.log("DEBUG fetchOrders 401:",Le),Z(Le)}else{const Le="Failed to load orders";console.log("DEBUG fetchOrders error:",Le),Z(Le)}}catch(de){console.error("DEBUG fetchOrders exception:",de.message),Z("Error: "+de.message)}},Ee=de=>{Te(de)},ye=async()=>{try{const de=await fetch("/api/finance/summary/shipper/me",{headers:{Authorization:$?`Bearer ${$}`:""}});console.log("DEBUG fetchFinance response status:",de.status,"ok:",de.ok);const Le=await de.json();if(console.log("DEBUG fetchFinance response data:",Le),de.ok)Y(Le);else{const _e=(Le==null?void 0:Le.message)||"Failed to load finance data";console.log("DEBUG fetchFinance error message:",_e),Z(_e)}}catch(de){console.error("DEBUG fetchFinance exception:",de.message),Z("Error loading finance data: "+de.message)}};D.useEffect(()=>{se(),ye()},[$,K]),D.useEffect(()=>{u.pathname.includes("/shipper/create")?f("create"):u.pathname.includes("/shipper/orders")?f("orders"):f("dashboard")},[u.pathname]),D.useEffect(()=>{const de=T.toLowerCase();E(y.filter(Le=>{var _e,ie,Fe;return((_e=Le.bookingId)==null?void 0:_e.toLowerCase().includes(de))||((ie=Le.consigneeName)==null?void 0:ie.toLowerCase().includes(de))||((Fe=Le.destinationCity)==null?void 0:Fe.toLowerCase().includes(de))}))},[T,y]);const Ue=al.useMemo(()=>{if(O==="all")return w;const de=new Date;let Le=new Date(de),_e=new Date(de);if(O==="today")Le.setHours(0,0,0,0),_e.setHours(23,59,59,999);else if(O==="week"){const ie=de.getDay(),Fe=ie===0?-6:1-ie;Le=new Date(de),Le.setDate(de.getDate()+Fe),Le.setHours(0,0,0,0),_e=new Date(Le),_e.setDate(Le.getDate()+6),_e.setHours(23,59,59,999)}else O==="month"&&(Le=new Date(de.getFullYear(),de.getMonth(),1,0,0,0,0),_e=new Date(de.getFullYear(),de.getMonth()+1,0,23,59,59,999));return w.filter(ie=>{const Fe=new Date(ie==null?void 0:ie.createdAt);return Number.isNaN(Fe.getTime())?!1:Fe.getTime()>=Le.getTime()&&Fe.getTime()<=_e.getTime()})},[w,O]),Re=al.useMemo(()=>{const de=Pe=>{if(!Pe)return NaN;const ot=new Date(Pe);if(!Number.isNaN(ot.getTime()))return ot.getTime();if(typeof Pe=="string"){const St=Pe.trim();if(St.includes("/")){const rt=St.split("/");if(rt.length===3){const[ba,wa,an]=rt;if(String(ba).length===2){const It=Number(ba),ke=Number(wa),zt=Number(an);return new Date(zt,ke-1,It).getTime()}}}if(St.includes("-")){const rt=St.split("-");if(rt.length===3&&String(rt[0]).length===2){const[ba,wa,an]=rt;return new Date(Number(an),Number(wa)-1,Number(ba)).getTime()}}}return NaN},Le=Pe=>Number(((Pe==null?void 0:Pe.codAmount)||0)-((Pe==null?void 0:Pe.serviceCharges)||0)),_e=Pe=>Number((Pe==null?void 0:Pe.serviceCharges)||0),[ie,Fe]=String(v||"date:desc").split(":"),Ke=Fe==="asc"?1:-1,Ye=Ue.map((Pe,ot)=>({o:Pe,idx:ot}));return Ye.sort((Pe,ot)=>{var ba,wa,an,It;let St,rt;return ie==="date"?(St=de((ba=Pe.o)==null?void 0:ba.createdAt),rt=de((wa=ot.o)==null?void 0:wa.createdAt)):ie==="cod"?(St=Le(Pe.o),rt=Le(ot.o)):ie==="charges"?(St=_e(Pe.o),rt=_e(ot.o)):ie==="status"&&(St=String(((an=Pe.o)==null?void 0:an.status)||"").toLowerCase(),rt=String(((It=ot.o)==null?void 0:It.status)||"").toLowerCase()),St===rt?Pe.idx-ot.idx:typeof St=="string"||typeof rt=="string"?String(St).localeCompare(String(rt))*Ke:Number.isNaN(St)&&Number.isNaN(rt)?Pe.idx-ot.idx:Number.isNaN(St)?1:Number.isNaN(rt)?-1:(St-rt)*Ke}),Ye.map(Pe=>Pe.o)},[Ue,v]);D.useEffect(()=>{const de=Ne.trim().toLowerCase();if(de.length<2){U([]);return}U(y.filter(Le=>{var _e,ie,Fe,Ke;return((_e=Le.bookingId)==null?void 0:_e.toLowerCase().includes(de))||((ie=Le.trackingId)==null?void 0:ie.toLowerCase().includes(de))||((Fe=Le.consigneeName)==null?void 0:Fe.toLowerCase().includes(de))||((Ke=Le.destinationCity)==null?void 0:Ke.toLowerCase().includes(de))}).slice(0,8))},[Ne,y]);const Ge=(de,Le)=>{X(_e=>Le?_e.includes(de)?_e:[..._e,de]:_e.filter(ie=>ie!==de))},et=async()=>{if(he.length!==0)try{const de=localStorage.getItem("token"),Le=await fetch("/api/orders/labels/print",{method:"POST",headers:{"Content-Type":"application/json",Authorization:de?`Bearer ${de}`:""},body:JSON.stringify({orderIds:he})});if(!Le.ok){if(Le.status===401){alert("Session expired. Please login again.");return}const Fe=await Le.text();alert(Fe||"Failed to generate labels");return}const _e=await Le.text(),ie=window.open("","_blank");if(!ie){alert("Popup blocked. Please allow popups to print labels.");return}ie.document.write(_e),ie.document.close(),ie.focus(),setTimeout(()=>{try{ie.print()}catch{}},200)}catch(de){alert(de.message||"Error generating labels")}},ct=y.filter(de=>de.status==="DELIVERED").length,ns=y.filter(de=>!["DELIVERED","RETURNED","FAILED"].includes(de.status)).reduce((de,Le)=>de+Number(Le.codAmount||0),0),Dt=y.filter(de=>de.status==="RETURNED").length,Js=de=>({CREATED:"Pending",ASSIGNED:"In LLL Warehouse",OUT_FOR_DELIVERY:"Out for delivery",RETURNED:"Returned",DELIVERED:"Delivered",FAILED:"Failed"})[de]||de,dt=de=>{const Le=de.bookingState==="BOOKED",_e=Le?"bg-green-100 text-green-700 border-green-200":"bg-amber-100 text-amber-700 border-amber-200",ie=Le?"Booked":"Unbooked";return s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs border ${_e}`,children:ie})},Ns=de=>de.isIntegrated?s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs border border-blue-200 bg-blue-50 text-blue-700",children:"Integrated"}):s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs border border-gray-200 bg-gray-50 text-gray-700",children:"Manual"}),Bs=async de=>{try{Z("");const Le=await fetch(`/api/orders/${de}/book`,{method:"PATCH",headers:{Authorization:$?`Bearer ${$}`:""}}),_e=await Le.json();if(!Le.ok)throw new Error((_e==null?void 0:_e.message)||"Booking failed");C(ie=>ie.map(Fe=>Fe._id===de?_e:Fe)),E(ie=>ie.map(Fe=>Fe._id===de?_e:Fe))}catch(Le){Z(Le.message||"Failed to book order")}},us=al.useMemo(()=>{let de=new Date;de.setHours(0,0,0,0),K==="7days"?de.setDate(de.getDate()-6):K==="15days"?de.setDate(de.getDate()-14):K==="30days"&&de.setDate(de.getDate()-29);const Le=y.filter(Ye=>{const Pe=new Date(Ye.createdAt);return Pe.setHours(0,0,0,0),Pe.getTime()>=de.getTime()}),_e=Le.length,ie=Le.filter(Ye=>!["DELIVERED","RETURNED","FAILED"].includes(Ye.status)).length,Fe=Le.filter(Ye=>!["DELIVERED","RETURNED","FAILED"].includes(Ye.status)).reduce((Ye,Pe)=>{const ot=Pe.paymentType==="COD";return Q==="COD"&&ot||Q==="DP"&&!ot?Ye+(Pe.codAmount||0):Ye},0),Ke={total:Le.length,unbooked:Le.filter(Ye=>Ye.bookingState!=="BOOKED").length,booked:Le.filter(Ye=>Ye.bookingState==="BOOKED").length,warehouse:Le.filter(Ye=>["ASSIGNED","AT_LLL_WAREHOUSE"].includes(Ye.status)).length,ofd:Le.filter(Ye=>Ye.status==="OUT_FOR_DELIVERY").length,delivered:Le.filter(Ye=>Ye.status==="DELIVERED").length,attempted:Le.filter(Ye=>["FAILED","FIRST_ATTEMPT","SECOND_ATTEMPT","THIRD_ATTEMPT"].includes(Ye.status)).length,returned:Le.filter(Ye=>Ye.status==="RETURNED").length};return{header:{total:_e,pending:ie,amount:Fe},grid:Ke}},[y,K,Q]),Xt=async de=>{if(de.preventDefault(),P(!0),Z(""),!re.weightKg||re.weightKg<=0){Z("Weight must be greater than 0"),P(!1);return}try{const Le={consigneeName:re.consigneeName,consigneePhone:re.consigneePhone,consigneeAddress:re.consigneeAddress,destinationCity:re.destinationCity,serviceType:re.serviceType,codAmount:re.paymentType==="ADVANCE"?0:Number(re.codAmount||0),paymentType:re.paymentType,productDescription:re.productDescription,pieces:Number(re.pieces),fragile:!!re.fragile,weightKg:Number(re.weightKg),remarks:re.remarks},_e=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:$?`Bearer ${$}`:""},body:JSON.stringify(Le)});if(!_e.ok){const ie=await _e.json().catch(()=>({message:"Failed"}));throw new Error(ie.message||"Order creation failed")}await se(),f("list"),le({consigneeName:"",consigneePhone:"",consigneeAddress:"",destinationCity:"Lahore",serviceType:"SAME_DAY",codAmount:"",paymentType:"COD",productDescription:"",pieces:"1",fragile:!1,weightKg:"",remarks:""})}catch(Le){Z(Le.message)}finally{P(!1)}},Rt=m==="dashboard";return s.jsxs("div",{className:"space-y-8",children:[Rt&&s.jsxs("div",{className:"block sm:hidden space-y-4",children:[s.jsxs("div",{className:"bg-[#0B6D45] p-6 rounded-b-3xl text-white shadow-lg -mx-4 -mt-4 mb-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:K==="7days"?"7 Days Orders":K==="15days"?"15 Days Orders":K==="30days"?"30 Days Orders":"Today's Orders"}),s.jsxs("div",{className:"flex items-center gap-2 mt-1 opacity-80",children:[s.jsx("span",{className:"text-2xl font-bold",children:us.header.total}),s.jsx(Fr,{className:"w-4 h-4 cursor-pointer",onClick:se})]})]}),s.jsxs("div",{className:"bg-[#085233] rounded-lg p-1 flex text-xs font-semibold",children:[s.jsx("button",{onClick:()=>te("COD"),className:`px-3 py-1 rounded-md transition-all ${Q==="COD"?"bg-white text-[#0B6D45] shadow-sm":"text-green-100"}`,children:"COD"}),s.jsx("button",{onClick:()=>te("DP"),className:`px-3 py-1 rounded-md transition-all ${Q==="DP"?"bg-white text-[#0B6D45] shadow-sm":"text-green-100"}`,children:"DP"})]})]}),s.jsxs("div",{className:"mb-2",children:[s.jsxs("p",{className:"text-green-100 text-sm",children:["PKR ",s.jsx(Ur,{className:"inline w-3 h-3 ml-1"})]}),s.jsxs("div",{className:"flex justify-between items-end mt-1",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-3xl font-bold",children:us.header.amount.toLocaleString()}),s.jsx("p",{className:"text-xs text-green-100 mt-1",children:"Pending Amount"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("span",{className:"text-2xl font-bold",children:us.header.pending}),s.jsx("p",{className:"text-xs text-green-100 mt-1",children:"Pending Orders"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("span",{className:"text-2xl font-bold",children:us.header.total}),s.jsx("p",{className:"text-xs text-green-100 mt-1",children:"Total Orders"})]})]})]})]}),s.jsxs("div",{className:"flex justify-center gap-2 mb-4 px-2 overflow-x-auto",children:[s.jsx("button",{onClick:()=>Ee("7days"),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${K==="7days"?"bg-black text-white":"bg-white text-gray-500 border border-gray-200"}`,children:"7 DAYS"}),s.jsx("button",{onClick:()=>Ee("15days"),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${K==="15days"?"bg-black text-white":"bg-white text-gray-500 border border-gray-200"}`,children:"15 DAYS"}),s.jsx("button",{onClick:()=>Ee("30days"),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${K==="30days"?"bg-black text-white":"bg-white text-gray-500 border border-gray-200"}`,children:"30 DAYS"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 px-1",children:[s.jsx(Xn,{icon:S2,title:"Total Orders",count:us.grid.total,colorClass:"text-gray-600"}),s.jsx(Xn,{icon:gt,title:"Unbooked",count:us.grid.unbooked,colorClass:"text-amber-600"}),s.jsx(Xn,{icon:u2,title:"Booked",count:us.grid.booked,colorClass:"text-green-600"}),s.jsx(Xn,{icon:rl,title:"In Warehouse",count:us.grid.warehouse,colorClass:"text-blue-600"}),s.jsx(Xn,{icon:p2,title:"Out for Delivery",count:us.grid.ofd,colorClass:"text-cyan-600"}),s.jsx(Xn,{icon:qn,title:"Delivered",count:us.grid.delivered,colorClass:"text-green-700"}),s.jsx(Xn,{icon:Ur,title:"Attempted",count:us.grid.attempted,colorClass:"text-red-500"}),s.jsx(Xn,{icon:V2,title:"Returned",count:us.grid.returned,colorClass:"text-orange-600"})]})]}),s.jsxs("div",{className:`${Rt?"hidden sm:block":""} bg-white p-6 rounded-xl border border-gray-100 shadow-sm`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(gt,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Shipper Dashboard"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[m==="dashboard"&&s.jsx(as,{onClick:async()=>{try{const de=await fetch("/api/notifications/pickup-request",{method:"POST",headers:{"Content-Type":"application/json",Authorization:$?`Bearer ${$}`:""},body:JSON.stringify({shipperId:(Oe==null?void 0:Oe.id)||localStorage.getItem("userId"),message:"Pickup required"})});if(de.ok)alert("Pickup request sent successfully!");else{const Le=await de.json();alert(Le.message||"Failed to send pickup request")}}catch(de){alert("Error sending pickup request: "+de.message)}},variant:"outline",children:"Send Pickup Request"}),m==="list"&&s.jsxs(as,{onClick:()=>ve("/shipper/create"),children:[s.jsx(f0,{className:"w-4 h-4"})," New Order"]})]})]}),s.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Create and track shipments."})]}),m==="dashboard"&&s.jsxs("div",{className:"hidden sm:block bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Quick Actions"})}),s.jsxs("div",{className:"flex flex-wrap gap-3",children:[s.jsxs(as,{onClick:()=>f("create"),children:[s.jsx(f0,{className:"w-4 h-4"})," Create New Order"]}),s.jsxs(as,{variant:"outline",onClick:()=>f("orders"),children:[s.jsx(gt,{className:"w-4 h-4"})," View All Orders"]})]})]}),m==="dashboard"&&s.jsxs("div",{className:"hidden sm:block bg-white rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"p-6 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:K==="7days"?"Last 7 Days Orders":K==="15days"?"Last 15 Days Orders":K==="30days"?"Last 30 Days Orders":"Today's Orders"}),s.jsx("button",{onClick:se,className:"text-gray-400 hover:text-primary",children:s.jsx(Fr,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[s.jsx("button",{onClick:()=>Ee("today"),className:`px-3 py-1.5 text-xs rounded-full ${K==="today"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"Today"}),s.jsx("button",{onClick:()=>Ee("7days"),className:`px-3 py-1.5 text-xs rounded-full ${K==="7days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"7 Days"}),s.jsx("button",{onClick:()=>Ee("15days"),className:`px-3 py-1.5 text-xs rounded-full ${K==="15days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"15 Days"}),s.jsx("button",{onClick:()=>Ee("30days"),className:`px-3 py-1.5 text-xs rounded-full ${K==="30days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"30 Days"})]}),s.jsxs("div",{className:"flex items-center justify-between mt-4",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>te("COD"),className:`px-3 py-1.5 text-xs rounded-full ${Q==="COD"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"COD"}),s.jsx("button",{onClick:()=>te("DP"),className:`px-3 py-1.5 text-xs rounded-full ${Q==="DP"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"DP"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Pending Amount"}),s.jsxs("p",{className:"text-lg font-bold text-secondary",children:["PKR"," ",Q==="COD"?q.pendingCod.toLocaleString():q.pendingPrepaid.toLocaleString()]})]})]}),s.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Total Orders Today"}),s.jsx("p",{className:"text-lg font-bold text-secondary",children:q.totalOrders})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[s.jsx(Jt,{icon:ds,title:"Total Orders",count:q.totalOrders}),s.jsx(Jt,{icon:gt,title:"LLL Warehouse",count:q.lllWarehouse}),s.jsx(Jt,{icon:ds,title:"Out for Delivery",count:q.outForDelivery}),s.jsx(Jt,{icon:Ut,title:"Pending COD",count:`PKR ${q.pendingCod.toLocaleString()}`}),s.jsx(Jt,{icon:bn,title:"Pending Prepaid",count:`PKR ${q.pendingPrepaid.toLocaleString()}`})]})]}),m==="dashboard"&&s.jsxs("div",{className:"hidden sm:block grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx(Jt,{icon:gt,title:"Total Bookings",count:y.length}),s.jsx(Jt,{icon:ds,title:"Delivered",count:ct}),s.jsx(Jt,{icon:Ut,title:"COD Pending",count:`PKR ${ns.toLocaleString()}`}),s.jsx(Jt,{icon:Fr,title:"Returned",count:Dt}),s.jsx(Jt,{icon:Ut,title:"Total COD",count:ne?`PKR ${Number(ne.totals.totalCodCollected||0).toLocaleString()}`:""}),s.jsx(Jt,{icon:Ut,title:"Service Charges",count:ne?`PKR ${Number(ne.totals.totalCompanyCommission||0).toLocaleString()}`:""}),s.jsx(Jt,{icon:Ut,title:"Net Amount",count:ne?`PKR ${Number((ne.totals.totalCodCollected||0)-(ne.totals.totalCompanyCommission||0)).toLocaleString()}`:""})]}),m==="create"?s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm max-w-2xl",children:s.jsxs("form",{onSubmit:Xt,className:"p-6 space-y-6",children:[F&&s.jsx("p",{className:"text-sm text-red-600",children:F}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsx(st,{label:"Consignee Name",value:re.consigneeName,onChange:de=>le({...re,consigneeName:de.target.value}),required:!0}),s.jsx(st,{label:"Consignee Phone",value:re.consigneePhone,onChange:de=>le({...re,consigneePhone:de.target.value}),required:!0}),s.jsx(st,{label:"City",value:re.destinationCity,onChange:de=>le({...re,destinationCity:de.target.value})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Service Type"}),s.jsxs("select",{className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white text-gray-900 focus:border-primary focus:ring-primary/20 focus:outline-none",value:re.serviceType,onChange:de=>le({...re,serviceType:de.target.value}),children:[s.jsx("option",{value:"SAME_DAY",children:"SAME_DAY"}),s.jsx("option",{value:"OVERNIGHT",children:"OVERNIGHT"}),s.jsx("option",{value:"ECONOMY",children:"ECONOMY"})]})]}),s.jsx("div",{className:"md:col-span-2",children:s.jsx(st,{label:"Address",value:re.consigneeAddress,onChange:de=>le({...re,consigneeAddress:de.target.value}),required:!0})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Payment Type"}),s.jsxs("select",{className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white text-gray-900",value:re.paymentType,onChange:de=>le({...re,paymentType:de.target.value,codAmount:de.target.value==="ADVANCE"?"":re.codAmount}),children:[s.jsx("option",{value:"COD",children:"COD"}),s.jsx("option",{value:"ADVANCE",children:"ADVANCE"})]})]}),s.jsx(st,{label:"COD Amount (PKR)",type:"number",value:re.codAmount,onChange:de=>le({...re,codAmount:de.target.value}),disabled:re.paymentType==="ADVANCE"}),s.jsx(st,{label:"Weight (kg)",type:"number",step:"0.1",min:"0.1",value:re.weightKg,onChange:de=>le({...re,weightKg:de.target.value}),required:!0,placeholder:"Enter weight in kg (e.g. 0.5, 1.2, 2.5)"}),s.jsx("div",{className:"md:col-span-2",children:s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-sm text-blue-700",children:[s.jsx("strong",{children:"Service charges will be calculated automatically"})," ","based on the weight you enter and your shipper's configured weight brackets."]})})}),s.jsx(st,{label:"Pieces",type:"number",value:re.pieces,onChange:de=>le({...re,pieces:de.target.value})}),s.jsx("div",{className:"md:col-span-2",children:s.jsx(st,{label:"Product Description",value:re.productDescription,onChange:de=>le({...re,productDescription:de.target.value})})})]}),s.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:re.fragile,onChange:de=>le({...re,fragile:de.target.checked})}),s.jsx("span",{className:"text-sm",children:"Fragile"})]}),s.jsx(st,{label:"Remarks",value:re.remarks,onChange:de=>le({...re,remarks:de.target.value})}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx(as,{type:"button",variant:"outline",onClick:()=>f("dashboard"),children:"Cancel"}),s.jsx(as,{type:"submit",disabled:z,children:z?"Creating...":"Create Shipment"})]})]})}):m==="orders"?s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("div",{className:"p-6 border-b border-gray-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"My Orders"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto",children:[s.jsx("input",{value:T,onChange:de=>N(de.target.value),type:"text",placeholder:"Search orders...",className:"pl-3 pr-4 py-1.5 text-sm border border-gray-200 rounded-lg w-full sm:w-auto"}),s.jsxs("select",{value:v,onChange:de=>A(de.target.value),className:"pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white w-full sm:w-auto",children:[s.jsx("option",{value:"date:desc",children:"Sort by Date  Newest First"}),s.jsx("option",{value:"date:asc",children:"Sort by Date  Oldest First"}),s.jsx("option",{value:"cod:desc",children:"Sort by COD  High to Low"}),s.jsx("option",{value:"cod:asc",children:"Sort by COD  Low to High"}),s.jsx("option",{value:"charges:desc",children:"Sort by Service Charges  High to Low"}),s.jsx("option",{value:"charges:asc",children:"Sort by Service Charges  Low to High"}),s.jsx("option",{value:"status:asc",children:"Sort by Status  AZ"}),s.jsx("option",{value:"status:desc",children:"Sort by Status  ZA"})]}),s.jsxs("select",{value:O,onChange:de=>R(de.target.value),className:"pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white w-full sm:w-auto","aria-label":"Filter by Date Range",children:[s.jsx("option",{value:"all",children:"All Orders"}),s.jsx("option",{value:"today",children:"Today"}),s.jsx("option",{value:"week",children:"This Week"}),s.jsx("option",{value:"month",children:"This Month"})]}),s.jsx("button",{onClick:se,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"}),V?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:et,className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary",children:["Print Selected (",he.length,"/",w.length,")"]}),s.jsx("button",{onClick:()=>{fe(!1),X([])},className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Cancel"})]}):s.jsx("button",{onClick:()=>{fe(!0),X([])},className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary",children:"Print Labels"})]})]})}),s.jsx("div",{className:"p-6",children:Re.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No orders yet."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500",children:[s.jsx("th",{className:"py-2 px-3",children:"Select"}),s.jsx("th",{className:"py-2 px-3",children:"Order ID"}),s.jsx("th",{className:"py-2 px-3",children:"Source"}),s.jsx("th",{className:"py-2 px-3",children:"Booking"}),s.jsx("th",{className:"py-2 px-3",children:"Consignee"}),s.jsx("th",{className:"py-2 px-3",children:"COD"}),s.jsx("th",{className:"py-2 px-3",children:"Date"}),s.jsx("th",{className:"py-2 px-3",children:"Status"}),s.jsx("th",{className:"py-2 px-3",children:"Payment"}),s.jsx("th",{className:"py-2 px-3",children:"Actions"})]})}),s.jsx("tbody",{children:Re.map(de=>s.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 cursor-pointer",onClick:()=>!V&&ve(`/shipper/order/${de._id}`),children:[s.jsx("td",{className:"py-2 px-3",children:s.jsx("input",{type:"checkbox",onClick:Le=>Le.stopPropagation(),checked:he.includes(de._id),onChange:Le=>Ge(de._id,Le.target.checked),disabled:!V})}),s.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:de.bookingId}),s.jsx("td",{className:"py-2 px-3",children:Ns(de)}),s.jsx("td",{className:"py-2 px-3",children:dt(de)}),s.jsx("td",{className:"py-2 px-3 text-secondary",children:de.consigneeName}),s.jsxs("td",{className:"py-2 px-3",children:["PKR"," ",Number((de.codAmount||0)-(de.serviceCharges||0)).toLocaleString()]}),s.jsx("td",{className:"py-2 px-3",children:new Date(de.createdAt).toLocaleDateString()}),s.jsx("td",{className:"py-2 px-3 text-xs",children:Js(de.status)}),s.jsx("td",{className:"py-2 px-3 text-xs",children:de.paymentType}),s.jsx("td",{className:"py-2 px-3",children:de.isIntegrated&&de.bookingState==="UNBOOKED"&&s.jsx("button",{className:"px-3 py-1 text-xs rounded border border-primary text-primary hover:bg-primary hover:text-white",onClick:Le=>{Le.stopPropagation(),Bs(de._id)},children:"Book Now"})})]},de._id))})]})})})]}):null]})},wm=({status:u})=>{const m=f=>{switch(f){case"Delivered":return"bg-green-100 text-green-800 border-green-200";case"In Transit":return"bg-blue-100 text-blue-800 border-blue-200";case"Assigned":return"bg-indigo-100 text-indigo-800 border-indigo-200";case"Created":return"bg-gray-100 text-gray-800 border-gray-200";case"Returned":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"Failed":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return s.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-semibold border ${m(u)}`,children:u})},Cx=()=>{const{id:u}=Vc(),m=Gs(),[f,y]=D.useState(null),[C,w]=D.useState(null),[E,T]=D.useState(!0),[N,v]=D.useState(""),A=typeof window<"u"?localStorage.getItem("token"):null,O=async()=>{T(!0),v("");try{const F=await fetch(`/api/orders/${u}`,{headers:{Authorization:A?`Bearer ${A}`:""}}),Z=await F.json();if(!F.ok)throw new Error(Z.message||"Failed to fetch order");y(Z);try{const ne=await fetch(`/api/finance/transactions/order/${u}`,{headers:{Authorization:A?`Bearer ${A}`:""}}),Y=await ne.json();ne.ok&&w(Y)}catch{}}catch(F){v(F.message)}finally{T(!1)}};if(D.useEffect(()=>{O()},[u]),E)return s.jsx("div",{className:"p-6",children:"Loading..."});if(N)return s.jsx("div",{className:"p-6 text-red-600 text-sm",children:N});if(!f)return null;const R=Number(f.codAmount||0).toLocaleString(),z=C?Number(C.companyCommission||0):0,P=C?Number((C.totalCodCollected||0)-(C.companyCommission||0)):null;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(gt,{className:"w-6 h-6 text-primary"}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-bold text-secondary",children:["Order ",f.bookingId]}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Service: ",f.serviceType]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>m(`/label-print/${u}`),className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary flex items-center gap-2",children:[s.jsx(rm,{className:"w-4 h-4"})," Print Label"]}),s.jsx("button",{onClick:()=>m(-1),className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Back"})]})]}),s.jsxs("div",{className:"bg-secondary text-white rounded-2xl p-6 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs opacity-80",children:"COD Amount"}),s.jsxs("div",{className:"text-3xl font-bold",children:["PKR ",R]})]}),s.jsx(wm,{status:f.status})]}),C&&s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary mb-2",children:"Settlement"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-500",children:"Total COD Collected"}),s.jsxs("div",{className:"font-semibold",children:["PKR ",Number(C.totalCodCollected||0).toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-500",children:"Service Charges"}),s.jsxs("div",{className:"font-semibold",children:["PKR ",Number(z).toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-500",children:"Net Amount"}),s.jsx("div",{className:"font-semibold",children:P!==null?`PKR ${Number(P).toLocaleString()}`:""})]})]}),s.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Formula: Net = COD  Service Charges"})]}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Order Details"}),s.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-500",children:"Weight"}),s.jsxs("div",{className:"font-semibold",children:[f.weightKg||f.weight||"N/A"," kg"]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-500",children:"Service Charges"}),s.jsxs("div",{className:"font-semibold",children:["PKR ",Number(f.serviceCharges||0).toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-500",children:"Pieces"}),s.jsx("div",{className:"font-semibold",children:f.pieces||1})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-500",children:"Payment Type"}),s.jsx("div",{className:"font-semibold",children:f.paymentType||"COD"})]}),f.productDescription&&s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("div",{className:"text-gray-500",children:"Product Description"}),s.jsx("div",{className:"font-semibold",children:f.productDescription})]}),f.remarks&&s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("div",{className:"text-gray-500",children:"Remarks"}),s.jsx("div",{className:"font-semibold",children:f.remarks})]})]})]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Consignee"}),s.jsxs("div",{className:"mt-3 space-y-2 text-sm text-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Kn,{className:"w-4 h-4"})," ",f.consigneeAddress,","," ",f.destinationCity]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Lr,{className:"w-4 h-4"})," ",f.consigneePhone]})]})]})}),s.jsxs("div",{className:"text-xs text-gray-400",children:["Created on ",new Date(f.createdAt).toDateString()]})]})};function hw(){const[u,m]=D.useState(null),[f,y]=D.useState(!1),[C,w]=D.useState(""),E=localStorage.getItem("token"),T=async()=>{y(!0),w("");try{const R=await fetch("/api/integrations/shipper/me",{headers:{Authorization:E?`Bearer ${E}`:""}}),z=await R.json();if(!R.ok)throw new Error(z.message||"Failed to load");m(z)}catch(R){w(R.message)}finally{y(!1)}};D.useEffect(()=>{T()},[]);const N=async()=>{try{const R=await fetch("/api/integrations/shipper/me",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:E?`Bearer ${E}`:""},body:JSON.stringify({enabled:u.enabled,providers:u.providers})}),z=await R.json();if(!R.ok)throw new Error(z.message||"Failed to save");m(z),ks("Integrations saved")}catch(R){bt(R.message||"Failed to save")}},v=async()=>{try{const R=await fetch("/api/integrations/shipper/me/regenerate-key",{method:"POST",headers:{Authorization:E?`Bearer ${E}`:""}}),z=await R.json();if(!R.ok)throw new Error(z.message||"Failed to regenerate key");m(P=>({...P,apiKey:z.apiKey})),ks("API key regenerated")}catch(R){bt(R.message||"Failed to regenerate key")}},A=async()=>{try{await navigator.clipboard.writeText(u.apiKey||""),ks("API Key copied")}catch{bt("Copy failed")}},O=R=>`https://jeanelle-relaxative-lera.ngrok-free.dev/api/integrations/${R.toLowerCase()}/orders?key=${u.apiKey}`;return f?s.jsx("div",{className:"p-6",children:"Loading..."}):C?s.jsx("div",{className:"p-6 text-red-600",children:C}):u?s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-secondary",children:"Integrations"}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[s.jsx("div",{className:"font-semibold",children:"Enable Integrations"}),s.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[s.jsx("input",{type:"checkbox",checked:!!u.enabled,onChange:R=>m(z=>({...z,enabled:R.target.checked}))})," Enabled"]})]})}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-6",children:[s.jsx("div",{className:"font-semibold mb-2",children:"API Key"}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[s.jsx("code",{className:"px-3 py-1.5 bg-gray-50 border border-gray-200 rounded text-sm select-all w-full sm:w-auto mb-2 sm:mb-0 break-all",children:u.apiKey}),s.jsxs("button",{onClick:A,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 w-full sm:w-auto",children:[s.jsx(R2,{className:"w-4 h-4 inline"})," Copy"]}),s.jsx("button",{onClick:v,className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary w-full sm:w-auto",children:"Regenerate"})]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["External systems must send header ",s.jsx("code",{children:"X-LahoreLink-Integration-Key"})," with this value."]})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-6",children:[s.jsx("div",{className:"font-semibold mb-2",children:"Providers"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["SHOPIFY","WOOCOMMERCE","CUSTOM"].map(R=>{const z=(u.providers||[]).findIndex(Z=>Z.provider===R),P=z>=0?u.providers[z]:{enabled:!1},F=Z=>m(ne=>{const Y=[...ne.providers||[]],q=Y.findIndex(oe=>oe.provider===R);return q>=0?Y[q]={...Y[q],...Z}:Y.push({provider:R,...Z}),{...ne,providers:Y}});return s.jsxs("div",{className:"border border-gray-200 rounded p-4",children:[s.jsx("div",{className:"font-semibold mb-2",children:R}),s.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[s.jsx("input",{type:"checkbox",checked:!!P.enabled,onChange:Z=>F({enabled:Z.target.checked})})," Enabled"]}),s.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Webhook URL:"}),s.jsx("code",{className:"text-xs bg-gray-50 border border-gray-200 rounded px-2 py-1 block mt-1 break-all",children:O(R)})]},R)})}),s.jsx("div",{className:"mt-4",children:s.jsx("button",{onClick:N,className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary",children:"Save Changes"})})]})]}):null}const fw=()=>{const{user:u,refreshMe:m,logout:f}=Qs(),y=Gs(),[C,w]=D.useState(!1),[E,T]=D.useState(""),[N,v]=D.useState(()=>u?{role:u.role,portalActive:u.portalActive??null,weightBracketsCount:u.weightBracketsCount??null}:null),A=async()=>{try{w(!0),T("");const z=await m();v({role:z==null?void 0:z.role,portalActive:z==null?void 0:z.portalActive,weightBracketsCount:z==null?void 0:z.weightBracketsCount})}catch(z){if((z==null?void 0:z.status)===401){await f(),y("/",{replace:!0});return}T(z.message||"Failed to fetch status")}finally{w(!1)}},O=async()=>{try{await f()}finally{y("/",{replace:!0})}};D.useEffect(()=>{A()},[]);const R=(N==null?void 0:N.portalActive)===!0;return D.useEffect(()=>{R&&y("/shipper/dashboard",{replace:!0})},[R,y]),s.jsx("div",{className:"min-h-[70vh] flex items-center justify-center",children:s.jsxs("div",{className:"w-full max-w-xl bg-white border border-gray-100 shadow-sm rounded-2xl p-8",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center",children:s.jsx(im,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-secondary",children:"Verification in Progress"}),s.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Your account is under configuration. Please wait until management sets your weight brackets. You will get access once configured."})]})]}),s.jsxs("div",{className:"mt-6 space-y-3",children:[E&&s.jsxs("div",{className:"p-3 rounded-lg bg-red-50 border border-red-100 flex items-center gap-2 text-red-600 text-sm",children:[s.jsx(Ur,{className:"w-4 h-4"}),E]}),s.jsxs("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-200 text-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-gray-600",children:"Portal access"}),s.jsx("div",{className:"font-semibold text-secondary",children:N?R?"ACTIVE":"PENDING":""})]}),s.jsxs("div",{className:"flex items-center justify-between mt-2",children:[s.jsx("div",{className:"text-gray-600",children:"Weight brackets"}),s.jsx("div",{className:"font-semibold text-secondary",children:typeof(N==null?void 0:N.weightBracketsCount)=="number"?N.weightBracketsCount:""})]})]}),s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Contact support if this takes longer than expected."}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(as,{onClick:O,disabled:C,variant:"outline",children:[s.jsx(am,{className:"w-4 h-4"}),"Logout"]}),s.jsxs(as,{onClick:A,disabled:C,variant:"outline",children:[s.jsx(Fr,{className:`w-4 h-4 ${C?"animate-spin":""}`}),"Refresh Status"]})]})]}),R&&s.jsx("div",{className:"p-3 rounded-lg bg-green-50 border border-green-100 text-green-700 text-sm",children:"Your portal is now active. Redirecting you to your dashboard..."})]})]})})},xw=()=>{const[u,m]=D.useState([]),[f,y]=D.useState(!0),[C,w]=D.useState(""),[E,T]=D.useState(""),[N,v]=D.useState(null),[A,O]=D.useState({}),R=typeof window<"u"?localStorage.getItem("token"):null,z=async()=>{y(!0),w("");try{const Y=await fetch("/api/orders/integrated/pending",{headers:{Authorization:R?`Bearer ${R}`:""}}),q=await Y.json();if(!Y.ok)throw new Error((q==null?void 0:q.message)||"Failed to load integrated orders");m(Array.isArray(q)?q:[])}catch(Y){w(Y.message||"Failed to load integrated orders")}finally{y(!1)}};D.useEffect(()=>{z()},[]);const P=D.useMemo(()=>{const Y=E.trim().toLowerCase();return Y?u.filter(q=>String((q==null?void 0:q.bookingId)||"").toLowerCase().includes(Y)||String((q==null?void 0:q.consigneeName)||"").toLowerCase().includes(Y)||String((q==null?void 0:q.destinationCity)||"").toLowerCase().includes(Y)):u},[u,E]),F=Y=>{const q=(Y==null?void 0:Y.bookingState)==="BOOKED",oe=(Y==null?void 0:Y.isDeleted)===!0,Q=oe?"Deleted":q?"Booked":"Pending Approval",te=oe?"bg-red-50 text-red-700 border-red-200":q?"bg-green-50 text-green-700 border-green-200":"bg-amber-50 text-amber-800 border-amber-200";return s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs border ${te}`,children:Q})},Z=async Y=>{try{O(Q=>({...Q,[Y]:!0}));const q=await fetch(`/api/orders/${Y}/book`,{method:"PATCH",headers:{Authorization:R?`Bearer ${R}`:""}}),oe=await q.json();if(!q.ok)throw new Error((oe==null?void 0:oe.message)||"Failed to book order");m(Q=>Q.filter(te=>te._id!==Y))}catch(q){w(q.message||"Failed to book order")}finally{O(q=>({...q,[Y]:!1}))}},ne=async Y=>{try{O(Q=>({...Q,[Y]:!0}));const q=await fetch(`/api/orders/${Y}/reject`,{method:"PATCH",headers:{Authorization:R?`Bearer ${R}`:""}}),oe=await q.json();if(!q.ok)throw new Error((oe==null?void 0:oe.message)||"Failed to delete order");m(Q=>Q.filter(te=>te._id!==Y)),v(null)}catch(q){w(q.message||"Failed to delete order")}finally{O(q=>({...q,[Y]:!1}))}};return s.jsxs("div",{className:"space-y-6",children:[C&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:C}),s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(gt,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Integrated Orders"})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto",children:[s.jsx("input",{value:E,onChange:Y=>T(Y.target.value),type:"text",placeholder:"Search orders...",className:"pl-3 pr-4 py-1.5 text-sm border border-gray-200 rounded-lg w-full sm:w-auto"}),s.jsxs("button",{onClick:z,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 flex items-center gap-2",disabled:f,children:[s.jsx(Fr,{className:`w-4 h-4 ${f?"animate-spin":""}`}),"Refresh"]})]})]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:s.jsx("div",{className:"p-6",children:f?s.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):P.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No integrated orders pending approval."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500",children:[s.jsx("th",{className:"py-2 px-3",children:"Order ID"}),s.jsx("th",{className:"py-2 px-3",children:"Customer"}),s.jsx("th",{className:"py-2 px-3",children:"City"}),s.jsx("th",{className:"py-2 px-3",children:"COD / Amount"}),s.jsx("th",{className:"py-2 px-3",children:"Status"}),s.jsx("th",{className:"py-2 px-3 text-right",children:"Actions"})]})}),s.jsx("tbody",{children:P.map(Y=>{const q=!!A[Y._id],oe=Number((Y==null?void 0:Y.codAmount)||0);return s.jsxs("tr",{className:"border-t border-gray-100",children:[s.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:Y.bookingId}),s.jsx("td",{className:"py-2 px-3 text-secondary",children:Y.consigneeName||""}),s.jsx("td",{className:"py-2 px-3",children:Y.destinationCity||""}),s.jsxs("td",{className:"py-2 px-3",children:["PKR ",oe.toLocaleString()]}),s.jsx("td",{className:"py-2 px-3",children:F(Y)}),s.jsx("td",{className:"py-2 px-3",children:s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>Z(Y._id),disabled:q,className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary disabled:opacity-60",children:q?"Working...":"Book"}),s.jsxs("button",{onClick:()=>v(Y),disabled:q,className:"px-3 py-1.5 text-xs bg-red-50 hover:bg-red-100 text-red-700 rounded border border-red-200 flex items-center gap-2 disabled:opacity-60",children:[s.jsx(lm,{className:"w-4 h-4"})," Delete"]})]})})]},Y._id)})})]})})})}),N&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>v(null),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",onClick:Y=>Y.stopPropagation(),children:[s.jsxs("div",{className:"p-6 border-b border-gray-100",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Confirm Delete"}),s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Are you sure you want to delete this integrated order?"})]}),s.jsxs("div",{className:"p-6 flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>v(null),className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Cancel"}),s.jsx("button",{onClick:()=>ne(N._id),className:"px-3 py-1.5 text-xs bg-red-600 hover:bg-red-700 text-white rounded border border-red-600",disabled:!!A[N._id],children:"Confirm"})]})]})})]})},Ir=u=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0}).format(Number(u||0)),Ex=u=>{if(!u)return"";const m=new Date(u);return Number.isNaN(m.getTime())?"":m.toLocaleString()},mw=()=>{var Ne,M,L,U,V,fe,he,X,se,Ee;const{user:u}=Qs(),m=(u==null?void 0:u.token)||ea(),[f,y]=D.useState(!1),[C,w]=D.useState(!1),[E,T]=D.useState(""),[N,v]=D.useState(null),[A,O]=D.useState({rows:[],totals:null,total:0,page:1,totalPages:1}),[R,z]=D.useState(""),[P,F]=D.useState(""),[Z,ne]=D.useState("ALL"),[Y,q]=D.useState(""),[oe,Q]=D.useState(1),te=20,K=Number((N==null?void 0:N.balance)||0),Te=D.useMemo(()=>{const ye=K>=0;return{positive:ye,colorClass:ye?"text-green-700":"text-red-600",helper:ye?"Payable to Shipper":"Payable by Shipper"}},[K]),re=async()=>{y(!0),T("");try{const ye=await fetch("/api/shipper/finance/summary",{headers:{Authorization:m?`Bearer ${m}`:""}}),Ue=await ye.json();if(!ye.ok)throw new Error(Ue.message||"Failed to load finance summary");v(Ue)}catch(ye){T(ye.message)}finally{y(!1)}},le=async(ye={})=>{w(!0),T("");try{const Ue=new URLSearchParams;(ye.from??R)&&Ue.set("from",ye.from??R),(ye.to??P)&&Ue.set("to",ye.to??P);const Re=ye.paidStatus??Z;(Re==="PAID"||Re==="UNPAID")&&Ue.set("status",Re);const Ge=ye.search??Y;Ge&&String(Ge).trim()&&Ue.set("search",String(Ge).trim());const et=ye.page??oe;Ue.set("page",String(et)),Ue.set("limit",String(te));const ct=await fetch(`/api/shipper/finance/ledger?${Ue.toString()}`,{headers:{Authorization:m?`Bearer ${m}`:""}}),ns=await ct.json();if(!ct.ok)throw new Error(ns.message||"Failed to load ledger");O(ns)}catch(Ue){T(Ue.message)}finally{w(!1)}};D.useEffect(()=>{re()},[m]),D.useEffect(()=>{le({page:oe})},[m,oe]);const Oe=async()=>{Q(1),await le({page:1})},$=async()=>{try{const ye=new URLSearchParams;R&&ye.set("from",R),P&&ye.set("to",P),(Z==="PAID"||Z==="UNPAID")&&ye.set("status",Z),Y&&String(Y).trim()&&ye.set("search",String(Y).trim()),ye.set("format","csv"),ye.set("limit","all");const Ue=await fetch(`/api/shipper/finance/ledger?${ye.toString()}`,{headers:{Authorization:m?`Bearer ${m}`:""}});if(!Ue.ok){const ct=await Ue.json().catch(()=>({}));throw new Error(ct.message||"Failed to download CSV")}const Re=await Ue.blob(),Ge=window.URL.createObjectURL(Re),et=document.createElement("a");et.href=Ge,et.download="shipper-ledger.csv",document.body.appendChild(et),et.click(),et.remove(),window.URL.revokeObjectURL(Ge)}catch(ye){T(ye.message)}},ve=N==null?void 0:N.serviceChargesPolicy;return s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ut,{className:"w-6 h-6 text-green-600"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Finance"})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(as,{variant:"outline",onClick:$,className:"text-xs",children:[s.jsx(kc,{className:"w-4 h-4"}),"Download CSV"]})})]})}),E&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:E}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"p-5 border-b border-gray-100",children:[s.jsx("div",{className:"text-sm font-bold text-secondary",children:"Info"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Shipper profile (read-only)"})]}),s.jsxs("div",{className:"p-5 space-y-3 text-sm",children:[s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("div",{className:"text-gray-500",children:"Name"}),s.jsx("div",{className:"font-medium text-secondary text-right",children:((Ne=N==null?void 0:N.shipper)==null?void 0:Ne.name)||""})]}),s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("div",{className:"text-gray-500",children:"Company"}),s.jsx("div",{className:"font-medium text-secondary text-right",children:((M=N==null?void 0:N.shipper)==null?void 0:M.companyName)||""})]}),s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("div",{className:"text-gray-500",children:"Phone"}),s.jsx("div",{className:"font-medium text-secondary text-right",children:((L=N==null?void 0:N.shipper)==null?void 0:L.phone)||""})]}),s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("div",{className:"text-gray-500",children:"Email"}),s.jsx("div",{className:"font-medium text-secondary text-right",children:((U=N==null?void 0:N.shipper)==null?void 0:U.email)||""})]}),s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("div",{className:"text-gray-500",children:"Address"}),s.jsx("div",{className:"font-medium text-secondary text-right",children:((V=N==null?void 0:N.shipper)==null?void 0:V.address)||""})]}),s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("div",{className:"text-gray-500",children:"CNIC/NTN"}),s.jsx("div",{className:"font-medium text-secondary text-right",children:((fe=N==null?void 0:N.shipper)==null?void 0:fe.cnic)||""})]}),s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("div",{className:"text-gray-500",children:"Account Created"}),s.jsx("div",{className:"font-medium text-secondary text-right",children:Ex((he=N==null?void 0:N.shipper)==null?void 0:he.createdAt)})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"p-5 border-b border-gray-100",children:[s.jsx("div",{className:"text-sm font-bold text-secondary",children:"Services / Charges"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Pricing policy decided by management"})]}),s.jsx("div",{className:"p-5",children:ve?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-gray-700",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Policy"}),s.jsx("div",{className:"font-medium text-secondary",children:"Weight Brackets (PKR / parcel)"})]}),s.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500 border-b bg-gray-50",children:[s.jsx("th",{className:"py-2 px-3",children:"Min (kg)"}),s.jsx("th",{className:"py-2 px-3",children:"Max (kg)"}),s.jsx("th",{className:"py-2 px-3 text-right",children:"Charge"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:(ve.weightBrackets||[]).map((ye,Ue)=>s.jsxs("tr",{children:[s.jsx("td",{className:"py-2 px-3",children:Number(ye.minKg||0)}),s.jsx("td",{className:"py-2 px-3",children:ye.maxKg===null||ye.maxKg===void 0?"":Number(ye.maxKg)}),s.jsx("td",{className:"py-2 px-3 text-right font-medium",children:Ir(ye.charge)})]},Ue))})]})}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Units:",s.jsx("span",{className:"font-medium text-gray-700",children:" PKR per parcel"})]})]}):s.jsx("div",{className:"text-sm text-gray-500",children:"No pricing policy found."})})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"p-5 border-b border-gray-100",children:[s.jsx("div",{className:"text-sm font-bold text-secondary",children:"Balance"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Computed from ledger entries"})]}),s.jsxs("div",{className:"p-6",children:[s.jsx("div",{className:`text-4xl font-extrabold tracking-tight ${Te.colorClass}`,children:f?"":Ir(K)}),s.jsx("div",{className:"mt-2 text-sm text-gray-500",children:Te.helper}),s.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:["Positive/Zero:",s.jsx("span",{className:"text-green-700 font-medium",children:" payable to shipper"}),s.jsx("span",{className:"mx-2",children:"|"}),"Negative:",s.jsx("span",{className:"text-red-600 font-medium",children:" payable by shipper"})]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"p-6 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(C0,{className:"w-4 h-4 text-gray-500"}),s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Ledger / Journal"})]}),s.jsx("div",{className:"text-sm text-gray-500",children:"Newest first"})]}),s.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-5 gap-3",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"From"}),s.jsx("input",{type:"date",value:R,onChange:ye=>z(ye.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"To"}),s.jsx("input",{type:"date",value:P,onChange:ye=>F(ye.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"Paid Status"}),s.jsxs("select",{value:Z,onChange:ye=>ne(ye.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg bg-white",children:[s.jsx("option",{value:"ALL",children:"All"}),s.jsx("option",{value:"PAID",children:"Paid"}),s.jsx("option",{value:"UNPAID",children:"Unpaid"})]})]}),s.jsxs("div",{className:"flex flex-col md:col-span-2",children:[s.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"Search Booking ID"}),s.jsx("input",{value:Y,onChange:ye=>q(ye.target.value),placeholder:"e.g. BKG-000123",className:"px-3 py-2 text-sm border border-gray-200 rounded-lg"})]})]}),s.jsxs("div",{className:"mt-4 flex items-center justify-between flex-wrap gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(as,{onClick:Oe,className:"text-xs",children:"Apply Filters"}),s.jsx(as,{variant:"outline",onClick:()=>{z(""),F(""),ne("ALL"),q(""),Q(1),le({from:"",to:"",paidStatus:"ALL",search:"",page:1})},className:"text-xs",children:"Reset"})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Totals (filtered):",s.jsxs("span",{className:"ml-2",children:["COD: ",s.jsx("span",{className:"font-medium text-secondary",children:Ir(((X=A==null?void 0:A.totals)==null?void 0:X.totalCod)||0)})]}),s.jsxs("span",{className:"ml-2",children:["Charges: ",s.jsx("span",{className:"font-medium text-secondary",children:Ir(((se=A==null?void 0:A.totals)==null?void 0:se.totalServiceCharges)||0)})]}),s.jsxs("span",{className:"ml-2",children:["Receivable: ",s.jsx("span",{className:"font-medium text-secondary",children:Ir(((Ee=A==null?void 0:A.totals)==null?void 0:Ee.totalReceivable)||0)})]})]})]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500 border-b bg-gray-50",children:[s.jsx("th",{className:"py-3 px-4",children:"Date/Time"}),s.jsx("th",{className:"py-3 px-4",children:"Particular"}),s.jsx("th",{className:"py-3 px-4",children:"Booking ID"}),s.jsx("th",{className:"py-3 px-4 text-right",children:"COD Amount"}),s.jsx("th",{className:"py-3 px-4 text-right",children:"Service Charges"}),s.jsx("th",{className:"py-3 px-4 text-right",children:"Receivable"}),s.jsx("th",{className:"py-3 px-4 text-center",children:"Paid"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:C?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"py-10 px-4 text-center text-gray-500",children:"Loading transactions"})}):((A==null?void 0:A.rows)||[]).length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"py-10 px-4 text-center text-gray-500",children:"No transactions found"})}):(A.rows||[]).map(ye=>{const Ue=Number(ye.receivable??ye.amount??0);return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"py-3 px-4 text-xs text-gray-600",children:Ex(ye.date)}),s.jsx("td",{className:"py-3 px-4",children:ye.particular||""}),s.jsx("td",{className:"py-3 px-4 font-mono text-xs",children:ye.bookingId||""}),s.jsx("td",{className:"py-3 px-4 text-right",children:Ir(ye.codAmount??0)}),s.jsx("td",{className:"py-3 px-4 text-right",children:Ir(ye.serviceCharges??0)}),s.jsx("td",{className:`py-3 px-4 text-right font-semibold ${Ue>=0?"text-green-700":"text-red-600"}`,children:Ir(Ue)}),s.jsx("td",{className:"py-3 px-4 text-center",children:s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${ye.status==="PAID"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:ye.status==="PAID"?"Paid":"Unpaid"})})]},ye._id)})})]})}),s.jsxs("div",{className:"p-4 border-t border-gray-100 flex items-center justify-between flex-wrap gap-2",children:[s.jsxs("div",{className:"text-xs text-gray-500",children:["Showing page ",(A==null?void 0:A.page)||1," of ",(A==null?void 0:A.totalPages)||1," (Total ",(A==null?void 0:A.total)||0,")"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>Q(ye=>Math.max(1,ye-1)),disabled:((A==null?void 0:A.page)||1)<=1,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Prev"}),s.jsx("button",{onClick:()=>Q(ye=>Math.min((A==null?void 0:A.totalPages)||1,ye+1)),disabled:((A==null?void 0:A.page)||1)>=((A==null?void 0:A.totalPages)||1),className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})},Ax={0:"101001101101",1:"110100101011",2:"101100101011",3:"110110010101",4:"101001101011",5:"110100110101",6:"101100110101",7:"101001011011",8:"110100101101",9:"101100101101",A:"110101001011",B:"101101001011",C:"110110100101",D:"101011001011",E:"110101100101",F:"101101100101",G:"101010011011",H:"110101001101",I:"101101001101",J:"101011001101",K:"110101010011",L:"101101010011",M:"110110101001",N:"101011010011",O:"110101101001",P:"101101101001",Q:"101010110011",R:"110101011001",S:"101101011001",T:"101011011001",U:"110010101011",V:"100110101011",W:"110011010101",X:"100101101011",Y:"110010110101",Z:"100110110101","-":"100101011011",".":"110010101101"," ":"100110101101",$:"100100100101","/":"100100101001","+":"100101001001","%":"101001001001","*":"100101101101"},Wu=({value:u,height:m=60,barWidth:f=2,targetWidth:y,showValue:C=!0,className:w=""})=>{const E=typeof m=="string"&&m.startsWith("h-"),T=E?m==="h-6"?24:m==="h-8"?32:40:m;if(!u)return s.jsx("div",{className:`${w} ${E?m:""} border border-dashed border-gray-400 flex items-center justify-center text-xs text-gray-500`,children:"[BARCODE]"});const N=`*${String(u).toUpperCase()}*`;let v="";for(const z of N){const P=Ax[z]||Ax["-"];v+=P+"0"}const A=[];let O=0;for(const z of v){const P=f;z==="1"&&A.push(s.jsx("rect",{x:O,y:0,width:P,height:T,fill:"#000"},O)),O+=P}const R=y||O;return s.jsxs("div",{className:w,children:[s.jsx("svg",{width:E?"100%":R,height:E?m:T,viewBox:`0 0 ${O} ${T}`,xmlns:"http://www.w3.org/2000/svg",shapeRendering:"crispEdges",preserveAspectRatio:"none",style:E?{display:"block"}:{},children:A}),C&&u&&s.jsx("div",{className:"text-xs text-center mt-1",children:u})]})};var tl={},Qu={exports:{}},Ju,jx;function gw(){if(jx)return Ju;jx=1;var u="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Ju=u,Ju}var $u,Sx;function pw(){if(Sx)return $u;Sx=1;var u=gw();function m(){}function f(){}return f.resetWarningCache=m,$u=function(){function y(E,T,N,v,A,O){if(O!==u){var R=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw R.name="Invariant Violation",R}}y.isRequired=y;function C(){return y}var w={array:y,bigint:y,bool:y,func:y,number:y,object:y,string:y,symbol:y,any:y,arrayOf:C,element:y,elementType:y,instanceOf:C,node:y,objectOf:C,oneOf:C,oneOfType:C,shape:C,exact:C,checkPropTypes:f,resetWarningCache:m};return w.PropTypes=w,w},$u}var Tx;function vm(){return Tx||(Tx=1,Qu.exports=pw()()),Qu.exports}var e0,Rx;function Nm(){return Rx||(Rx=1,e0={L:1,M:0,Q:3,H:2}),e0}var t0,Ox;function Cm(){return Ox||(Ox=1,t0={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}),t0}var s0,Dx;function yw(){if(Dx)return s0;Dx=1;var u=Cm();function m(f){this.mode=u.MODE_8BIT_BYTE,this.data=f}return m.prototype={getLength:function(f){return this.data.length},write:function(f){for(var y=0;y<this.data.length;y++)f.put(this.data.charCodeAt(y),8)}},s0=m,s0}var a0,_x;function bw(){if(_x)return a0;_x=1;var u=Nm();function m(f,y){this.totalCount=f,this.dataCount=y}return m.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],m.getRSBlocks=function(f,y){var C=m.getRsBlockTable(f,y);if(C==null)throw new Error("bad rs block @ typeNumber:"+f+"/errorCorrectLevel:"+y);for(var w=C.length/3,E=new Array,T=0;T<w;T++)for(var N=C[T*3+0],v=C[T*3+1],A=C[T*3+2],O=0;O<N;O++)E.push(new m(v,A));return E},m.getRsBlockTable=function(f,y){switch(y){case u.L:return m.RS_BLOCK_TABLE[(f-1)*4+0];case u.M:return m.RS_BLOCK_TABLE[(f-1)*4+1];case u.Q:return m.RS_BLOCK_TABLE[(f-1)*4+2];case u.H:return m.RS_BLOCK_TABLE[(f-1)*4+3];default:return}},a0=m,a0}var n0,Ix;function ww(){if(Ix)return n0;Ix=1;function u(){this.buffer=new Array,this.length=0}return u.prototype={get:function(m){var f=Math.floor(m/8);return(this.buffer[f]>>>7-m%8&1)==1},put:function(m,f){for(var y=0;y<f;y++)this.putBit((m>>>f-y-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(m){var f=Math.floor(this.length/8);this.buffer.length<=f&&this.buffer.push(0),m&&(this.buffer[f]|=128>>>this.length%8),this.length++}},n0=u,n0}var r0,Mx;function Em(){if(Mx)return r0;Mx=1;for(var u={glog:function(f){if(f<1)throw new Error("glog("+f+")");return u.LOG_TABLE[f]},gexp:function(f){for(;f<0;)f+=255;for(;f>=256;)f-=255;return u.EXP_TABLE[f]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},m=0;m<8;m++)u.EXP_TABLE[m]=1<<m;for(var m=8;m<256;m++)u.EXP_TABLE[m]=u.EXP_TABLE[m-4]^u.EXP_TABLE[m-5]^u.EXP_TABLE[m-6]^u.EXP_TABLE[m-8];for(var m=0;m<255;m++)u.LOG_TABLE[u.EXP_TABLE[m]]=m;return r0=u,r0}var i0,kx;function Am(){if(kx)return i0;kx=1;var u=Em();function m(f,y){if(f.length==null)throw new Error(f.length+"/"+y);for(var C=0;C<f.length&&f[C]==0;)C++;this.num=new Array(f.length-C+y);for(var w=0;w<f.length-C;w++)this.num[w]=f[w+C]}return m.prototype={get:function(f){return this.num[f]},getLength:function(){return this.num.length},multiply:function(f){for(var y=new Array(this.getLength()+f.getLength()-1),C=0;C<this.getLength();C++)for(var w=0;w<f.getLength();w++)y[C+w]^=u.gexp(u.glog(this.get(C))+u.glog(f.get(w)));return new m(y,0)},mod:function(f){if(this.getLength()-f.getLength()<0)return this;for(var y=u.glog(this.get(0))-u.glog(f.get(0)),C=new Array(this.getLength()),w=0;w<this.getLength();w++)C[w]=this.get(w);for(var w=0;w<f.getLength();w++)C[w]^=u.gexp(u.glog(f.get(w))+y);return new m(C,0).mod(f)}},i0=m,i0}var l0,Bx;function vw(){if(Bx)return l0;Bx=1;var u=Cm(),m=Am(),f=Em(),y={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},C={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(w){for(var E=w<<10;C.getBCHDigit(E)-C.getBCHDigit(C.G15)>=0;)E^=C.G15<<C.getBCHDigit(E)-C.getBCHDigit(C.G15);return(w<<10|E)^C.G15_MASK},getBCHTypeNumber:function(w){for(var E=w<<12;C.getBCHDigit(E)-C.getBCHDigit(C.G18)>=0;)E^=C.G18<<C.getBCHDigit(E)-C.getBCHDigit(C.G18);return w<<12|E},getBCHDigit:function(w){for(var E=0;w!=0;)E++,w>>>=1;return E},getPatternPosition:function(w){return C.PATTERN_POSITION_TABLE[w-1]},getMask:function(w,E,T){switch(w){case y.PATTERN000:return(E+T)%2==0;case y.PATTERN001:return E%2==0;case y.PATTERN010:return T%3==0;case y.PATTERN011:return(E+T)%3==0;case y.PATTERN100:return(Math.floor(E/2)+Math.floor(T/3))%2==0;case y.PATTERN101:return E*T%2+E*T%3==0;case y.PATTERN110:return(E*T%2+E*T%3)%2==0;case y.PATTERN111:return(E*T%3+(E+T)%2)%2==0;default:throw new Error("bad maskPattern:"+w)}},getErrorCorrectPolynomial:function(w){for(var E=new m([1],0),T=0;T<w;T++)E=E.multiply(new m([1,f.gexp(T)],0));return E},getLengthInBits:function(w,E){if(1<=E&&E<10)switch(w){case u.MODE_NUMBER:return 10;case u.MODE_ALPHA_NUM:return 9;case u.MODE_8BIT_BYTE:return 8;case u.MODE_KANJI:return 8;default:throw new Error("mode:"+w)}else if(E<27)switch(w){case u.MODE_NUMBER:return 12;case u.MODE_ALPHA_NUM:return 11;case u.MODE_8BIT_BYTE:return 16;case u.MODE_KANJI:return 10;default:throw new Error("mode:"+w)}else if(E<41)switch(w){case u.MODE_NUMBER:return 14;case u.MODE_ALPHA_NUM:return 13;case u.MODE_8BIT_BYTE:return 16;case u.MODE_KANJI:return 12;default:throw new Error("mode:"+w)}else throw new Error("type:"+E)},getLostPoint:function(w){for(var E=w.getModuleCount(),T=0,N=0;N<E;N++)for(var v=0;v<E;v++){for(var A=0,O=w.isDark(N,v),R=-1;R<=1;R++)if(!(N+R<0||E<=N+R))for(var z=-1;z<=1;z++)v+z<0||E<=v+z||R==0&&z==0||O==w.isDark(N+R,v+z)&&A++;A>5&&(T+=3+A-5)}for(var N=0;N<E-1;N++)for(var v=0;v<E-1;v++){var P=0;w.isDark(N,v)&&P++,w.isDark(N+1,v)&&P++,w.isDark(N,v+1)&&P++,w.isDark(N+1,v+1)&&P++,(P==0||P==4)&&(T+=3)}for(var N=0;N<E;N++)for(var v=0;v<E-6;v++)w.isDark(N,v)&&!w.isDark(N,v+1)&&w.isDark(N,v+2)&&w.isDark(N,v+3)&&w.isDark(N,v+4)&&!w.isDark(N,v+5)&&w.isDark(N,v+6)&&(T+=40);for(var v=0;v<E;v++)for(var N=0;N<E-6;N++)w.isDark(N,v)&&!w.isDark(N+1,v)&&w.isDark(N+2,v)&&w.isDark(N+3,v)&&w.isDark(N+4,v)&&!w.isDark(N+5,v)&&w.isDark(N+6,v)&&(T+=40);for(var F=0,v=0;v<E;v++)for(var N=0;N<E;N++)w.isDark(N,v)&&F++;var Z=Math.abs(100*F/E/E-50)/5;return T+=Z*10,T}};return l0=C,l0}var o0,Lx;function Nw(){if(Lx)return o0;Lx=1;var u=yw(),m=bw(),f=ww(),y=vw(),C=Am();function w(T,N){this.typeNumber=T,this.errorCorrectLevel=N,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var E=w.prototype;return E.addData=function(T){var N=new u(T);this.dataList.push(N),this.dataCache=null},E.isDark=function(T,N){if(T<0||this.moduleCount<=T||N<0||this.moduleCount<=N)throw new Error(T+","+N);return this.modules[T][N]},E.getModuleCount=function(){return this.moduleCount},E.make=function(){if(this.typeNumber<1){var T=1;for(T=1;T<40;T++){for(var N=m.getRSBlocks(T,this.errorCorrectLevel),v=new f,A=0,O=0;O<N.length;O++)A+=N[O].dataCount;for(var O=0;O<this.dataList.length;O++){var R=this.dataList[O];v.put(R.mode,4),v.put(R.getLength(),y.getLengthInBits(R.mode,T)),R.write(v)}if(v.getLengthInBits()<=A*8)break}this.typeNumber=T}this.makeImpl(!1,this.getBestMaskPattern())},E.makeImpl=function(T,N){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var v=0;v<this.moduleCount;v++){this.modules[v]=new Array(this.moduleCount);for(var A=0;A<this.moduleCount;A++)this.modules[v][A]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(T,N),this.typeNumber>=7&&this.setupTypeNumber(T),this.dataCache==null&&(this.dataCache=w.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,N)},E.setupPositionProbePattern=function(T,N){for(var v=-1;v<=7;v++)if(!(T+v<=-1||this.moduleCount<=T+v))for(var A=-1;A<=7;A++)N+A<=-1||this.moduleCount<=N+A||(0<=v&&v<=6&&(A==0||A==6)||0<=A&&A<=6&&(v==0||v==6)||2<=v&&v<=4&&2<=A&&A<=4?this.modules[T+v][N+A]=!0:this.modules[T+v][N+A]=!1)},E.getBestMaskPattern=function(){for(var T=0,N=0,v=0;v<8;v++){this.makeImpl(!0,v);var A=y.getLostPoint(this);(v==0||T>A)&&(T=A,N=v)}return N},E.createMovieClip=function(T,N,v){var A=T.createEmptyMovieClip(N,v),O=1;this.make();for(var R=0;R<this.modules.length;R++)for(var z=R*O,P=0;P<this.modules[R].length;P++){var F=P*O,Z=this.modules[R][P];Z&&(A.beginFill(0,100),A.moveTo(F,z),A.lineTo(F+O,z),A.lineTo(F+O,z+O),A.lineTo(F,z+O),A.endFill())}return A},E.setupTimingPattern=function(){for(var T=8;T<this.moduleCount-8;T++)this.modules[T][6]==null&&(this.modules[T][6]=T%2==0);for(var N=8;N<this.moduleCount-8;N++)this.modules[6][N]==null&&(this.modules[6][N]=N%2==0)},E.setupPositionAdjustPattern=function(){for(var T=y.getPatternPosition(this.typeNumber),N=0;N<T.length;N++)for(var v=0;v<T.length;v++){var A=T[N],O=T[v];if(this.modules[A][O]==null)for(var R=-2;R<=2;R++)for(var z=-2;z<=2;z++)R==-2||R==2||z==-2||z==2||R==0&&z==0?this.modules[A+R][O+z]=!0:this.modules[A+R][O+z]=!1}},E.setupTypeNumber=function(T){for(var N=y.getBCHTypeNumber(this.typeNumber),v=0;v<18;v++){var A=!T&&(N>>v&1)==1;this.modules[Math.floor(v/3)][v%3+this.moduleCount-8-3]=A}for(var v=0;v<18;v++){var A=!T&&(N>>v&1)==1;this.modules[v%3+this.moduleCount-8-3][Math.floor(v/3)]=A}},E.setupTypeInfo=function(T,N){for(var v=this.errorCorrectLevel<<3|N,A=y.getBCHTypeInfo(v),O=0;O<15;O++){var R=!T&&(A>>O&1)==1;O<6?this.modules[O][8]=R:O<8?this.modules[O+1][8]=R:this.modules[this.moduleCount-15+O][8]=R}for(var O=0;O<15;O++){var R=!T&&(A>>O&1)==1;O<8?this.modules[8][this.moduleCount-O-1]=R:O<9?this.modules[8][15-O-1+1]=R:this.modules[8][15-O-1]=R}this.modules[this.moduleCount-8][8]=!T},E.mapData=function(T,N){for(var v=-1,A=this.moduleCount-1,O=7,R=0,z=this.moduleCount-1;z>0;z-=2)for(z==6&&z--;;){for(var P=0;P<2;P++)if(this.modules[A][z-P]==null){var F=!1;R<T.length&&(F=(T[R]>>>O&1)==1);var Z=y.getMask(N,A,z-P);Z&&(F=!F),this.modules[A][z-P]=F,O--,O==-1&&(R++,O=7)}if(A+=v,A<0||this.moduleCount<=A){A-=v,v=-v;break}}},w.PAD0=236,w.PAD1=17,w.createData=function(T,N,v){for(var A=m.getRSBlocks(T,N),O=new f,R=0;R<v.length;R++){var z=v[R];O.put(z.mode,4),O.put(z.getLength(),y.getLengthInBits(z.mode,T)),z.write(O)}for(var P=0,R=0;R<A.length;R++)P+=A[R].dataCount;if(O.getLengthInBits()>P*8)throw new Error("code length overflow. ("+O.getLengthInBits()+">"+P*8+")");for(O.getLengthInBits()+4<=P*8&&O.put(0,4);O.getLengthInBits()%8!=0;)O.putBit(!1);for(;!(O.getLengthInBits()>=P*8||(O.put(w.PAD0,8),O.getLengthInBits()>=P*8));)O.put(w.PAD1,8);return w.createBytes(O,A)},w.createBytes=function(T,N){for(var v=0,A=0,O=0,R=new Array(N.length),z=new Array(N.length),P=0;P<N.length;P++){var F=N[P].dataCount,Z=N[P].totalCount-F;A=Math.max(A,F),O=Math.max(O,Z),R[P]=new Array(F);for(var ne=0;ne<R[P].length;ne++)R[P][ne]=255&T.buffer[ne+v];v+=F;var Y=y.getErrorCorrectPolynomial(Z),q=new C(R[P],Y.getLength()-1),oe=q.mod(Y);z[P]=new Array(Y.getLength()-1);for(var ne=0;ne<z[P].length;ne++){var Q=ne+oe.getLength()-z[P].length;z[P][ne]=Q>=0?oe.get(Q):0}}for(var te=0,ne=0;ne<N.length;ne++)te+=N[ne].totalCount;for(var K=new Array(te),Te=0,ne=0;ne<A;ne++)for(var P=0;P<N.length;P++)ne<R[P].length&&(K[Te++]=R[P][ne]);for(var ne=0;ne<O;ne++)for(var P=0;P<N.length;P++)ne<z[P].length&&(K[Te++]=z[P][ne]);return K},o0=w,o0}var Dc={},Px;function Cw(){if(Px)return Dc;Px=1,Object.defineProperty(Dc,"__esModule",{value:!0});var u=Object.assign||function(v){for(var A=1;A<arguments.length;A++){var O=arguments[A];for(var R in O)Object.prototype.hasOwnProperty.call(O,R)&&(v[R]=O[R])}return v},m=vm(),f=w(m),y=lo(),C=w(y);function w(v){return v&&v.__esModule?v:{default:v}}function E(v,A){var O={};for(var R in v)A.indexOf(R)>=0||Object.prototype.hasOwnProperty.call(v,R)&&(O[R]=v[R]);return O}var T={bgColor:f.default.oneOfType([f.default.object,f.default.string]).isRequired,bgD:f.default.string.isRequired,fgColor:f.default.oneOfType([f.default.object,f.default.string]).isRequired,fgD:f.default.string.isRequired,size:f.default.number.isRequired,title:f.default.string,viewBoxSize:f.default.number.isRequired,xmlns:f.default.string},N=(0,y.forwardRef)(function(v,A){var O=v.bgColor,R=v.bgD,z=v.fgD,P=v.fgColor,F=v.size,Z=v.title,ne=v.viewBoxSize,Y=v.xmlns,q=Y===void 0?"http://www.w3.org/2000/svg":Y,oe=E(v,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return C.default.createElement("svg",u({},oe,{height:F,ref:A,viewBox:"0 0 "+ne+" "+ne,width:F,xmlns:q}),Z?C.default.createElement("title",null,Z):null,C.default.createElement("path",{d:R,fill:O}),C.default.createElement("path",{d:z,fill:P}))});return N.displayName="QRCodeSvg",N.propTypes=T,Dc.default=N,Dc}var Fx;function Ew(){if(Fx)return tl;Fx=1,Object.defineProperty(tl,"__esModule",{value:!0}),tl.QRCode=void 0;var u=Object.assign||function(F){for(var Z=1;Z<arguments.length;Z++){var ne=arguments[Z];for(var Y in ne)Object.prototype.hasOwnProperty.call(ne,Y)&&(F[Y]=ne[Y])}return F},m=vm(),f=O(m),y=Nm(),C=O(y),w=Nw(),E=O(w),T=lo(),N=O(T),v=Cw(),A=O(v);function O(F){return F&&F.__esModule?F:{default:F}}function R(F,Z){var ne={};for(var Y in F)Z.indexOf(Y)>=0||Object.prototype.hasOwnProperty.call(F,Y)&&(ne[Y]=F[Y]);return ne}var z={bgColor:f.default.oneOfType([f.default.object,f.default.string]),fgColor:f.default.oneOfType([f.default.object,f.default.string]),level:f.default.string,size:f.default.number,value:f.default.string.isRequired},P=(0,T.forwardRef)(function(F,Z){var ne=F.bgColor,Y=ne===void 0?"#FFFFFF":ne,q=F.fgColor,oe=q===void 0?"#000000":q,Q=F.level,te=Q===void 0?"L":Q,K=F.size,Te=K===void 0?256:K,re=F.value,le=R(F,["bgColor","fgColor","level","size","value"]),Oe=new E.default(-1,C.default[te]);Oe.addData(re),Oe.make();var $=Oe.modules;return N.default.createElement(A.default,u({},le,{bgColor:Y,bgD:$.map(function(ve,Ne){return ve.map(function(M,L){return M?"":"M "+L+" "+Ne+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:oe,fgD:$.map(function(ve,Ne){return ve.map(function(M,L){return M?"M "+L+" "+Ne+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:Z,size:Te,viewBoxSize:$.length}))});return tl.QRCode=P,P.displayName="QRCode",P.propTypes=z,tl.default=P,tl}var Aw=Ew();const jw=zc(Aw),Ux=({value:u,size:m="w-8 h-8"})=>u?s.jsx("div",{className:`${m} flex items-center justify-center bg-white p-1`,children:s.jsx(jw,{value:u,size:256,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 256 256"})}):null,Sw=()=>{const{id:u}=Vc(),m=sn(),f=Gs(),[y,C]=D.useState(null),[w,E]=D.useState(null),[T,N]=D.useState(""),v=typeof window<"u"?localStorage.getItem("token"):null,A=async()=>{N("");try{const z=new URLSearchParams(m.search).get("ids");if(z){const P=await fetch(`/api/orders/labels?ids=${encodeURIComponent(z)}`,{headers:{Authorization:v?`Bearer ${v}`:""}}),F=await P.json();if(!P.ok)throw new Error(F.message||"Failed to load labels");E(F.labels||[])}else{const P=await fetch(`/api/orders/${u}/label`,{headers:{Authorization:v?`Bearer ${v}`:""}}),F=await P.json();if(!P.ok)throw new Error(F.message||"Failed to load label");C(F)}}catch(R){N(R.message)}};if(D.useEffect(()=>{A()},[u,m.search]),D.useEffect(()=>{w&&w.length>0&&setTimeout(()=>{try{window.print()}catch{}},200)},[w]),D.useEffect(()=>{},[]),T)return s.jsx("div",{className:"p-6 text-red-600",children:T});if(!y&&!w)return s.jsx("div",{className:"p-6",children:"Loading..."});const O=R=>{var L,U,V,fe,he,X,se,Ee,ye,Ue,Re,Ge,et,ct,ns,Dt,Js,dt,Ns;const z=(L=R.order)!=null&&L.createdAt?new Date(R.order.createdAt).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],P=Number(((U=R.order)==null?void 0:U.codAmount)||0),F=((V=R.order)==null?void 0:V.remarks)||((fe=R.order)!=null&&fe.fragile?"FRAGILE - Handle with care":"Allow to open in front of rider"),Z=((he=R.order)==null?void 0:he.productDescription)||"N/A",ne=((X=R.consignee)==null?void 0:X.name)||"N/A",Y=((se=R.consignee)==null?void 0:se.phone)||"N/A",q=((Ee=R.consignee)==null?void 0:Ee.address)||"N/A",oe=((ye=R.consignee)==null?void 0:ye.destinationCity)||"N/A",Q=R.bookingId||"N/A",te=((Ue=R.shipper)==null?void 0:Ue.name)||"N/A",K=((Re=R.shipper)==null?void 0:Re.address)||((Ge=R.shipper)==null?void 0:Ge.companyName)||"N/A",Te=((et=R.shipper)==null?void 0:et.phone)||"N/A",re=R.trackingId||"N/A",le=((ct=R.order)==null?void 0:ct.paymentType)||((ns=R.shipper)==null?void 0:ns.serviceType)||"COD",Oe=(((Dt=R.order)==null?void 0:Dt.weightKg)||((Js=R.order)==null?void 0:Js.weight)||"0.5")+" KG",$=(dt=R.order)!=null&&dt.fragile?"true":"false",ve=((Ns=R.order)==null?void 0:Ns.pieces)||1,Ne=`LLL|${Q}`;return s.jsxs("div",{className:"bg-white text-black w-full max-w-[800px] border-2 border-black box-border shadow-lg mx-auto print:shadow-none",children:[s.jsxs("div",{className:"grid grid-cols-12 divide-x-2 divide-black",children:[s.jsxs("div",{className:"col-span-4 flex flex-col",children:[s.jsx("div",{className:"border-b-2 border-black text-center font-bold text-sm py-1",children:"Customer Information"}),s.jsxs("div",{className:"p-2 text-xs leading-snug flex-grow",children:[s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"font-bold text-gray-600 mr-1",children:"Name:"}),s.jsx("span",{className:"font-bold",children:ne})]}),s.jsxs("div",{className:"mb-1",children:[s.jsx("span",{className:"font-bold text-gray-600 mr-1",children:"Phone:"}),s.jsx("span",{className:"font-bold",children:Y})]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("span",{className:"font-bold text-gray-600 mr-1",children:"Address:"}),s.jsx("span",{children:q})]}),s.jsx("div",{className:"border-t border-black my-1"}),s.jsxs("div",{className:"font-bold text-sm mt-1",children:["Destination: ",oe]}),s.jsx("div",{className:"border-t border-black my-1"}),s.jsxs("div",{className:"mt-2",children:[s.jsxs("span",{className:"font-bold",children:["Order: ",Q]}),s.jsx("div",{className:"mt-1 w-3/4",children:s.jsx(Wu,{value:String(Q).replace(/[^0-9]/g,""),height:"h-6",showValue:!1})}),Q!=="N/A"&&s.jsx("div",{className:"mt-1 flex justify-center",children:s.jsx(Ux,{value:Ne,size:"w-[70px] h-[70px]"})})]})]})]}),s.jsxs("div",{className:"col-span-4 flex flex-col",children:[s.jsx("div",{className:"border-b-2 border-black text-center font-bold text-sm py-1",children:"Brand Information"}),s.jsxs("div",{className:"p-2 text-[10px] leading-tight font-condensed",children:[s.jsxs("div",{className:"flex justify-between items-start mb-1",children:[s.jsxs("span",{className:"font-bold",children:["Shipper: ",te]}),s.jsx("span",{className:"font-bold",children:Te})]}),s.jsxs("div",{className:"mb-2",children:[s.jsx("span",{className:"font-bold mr-1",children:"Shipper Address:"}),s.jsx("span",{children:K})]})]}),s.jsxs("div",{className:"border-t-2 border-black flex-grow flex flex-col items-center justify-center p-2",children:[s.jsxs("div",{className:"font-black text-lg mb-1",children:["Amount: Rs ",P.toLocaleString()]}),s.jsx("div",{className:"w-3/4",children:s.jsx(Wu,{value:String(P).replace(/[^0-9]/g,""),height:"h-8",showValue:!1})})]})]}),s.jsxs("div",{className:"col-span-4 flex flex-col",children:[s.jsx("div",{className:"border-b-2 border-black text-center font-bold text-sm py-1",children:"Parcel Information"}),s.jsxs("div",{className:"flex items-center justify-between px-2 py-2 border-b border-black",children:[s.jsx("div",{className:"flex items-center",children:s.jsx("img",{src:"/logo.png",alt:"Company Logo",className:"h-[74px]"})}),Q!=="N/A"&&s.jsx("div",{className:"flex flex-col items-center",children:s.jsx(Ux,{value:"https://lahorelinklogistics.com",size:"w-[70px] h-[70px]"})})]}),s.jsx("div",{className:"p-2 flex flex-col items-center border-b border-black",children:s.jsx("div",{className:"w-full",children:s.jsx(Wu,{value:String(re).replace(/[^0-9]/g,""),height:"h-10",className:"w-full"})})}),s.jsxs("div",{className:"flex-grow text-xs font-bold",children:[s.jsxs("div",{className:"p-1 border-b border-black",children:["Service: ",le]}),s.jsxs("div",{className:"grid grid-cols-2 border-b border-black",children:[s.jsxs("div",{className:"p-1 border-r border-black",children:["Date: ",z]}),s.jsxs("div",{className:"p-1 text-right",children:["Weight: ",Oe]})]}),s.jsxs("div",{className:"grid grid-cols-2",children:[s.jsxs("div",{className:"p-1 border-r border-black",children:["Fragile: ",$]}),s.jsxs("div",{className:"p-1 text-right",children:["Pieces: ",ve]})]})]})]})]}),s.jsxs("div",{className:"border-t-2 border-black p-1 text-xs",children:[s.jsx("span",{className:"font-bold mr-1",children:"Remarks:"}),s.jsxs("span",{className:"font-bold",children:["- ",F]})]}),s.jsxs("div",{className:"border-t-2 border-black p-0.5 text-[10px] leading-tight font-condensed h-10 overflow-hidden",children:[s.jsx("span",{className:"font-bold mr-1",children:"Products:"}),s.jsx("span",{children:Z!=="N/A"?`[ ${ve} x ${Z} ]`:"[Product information not available]"})]})]})};return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:`
        /* Screen */
        .no-print { display: inline-flex; }
        @media print { .no-print { display: none !important; } }

        /* Print: only label content */
        @media print {
          body * { visibility: hidden !important; }
          #label-root, #label-root * { visibility: visible !important; }
          #label-root { position: absolute; left: 0; top: 0; width: 100%; margin: 0; padding: 0; }
          .space-y-6 > * + * { margin-top: 0 !important; }
          .print\\:space-y-0 > * + * { margin-top: 0 !important; }
          .print\\:mb-0 { margin-bottom: 0 !important; }
          .print\\:page-break-after-always { page-break-after: always; }
        }
        @page { size: A4 portrait; margin: 8mm; }
      `}),s.jsxs("div",{className:"flex justify-between px-6 pt-6",children:[s.jsx("button",{className:"no-print px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>f(-1),children:"Back"}),s.jsx("button",{className:"no-print px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary",onClick:()=>window.print(),children:"Print"})]}),s.jsx("div",{id:"label-root",className:"p-8 print:p-0",children:w?s.jsx("div",{className:"w-full space-y-6 print:space-y-0",children:w.map((R,z)=>s.jsx("div",{className:"w-full flex justify-center mb-6 print:mb-0 print:page-break-after-always",children:O(R)},z))}):s.jsx("div",{className:"w-full flex justify-center",children:y&&O(y)})})]})},Tw=()=>{const[u,m]=D.useState([]),[f,y]=D.useState(!0),[C,w]=D.useState(""),[E,T]=D.useState(null),[N,v]=D.useState(""),[A,O]=D.useState([]),[R,z]=D.useState(null),P=typeof window<"u"?localStorage.getItem("token"):null,F=T0(),Z=async()=>{y(!0),w("");try{const V=await fetch("/api/orders",{headers:{Authorization:P?`Bearer ${P}`:""}}),fe=await V.json();if(!V.ok)throw new Error(fe.message||"Failed to fetch orders");m(fe)}catch(V){w(V.message)}finally{y(!1)}},ne=async()=>{try{const V=await fetch("/api/finance/summary/rider/me",{headers:{Authorization:P?`Bearer ${P}`:""}}),fe=await V.json();V.ok&&T(fe)}catch{}},Y=async V=>{if(V&&V.preventDefault(),z(null),!!N.trim())try{const fe=await fetch(`/api/orders?q=${encodeURIComponent(N.trim())}`,{headers:{Authorization:P?`Bearer ${P}`:""}}),he=await fe.json();fe.ok&&Array.isArray(he)&&he.length>0?z(he[0]):z({notFound:!0})}catch{}};D.useEffect(()=>{Z(),ne()},[]);const q=Gs();D.useEffect(()=>{const V=N.trim().toLowerCase();if(V.length<2){O([]);return}O(u.filter(fe=>{var he,X,se,Ee;return((he=fe.bookingId)==null?void 0:he.toLowerCase().includes(V))||((X=fe.trackingId)==null?void 0:X.toLowerCase().includes(V))||((se=fe.consigneeName)==null?void 0:se.toLowerCase().includes(V))||((Ee=fe.destinationCity)==null?void 0:Ee.toLowerCase().includes(V))}).slice(0,8))},[N,u]);const oe=async(V,fe)=>{try{const he=await fetch(`/api/orders/${V}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:P?`Bearer ${P}`:""},body:JSON.stringify({status:fe})}),X=await he.json();if(!he.ok)throw new Error(X.message||"Failed to update status");await Z()}catch(he){w(he.message)}},Q=V=>{const fe=Number(V);return Number.isNaN(fe)?"":fe.toLocaleString()},te=D.useMemo(()=>u.filter(V=>new Date(V.createdAt).toDateString()===new Date().toDateString()).length,[u]);D.useMemo(()=>u.filter(V=>V.status==="DELIVERED").length,[u]),D.useMemo(()=>u.filter(V=>V.status==="RETURNED").length,[u]),D.useMemo(()=>u.filter(V=>!["DELIVERED","RETURNED"].includes(V.status)).length,[u]),D.useMemo(()=>u.filter(V=>V.status==="OUT_FOR_DELIVERY").length,[u]),D.useMemo(()=>u.filter(V=>["FIRST_ATTEMPT","SECOND_ATTEMPT","THIRD_ATTEMPT","FAILED"].includes(V.status)).length,[u]);const K=[{label:"7 DAYS",value:"7days"},{label:"15 DAYS",value:"15days"},{label:"30 DAYS",value:"30days"}],[Te,re]=D.useState("7days"),le=D.useMemo(()=>{let V=new Date;return V.setHours(0,0,0,0),Te==="7days"?V.setDate(V.getDate()-6):Te==="15days"?V.setDate(V.getDate()-14):Te==="30days"&&V.setDate(V.getDate()-29),u.filter(fe=>{const he=new Date(fe.createdAt);return he.setHours(0,0,0,0),he.getTime()>=V.getTime()})},[u,Te]),Oe=D.useMemo(()=>le.filter(V=>V.status==="DELIVERED").length,[le]),$=D.useMemo(()=>le.filter(V=>V.status==="RETURNED").length,[le]),ve=D.useMemo(()=>le.filter(V=>V.status==="OUT_FOR_DELIVERY").length,[le]),Ne=D.useMemo(()=>le.filter(V=>["FIRST_ATTEMPT","SECOND_ATTEMPT","THIRD_ATTEMPT","FAILED"].includes(V.status)).length,[le]),M=D.useMemo(()=>le.filter(V=>!["DELIVERED","RETURNED"].includes(V.status)).length,[le]),L=()=>{var V,fe,he,X,se;return s.jsx("div",{className:"space-y-8",children:s.jsx(S0,{heroTitle:Te==="7days"?"7 Days Tasks":Te==="15days"?"15 Days Tasks":"30 Days Tasks",heroCount:le.length,onRefresh:Z,kpis:[{prefix:"PKR",value:Q(((V=E==null?void 0:E.totals)==null?void 0:V.todayCodCollected)||0),label:"COD Today"},{value:M,label:"Pending"},{value:le.length,label:"Total Orders"}],periodOptions:K,activePeriod:Te,onPeriodChange:Ee=>re(Ee),statCards:[{key:"today",icon:bn,title:"Assigned Today",value:te,colorClass:"text-gray-600"},{key:"outForDelivery",icon:ds,title:"Out for Delivery",value:ve,colorClass:"text-cyan-600"},{key:"delivered",icon:h0,title:"Delivered",value:Oe,colorClass:"text-green-700"},{key:"returned",icon:x0,title:"Returned",value:$,colorClass:"text-orange-600"},{key:"attempted",icon:bn,title:"Attempts",value:Ne,colorClass:"text-red-500"},...E?[{key:"codToday",icon:Ut,title:"COD Today",value:`PKR ${Q(((fe=E==null?void 0:E.totals)==null?void 0:fe.todayCodCollected)||0)}`,colorClass:"text-green-600"},{key:"totalCod",icon:Ut,title:"Total COD",value:`PKR ${Q(((he=E==null?void 0:E.totals)==null?void 0:he.totalCodCollected)||0)}`,colorClass:"text-emerald-600"},{key:"settledCount",icon:Ut,title:"Settled",value:(X=E==null?void 0:E.totals)==null?void 0:X.settledCount,colorClass:"text-indigo-600"},{key:"pendingCountFinance",icon:Ut,title:"Pending",value:(se=E==null?void 0:E.totals)==null?void 0:se.pendingCount,colorClass:"text-amber-600"}]:[]]})})},U=()=>{var V,fe;return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(ds,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Rider Dashboard"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("form",{onSubmit:Y,className:"relative",children:[s.jsx(A0,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),s.jsx("input",{value:N,onChange:he=>v(he.target.value),type:"text",placeholder:"Enter Booking/Tracking ID",className:"pl-9 pr-4 py-1.5 text-sm border border-gray-200 rounded-lg"}),A.length>0&&s.jsx("ul",{className:"absolute left-0 top-full mt-1 w-72 bg-white border border-gray-200 rounded-lg shadow z-10",children:A.map(he=>s.jsxs("li",{className:"px-3 py-2 text-sm hover:bg-gray-50 cursor-pointer",onMouseDown:()=>z(he),children:[s.jsx("span",{className:"font-mono text-xs mr-2",children:he.bookingId}),s.jsx("span",{children:he.consigneeName}),s.jsxs("span",{className:"text-xs text-gray-500",children:["  ",he.destinationCity]})]},he._id))})]}),s.jsx("button",{onClick:Z,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]})]}),s.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Overview of assigned orders."})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Today"}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:u.filter(he=>new Date(he.createdAt).toDateString()===new Date().toDateString()).length})]}),s.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Delivered"}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:u.filter(he=>he.status==="DELIVERED").length})]}),s.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Returned"}),s.jsx("h3",{className:"text-2xl font-bold text-secondary",children:u.filter(he=>he.status==="RETURNED").length})]}),E&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 md:col-span-3",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:"COD Today"}),s.jsxs("h3",{className:"text-xl font-bold text-secondary",children:["PKR ",Number(E.totals.todayCodCollected||0).toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Total COD"}),s.jsxs("h3",{className:"text-xl font-bold text-secondary",children:["PKR ",Number(E.totals.totalCodCollected||0).toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Settled"}),s.jsx("h3",{className:"text-xl font-bold text-secondary",children:E.totals.settledCount})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Pending"}),s.jsx("h3",{className:"text-xl font-bold text-secondary",children:E.totals.pendingCount})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h4",{className:"font-semibold text-sm text-secondary",children:"Recent Payments"}),s.jsx("ul",{className:"mt-2 space-y-2",children:(E.transactions||[]).slice(0,5).map(he=>s.jsxs("li",{className:"flex justify-between text-sm",children:[s.jsxs("span",{children:["PKR ",Number(he.totalCodCollected||0).toLocaleString()]}),s.jsx("span",{className:"text-xs",children:he.settlementStatus})]},he._id))})]})]})})]}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary mb-3",children:"All Orders"}),C&&s.jsx("p",{className:"text-sm text-red-600",children:C}),f?s.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):u.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"No assigned orders."}):s.jsx("ul",{className:"space-y-3",children:u.map(he=>s.jsxs("li",{className:"border border-gray-100 rounded-lg p-4 cursor-pointer hover:bg-gray-50",onClick:()=>q(`/rider/task/${he._id}`),children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-mono text-xs",children:he.bookingId}),s.jsx("span",{className:"text-xs",children:he.status})]}),s.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-2 mt-1",children:[s.jsx(Kn,{className:"w-3 h-3"}),s.jsxs("span",{children:[he.consigneeAddress,"  ",he.destinationCity]})]}),s.jsxs("div",{className:"mt-2 text-right text-sm font-semibold text-secondary",children:["PKR ",Number(he.codAmount||0).toLocaleString()]}),he.status!=="DELIVERED"&&he.status!=="RETURNED"&&s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsx("button",{onClick:()=>oe(he._id,"FIRST_ATTEMPT"),className:"px-3 py-1.5 text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 rounded",children:"1st Attempt"}),s.jsx("button",{onClick:()=>oe(he._id,"SECOND_ATTEMPT"),className:"px-3 py-1.5 text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 rounded",children:"2nd Attempt"}),s.jsx("button",{onClick:()=>oe(he._id,"THIRD_ATTEMPT"),className:"px-3 py-1.5 text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 rounded",children:"3rd Attempt"}),s.jsxs("button",{onClick:()=>oe(he._id,"DELIVERED"),className:"px-3 py-1.5 text-xs bg-green-600 hover:bg-green-700 text-white rounded",children:[s.jsx(h0,{className:"w-4 h-4 inline"})," Delivered"]}),s.jsxs("button",{onClick:()=>oe(he._id,"RETURNED"),className:"px-3 py-1.5 text-xs bg-red-600 hover:bg-red-700 text-white rounded",children:[s.jsx(x0,{className:"w-4 h-4 inline"})," Return"]})]})]},he._id))})]})}),R&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>z(null),children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden",onClick:he=>he.stopPropagation(),children:[s.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Order Detail"}),s.jsx("button",{onClick:()=>z(null),className:"text-gray-400 hover:text-gray-600",children:""})]}),s.jsx("div",{className:"p-6 space-y-2 text-sm",children:R.notFound?s.jsx("p",{className:"text-red-600",children:"No order found"}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Business:"})," ",((V=R.shipper)==null?void 0:V.companyName)||((fe=R.shipper)==null?void 0:fe.name)]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Booking ID:"})," ",s.jsx("span",{className:"font-mono",children:R.bookingId})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Tracking ID:"})," ",s.jsx("span",{className:"font-mono",children:R.trackingId})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Consignee:"})," ",R.consigneeName,"  ",R.destinationCity]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Address:"})," ",R.consigneeAddress]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Phone:"})," ",R.consigneePhone]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Service Type:"})," ",R.serviceType]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Pieces:"})," ",R.pieces]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Fragile:"})," ",R.fragile?"Yes":"No"]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Remarks:"})," ",R.remarks||""]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Payment Type:"})," ",R.paymentType]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"COD:"})," Rs ",Number(R.codAmount||0).toLocaleString()]}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Status: ",R.status]})]})}),s.jsx("div",{className:"p-4 flex justify-end gap-2 border-t border-gray-100",children:s.jsx("button",{className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>z(null),children:"Close"})})]})})]})};return F?s.jsx(L,{}):s.jsx(U,{})},Rw=()=>{const[u,m]=D.useState([]),[f,y]=D.useState(!0),[C,w]=D.useState(""),E=typeof window<"u"?localStorage.getItem("token"):null,T=async()=>{y(!0),w("");try{const N=await fetch("/api/orders",{headers:{Authorization:E?`Bearer ${E}`:""}}),v=await N.json();if(!N.ok)throw new Error(v.message||"Failed to fetch orders");m(v)}catch(N){w(N.message)}finally{y(!1)}};return D.useEffect(()=>{T()},[]),s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(gt,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"All Orders"})]})}),s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[C&&s.jsx("p",{className:"text-sm text-red-600",children:C}),f?s.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):s.jsx("ul",{className:"space-y-3",children:u.map(N=>s.jsxs("li",{className:"border border-gray-100 rounded-lg p-4 flex justify-between",children:[s.jsxs("span",{className:"text-sm text-gray-700",children:[N.consigneeName,"  ",N.destinationCity]}),s.jsx("span",{className:"text-xs",children:N.status})]},N._id))})]})]})},Ow=()=>{const{id:u}=Vc(),m=Gs(),[f,y]=D.useState(null),[C,w]=D.useState(!0),[E,T]=D.useState(""),N=typeof window<"u"?localStorage.getItem("token"):null,v=async()=>{w(!0),T("");try{const R=await fetch(`/api/orders/${u}`,{headers:{Authorization:N?`Bearer ${N}`:""}}),z=await R.json();if(!R.ok)throw new Error(z.message||"Failed to fetch order");y(z)}catch(R){T(R.message)}finally{w(!1)}};D.useEffect(()=>{v()},[u]);const A=async R=>{try{const z=await fetch(`/api/orders/${u}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:N?`Bearer ${N}`:""},body:JSON.stringify({status:R})}),P=await z.json();if(!z.ok)throw new Error(P.message||"Failed to update status");y(P)}catch(z){T(z.message)}};if(C)return s.jsx("div",{className:"p-6",children:"Loading..."});if(E)return s.jsx("div",{className:"p-6 text-red-600 text-sm",children:E});if(!f)return null;const O=Number(f.codAmount||0).toLocaleString();return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-secondary text-white rounded-2xl p-6 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs opacity-80",children:"Collect Cash"}),s.jsxs("div",{className:"text-3xl font-bold",children:["PKR ",O]})]}),s.jsx("button",{onClick:()=>m(-1),className:"p-2 bg-white/10 rounded-lg",children:s.jsx(f2,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-secondary",children:f.consigneeName}),s.jsx("p",{className:"text-xs text-gray-500",children:f.bookingId})]}),s.jsx(wm,{status:f.status})]}),s.jsxs("div",{className:"mt-3 space-y-2 text-sm text-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Kn,{className:"w-4 h-4"})," ",f.consigneeAddress,"  ",f.destinationCity]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Lr,{className:"w-4 h-4"})," ",f.consigneePhone]}),s.jsxs("div",{children:["Service Type: ",f.serviceType]}),s.jsxs("div",{children:["Pieces: ",f.pieces]}),s.jsxs("div",{children:["Fragile: ",f.fragile?"Yes":"No"]}),s.jsxs("div",{children:["Remarks: ",f.remarks||""]}),s.jsxs("div",{children:["Payment Type: ",f.paymentType]})]})]})}),f.status!=="DELIVERED"&&f.status!=="RETURNED"&&s.jsxs("div",{className:"flex gap-3",children:[f.status==="ASSIGNED"&&s.jsxs("button",{onClick:()=>A("OUT_FOR_DELIVERY"),className:"flex-1 h-12 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold",children:[s.jsx(nm,{className:"w-4 h-4 inline"})," Start Delivery"]}),s.jsx("button",{onClick:()=>A("FIRST_ATTEMPT"),className:"flex-1 h-12 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg font-semibold",children:"1st Attempt"}),s.jsx("button",{onClick:()=>A("SECOND_ATTEMPT"),className:"flex-1 h-12 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg font-semibold",children:"2nd Attempt"}),s.jsx("button",{onClick:()=>A("THIRD_ATTEMPT"),className:"flex-1 h-12 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg font-semibold",children:"3rd Attempt"}),s.jsxs("button",{onClick:()=>A("DELIVERED"),className:"flex-1 h-12 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold",children:[s.jsx(h0,{className:"w-4 h-4 inline"})," Delivered"]}),s.jsxs("button",{onClick:()=>A("RETURNED"),className:"flex-1 h-12 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold",children:[s.jsx(x0,{className:"w-4 h-4 inline"})," Return"]})]}),s.jsxs("div",{className:"text-xs text-gray-400",children:["Shipment created on ",new Date(f.createdAt).toDateString()]})]})},Dw=()=>{const[u,m]=D.useState(null),[f,y]=D.useState(""),[C,w]=D.useState(!1),{user:E}=Qs(),T=(E==null?void 0:E.token)||ea(),N=async O=>{if(!O||!O.trim()){y("Please enter or scan a booking ID");return}w(!0),y(""),m(null);try{const R=await fetch(`/api/orders/details/${encodeURIComponent(O.trim())}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${T}`}}),z=R.headers.get("content-type");if(!z||!z.includes("application/json")){const F=await R.text();throw new Error(`Server returned non-JSON response: ${F.substring(0,100)}`)}const P=await R.json();if(!R.ok)throw new Error(P.message||"Failed to fetch order details");m(P)}catch(R){y(R.message),m(null)}finally{w(!1)}},v=O=>{N(O)},A=O=>{y(O)};return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Pr,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Scan Parcel QR"})]}),s.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Scan QR code from parcel label to view order details (read-only)"})]}),s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsx(Yc,{onScan:v,onError:A})}),C&&s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-600",children:[s.jsx("div",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Processing scan..."})]})}),f&&s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"p-4 bg-red-50 border border-red-100 text-red-600 rounded-lg flex items-center gap-2",children:[s.jsx(yn,{className:"w-5 h-5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Assignment Failed"}),s.jsx("p",{className:"text-sm",children:f})]})]})}),u&&s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-100 text-blue-700 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(qn,{className:"w-5 h-5"}),s.jsx("p",{className:"font-semibold",children:"Order Details"})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(gt,{className:"w-4 h-4"}),s.jsx("span",{className:"font-medium",children:"Booking ID:"}),s.jsx("span",{className:"font-mono",children:u.bookingId})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:"Tracking ID:"}),s.jsx("span",{className:"font-mono",children:u.trackingId})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:"Consignee:"}),s.jsx("span",{children:u.consigneeName})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Kn,{className:"w-4 h-4"}),s.jsx("span",{className:"font-medium",children:"Address:"}),s.jsxs("span",{children:[u.consigneeAddress,", ",u.destinationCity]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:"Phone:"}),s.jsx("span",{children:u.consigneePhone})]}),u.codAmount>0&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ut,{className:"w-4 h-4"}),s.jsx("span",{className:"font-medium",children:"COD Amount:"}),s.jsxs("span",{children:["PKR ",Number(u.codAmount).toLocaleString()]})]}),s.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200",children:[s.jsx("span",{className:"font-medium",children:"Status:"}),s.jsx("span",{className:"ml-2 px-2 py-1 bg-blue-200 text-blue-800 rounded text-xs font-semibold",children:u.status})]}),u.assignedRider&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-200",children:[s.jsx("span",{className:"font-medium",children:"Assigned Rider:"}),s.jsx("span",{className:"ml-2",children:u.assignedRider.name})]})]})]})})]})},to=u=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0}).format(Number(u||0)),_w=u=>{if(!u)return"";const m=new Date(u);return Number.isNaN(m.getTime())?"":m.toLocaleString()},Iw=[{key:"today",label:"Today"},{key:"7",label:"7 Days"},{key:"15",label:"15 Days"},{key:"30",label:"30 Days"}],Mw=()=>{const u=ea(),[m,f]=D.useState(!1),[y,C]=D.useState(""),[w,E]=D.useState(""),[T,N]=D.useState({summary:null,items:[],page:1,totalPages:1,total:0}),[v,A]=D.useState(""),[O,R]=D.useState(""),[z,P]=D.useState("all"),[F,Z]=D.useState("desc"),[ne,Y]=D.useState(1),q=20,oe=le=>{const Oe=new Date,$=new Date(Oe);$.setHours(23,59,59,999);let ve=new Date(Oe);if(ve.setHours(0,0,0,0),le!=="today"){const Ne=Number(le);!Number.isNaN(Ne)&&Ne>0&&(ve=new Date($),ve.setDate(ve.getDate()-(Ne-1)),ve.setHours(0,0,0,0))}A(ve.toISOString().slice(0,10)),R($.toISOString().slice(0,10)),Y(1)},Q=async(le={})=>{f(!0),C(""),E("");try{const Oe=new URLSearchParams,$=le.from??v,ve=le.to??O,Ne=le.status??z,M=le.sortOrder??F,L=le.page??ne;$&&Oe.set("from",$),ve&&Oe.set("to",ve),Ne&&Ne!=="all"&&Oe.set("status",Ne),M&&(M==="asc"||M==="desc")&&Oe.set("sortOrder",M),Oe.set("page",String(L)),Oe.set("limit",String(q));const U=await fetch(`/api/riders/finance/me?${Oe.toString()}`,{headers:{Authorization:u?`Bearer ${u}`:""}}),V=await U.json();if(!U.ok)throw new Error(V.message||"Failed to load rider finance");N(V),!V.items||V.items.length===0?E("No records found for selected range"):E("Finance loaded successfully")}catch(Oe){C(Oe.message||"Failed to load finance data")}finally{f(!1)}};D.useEffect(()=>{Q({page:1})},[u]);const te=T.summary||{},K=D.useMemo(()=>{const le=Number(te.unpaidBalance||0),Oe=le>=0;return{value:le,positive:Oe,colorClass:Oe?"text-green-700":"text-red-600",helper:Oe?"Payable to Rider":"Payable by Rider"}},[te.unpaidBalance]),Te=async()=>{Y(1),await Q({page:1})},re=()=>{A(""),R(""),P("all"),Z("desc"),Y(1),Q({from:"",to:"",status:"all",sortOrder:"desc",page:1})};return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ut,{className:"w-6 h-6 text-green-600"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Rider Finance"})]})}),s.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Your earnings and settlements overview."})]}),y&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:y}),w&&!y&&s.jsx("div",{className:"p-3 bg-green-50 border border-green-100 text-green-700 text-sm rounded",children:w}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Delivered (range)"}),s.jsx("div",{className:"mt-1 text-2xl font-bold text-secondary",children:te.deliveredCount||0})]}),s.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Returned (range)"}),s.jsx("div",{className:"mt-1 text-2xl font-bold text-secondary",children:te.returnedCount||0})]}),s.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"COD Collected (range)"}),s.jsx("div",{className:"mt-1 text-xl font-bold text-secondary",children:to(te.codCollected||0)})]}),s.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Unpaid Balance"}),s.jsx("div",{className:`mt-1 text-xl font-extrabold ${K.colorClass}`,children:to(K.value)}),s.jsx("div",{className:"mt-1 text-xs text-gray-500",children:K.helper})]})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"p-6 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(C0,{className:"w-4 h-4 text-gray-500"}),s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Transactions"})]}),s.jsx("div",{className:"flex items-center gap-2 text-xs",children:Iw.map(le=>s.jsx("button",{type:"button",onClick:()=>oe(le.key),className:"px-3 py-1.5 rounded-full border border-gray-200 bg-gray-50 hover:bg-gray-100 text-gray-700",children:le.label},le.key))})]}),s.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-5 gap-3",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"From"}),s.jsx("input",{type:"date",value:v,onChange:le=>A(le.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"To"}),s.jsx("input",{type:"date",value:O,onChange:le=>R(le.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"Status"}),s.jsxs("select",{value:z,onChange:le=>P(le.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg bg-white",children:[s.jsx("option",{value:"all",children:"All"}),s.jsx("option",{value:"delivered",children:"Delivered"}),s.jsx("option",{value:"returned",children:"Returned"})]})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"Sort by Date"}),s.jsxs("select",{value:F,onChange:le=>{Z(le.target.value),Y(1),Q({sortOrder:le.target.value,page:1})},className:"px-3 py-2 text-sm border border-gray-200 rounded-lg bg-white",children:[s.jsx("option",{value:"desc",children:"Sort by Date  Newest First"}),s.jsx("option",{value:"asc",children:"Sort by Date  Oldest First"})]})]}),s.jsxs("div",{className:"flex items-end gap-2",children:[s.jsx(as,{onClick:Te,className:"text-xs",children:"Apply Filters"}),s.jsx(as,{variant:"outline",onClick:re,className:"text-xs",children:"Reset"})]})]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-left text-gray-500 border-b bg-gray-50",children:[s.jsx("th",{className:"py-3 px-4",children:"Date/Time"}),s.jsx("th",{className:"py-3 px-4",children:"Order ID"}),s.jsx("th",{className:"py-3 px-4",children:"Shipper"}),s.jsx("th",{className:"py-3 px-4",children:"Destination"}),s.jsx("th",{className:"py-3 px-4 text-right",children:"COD Amount"}),s.jsx("th",{className:"py-3 px-4 text-right",children:"Service Charges"}),s.jsx("th",{className:"py-3 px-4 text-right",children:"Rider Earning"}),s.jsx("th",{className:"py-3 px-4 text-center",children:"Status"}),s.jsx("th",{className:"py-3 px-4 text-center",children:"Settlement"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:m?s.jsx("tr",{children:s.jsx("td",{colSpan:9,className:"py-10 px-4 text-center text-gray-500",children:"Loading transactions"})}):(T.items||[]).length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:9,className:"py-10 px-4 text-center text-gray-500",children:"No transactions found"})}):(T.items||[]).map(le=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"py-3 px-4 text-xs text-gray-600",children:_w(le.date)}),s.jsx("td",{className:"py-3 px-4 font-mono text-xs",children:le.orderId||""}),s.jsx("td",{className:"py-3 px-4",children:le.shipperName||""}),s.jsx("td",{className:"py-3 px-4",children:le.destination||""}),s.jsx("td",{className:"py-3 px-4 text-right",children:to(le.codAmount||0)}),s.jsx("td",{className:"py-3 px-4 text-right",children:to(le.serviceCharges||0)}),s.jsx("td",{className:"py-3 px-4 text-right font-semibold text-secondary",children:to(le.riderEarning||0)}),s.jsx("td",{className:"py-3 px-4 text-center",children:s.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-700",children:le.status||""})}),s.jsx("td",{className:"py-3 px-4 text-center",children:s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${le.settlementStatus==="PAID"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:le.settlementStatus==="PAID"?"Paid":"Unpaid"})})]},le.id))})]})}),s.jsxs("div",{className:"p-4 border-t border-gray-100 flex items-center justify-between flex-wrap gap-2",children:[s.jsxs("div",{className:"text-xs text-gray-500",children:["Showing page ",T.page||1," of ",T.totalPages||1," (Total ",T.total||0,")"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>{const le=Math.max(1,(T.page||1)-1);Y(le),Q({page:le})},disabled:(T.page||1)<=1,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Prev"}),s.jsx("button",{onClick:()=>{const le=Math.min(T.totalPages||1,(T.page||1)+1);Y(le),Q({page:le})},disabled:(T.page||1)>=(T.totalPages||1),className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})},kw=()=>{const[u,m]=D.useState({name:"",email:"",password:"",confirmPassword:"",companyName:"",cnicNumber:"",contactNumber:"",emergencyContact:"",pickupAddress:"",bankName:"",iban:"",accountNumber:"",accountHolderName:""}),[f,y]=D.useState({}),[C,w]=D.useState(""),[E,T]=D.useState(!1),N=Gs(),v=R=>{const{name:z,value:P}=R.target;m(F=>({...F,[z]:P})),f[z]&&y(F=>({...F,[z]:""}))},A=()=>{const R={};return u.name.trim()||(R.name="Name is required"),u.email?/\S+@\S+\.\S+/.test(u.email)||(R.email="Email is invalid"):R.email="Email is required",u.password?u.password.length<6&&(R.password="Password must be at least 6 characters"):R.password="Password is required",u.confirmPassword?u.password!==u.confirmPassword&&(R.confirmPassword="Passwords do not match"):R.confirmPassword="Please confirm your password",u.companyName.trim()||(R.companyName="Business name is required"),u.contactNumber.trim()||(R.contactNumber="Contact number is required"),u.cnicNumber.trim()||(R.cnicNumber="CNIC number is required"),u.emergencyContact.trim()||(R.emergencyContact="Emergency contact is required"),u.pickupAddress.trim()||(R.pickupAddress="Pickup address is required"),u.bankName.trim()||(R.bankName="Bank Name is required"),u.accountHolderName.trim()||(R.accountHolderName="Account Holder Name is required"),u.accountNumber.trim()?(u.accountNumber.length<6||u.accountNumber.length>30)&&(R.accountNumber="Account Number must be 6-30 characters"):R.accountNumber="Account Number is required",u.iban.trim()?/^[A-Z0-9]{15,34}$/.test(u.iban.trim().toUpperCase())||(R.iban="Invalid IBAN format (15-34 alphanumeric)"):R.iban="IBAN is required",y(R),Object.keys(R).length===0},O=async R=>{if(R.preventDefault(),w(""),!!A()){T(!0);try{const{confirmPassword:z,...P}=u,F=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...P,role:"SHIPPER"})}),Z=await F.json();if(!F.ok)throw new Error(Z.message||"Signup failed");N("/")}catch(z){w(z.message||"An error occurred during signup")}finally{T(!1)}}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#F8F9FA] p-6",children:s.jsxs("form",{onSubmit:O,className:"w-full max-w-md bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-4",children:[s.jsx("h2",{className:"text-2xl font-bold text-secondary mb-6",children:"Sign up as Shipper"}),C&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:C}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(st,{label:"Name",name:"name",value:u.name,onChange:v,error:f.name,required:!0}),f.name&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.name})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Email",type:"email",name:"email",value:u.email,onChange:v,error:f.email,required:!0}),f.email&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.email})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Password",type:"password",name:"password",value:u.password,onChange:v,error:f.password,required:!0}),f.password&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.password})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Confirm Password",type:"password",name:"confirmPassword",value:u.confirmPassword,onChange:v,error:f.confirmPassword,required:!0}),f.confirmPassword&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.confirmPassword})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Business Name",name:"companyName",value:u.companyName,onChange:v,error:f.companyName,required:!0}),f.companyName&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.companyName})]}),s.jsxs("div",{children:[s.jsx(st,{label:"CNIC Number",name:"cnicNumber",value:u.cnicNumber,onChange:v,placeholder:"#####-#######-#",error:f.cnicNumber,required:!0}),f.cnicNumber&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.cnicNumber})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Contact Number",name:"contactNumber",value:u.contactNumber,onChange:v,placeholder:"03XXXXXXXXX",error:f.contactNumber,required:!0}),f.contactNumber&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.contactNumber})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Emergency Contact",name:"emergencyContact",value:u.emergencyContact,onChange:v,error:f.emergencyContact,required:!0}),f.emergencyContact&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.emergencyContact})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Pickup Address",name:"pickupAddress",value:u.pickupAddress,onChange:v,error:f.pickupAddress,required:!0}),f.pickupAddress&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.pickupAddress})]}),s.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Bank Details"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(st,{label:"Bank Name",name:"bankName",value:u.bankName,onChange:v,error:f.bankName,required:!0}),f.bankName&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.bankName})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Account Holder Name",name:"accountHolderName",value:u.accountHolderName,onChange:v,error:f.accountHolderName,required:!0}),f.accountHolderName&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.accountHolderName})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Account Number",name:"accountNumber",value:u.accountNumber,onChange:v,error:f.accountNumber,required:!0}),f.accountNumber&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.accountNumber})]}),s.jsxs("div",{children:[s.jsx(st,{label:"IBAN",name:"iban",value:u.iban,onChange:v,placeholder:"PK...",error:f.iban,required:!0}),f.iban&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.iban})]})]})]}),s.jsx(as,{type:"submit",fullWidth:!0,className:"mt-2",disabled:E,children:E?"Creating Account...":"Create Account"})]})]})})},Bw=()=>{const[u,m]=D.useState({name:"",email:"",password:"",confirmPassword:"",cnic:""}),[f,y]=D.useState({}),[C,w]=D.useState(""),[E,T]=D.useState(!1),N=Gs(),v=R=>{const{name:z,value:P}=R.target;m(F=>({...F,[z]:P})),f[z]&&y(F=>({...F,[z]:""}))},A=()=>{const R={};return u.name.trim()||(R.name="Name is required"),u.email?/\S+@\S+\.\S+/.test(u.email)||(R.email="Email is invalid"):R.email="Email is required",u.cnic?u.cnic.replace(/\D/g,"").length!==13&&(R.cnic="Invalid CNIC format. Must be 13 digits."):R.cnic="CNIC is required",u.password?u.password.length<6&&(R.password="Password must be at least 6 characters"):R.password="Password is required",u.confirmPassword?u.password!==u.confirmPassword&&(R.confirmPassword="Passwords do not match"):R.confirmPassword="Please confirm your password",y(R),Object.keys(R).length===0},O=async R=>{if(R.preventDefault(),w(""),!!A()){T(!0);try{const{confirmPassword:z,...P}=u,F=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...P,role:"RIDER"})}),Z=await F.json();if(!F.ok)throw new Error(Z.message||"Signup failed");N("/")}catch(z){w(z.message||"An error occurred during signup")}finally{T(!1)}}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#F8F9FA] p-6",children:s.jsxs("form",{onSubmit:O,className:"w-full max-w-md bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-4",children:[s.jsx("h2",{className:"text-2xl font-bold text-secondary mb-6",children:"Sign up as Rider"}),C&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:C}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(st,{label:"Name",name:"name",value:u.name,onChange:v,error:f.name,required:!0}),f.name&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.name})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Email",type:"email",name:"email",value:u.email,onChange:v,error:f.email,required:!0}),f.email&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.email})]}),s.jsxs("div",{children:[s.jsx(st,{label:"CNIC Number",name:"cnic",value:u.cnic,onChange:v,placeholder:"#####-#######-#",error:f.cnic,required:!0}),f.cnic&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.cnic})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Password",type:"password",name:"password",value:u.password,onChange:v,error:f.password,required:!0}),f.password&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.password})]}),s.jsxs("div",{children:[s.jsx(st,{label:"Confirm Password",type:"password",name:"confirmPassword",value:u.confirmPassword,onChange:v,error:f.confirmPassword,required:!0}),f.confirmPassword&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.confirmPassword})]}),s.jsx(as,{type:"submit",fullWidth:!0,className:"mt-2",disabled:E,children:E?"Creating Account...":"Create Account"})]})]})})},Lw=({seconds:u,onComplete:m})=>{const[f,y]=D.useState(u);D.useEffect(()=>{if(f===0){m();return}const w=setTimeout(()=>y(f-1),1e3);return()=>clearTimeout(w)},[f,m]);const C=w=>{const E=Math.floor(w/60),T=w%60;return`${E}:${T<10?"0":""}${T}`};return s.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:["Code expires in: ",s.jsx("span",{className:"font-medium",children:C(f)})]})},Pw=()=>{const[u,m]=D.useState(1),[f,y]=D.useState(""),[C,w]=D.useState(""),[E,T]=D.useState(""),[N,v]=D.useState(""),[A,O]=D.useState(null),[R,z]=D.useState(!1),[P,F]=D.useState(!1),[Z,ne]=D.useState(""),Y=Gs(),q=async le=>{le.preventDefault(),O(null),z(!0);const Oe=ya("Sending verification code...");try{const $=await fetch("/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f})}),ve=await $.json().catch(()=>({}));if(!$.ok)throw new Error(ve.message||"Failed to send verification code");O({ok:!0,message:"Verification code sent to your email"}),m(2),F(!0),ks("Verification code sent")}catch($){O({ok:!1,message:$.message||"Failed to send verification code"}),bt($.message||"Failed to send code")}finally{z(!1),pa(Oe)}},oe=async le=>{le.preventDefault(),O(null),z(!0);const Oe=ya("Verifying code...");try{const $=await fetch("/api/auth/verify-reset-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f,code:C})}),ve=await $.json().catch(()=>({}));if(!$.ok)throw new Error(ve.message||"Invalid verification code");ne(ve.resetToken),O({ok:!0,message:"Code verified. Please set a new password."}),m(3),ks("Code verified")}catch($){O({ok:!1,message:$.message}),bt($.message||"Verification failed")}finally{z(!1),pa(Oe)}},Q=async le=>{if(le.preventDefault(),E!==N){O({ok:!1,message:"Passwords do not match"}),bt("Passwords do not match");return}if(E.length<6){O({ok:!1,message:"Password must be at least 6 characters"}),bt("Password must be at least 6 characters");return}O(null),z(!0);const Oe=ya("Resetting password...");try{const $=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:Z,password:E,confirmPassword:N})}),ve=await $.json().catch(()=>({}));if(!$.ok)throw new Error(ve.message||"Failed to reset password");O({ok:!0,message:"Password reset successfully! Redirecting to login..."}),ks("Password reset successfully"),setTimeout(()=>Y("/"),2e3)}catch($){O({ok:!1,message:$.message}),bt($.message||"Reset failed")}finally{z(!1),pa(Oe)}},te=()=>{O(null),w(""),q(new Event("submit")),ks("Resending code")},K=()=>s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Reset your password"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Enter the email address associated with your account and we'll send you a verification code."}),s.jsxs("form",{onSubmit:q,className:"space-y-4",children:[s.jsx(st,{label:"Email",type:"email",value:f,onChange:le=>y(le.target.value),placeholder:"Enter your email address",required:!0}),s.jsx(as,{type:"submit",fullWidth:!0,disabled:R,className:"mt-4",children:R?"Sending...":"Send Verification Code"})]})]}),Te=()=>s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Enter Verification Code"}),s.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["We've sent a 6-digit code to ",s.jsx("span",{className:"font-medium",children:f}),". Please enter it below to verify your identity."]}),s.jsxs("form",{onSubmit:oe,className:"space-y-4",children:[s.jsxs("div",{className:"w-full",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Verification Code"}),s.jsx("input",{type:"text",value:C,onChange:le=>w(le.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"Enter 6-digit code",required:!0,maxLength:6,inputMode:"numeric",pattern:"[0-9]*",className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 bg-white text-gray-900 placeholder-gray-400 focus:outline-none transition-all duration-200"})]}),P&&s.jsx(Lw,{seconds:600,onComplete:()=>F(!1)}),s.jsxs("div",{className:"flex justify-between items-center mt-2",children:[s.jsx("button",{type:"button",onClick:te,className:"text-sm text-blue-600 hover:text-blue-800 disabled:opacity-50",disabled:P||R,children:"Resend Code"}),!P&&s.jsx("span",{className:"text-sm text-gray-500",children:"Didn't receive a code? Try again"})]}),s.jsx(as,{type:"submit",fullWidth:!0,disabled:R||C.length!==6,className:"mt-4",children:R?"Verifying...":"Verify Code"})]})]}),re=()=>s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create New Password"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Please create a new password for your account."}),s.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[s.jsx(st,{label:"New Password",type:"password",value:E,onChange:le=>T(le.target.value),placeholder:"Enter new password",required:!0,minLength:6}),s.jsx(st,{label:"Confirm New Password",type:"password",value:N,onChange:le=>v(le.target.value),placeholder:"Confirm new password",required:!0,minLength:6}),s.jsx(as,{type:"submit",fullWidth:!0,disabled:R||!E||E!==N,className:"mt-4",children:R?"Resetting...":"Reset Password"})]})]});return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:s.jsxs("div",{className:"w-full max-w-md bg-white p-8 rounded-xl shadow-sm border border-gray-100",children:[A&&s.jsx("div",{className:`p-3 mb-6 rounded-lg text-sm ${A.ok?"bg-green-50 text-green-700 border border-green-100":"bg-red-50 text-red-700 border border-red-100"}`,children:A.message}),u>1&&u<3&&s.jsxs("button",{onClick:()=>m(u-1),className:"flex items-center text-sm text-gray-500 hover:text-gray-700 mb-4",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back"]}),u===1&&K(),u===2&&Te(),u===3&&re()]})})};function Fw(){return new URLSearchParams(sn().search)}const Uw=()=>{const m=Fw().get("token")||"",[f,y]=D.useState(""),[C,w]=D.useState(""),[E,T]=D.useState(null),[N,v]=D.useState(!1),A=Gs();D.useEffect(()=>{m||T({ok:!1,message:"Missing token. Use the link from your email."})},[m]);const O=async R=>{if(R.preventDefault(),T(null),f.length<6)return T({ok:!1,message:"Password too short (min 6 chars)"});if(f!==C)return T({ok:!1,message:"Passwords do not match"});const z=ya("Resetting password...");v(!0);try{const P=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:m,password:f})}),F=await P.json().catch(()=>({}));if(!P.ok)throw new Error(F.message||"Reset failed");T({ok:!0,message:"Password reset successfully. Redirecting to login..."}),ks("Password reset successfully"),setTimeout(()=>A("/"),2500)}catch(P){T({ok:!1,message:P.message}),bt(P.message||"Reset failed")}finally{v(!1),pa(z)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center p-6",children:s.jsxs("div",{className:"w-full max-w-md bg-white p-8 rounded shadow",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Choose a new password"}),E&&s.jsx("div",{className:`p-3 mb-4 rounded ${E.ok?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:E.message}),s.jsxs("form",{onSubmit:O,className:"space-y-4",children:[s.jsx(st,{label:"New password",type:"password",value:f,onChange:R=>y(R.target.value),required:!0}),s.jsx(st,{label:"Confirm password",type:"password",value:C,onChange:R=>w(R.target.value),required:!0}),s.jsx(as,{type:"submit",fullWidth:!0,disabled:N||!m,children:N?"Resetting...":"Reset password"})]})]})})},zx=()=>{const[u,m]=D.useState(null),[f,y]=D.useState(""),[C,w]=D.useState(!1),{user:E}=Qs(),T=(E==null?void 0:E.token)||ea(),N=async O=>{if(!O||!O.trim()){y("Please enter or scan a booking ID");return}w(!0),y(""),m(null);try{const R=await fetch("/api/orders/scan",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${T}`},body:JSON.stringify({bookingId:O.trim()})}),z=await R.json();if(!R.ok)throw new Error(z.message||"Failed to scan order");m(z.order)}catch(R){y(R.message),m(null)}finally{w(!1)}},v=O=>{N(O)},A=O=>{y(O)};return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Pr,{className:"w-6 h-6 text-primary"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"LLL Warehouse Scanner"})]}),s.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Scan QR code from order label to mark order as arrived at LLL warehouse"})]}),s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsx(Yc,{onScan:v,onError:A})}),C&&s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-600",children:[s.jsx("div",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Processing scan..."})]})}),f&&s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"p-4 bg-red-50 border border-red-100 text-red-600 rounded-lg flex items-center gap-2",children:[s.jsx(yn,{className:"w-5 h-5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Scan Failed"}),s.jsx("p",{className:"text-sm",children:f})]})]})}),u&&s.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:s.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 text-green-700 mb-3",children:[s.jsx(qn,{className:"w-5 h-5"}),s.jsxs("span",{className:"font-semibold text-lg",children:["Order ",u.bookingId," marked as Arrived at LLL Warehouse"]})]}),s.jsx("div",{className:"text-sm text-gray-700 space-y-2 bg-white p-3 rounded border border-green-200",children:s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-500",children:"Order ID:"}),s.jsx("span",{className:"font-mono ml-2",children:u.bookingId})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-500",children:"Status:"}),s.jsx("span",{className:"ml-2 px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-semibold",children:u.status})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-500",children:"Consignee:"}),s.jsx("span",{className:"ml-2",children:u.consigneeName})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-500",children:"City:"}),s.jsx("span",{className:"ml-2",children:u.destinationCity})]}),u.shipper&&s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"font-medium text-gray-500",children:"Shipper:"}),s.jsx("span",{className:"ml-2",children:u.shipper.name||u.shipper.email})]})]})})]})})]})},Gn=u=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0}).format(Number(u||0)),Hx=()=>{const{user:u}=Qs(),m=(u==null?void 0:u.token)||ea(),[f,y]=D.useState("today"),[C,w]=D.useState(""),[E,T]=D.useState(""),[N,v]=D.useState(!1),[A,O]=D.useState(""),[R,z]=D.useState(null),P=async()=>{v(!0),O("");try{const Z=new URLSearchParams;Z.set("range",f),f==="custom"&&C&&E&&(Z.set("from",C),Z.set("to",E));const ne=await fetch(`/api/finance/company-summary?${Z.toString()}`,{headers:{Authorization:m?`Bearer ${m}`:""}}),Y=await ne.json();if(!ne.ok)throw new Error(Y.message||"Failed to load finance summary");z(Y)}catch(Z){O(Z.message)}finally{v(!1)}};D.useEffect(()=>{P()},[f]);const F=({value:Z,label:ne})=>s.jsx("button",{onClick:()=>y(Z),className:`px-3 py-1.5 text-xs rounded-full border ${f===Z?"bg-black text-white border-black":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,children:ne});return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ut,{className:"w-6 h-6 text-green-600"}),s.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Company Finance"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(F,{value:"today",label:"Today"}),s.jsx(F,{value:"7days",label:"7 Days"}),s.jsx(F,{value:"30days",label:"30 Days"}),s.jsx(F,{value:"all",label:"All Time"})]})]}),s.jsx("div",{className:"mt-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>y("custom"),className:`px-3 py-1.5 text-xs rounded-full border ${f==="custom"?"bg-black text-white border-black":"bg-white text-gray-700 border-gray-200 hover:bg-gray-50"}`,children:"Custom Range"}),f==="custom"&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"date",value:C,onChange:Z=>w(Z.target.value),className:"px-2 py-1.5 text-xs border border-gray-200 rounded"}),s.jsx("span",{className:"text-xs text-gray-500",children:"to"}),s.jsx("input",{type:"date",value:E,onChange:Z=>T(Z.target.value),className:"px-2 py-1.5 text-xs border border-gray-200 rounded"}),s.jsx(as,{onClick:P,className:"text-xs",children:"Apply"})]})]})})]}),A&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:A}),s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Orders"}),s.jsx(gt,{className:"w-4 h-4 text-gray-400"})]}),s.jsx("div",{className:"mt-2 text-2xl font-bold text-secondary",children:(R==null?void 0:R.orders)??(N?"":0)})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Total COD"}),s.jsx(Ut,{className:"w-4 h-4 text-gray-400"})]}),s.jsx("div",{className:"mt-2 text-2xl font-bold text-secondary",children:R?Gn(R.totalCod):N?"":Gn(0)})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Service Charges"}),s.jsx(om,{className:"w-4 h-4 text-gray-400"})]}),s.jsx("div",{className:"mt-2 text-2xl font-bold text-secondary",children:R?Gn(R.totalServiceCharges):N?"":Gn(0)})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Company Earnings"}),s.jsx(Ut,{className:"w-4 h-4 text-green-600"})]}),s.jsx("div",{className:"mt-2 text-2xl font-bold text-green-700",children:R?Gn(R.companyEarnings):N?"":Gn(0)})]})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[s.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[s.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Delivery Outcomes"}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Range: ",(R==null?void 0:R.range)||f]})]}),s.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Delivered Orders"}),s.jsx("div",{className:"mt-2 text-xl font-semibold text-secondary",children:(R==null?void 0:R.deliveredOrders)??(N?"":0)})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Returned Orders"}),s.jsx("div",{className:"mt-2 text-xl font-semibold text-secondary",children:(R==null?void 0:R.returnedOrders)??(N?"":0)})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Total Amount (COD + Charges)"}),s.jsx("div",{className:"mt-2 text-xl font-semibold text-secondary",children:R?Gn(R.totalAmount):N?"":Gn(0)})]})]}),(R==null?void 0:R.unpaidRiderServiceCharges)!==void 0&&s.jsxs("div",{className:"p-6 border-t border-gray-100",children:[s.jsx("div",{className:"text-sm text-gray-600",children:"Unpaid rider balances:"}),s.jsx("div",{className:"mt-1 text-lg font-bold text-secondary",children:Gn(R.unpaidRiderServiceCharges)})]})]}),N&&s.jsx("div",{className:"text-sm text-gray-600",children:"Loading summary"})]})},zw=()=>{const{login:u}=Qs(),m=sn(),f=Gs();return al.useEffect(()=>{(async()=>{const C=new URLSearchParams(m.search),w=C.get("token");if(!w){f("/");return}const E=await u({token:w});C.delete("token"),C.delete("role"),C.delete("name"),C.delete("email"),C.delete("id");const T=window.location.pathname+(C.toString()?`?${C.toString()}`:"");window.history.replaceState({},document.title,T);const N=(E==null?void 0:E.portalActive)===!0,v=(E==null?void 0:E.role)==="CEO"?"/dashboard/ceo":(E==null?void 0:E.role)==="MANAGER"?"/manager/dashboard":(E==null?void 0:E.role)==="SHIPPER"?N?"/shipper/dashboard":"/pending-approval":"/rider/dashboard";f(v)})()},[m,u,f]),s.jsx("div",{children:"Authenticating..."})},Hw=()=>{const{user:u}=Qs(),m=(u==null?void 0:u.portalActive)===!0,f=({children:y})=>{if(u){const C=u.role==="CEO"?"/dashboard/ceo":u.role==="MANAGER"?"/manager/dashboard":u.role==="SHIPPER"?m?"/shipper/dashboard":"/pending-approval":"/rider/dashboard";return s.jsx(mi,{to:C,replace:!0})}return y};return s.jsxs(Yp,{children:[s.jsx(at,{path:"/auth/callback",element:s.jsx(zw,{})}),s.jsx(at,{path:"/",element:s.jsx(f,{children:s.jsx(Nb,{})})}),s.jsx(at,{path:"/signup/shipper",element:s.jsx(f,{children:s.jsx(kw,{})})}),s.jsx(at,{path:"/signup/rider",element:s.jsx(f,{children:s.jsx(Bw,{})})}),s.jsx(at,{path:"/forgot-password",element:s.jsx(f,{children:s.jsx(Pw,{})})}),s.jsx(at,{path:"/reset-password",element:s.jsx(f,{children:s.jsx(Uw,{})})}),s.jsx(at,{path:"/dashboard/ceo",element:s.jsx(yt,{allowedRoles:["CEO"],children:s.jsx(Sb,{})})}),s.jsx(at,{path:"/ceo/users",element:s.jsx(yt,{allowedRoles:["CEO"],children:s.jsx(Tb,{})})}),s.jsx(at,{path:"/ceo/orders",element:s.jsx(yt,{allowedRoles:["CEO"],children:s.jsx(Rb,{})})}),s.jsx(at,{path:"/ceo/commission",element:s.jsx(yt,{allowedRoles:["CEO"],children:s.jsx(wx,{})})}),s.jsx(at,{path:"/ceo/logistics",element:s.jsx(yt,{allowedRoles:["CEO"],children:s.jsx(Ob,{})})}),s.jsx(at,{path:"/ceo/company-profile",element:s.jsx(yt,{allowedRoles:["CEO"],children:s.jsx(Db,{})})}),s.jsx(at,{path:"/ceo/warehouse-scan",element:s.jsx(yt,{allowedRoles:["CEO"],children:s.jsx(bx,{})})}),s.jsx(at,{path:"/ceo/scanner",element:s.jsx(yt,{allowedRoles:["CEO"],children:s.jsx(zx,{})})}),s.jsx(at,{path:"/ceo/assign-scan",element:s.jsx(yt,{allowedRoles:["CEO"],children:s.jsx(yx,{})})}),s.jsx(at,{path:"/ceo/riders",element:s.jsx(yt,{allowedRoles:["CEO"],children:s.jsx(iw,{})})}),s.jsx(at,{path:"/ceo/finance/company",element:s.jsx(yt,{allowedRoles:["CEO"],children:s.jsx(Hx,{})})}),s.jsx(at,{path:"/ceo/finance/invoice",element:s.jsx(yt,{allowedRoles:["CEO"],children:s.jsx(Nx,{})})}),s.jsx(at,{path:"/manager/dashboard",element:s.jsx(yt,{allowedRoles:["MANAGER"],children:s.jsx(lw,{})})}),s.jsx(at,{path:"/manager/orders",element:s.jsx(yt,{allowedRoles:["MANAGER"],children:s.jsx(ow,{})})}),s.jsx(at,{path:"/manager/riders",element:s.jsx(yt,{allowedRoles:["MANAGER"],children:s.jsx(cw,{})})}),s.jsx(at,{path:"/manager/commission",element:s.jsx(yt,{allowedRoles:["MANAGER"],children:s.jsx(wx,{})})}),s.jsx(at,{path:"/manager/finance/invoice",element:s.jsx(yt,{allowedRoles:["MANAGER"],children:s.jsx(Nx,{})})}),s.jsx(at,{path:"/manager/logistics",element:s.jsx(yt,{allowedRoles:["MANAGER"],children:s.jsx(dw,{})})}),s.jsx(at,{path:"/manager/warehouse-scan",element:s.jsx(yt,{allowedRoles:["MANAGER"],children:s.jsx(bx,{})})}),s.jsx(at,{path:"/manager/assign-scan",element:s.jsx(yt,{allowedRoles:["MANAGER"],children:s.jsx(yx,{})})}),s.jsx(at,{path:"/manager/finance/company",element:s.jsx(yt,{allowedRoles:["MANAGER"],children:s.jsx(Hx,{})})}),s.jsx(at,{path:"/invoice-print/:id",element:s.jsx(yt,{allowedRoles:["CEO","MANAGER"],noLayout:!0,children:s.jsx(uw,{})})}),s.jsx(at,{path:"/manager/scanner",element:s.jsx(yt,{allowedRoles:["MANAGER"],children:s.jsx(zx,{})})}),s.jsx(at,{path:"/pending-approval",element:s.jsx(yt,{allowedRoles:["SHIPPER"],noLayout:!0,children:s.jsx(fw,{})})}),s.jsx(at,{path:"/shipper/pending-approval",element:s.jsx(yt,{allowedRoles:["SHIPPER"],noLayout:!0,children:s.jsx(mi,{to:"/pending-approval",replace:!0})})}),s.jsx(at,{path:"/shipper/dashboard",element:s.jsx(yt,{allowedRoles:["SHIPPER"],children:s.jsx(Zu,{})})}),s.jsx(at,{path:"/shipper/orders",element:s.jsx(yt,{allowedRoles:["SHIPPER"],children:s.jsx(Zu,{})})}),s.jsx(at,{path:"/shipper/create",element:s.jsx(yt,{allowedRoles:["SHIPPER"],children:s.jsx(Zu,{})})}),s.jsx(at,{path:"/shipper/orders/:id",element:s.jsx(yt,{allowedRoles:["SHIPPER"],children:s.jsx(Cx,{})})}),s.jsx(at,{path:"/shipper/order/:id",element:s.jsx(yt,{allowedRoles:["SHIPPER"],children:s.jsx(Cx,{})})}),s.jsx(at,{path:"/shipper/integrations",element:s.jsx(yt,{allowedRoles:["SHIPPER"],children:s.jsx(hw,{})})}),s.jsx(at,{path:"/shipper/finance",element:s.jsx(yt,{allowedRoles:["SHIPPER"],children:s.jsx(mw,{})})}),s.jsx(at,{path:"/shipper/integrated-orders",element:s.jsx(yt,{allowedRoles:["SHIPPER"],children:s.jsx(xw,{})})}),s.jsx(at,{path:"/label-print/:id",element:s.jsx(yt,{allowedRoles:["SHIPPER","MANAGER"],noLayout:!0,children:s.jsx(Sw,{})})}),s.jsx(at,{path:"/rider/dashboard",element:s.jsx(yt,{allowedRoles:["RIDER"],children:s.jsx(Tw,{})})}),s.jsx(at,{path:"/rider/history",element:s.jsx(yt,{allowedRoles:["RIDER"],children:s.jsx(Rw,{})})}),s.jsx(at,{path:"/rider/finance",element:s.jsx(yt,{allowedRoles:["RIDER"],children:s.jsx(Mw,{})})}),s.jsx(at,{path:"/rider/task/:id",element:s.jsx(yt,{allowedRoles:["RIDER"],children:s.jsx(Ow,{})})}),s.jsx(at,{path:"/rider/scan",element:s.jsx(yt,{allowedRoles:["RIDER"],children:s.jsx(Dw,{})})}),s.jsx(at,{path:"*",element:u?s.jsx(mi,{to:u.role==="CEO"?"/dashboard/ceo":u.role==="MANAGER"?"/manager/dashboard":u.role==="SHIPPER"?m?"/shipper/dashboard":"/pending-approval":"/rider/dashboard",replace:!0}):s.jsx(mi,{to:"/",replace:!0})})]})},Vw=()=>s.jsx($p,{children:s.jsx(n2,{children:s.jsx(Hw,{})})}),jm=document.getElementById("root");if(!jm)throw new Error("Could not find root element to mount to");const Gw=ep.createRoot(jm);Gw.render(s.jsxs(al.StrictMode,{children:[s.jsx(vb,{position:"top-right",toastOptions:{duration:3e3}}),s.jsx(Vw,{})]}));
