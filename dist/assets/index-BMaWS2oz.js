function Dx(h,p){for(var f=0;f<p.length;f++){const y=p[f];if(typeof y!="string"&&!Array.isArray(y)){for(const v in y)if(v!=="default"&&!(v in h)){const N=Object.getOwnPropertyDescriptor(y,v);N&&Object.defineProperty(h,v,N.get?N:{enumerable:!0,get:()=>y[v]})}}}return Object.freeze(Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}))}(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const v of document.querySelectorAll('link[rel="modulepreload"]'))y(v);new MutationObserver(v=>{for(const N of v)if(N.type==="childList")for(const A of N.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&y(A)}).observe(document,{childList:!0,subtree:!0});function f(v){const N={};return v.integrity&&(N.integrity=v.integrity),v.referrerPolicy&&(N.referrerPolicy=v.referrerPolicy),v.crossOrigin==="use-credentials"?N.credentials="include":v.crossOrigin==="anonymous"?N.credentials="omit":N.credentials="same-origin",N}function y(v){if(v.ep)return;v.ep=!0;const N=f(v);fetch(v.href,N)}})();var Nc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mc(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var Du={exports:{}},ql={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A1;function Ng(){if(A1)return ql;A1=1;var h=Symbol.for("react.transitional.element"),p=Symbol.for("react.fragment");function f(y,v,N){var A=null;if(N!==void 0&&(A=""+N),v.key!==void 0&&(A=""+v.key),"key"in v){N={};for(var R in v)R!=="key"&&(N[R]=v[R])}else N=v;return v=N.ref,{$$typeof:h,type:y,key:A,ref:v!==void 0?v:null,props:N}}return ql.Fragment=p,ql.jsx=f,ql.jsxs=f,ql}var E1;function vg(){return E1||(E1=1,Du.exports=Ng()),Du.exports}var e=vg(),_u={exports:{}},Nt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S1;function jg(){if(S1)return Nt;S1=1;var h=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),A=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),_=Symbol.iterator;function L(E){return E===null||typeof E!="object"?null:(E=_&&E[_]||E["@@iterator"],typeof E=="function"?E:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,Y={};function ee(E,G,U){this.props=E,this.context=G,this.refs=Y,this.updater=U||P}ee.prototype.isReactComponent={},ee.prototype.setState=function(E,G){if(typeof E!="object"&&typeof E!="function"&&E!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,E,G,"setState")},ee.prototype.forceUpdate=function(E){this.updater.enqueueForceUpdate(this,E,"forceUpdate")};function K(){}K.prototype=ee.prototype;function H(E,G,U){this.props=E,this.context=G,this.refs=Y,this.updater=U||P}var q=H.prototype=new K;q.constructor=H,V(q,ee.prototype),q.isPureReactComponent=!0;var te=Array.isArray;function ce(){}var $={H:null,A:null,T:null,S:null},Re=Object.prototype.hasOwnProperty;function oe(E,G,U){var Z=U.ref;return{$$typeof:h,type:E,key:G,ref:Z!==void 0?Z:null,props:U}}function Ee(E,G){return oe(E.type,G,E.props)}function me(E){return typeof E=="object"&&E!==null&&E.$$typeof===h}function ne(E){var G={"=":"=0",":":"=2"};return"$"+E.replace(/[=:]/g,function(U){return G[U]})}var J=/\/+/g;function ae(E,G){return typeof E=="object"&&E!==null&&E.key!=null?ne(""+E.key):G.toString(36)}function F(E){switch(E.status){case"fulfilled":return E.value;case"rejected":throw E.reason;default:switch(typeof E.status=="string"?E.then(ce,ce):(E.status="pending",E.then(function(G){E.status==="pending"&&(E.status="fulfilled",E.value=G)},function(G){E.status==="pending"&&(E.status="rejected",E.reason=G)})),E.status){case"fulfilled":return E.value;case"rejected":throw E.reason}}throw E}function W(E,G,U,Z,we){var xe=typeof E;(xe==="undefined"||xe==="boolean")&&(E=null);var Ge=!1;if(E===null)Ge=!0;else switch(xe){case"bigint":case"string":case"number":Ge=!0;break;case"object":switch(E.$$typeof){case h:case p:Ge=!0;break;case C:return Ge=E._init,W(Ge(E._payload),G,U,Z,we)}}if(Ge)return we=we(E),Ge=Z===""?"."+ae(E,0):Z,te(we)?(U="",Ge!=null&&(U=Ge.replace(J,"$&/")+"/"),W(we,G,U,"",function(jt){return jt})):we!=null&&(me(we)&&(we=Ee(we,U+(we.key==null||E&&E.key===we.key?"":(""+we.key).replace(J,"$&/")+"/")+Ge)),G.push(we)),1;Ge=0;var Ve=Z===""?".":Z+":";if(te(E))for(var Je=0;Je<E.length;Je++)Z=E[Je],xe=Ve+ae(Z,Je),Ge+=W(Z,G,U,xe,we);else if(Je=L(E),typeof Je=="function")for(E=Je.call(E),Je=0;!(Z=E.next()).done;)Z=Z.value,xe=Ve+ae(Z,Je++),Ge+=W(Z,G,U,xe,we);else if(xe==="object"){if(typeof E.then=="function")return W(F(E),G,U,Z,we);throw G=String(E),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(E).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return Ge}function Q(E,G,U){if(E==null)return E;var Z=[],we=0;return W(E,Z,"","",function(xe){return G.call(U,xe,we++)}),Z}function Ne(E){if(E._status===-1){var G=E._result;G=G(),G.then(function(U){(E._status===0||E._status===-1)&&(E._status=1,E._result=U)},function(U){(E._status===0||E._status===-1)&&(E._status=2,E._result=U)}),E._status===-1&&(E._status=0,E._result=G)}if(E._status===1)return E._result.default;throw E._result}var Se=typeof reportError=="function"?reportError:function(E){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof E=="object"&&E!==null&&typeof E.message=="string"?String(E.message):String(E),error:E});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",E);return}console.error(E)},fe={map:Q,forEach:function(E,G,U){Q(E,function(){G.apply(this,arguments)},U)},count:function(E){var G=0;return Q(E,function(){G++}),G},toArray:function(E){return Q(E,function(G){return G})||[]},only:function(E){if(!me(E))throw Error("React.Children.only expected to receive a single React element child.");return E}};return Nt.Activity=O,Nt.Children=fe,Nt.Component=ee,Nt.Fragment=f,Nt.Profiler=v,Nt.PureComponent=H,Nt.StrictMode=y,Nt.Suspense=j,Nt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$,Nt.__COMPILER_RUNTIME={__proto__:null,c:function(E){return $.H.useMemoCache(E)}},Nt.cache=function(E){return function(){return E.apply(null,arguments)}},Nt.cacheSignal=function(){return null},Nt.cloneElement=function(E,G,U){if(E==null)throw Error("The argument must be a React element, but you passed "+E+".");var Z=V({},E.props),we=E.key;if(G!=null)for(xe in G.key!==void 0&&(we=""+G.key),G)!Re.call(G,xe)||xe==="key"||xe==="__self"||xe==="__source"||xe==="ref"&&G.ref===void 0||(Z[xe]=G[xe]);var xe=arguments.length-2;if(xe===1)Z.children=U;else if(1<xe){for(var Ge=Array(xe),Ve=0;Ve<xe;Ve++)Ge[Ve]=arguments[Ve+2];Z.children=Ge}return oe(E.type,we,Z)},Nt.createContext=function(E){return E={$$typeof:A,_currentValue:E,_currentValue2:E,_threadCount:0,Provider:null,Consumer:null},E.Provider=E,E.Consumer={$$typeof:N,_context:E},E},Nt.createElement=function(E,G,U){var Z,we={},xe=null;if(G!=null)for(Z in G.key!==void 0&&(xe=""+G.key),G)Re.call(G,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(we[Z]=G[Z]);var Ge=arguments.length-2;if(Ge===1)we.children=U;else if(1<Ge){for(var Ve=Array(Ge),Je=0;Je<Ge;Je++)Ve[Je]=arguments[Je+2];we.children=Ve}if(E&&E.defaultProps)for(Z in Ge=E.defaultProps,Ge)we[Z]===void 0&&(we[Z]=Ge[Z]);return oe(E,xe,we)},Nt.createRef=function(){return{current:null}},Nt.forwardRef=function(E){return{$$typeof:R,render:E}},Nt.isValidElement=me,Nt.lazy=function(E){return{$$typeof:C,_payload:{_status:-1,_result:E},_init:Ne}},Nt.memo=function(E,G){return{$$typeof:w,type:E,compare:G===void 0?null:G}},Nt.startTransition=function(E){var G=$.T,U={};$.T=U;try{var Z=E(),we=$.S;we!==null&&we(U,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(ce,Se)}catch(xe){Se(xe)}finally{G!==null&&U.types!==null&&(G.types=U.types),$.T=G}},Nt.unstable_useCacheRefresh=function(){return $.H.useCacheRefresh()},Nt.use=function(E){return $.H.use(E)},Nt.useActionState=function(E,G,U){return $.H.useActionState(E,G,U)},Nt.useCallback=function(E,G){return $.H.useCallback(E,G)},Nt.useContext=function(E){return $.H.useContext(E)},Nt.useDebugValue=function(){},Nt.useDeferredValue=function(E,G){return $.H.useDeferredValue(E,G)},Nt.useEffect=function(E,G){return $.H.useEffect(E,G)},Nt.useEffectEvent=function(E){return $.H.useEffectEvent(E)},Nt.useId=function(){return $.H.useId()},Nt.useImperativeHandle=function(E,G,U){return $.H.useImperativeHandle(E,G,U)},Nt.useInsertionEffect=function(E,G){return $.H.useInsertionEffect(E,G)},Nt.useLayoutEffect=function(E,G){return $.H.useLayoutEffect(E,G)},Nt.useMemo=function(E,G){return $.H.useMemo(E,G)},Nt.useOptimistic=function(E,G){return $.H.useOptimistic(E,G)},Nt.useReducer=function(E,G,U){return $.H.useReducer(E,G,U)},Nt.useRef=function(E){return $.H.useRef(E)},Nt.useState=function(E){return $.H.useState(E)},Nt.useSyncExternalStore=function(E,G,U){return $.H.useSyncExternalStore(E,G,U)},Nt.useTransition=function(){return $.H.useTransition()},Nt.version="19.2.0",Nt}var T1;function so(){return T1||(T1=1,_u.exports=jg()),_u.exports}var D=so();const fn=Mc(D),Cg=Dx({__proto__:null,default:fn},[D]);var Iu={exports:{}},Kl={},Mu={exports:{}},ku={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R1;function Ag(){return R1||(R1=1,(function(h){function p(W,Q){var Ne=W.length;W.push(Q);e:for(;0<Ne;){var Se=Ne-1>>>1,fe=W[Se];if(0<v(fe,Q))W[Se]=Q,W[Ne]=fe,Ne=Se;else break e}}function f(W){return W.length===0?null:W[0]}function y(W){if(W.length===0)return null;var Q=W[0],Ne=W.pop();if(Ne!==Q){W[0]=Ne;e:for(var Se=0,fe=W.length,E=fe>>>1;Se<E;){var G=2*(Se+1)-1,U=W[G],Z=G+1,we=W[Z];if(0>v(U,Ne))Z<fe&&0>v(we,U)?(W[Se]=we,W[Z]=Ne,Se=Z):(W[Se]=U,W[G]=Ne,Se=G);else if(Z<fe&&0>v(we,Ne))W[Se]=we,W[Z]=Ne,Se=Z;else break e}}return Q}function v(W,Q){var Ne=W.sortIndex-Q.sortIndex;return Ne!==0?Ne:W.id-Q.id}if(h.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var N=performance;h.unstable_now=function(){return N.now()}}else{var A=Date,R=A.now();h.unstable_now=function(){return A.now()-R}}var j=[],w=[],C=1,O=null,_=3,L=!1,P=!1,V=!1,Y=!1,ee=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;function q(W){for(var Q=f(w);Q!==null;){if(Q.callback===null)y(w);else if(Q.startTime<=W)y(w),Q.sortIndex=Q.expirationTime,p(j,Q);else break;Q=f(w)}}function te(W){if(V=!1,q(W),!P)if(f(j)!==null)P=!0,ce||(ce=!0,ne());else{var Q=f(w);Q!==null&&F(te,Q.startTime-W)}}var ce=!1,$=-1,Re=5,oe=-1;function Ee(){return Y?!0:!(h.unstable_now()-oe<Re)}function me(){if(Y=!1,ce){var W=h.unstable_now();oe=W;var Q=!0;try{e:{P=!1,V&&(V=!1,K($),$=-1),L=!0;var Ne=_;try{t:{for(q(W),O=f(j);O!==null&&!(O.expirationTime>W&&Ee());){var Se=O.callback;if(typeof Se=="function"){O.callback=null,_=O.priorityLevel;var fe=Se(O.expirationTime<=W);if(W=h.unstable_now(),typeof fe=="function"){O.callback=fe,q(W),Q=!0;break t}O===f(j)&&y(j),q(W)}else y(j);O=f(j)}if(O!==null)Q=!0;else{var E=f(w);E!==null&&F(te,E.startTime-W),Q=!1}}break e}finally{O=null,_=Ne,L=!1}Q=void 0}}finally{Q?ne():ce=!1}}}var ne;if(typeof H=="function")ne=function(){H(me)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,ae=J.port2;J.port1.onmessage=me,ne=function(){ae.postMessage(null)}}else ne=function(){ee(me,0)};function F(W,Q){$=ee(function(){W(h.unstable_now())},Q)}h.unstable_IdlePriority=5,h.unstable_ImmediatePriority=1,h.unstable_LowPriority=4,h.unstable_NormalPriority=3,h.unstable_Profiling=null,h.unstable_UserBlockingPriority=2,h.unstable_cancelCallback=function(W){W.callback=null},h.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Re=0<W?Math.floor(1e3/W):5},h.unstable_getCurrentPriorityLevel=function(){return _},h.unstable_next=function(W){switch(_){case 1:case 2:case 3:var Q=3;break;default:Q=_}var Ne=_;_=Q;try{return W()}finally{_=Ne}},h.unstable_requestPaint=function(){Y=!0},h.unstable_runWithPriority=function(W,Q){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Ne=_;_=W;try{return Q()}finally{_=Ne}},h.unstable_scheduleCallback=function(W,Q,Ne){var Se=h.unstable_now();switch(typeof Ne=="object"&&Ne!==null?(Ne=Ne.delay,Ne=typeof Ne=="number"&&0<Ne?Se+Ne:Se):Ne=Se,W){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=Ne+fe,W={id:C++,callback:Q,priorityLevel:W,startTime:Ne,expirationTime:fe,sortIndex:-1},Ne>Se?(W.sortIndex=Ne,p(w,W),f(j)===null&&W===f(w)&&(V?(K($),$=-1):V=!0,F(te,Ne-Se))):(W.sortIndex=fe,p(j,W),P||L||(P=!0,ce||(ce=!0,ne()))),W},h.unstable_shouldYield=Ee,h.unstable_wrapCallback=function(W){var Q=_;return function(){var Ne=_;_=Q;try{return W.apply(this,arguments)}finally{_=Ne}}}})(ku)),ku}var O1;function Eg(){return O1||(O1=1,Mu.exports=Ag()),Mu.exports}var Bu={exports:{}},ea={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D1;function Sg(){if(D1)return ea;D1=1;var h=so();function p(j){var w="https://react.dev/errors/"+j;if(1<arguments.length){w+="?args[]="+encodeURIComponent(arguments[1]);for(var C=2;C<arguments.length;C++)w+="&args[]="+encodeURIComponent(arguments[C])}return"Minified React error #"+j+"; visit "+w+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function f(){}var y={d:{f,r:function(){throw Error(p(522))},D:f,C:f,L:f,m:f,X:f,S:f,M:f},p:0,findDOMNode:null},v=Symbol.for("react.portal");function N(j,w,C){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:v,key:O==null?null:""+O,children:j,containerInfo:w,implementation:C}}var A=h.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function R(j,w){if(j==="font")return"";if(typeof w=="string")return w==="use-credentials"?w:""}return ea.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=y,ea.createPortal=function(j,w){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!w||w.nodeType!==1&&w.nodeType!==9&&w.nodeType!==11)throw Error(p(299));return N(j,w,null,C)},ea.flushSync=function(j){var w=A.T,C=y.p;try{if(A.T=null,y.p=2,j)return j()}finally{A.T=w,y.p=C,y.d.f()}},ea.preconnect=function(j,w){typeof j=="string"&&(w?(w=w.crossOrigin,w=typeof w=="string"?w==="use-credentials"?w:"":void 0):w=null,y.d.C(j,w))},ea.prefetchDNS=function(j){typeof j=="string"&&y.d.D(j)},ea.preinit=function(j,w){if(typeof j=="string"&&w&&typeof w.as=="string"){var C=w.as,O=R(C,w.crossOrigin),_=typeof w.integrity=="string"?w.integrity:void 0,L=typeof w.fetchPriority=="string"?w.fetchPriority:void 0;C==="style"?y.d.S(j,typeof w.precedence=="string"?w.precedence:void 0,{crossOrigin:O,integrity:_,fetchPriority:L}):C==="script"&&y.d.X(j,{crossOrigin:O,integrity:_,fetchPriority:L,nonce:typeof w.nonce=="string"?w.nonce:void 0})}},ea.preinitModule=function(j,w){if(typeof j=="string")if(typeof w=="object"&&w!==null){if(w.as==null||w.as==="script"){var C=R(w.as,w.crossOrigin);y.d.M(j,{crossOrigin:C,integrity:typeof w.integrity=="string"?w.integrity:void 0,nonce:typeof w.nonce=="string"?w.nonce:void 0})}}else w==null&&y.d.M(j)},ea.preload=function(j,w){if(typeof j=="string"&&typeof w=="object"&&w!==null&&typeof w.as=="string"){var C=w.as,O=R(C,w.crossOrigin);y.d.L(j,C,{crossOrigin:O,integrity:typeof w.integrity=="string"?w.integrity:void 0,nonce:typeof w.nonce=="string"?w.nonce:void 0,type:typeof w.type=="string"?w.type:void 0,fetchPriority:typeof w.fetchPriority=="string"?w.fetchPriority:void 0,referrerPolicy:typeof w.referrerPolicy=="string"?w.referrerPolicy:void 0,imageSrcSet:typeof w.imageSrcSet=="string"?w.imageSrcSet:void 0,imageSizes:typeof w.imageSizes=="string"?w.imageSizes:void 0,media:typeof w.media=="string"?w.media:void 0})}},ea.preloadModule=function(j,w){if(typeof j=="string")if(w){var C=R(w.as,w.crossOrigin);y.d.m(j,{as:typeof w.as=="string"&&w.as!=="script"?w.as:void 0,crossOrigin:C,integrity:typeof w.integrity=="string"?w.integrity:void 0})}else y.d.m(j)},ea.requestFormReset=function(j){y.d.r(j)},ea.unstable_batchedUpdates=function(j,w){return j(w)},ea.useFormState=function(j,w,C){return A.H.useFormState(j,w,C)},ea.useFormStatus=function(){return A.H.useHostTransitionStatus()},ea.version="19.2.0",ea}var _1;function _x(){if(_1)return Bu.exports;_1=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(p){console.error(p)}}return h(),Bu.exports=Sg(),Bu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I1;function Tg(){if(I1)return Kl;I1=1;var h=Eg(),p=so(),f=_x();function y(t){var a="https://react.dev/errors/"+t;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)a+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+t+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function v(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function N(t){var a=t,i=t;if(t.alternate)for(;a.return;)a=a.return;else{t=a;do a=t,(a.flags&4098)!==0&&(i=a.return),t=a.return;while(t)}return a.tag===3?i:null}function A(t){if(t.tag===13){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function R(t){if(t.tag===31){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function j(t){if(N(t)!==t)throw Error(y(188))}function w(t){var a=t.alternate;if(!a){if(a=N(t),a===null)throw Error(y(188));return a!==t?null:t}for(var i=t,c=a;;){var x=i.return;if(x===null)break;var g=x.alternate;if(g===null){if(c=x.return,c!==null){i=c;continue}break}if(x.child===g.child){for(g=x.child;g;){if(g===i)return j(x),t;if(g===c)return j(x),a;g=g.sibling}throw Error(y(188))}if(i.return!==c.return)i=x,c=g;else{for(var T=!1,B=x.child;B;){if(B===i){T=!0,i=x,c=g;break}if(B===c){T=!0,c=x,i=g;break}B=B.sibling}if(!T){for(B=g.child;B;){if(B===i){T=!0,i=g,c=x;break}if(B===c){T=!0,c=g,i=x;break}B=B.sibling}if(!T)throw Error(y(189))}}if(i.alternate!==c)throw Error(y(190))}if(i.tag!==3)throw Error(y(188));return i.stateNode.current===i?t:a}function C(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t;for(t=t.child;t!==null;){if(a=C(t),a!==null)return a;t=t.sibling}return null}var O=Object.assign,_=Symbol.for("react.element"),L=Symbol.for("react.transitional.element"),P=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),Y=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),K=Symbol.for("react.consumer"),H=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),$=Symbol.for("react.memo"),Re=Symbol.for("react.lazy"),oe=Symbol.for("react.activity"),Ee=Symbol.for("react.memo_cache_sentinel"),me=Symbol.iterator;function ne(t){return t===null||typeof t!="object"?null:(t=me&&t[me]||t["@@iterator"],typeof t=="function"?t:null)}var J=Symbol.for("react.client.reference");function ae(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===J?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case V:return"Fragment";case ee:return"Profiler";case Y:return"StrictMode";case te:return"Suspense";case ce:return"SuspenseList";case oe:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case P:return"Portal";case H:return t.displayName||"Context";case K:return(t._context.displayName||"Context")+".Consumer";case q:var a=t.render;return t=t.displayName,t||(t=a.displayName||a.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case $:return a=t.displayName||null,a!==null?a:ae(t.type)||"Memo";case Re:a=t._payload,t=t._init;try{return ae(t(a))}catch{}}return null}var F=Array.isArray,W=p.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=f.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ne={pending:!1,data:null,method:null,action:null},Se=[],fe=-1;function E(t){return{current:t}}function G(t){0>fe||(t.current=Se[fe],Se[fe]=null,fe--)}function U(t,a){fe++,Se[fe]=t.current,t.current=a}var Z=E(null),we=E(null),xe=E(null),Ge=E(null);function Ve(t,a){switch(U(xe,a),U(we,t),U(Z,null),a.nodeType){case 9:case 11:t=(t=a.documentElement)&&(t=t.namespaceURI)?Kf(t):0;break;default:if(t=a.tagName,a=a.namespaceURI)a=Kf(a),t=Zf(a,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}G(Z),U(Z,t)}function Je(){G(Z),G(we),G(xe)}function jt(t){t.memoizedState!==null&&U(Ge,t);var a=Z.current,i=Zf(a,t.type);a!==i&&(U(we,t),U(Z,i))}function Be(t){we.current===t&&(G(Z),G(we)),Ge.current===t&&(G(Ge),Vl._currentValue=Ne)}var lt,Ke;function ft(t){if(lt===void 0)try{throw Error()}catch(i){var a=i.stack.trim().match(/\n( *(at )?)/);lt=a&&a[1]||"",Ke=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+lt+t+Ke}var Oe=!1;function mt(t,a){if(!t||Oe)return"";Oe=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var Ie=function(){throw Error()};if(Object.defineProperty(Ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ie,[])}catch(Ae){var ve=Ae}Reflect.construct(t,[],Ie)}else{try{Ie.call()}catch(Ae){ve=Ae}t.call(Ie.prototype)}}else{try{throw Error()}catch(Ae){ve=Ae}(Ie=t())&&typeof Ie.catch=="function"&&Ie.catch(function(){})}}catch(Ae){if(Ae&&ve&&typeof Ae.stack=="string")return[Ae.stack,ve.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),T=g[0],B=g[1];if(T&&B){var se=T.split(`
`),be=B.split(`
`);for(x=c=0;c<se.length&&!se[c].includes("DetermineComponentFrameRoot");)c++;for(;x<be.length&&!be[x].includes("DetermineComponentFrameRoot");)x++;if(c===se.length||x===be.length)for(c=se.length-1,x=be.length-1;1<=c&&0<=x&&se[c]!==be[x];)x--;for(;1<=c&&0<=x;c--,x--)if(se[c]!==be[x]){if(c!==1||x!==1)do if(c--,x--,0>x||se[c]!==be[x]){var De=`
`+se[c].replace(" at new "," at ");return t.displayName&&De.includes("<anonymous>")&&(De=De.replace("<anonymous>",t.displayName)),De}while(1<=c&&0<=x);break}}}finally{Oe=!1,Error.prepareStackTrace=i}return(i=t?t.displayName||t.name:"")?ft(i):""}function yt(t,a){switch(t.tag){case 26:case 27:case 5:return ft(t.type);case 16:return ft("Lazy");case 13:return t.child!==a&&a!==null?ft("Suspense Fallback"):ft("Suspense");case 19:return ft("SuspenseList");case 0:case 15:return mt(t.type,!1);case 11:return mt(t.type.render,!1);case 1:return mt(t.type,!0);case 31:return ft("Activity");default:return""}}function Ze(t){try{var a="",i=null;do a+=yt(t,i),i=t,t=t.return;while(t);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Xe=Object.prototype.hasOwnProperty,Tt=h.unstable_scheduleCallback,He=h.unstable_cancelCallback,ye=h.unstable_shouldYield,Fe=h.unstable_requestPaint,We=h.unstable_now,rt=h.unstable_getCurrentPriorityLevel,st=h.unstable_ImmediatePriority,_s=h.unstable_UserBlockingPriority,pt=h.unstable_NormalPriority,ct=h.unstable_LowPriority,ds=h.unstable_IdlePriority,ue=h.log,ze=h.unstable_setDisableYieldValue,Ue=null,Te=null;function ot(t){if(typeof ue=="function"&&ze(t),Te&&typeof Te.setStrictMode=="function")try{Te.setStrictMode(Ue,t)}catch{}}var Ye=Math.clz32?Math.clz32:li,Kt=Math.log,pn=Math.LN2;function li(t){return t>>>=0,t===0?32:31-(Kt(t)/pn|0)|0}var Mr=256,Mt=262144,Oa=4194304;function en(t){var a=t&42;if(a!==0)return a;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function kr(t,a,i){var c=t.pendingLanes;if(c===0)return 0;var x=0,g=t.suspendedLanes,T=t.pingedLanes;t=t.warmLanes;var B=c&134217727;return B!==0?(c=B&~g,c!==0?x=en(c):(T&=B,T!==0?x=en(T):i||(i=B&~t,i!==0&&(x=en(i))))):(B=c&~g,B!==0?x=en(B):T!==0?x=en(T):i||(i=c&~t,i!==0&&(x=en(i)))),x===0?0:a!==0&&a!==x&&(a&g)===0&&(g=x&-x,i=a&-a,g>=i||g===32&&(i&4194048)!==0)?a:x}function Ks(t,a){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&a)===0}function nl(t,a){switch(t){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Us(){var t=Oa;return Oa<<=1,(Oa&62914560)===0&&(Oa=4194304),t}function tn(t){for(var a=[],i=0;31>i;i++)a.push(t);return a}function sn(t,a){t.pendingLanes|=a,a!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function Da(t,a,i,c,x,g){var T=t.pendingLanes;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=i,t.entangledLanes&=i,t.errorRecoveryDisabledLanes&=i,t.shellSuspendCounter=0;var B=t.entanglements,se=t.expirationTimes,be=t.hiddenUpdates;for(i=T&~i;0<i;){var De=31-Ye(i),Ie=1<<De;B[De]=0,se[De]=-1;var ve=be[De];if(ve!==null)for(be[De]=null,De=0;De<ve.length;De++){var Ae=ve[De];Ae!==null&&(Ae.lane&=-536870913)}i&=~Ie}c!==0&&ao(t,c,0),g!==0&&x===0&&t.tag!==0&&(t.suspendedLanes|=g&~(T&~a))}function ao(t,a,i){t.pendingLanes|=a,t.suspendedLanes&=~a;var c=31-Ye(a);t.entangledLanes|=a,t.entanglements[c]=t.entanglements[c]|1073741824|i&261930}function an(t,a){var i=t.entangledLanes|=a;for(t=t.entanglements;i;){var c=31-Ye(i),x=1<<c;x&a|t[c]&a&&(t[c]|=a),i&=~x}}function oi(t,a){var i=a&-a;return i=(i&42)!==0?1:Ys(i),(i&(t.suspendedLanes|a))!==0?0:i}function Ys(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Xa(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function ta(){var t=Q.p;return t!==0?t:(t=window.event,t===void 0?32:y1(t.type))}function qe(t,a){var i=Q.p;try{return Q.p=t,a()}finally{Q.p=i}}var sa=Math.random().toString(36).slice(2),Es="__reactFiber$"+sa,Jt="__reactProps$"+sa,pa="__reactContainer$"+sa,Kn="__reactEvents$"+sa,ci="__reactListeners$"+sa,_a="__reactHandles$"+sa,no="__reactResources$"+sa,Br="__reactMarker$"+sa;function oa(t){delete t[Es],delete t[Jt],delete t[Kn],delete t[ci],delete t[_a]}function bs(t){var a=t[Es];if(a)return a;for(var i=t.parentNode;i;){if(a=i[pa]||i[Es]){if(i=a.alternate,a.child!==null||i!==null&&i.child!==null)for(t=s1(t);t!==null;){if(i=t[Es])return i;t=s1(t)}return a}t=i,i=t.parentNode}return null}function Xt(t){if(t=t[Es]||t[pa]){var a=t.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return t}return null}function Zn(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t.stateNode;throw Error(y(33))}function aa(t){var a=t[no];return a||(a=t[no]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function ws(t){t[Br]=!0}var Me=new Set,ro={};function Zt(t,a){ya(t,a),ya(t+"Capture",a)}function ya(t,a){for(ro[t]=a,t=0;t<a.length;t++)Me.add(a[t])}var Lc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ut={},Ft={};function Dt(t){return Xe.call(Ft,t)?!0:Xe.call(Ut,t)?!1:Lc.test(t)?Ft[t]=!0:(Ut[t]=!0,!1)}function Wn(t,a,i){if(Dt(a))if(i===null)t.removeAttribute(a);else{switch(typeof i){case"undefined":case"function":case"symbol":t.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(a);return}}t.setAttribute(a,""+i)}}function Qn(t,a,i){if(i===null)t.removeAttribute(a);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(a);return}t.setAttribute(a,""+i)}}function ba(t,a,i,c){if(c===null)t.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(i);return}t.setAttributeNS(a,i,""+c)}}function Ht(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ya(t){var a=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Pc(t,a,i){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,a);if(!t.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var x=c.get,g=c.set;return Object.defineProperty(t,a,{configurable:!0,get:function(){return x.call(this)},set:function(T){i=""+T,g.call(this,T)}}),Object.defineProperty(t,a,{enumerable:c.enumerable}),{getValue:function(){return i},setValue:function(T){i=""+T},stopTracking:function(){t._valueTracker=null,delete t[a]}}}}function us(t){if(!t._valueTracker){var a=Ya(t)?"checked":"value";t._valueTracker=Pc(t,a,""+t[a])}}function qa(t){if(!t)return!1;var a=t._valueTracker;if(!a)return!0;var i=a.getValue(),c="";return t&&(c=Ya(t)?t.checked?"true":"false":t.value),t=c,t!==i?(a.setValue(t),!0):!1}function di(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Jn=/[\n"\\]/g;function Ot(t){return t.replace(Jn,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Is(t,a,i,c,x,g,T,B){t.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?t.type=T:t.removeAttribute("type"),a!=null?T==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+Ht(a)):t.value!==""+Ht(a)&&(t.value=""+Ht(a)):T!=="submit"&&T!=="reset"||t.removeAttribute("value"),a!=null?z(t,T,Ht(a)):i!=null?z(t,T,Ht(i)):c!=null&&t.removeAttribute("value"),x==null&&g!=null&&(t.defaultChecked=!!g),x!=null&&(t.checked=x&&typeof x!="function"&&typeof x!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?t.name=""+Ht(B):t.removeAttribute("name")}function ge(t,a,i,c,x,g,T,B){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(t.type=g),a!=null||i!=null){if(!(g!=="submit"&&g!=="reset"||a!=null)){us(t);return}i=i!=null?""+Ht(i):"",a=a!=null?""+Ht(a):i,B||a===t.value||(t.value=a),t.defaultValue=a}c=c??x,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=B?t.checked:!!c,t.defaultChecked=!!c,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(t.name=T),us(t)}function z(t,a,i){a==="number"&&di(t.ownerDocument)===t||t.defaultValue===""+i||(t.defaultValue=""+i)}function et(t,a,i,c){if(t=t.options,a){a={};for(var x=0;x<i.length;x++)a["$"+i[x]]=!0;for(i=0;i<t.length;i++)x=a.hasOwnProperty("$"+t[i].value),t[i].selected!==x&&(t[i].selected=x),x&&c&&(t[i].defaultSelected=!0)}else{for(i=""+Ht(i),a=null,x=0;x<t.length;x++){if(t[x].value===i){t[x].selected=!0,c&&(t[x].defaultSelected=!0);return}a!==null||t[x].disabled||(a=t[x])}a!==null&&(a.selected=!0)}}function Ss(t,a,i){if(a!=null&&(a=""+Ht(a),a!==t.value&&(t.value=a),i==null)){t.defaultValue!==a&&(t.defaultValue=a);return}t.defaultValue=i!=null?""+Ht(i):""}function na(t,a,i,c){if(a==null){if(c!=null){if(i!=null)throw Error(y(92));if(F(c)){if(1<c.length)throw Error(y(93));c=c[0]}i=c}i==null&&(i=""),a=i}i=Ht(a),t.defaultValue=i,c=t.textContent,c===i&&c!==""&&c!==null&&(t.value=c),us(t)}function $n(t,a){if(a){var i=t.firstChild;if(i&&i===t.lastChild&&i.nodeType===3){i.nodeValue=a;return}}t.textContent=a}var rl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ra(t,a,i){var c=a.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?c?t.setProperty(a,""):a==="float"?t.cssFloat="":t[a]="":c?t.setProperty(a,i):typeof i!="number"||i===0||rl.has(a)?a==="float"?t.cssFloat=i:t[a]=(""+i).trim():t[a]=i+"px"}function nt(t,a,i){if(a!=null&&typeof a!="object")throw Error(y(62));if(t=t.style,i!=null){for(var c in i)!i.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var x in a)c=a[x],a.hasOwnProperty(x)&&i[x]!==c&&ra(t,x,c)}else for(var g in a)a.hasOwnProperty(g)&&ra(t,g,a[g])}function is(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var io=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function er(t){return Fc.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function ca(){}var Lr=null;function il(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var hs=null,Ia=null;function Ka(t){var a=Xt(t);if(a&&(t=a.stateNode)){var i=t[Jt]||null;e:switch(t=a.stateNode,a.type){case"input":if(Is(t,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),a=i.name,i.type==="radio"&&a!=null){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+Ot(""+a)+'"][type="radio"]'),a=0;a<i.length;a++){var c=i[a];if(c!==t&&c.form===t.form){var x=c[Jt]||null;if(!x)throw Error(y(90));Is(c,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(a=0;a<i.length;a++)c=i[a],c.form===t.form&&qa(c)}break e;case"textarea":Ss(t,i.value,i.defaultValue);break e;case"select":a=i.value,a!=null&&et(t,!!i.multiple,a,!1)}}}var dt=!1;function lo(t,a,i){if(dt)return t(a,i);dt=!0;try{var c=t(a);return c}finally{if(dt=!1,(hs!==null||Ia!==null)&&($o(),hs&&(a=hs,t=Ia,Ia=hs=null,Ka(a),t)))for(a=0;a<t.length;a++)Ka(t[a])}}function bt(t,a){var i=t.stateNode;if(i===null)return null;var c=i[Jt]||null;if(c===null)return null;i=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(i&&typeof i!="function")throw Error(y(231,a,typeof i));return i}var ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ll=!1;if(ls)try{var yn={};Object.defineProperty(yn,"passive",{get:function(){ll=!0}}),window.addEventListener("test",yn,yn),window.removeEventListener("test",yn,yn)}catch{ll=!1}var Za=null,Wa=null,ui=null;function tr(){if(ui)return ui;var t,a=Wa,i=a.length,c,x="value"in Za?Za.value:Za.textContent,g=x.length;for(t=0;t<i&&a[t]===x[t];t++);var T=i-t;for(c=1;c<=T&&a[i-c]===x[g-c];c++);return ui=x.slice(t,1<c?1-c:void 0)}function nn(t){var a=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&a===13&&(t=13)):t=a,t===10&&(t=13),32<=t||t===13?t:0}function rn(){return!0}function ol(){return!1}function Ms(t){function a(i,c,x,g,T){this._reactName=i,this._targetInst=x,this.type=c,this.nativeEvent=g,this.target=T,this.currentTarget=null;for(var B in t)t.hasOwnProperty(B)&&(i=t[B],this[B]=i?i(g):g[B]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?rn:ol,this.isPropagationStopped=ol,this}return O(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=rn)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=rn)},persist:function(){},isPersistent:rn}),a}var wa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zs=Ms(wa),sr=O({},wa,{view:0,detail:0}),oo=Ms(sr),hi,cl,Pr,fi=O({},sr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fr,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Pr&&(Pr&&t.type==="mousemove"?(hi=t.screenX-Pr.screenX,cl=t.screenY-Pr.screenY):cl=hi=0,Pr=t),hi)},movementY:function(t){return"movementY"in t?t.movementY:cl}}),Yt=Ms(fi),co=O({},fi,{dataTransfer:0}),xi=Ms(co),ln=O({},sr,{relatedTarget:0}),dl=Ms(ln),Ce=O({},wa,{animationName:0,elapsedTime:0,pseudoElement:0}),Ct=Ms(Ce),Hs=O({},wa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),mi=Ms(Hs),uo=O({},wa,{data:0}),ho=Ms(uo),Uc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ul={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ts(t){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(t):(t=ul[t])?!!a[t]:!1}function Fr(){return Ts}var ps=O({},sr,{key:function(t){if(t.key){var a=Uc[t.key]||t.key;if(a!=="Unidentified")return a}return t.type==="keypress"?(t=nn(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?zc[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fr,charCode:function(t){return t.type==="keypress"?nn(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?nn(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),gi=Ms(ps),bn=O({},fi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wt=Ms(bn),ut=O({},sr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fr}),Hc=Ms(ut),os=O({},wa,{propertyName:0,elapsedTime:0,pseudoElement:0}),wn=Ms(os),ar=O({},fi,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Vc=Ms(ar),Ma=O({},wa,{newState:0,oldState:0}),hl=Ms(Ma),fo=[9,13,27,32],Ur=ls&&"CompositionEvent"in window,nr=null;ls&&"documentMode"in document&&(nr=document.documentMode);var xo=ls&&"TextEvent"in window&&!nr,mo=ls&&(!Ur||nr&&8<nr&&11>=nr),Nn=" ",pi=!1;function go(t,a){switch(t){case"keyup":return fo.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rr(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ir=!1;function on(t,a){switch(t){case"compositionend":return rr(a);case"keypress":return a.which!==32?null:(pi=!0,Nn);case"textInput":return t=a.data,t===Nn&&pi?null:t;default:return null}}function yi(t,a){if(ir)return t==="compositionend"||!Ur&&go(t,a)?(t=tr(),ui=Wa=Za=null,ir=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return mo&&a.locale!=="ko"?null:a.data;default:return null}}var da={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fl(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a==="input"?!!da[t.type]:a==="textarea"}function Na(t,a,i,c){hs?Ia?Ia.push(c):Ia=[c]:hs=c,a=ic(a,"onChange"),0<a.length&&(i=new zs("onChange","change",null,i,c),t.push({event:i,listeners:a}))}var zr=null,vn=null;function Gc(t){Hf(t,0)}function Hr(t){var a=Zn(t);if(qa(a))return t}function va(t,a){if(t==="change")return a}var po=!1;if(ls){var Vr;if(ls){var jn="oninput"in document;if(!jn){var kt=document.createElement("div");kt.setAttribute("oninput","return;"),jn=typeof kt.oninput=="function"}Vr=jn}else Vr=!1;po=Vr&&(!document.documentMode||9<document.documentMode)}function Gr(){zr&&(zr.detachEvent("onpropertychange",I),vn=zr=null)}function I(t){if(t.propertyName==="value"&&Hr(vn)){var a=[];Na(a,vn,t,il(t)),lo(Gc,a)}}function s(t,a,i){t==="focusin"?(Gr(),zr=a,vn=i,zr.attachEvent("onpropertychange",I)):t==="focusout"&&Gr()}function n(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Hr(vn)}function r(t,a){if(t==="click")return Hr(a)}function l(t,a){if(t==="input"||t==="change")return Hr(a)}function o(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var d=typeof Object.is=="function"?Object.is:o;function u(t,a){if(d(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var i=Object.keys(t),c=Object.keys(a);if(i.length!==c.length)return!1;for(c=0;c<i.length;c++){var x=i[c];if(!Xe.call(a,x)||!d(t[x],a[x]))return!1}return!0}function m(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function b(t,a){var i=m(t);t=0;for(var c;i;){if(i.nodeType===3){if(c=t+i.textContent.length,t<=a&&c>=a)return{node:i,offset:a-t};t=c}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=m(i)}}function S(t,a){return t&&a?t===a?!0:t&&t.nodeType===3?!1:a&&a.nodeType===3?S(t,a.parentNode):"contains"in t?t.contains(a):t.compareDocumentPosition?!!(t.compareDocumentPosition(a)&16):!1:!1}function M(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var a=di(t.document);a instanceof t.HTMLIFrameElement;){try{var i=typeof a.contentWindow.location.href=="string"}catch{i=!1}if(i)t=a.contentWindow;else break;a=di(t.document)}return a}function k(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a&&(a==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||a==="textarea"||t.contentEditable==="true")}var X=ls&&"documentMode"in document&&11>=document.documentMode,re=null,ie=null,he=null,je=!1;function Pe(t,a,i){var c=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;je||re==null||re!==di(c)||(c=re,"selectionStart"in c&&k(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),he&&u(he,c)||(he=c,c=ic(ie,"onSelect"),0<c.length&&(a=new zs("onSelect","select",null,a,i),t.push({event:a,listeners:c}),a.target=re)))}function Le(t,a){var i={};return i[t.toLowerCase()]=a.toLowerCase(),i["Webkit"+t]="webkit"+a,i["Moz"+t]="moz"+a,i}var ke={animationend:Le("Animation","AnimationEnd"),animationiteration:Le("Animation","AnimationIteration"),animationstart:Le("Animation","AnimationStart"),transitionrun:Le("Transition","TransitionRun"),transitionstart:Le("Transition","TransitionStart"),transitioncancel:Le("Transition","TransitionCancel"),transitionend:Le("Transition","TransitionEnd")},Rt={},wt={};ls&&(wt=document.createElement("div").style,"AnimationEvent"in window||(delete ke.animationend.animation,delete ke.animationiteration.animation,delete ke.animationstart.animation),"TransitionEvent"in window||delete ke.transitionend.transition);function Ns(t){if(Rt[t])return Rt[t];if(!ke[t])return t;var a=ke[t],i;for(i in a)if(a.hasOwnProperty(i)&&i in wt)return Rt[t]=a[i];return t}var ua=Ns("animationend"),Zs=Ns("animationiteration"),Qt=Ns("animationstart"),Vs=Ns("transitionrun"),ia=Ns("transitionstart"),lr=Ns("transitioncancel"),Cn=Ns("transitionend"),yo=new Map,xl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xl.push("scrollEnd");function Qa(t,a){yo.set(t,a),Zt(a,[t])}var bo=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},ka=[],bi=0,Xc=0;function wo(){for(var t=bi,a=Xc=bi=0;a<t;){var i=ka[a];ka[a++]=null;var c=ka[a];ka[a++]=null;var x=ka[a];ka[a++]=null;var g=ka[a];if(ka[a++]=null,c!==null&&x!==null){var T=c.pending;T===null?x.next=x:(x.next=T.next,T.next=x),c.pending=x}g!==0&&v0(i,x,g)}}function No(t,a,i,c){ka[bi++]=t,ka[bi++]=a,ka[bi++]=i,ka[bi++]=c,Xc|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function Yc(t,a,i,c){return No(t,a,i,c),vo(t)}function Xr(t,a){return No(t,null,null,a),vo(t)}function v0(t,a,i){t.lanes|=i;var c=t.alternate;c!==null&&(c.lanes|=i);for(var x=!1,g=t.return;g!==null;)g.childLanes|=i,c=g.alternate,c!==null&&(c.childLanes|=i),g.tag===22&&(t=g.stateNode,t===null||t._visibility&1||(x=!0)),t=g,g=g.return;return t.tag===3?(g=t.stateNode,x&&a!==null&&(x=31-Ye(i),t=g.hiddenUpdates,c=t[x],c===null?t[x]=[a]:c.push(a),a.lane=i|536870912),g):null}function vo(t){if(50<Bl)throw Bl=0,tu=null,Error(y(185));for(var a=t.return;a!==null;)t=a,a=t.return;return t.tag===3?t.stateNode:null}var wi={};function nm(t,a,i,c){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ja(t,a,i,c){return new nm(t,a,i,c)}function qc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function An(t,a){var i=t.alternate;return i===null?(i=ja(t.tag,a,t.key,t.mode),i.elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=a,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=t.flags&65011712,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,a=t.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i.refCleanup=t.refCleanup,i}function j0(t,a){t.flags&=65011714;var i=t.alternate;return i===null?(t.childLanes=0,t.lanes=a,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,t.type=i.type,a=i.dependencies,t.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),t}function jo(t,a,i,c,x,g){var T=0;if(c=t,typeof t=="function")qc(t)&&(T=1);else if(typeof t=="string")T=cg(t,i,Z.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case oe:return t=ja(31,i,a,x),t.elementType=oe,t.lanes=g,t;case V:return Yr(i.children,x,g,a);case Y:T=8,x|=24;break;case ee:return t=ja(12,i,a,x|2),t.elementType=ee,t.lanes=g,t;case te:return t=ja(13,i,a,x),t.elementType=te,t.lanes=g,t;case ce:return t=ja(19,i,a,x),t.elementType=ce,t.lanes=g,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case H:T=10;break e;case K:T=9;break e;case q:T=11;break e;case $:T=14;break e;case Re:T=16,c=null;break e}T=29,i=Error(y(130,t===null?"null":typeof t,"")),c=null}return a=ja(T,i,a,x),a.elementType=t,a.type=c,a.lanes=g,a}function Yr(t,a,i,c){return t=ja(7,t,c,a),t.lanes=i,t}function Kc(t,a,i){return t=ja(6,t,null,a),t.lanes=i,t}function C0(t){var a=ja(18,null,null,0);return a.stateNode=t,a}function Zc(t,a,i){return a=ja(4,t.children!==null?t.children:[],t.key,a),a.lanes=i,a.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},a}var A0=new WeakMap;function Ba(t,a){if(typeof t=="object"&&t!==null){var i=A0.get(t);return i!==void 0?i:(a={value:t,source:a,stack:Ze(a)},A0.set(t,a),a)}return{value:t,source:a,stack:Ze(a)}}var Ni=[],vi=0,Co=null,ml=0,La=[],Pa=0,or=null,cn=1,dn="";function En(t,a){Ni[vi++]=ml,Ni[vi++]=Co,Co=t,ml=a}function E0(t,a,i){La[Pa++]=cn,La[Pa++]=dn,La[Pa++]=or,or=t;var c=cn;t=dn;var x=32-Ye(c)-1;c&=~(1<<x),i+=1;var g=32-Ye(a)+x;if(30<g){var T=x-x%5;g=(c&(1<<T)-1).toString(32),c>>=T,x-=T,cn=1<<32-Ye(a)+x|i<<x|c,dn=g+t}else cn=1<<g|i<<x|c,dn=t}function Wc(t){t.return!==null&&(En(t,1),E0(t,1,0))}function Qc(t){for(;t===Co;)Co=Ni[--vi],Ni[vi]=null,ml=Ni[--vi],Ni[vi]=null;for(;t===or;)or=La[--Pa],La[Pa]=null,dn=La[--Pa],La[Pa]=null,cn=La[--Pa],La[Pa]=null}function S0(t,a){La[Pa++]=cn,La[Pa++]=dn,La[Pa++]=or,cn=a.id,dn=a.overflow,or=t}var Ws=null,fs=null,Pt=!1,cr=null,Fa=!1,Jc=Error(y(519));function dr(t){var a=Error(y(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gl(Ba(a,t)),Jc}function T0(t){var a=t.stateNode,i=t.type,c=t.memoizedProps;switch(a[Es]=t,a[Jt]=c,i){case"dialog":It("cancel",a),It("close",a);break;case"iframe":case"object":case"embed":It("load",a);break;case"video":case"audio":for(i=0;i<Pl.length;i++)It(Pl[i],a);break;case"source":It("error",a);break;case"img":case"image":case"link":It("error",a),It("load",a);break;case"details":It("toggle",a);break;case"input":It("invalid",a),ge(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":It("invalid",a);break;case"textarea":It("invalid",a),na(a,c.value,c.defaultValue,c.children)}i=c.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||a.textContent===""+i||c.suppressHydrationWarning===!0||Yf(a.textContent,i)?(c.popover!=null&&(It("beforetoggle",a),It("toggle",a)),c.onScroll!=null&&It("scroll",a),c.onScrollEnd!=null&&It("scrollend",a),c.onClick!=null&&(a.onclick=ca),a=!0):a=!1,a||dr(t,!0)}function R0(t){for(Ws=t.return;Ws;)switch(Ws.tag){case 5:case 31:case 13:Fa=!1;return;case 27:case 3:Fa=!0;return;default:Ws=Ws.return}}function ji(t){if(t!==Ws)return!1;if(!Pt)return R0(t),Pt=!0,!1;var a=t.tag,i;if((i=a!==3&&a!==27)&&((i=a===5)&&(i=t.type,i=!(i!=="form"&&i!=="button")||gu(t.type,t.memoizedProps)),i=!i),i&&fs&&dr(t),R0(t),a===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(y(317));fs=t1(t)}else if(a===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(y(317));fs=t1(t)}else a===27?(a=fs,Cr(t.type)?(t=Nu,Nu=null,fs=t):fs=a):fs=Ws?za(t.stateNode.nextSibling):null;return!0}function qr(){fs=Ws=null,Pt=!1}function $c(){var t=cr;return t!==null&&(ma===null?ma=t:ma.push.apply(ma,t),cr=null),t}function gl(t){cr===null?cr=[t]:cr.push(t)}var ed=E(null),Kr=null,Sn=null;function ur(t,a,i){U(ed,a._currentValue),a._currentValue=i}function Tn(t){t._currentValue=ed.current,G(ed)}function td(t,a,i){for(;t!==null;){var c=t.alternate;if((t.childLanes&a)!==a?(t.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),t===i)break;t=t.return}}function sd(t,a,i,c){var x=t.child;for(x!==null&&(x.return=t);x!==null;){var g=x.dependencies;if(g!==null){var T=x.child;g=g.firstContext;e:for(;g!==null;){var B=g;g=x;for(var se=0;se<a.length;se++)if(B.context===a[se]){g.lanes|=i,B=g.alternate,B!==null&&(B.lanes|=i),td(g.return,i,t),c||(T=null);break e}g=B.next}}else if(x.tag===18){if(T=x.return,T===null)throw Error(y(341));T.lanes|=i,g=T.alternate,g!==null&&(g.lanes|=i),td(T,i,t),T=null}else T=x.child;if(T!==null)T.return=x;else for(T=x;T!==null;){if(T===t){T=null;break}if(x=T.sibling,x!==null){x.return=T.return,T=x;break}T=T.return}x=T}}function Ci(t,a,i,c){t=null;for(var x=a,g=!1;x!==null;){if(!g){if((x.flags&524288)!==0)g=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var T=x.alternate;if(T===null)throw Error(y(387));if(T=T.memoizedProps,T!==null){var B=x.type;d(x.pendingProps.value,T.value)||(t!==null?t.push(B):t=[B])}}else if(x===Ge.current){if(T=x.alternate,T===null)throw Error(y(387));T.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(t!==null?t.push(Vl):t=[Vl])}x=x.return}t!==null&&sd(a,t,i,c),a.flags|=262144}function Ao(t){for(t=t.firstContext;t!==null;){if(!d(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Zr(t){Kr=t,Sn=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Qs(t){return O0(Kr,t)}function Eo(t,a){return Kr===null&&Zr(t),O0(t,a)}function O0(t,a){var i=a._currentValue;if(a={context:a,memoizedValue:i,next:null},Sn===null){if(t===null)throw Error(y(308));Sn=a,t.dependencies={lanes:0,firstContext:a},t.flags|=524288}else Sn=Sn.next=a;return i}var rm=typeof AbortController<"u"?AbortController:function(){var t=[],a=this.signal={aborted:!1,addEventListener:function(i,c){t.push(c)}};this.abort=function(){a.aborted=!0,t.forEach(function(i){return i()})}},im=h.unstable_scheduleCallback,lm=h.unstable_NormalPriority,ks={$$typeof:H,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ad(){return{controller:new rm,data:new Map,refCount:0}}function pl(t){t.refCount--,t.refCount===0&&im(lm,function(){t.controller.abort()})}var yl=null,nd=0,Ai=0,Ei=null;function om(t,a){if(yl===null){var i=yl=[];nd=0,Ai=lu(),Ei={status:"pending",value:void 0,then:function(c){i.push(c)}}}return nd++,a.then(D0,D0),a}function D0(){if(--nd===0&&yl!==null){Ei!==null&&(Ei.status="fulfilled");var t=yl;yl=null,Ai=0,Ei=null;for(var a=0;a<t.length;a++)(0,t[a])()}}function cm(t,a){var i=[],c={status:"pending",value:null,reason:null,then:function(x){i.push(x)}};return t.then(function(){c.status="fulfilled",c.value=a;for(var x=0;x<i.length;x++)(0,i[x])(a)},function(x){for(c.status="rejected",c.reason=x,x=0;x<i.length;x++)(0,i[x])(void 0)}),c}var _0=W.S;W.S=function(t,a){gf=We(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&om(t,a),_0!==null&&_0(t,a)};var Wr=E(null);function rd(){var t=Wr.current;return t!==null?t:cs.pooledCache}function So(t,a){a===null?U(Wr,Wr.current):U(Wr,a.pool)}function I0(){var t=rd();return t===null?null:{parent:ks._currentValue,pool:t}}var Si=Error(y(460)),id=Error(y(474)),To=Error(y(542)),Ro={then:function(){}};function M0(t){return t=t.status,t==="fulfilled"||t==="rejected"}function k0(t,a,i){switch(i=t[i],i===void 0?t.push(a):i!==a&&(a.then(ca,ca),a=i),a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,L0(t),t;default:if(typeof a.status=="string")a.then(ca,ca);else{if(t=cs,t!==null&&100<t.shellSuspendCounter)throw Error(y(482));t=a,t.status="pending",t.then(function(c){if(a.status==="pending"){var x=a;x.status="fulfilled",x.value=c}},function(c){if(a.status==="pending"){var x=a;x.status="rejected",x.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,L0(t),t}throw Jr=a,Si}}function Qr(t){try{var a=t._init;return a(t._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(Jr=i,Si):i}}var Jr=null;function B0(){if(Jr===null)throw Error(y(459));var t=Jr;return Jr=null,t}function L0(t){if(t===Si||t===To)throw Error(y(483))}var Ti=null,bl=0;function Oo(t){var a=bl;return bl+=1,Ti===null&&(Ti=[]),k0(Ti,t,a)}function wl(t,a){a=a.props.ref,t.ref=a!==void 0?a:null}function Do(t,a){throw a.$$typeof===_?Error(y(525)):(t=Object.prototype.toString.call(a),Error(y(31,t==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":t)))}function P0(t){function a(de,le){if(t){var pe=de.deletions;pe===null?(de.deletions=[le],de.flags|=16):pe.push(le)}}function i(de,le){if(!t)return null;for(;le!==null;)a(de,le),le=le.sibling;return null}function c(de){for(var le=new Map;de!==null;)de.key!==null?le.set(de.key,de):le.set(de.index,de),de=de.sibling;return le}function x(de,le){return de=An(de,le),de.index=0,de.sibling=null,de}function g(de,le,pe){return de.index=pe,t?(pe=de.alternate,pe!==null?(pe=pe.index,pe<le?(de.flags|=67108866,le):pe):(de.flags|=67108866,le)):(de.flags|=1048576,le)}function T(de){return t&&de.alternate===null&&(de.flags|=67108866),de}function B(de,le,pe,_e){return le===null||le.tag!==6?(le=Kc(pe,de.mode,_e),le.return=de,le):(le=x(le,pe),le.return=de,le)}function se(de,le,pe,_e){var it=pe.type;return it===V?De(de,le,pe.props.children,_e,pe.key):le!==null&&(le.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===Re&&Qr(it)===le.type)?(le=x(le,pe.props),wl(le,pe),le.return=de,le):(le=jo(pe.type,pe.key,pe.props,null,de.mode,_e),wl(le,pe),le.return=de,le)}function be(de,le,pe,_e){return le===null||le.tag!==4||le.stateNode.containerInfo!==pe.containerInfo||le.stateNode.implementation!==pe.implementation?(le=Zc(pe,de.mode,_e),le.return=de,le):(le=x(le,pe.children||[]),le.return=de,le)}function De(de,le,pe,_e,it){return le===null||le.tag!==7?(le=Yr(pe,de.mode,_e,it),le.return=de,le):(le=x(le,pe),le.return=de,le)}function Ie(de,le,pe){if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return le=Kc(""+le,de.mode,pe),le.return=de,le;if(typeof le=="object"&&le!==null){switch(le.$$typeof){case L:return pe=jo(le.type,le.key,le.props,null,de.mode,pe),wl(pe,le),pe.return=de,pe;case P:return le=Zc(le,de.mode,pe),le.return=de,le;case Re:return le=Qr(le),Ie(de,le,pe)}if(F(le)||ne(le))return le=Yr(le,de.mode,pe,null),le.return=de,le;if(typeof le.then=="function")return Ie(de,Oo(le),pe);if(le.$$typeof===H)return Ie(de,Eo(de,le),pe);Do(de,le)}return null}function ve(de,le,pe,_e){var it=le!==null?le.key:null;if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return it!==null?null:B(de,le,""+pe,_e);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case L:return pe.key===it?se(de,le,pe,_e):null;case P:return pe.key===it?be(de,le,pe,_e):null;case Re:return pe=Qr(pe),ve(de,le,pe,_e)}if(F(pe)||ne(pe))return it!==null?null:De(de,le,pe,_e,null);if(typeof pe.then=="function")return ve(de,le,Oo(pe),_e);if(pe.$$typeof===H)return ve(de,le,Eo(de,pe),_e);Do(de,pe)}return null}function Ae(de,le,pe,_e,it){if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return de=de.get(pe)||null,B(le,de,""+_e,it);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case L:return de=de.get(_e.key===null?pe:_e.key)||null,se(le,de,_e,it);case P:return de=de.get(_e.key===null?pe:_e.key)||null,be(le,de,_e,it);case Re:return _e=Qr(_e),Ae(de,le,pe,_e,it)}if(F(_e)||ne(_e))return de=de.get(pe)||null,De(le,de,_e,it,null);if(typeof _e.then=="function")return Ae(de,le,pe,Oo(_e),it);if(_e.$$typeof===H)return Ae(de,le,pe,Eo(le,_e),it);Do(le,_e)}return null}function $e(de,le,pe,_e){for(var it=null,Vt=null,tt=le,At=le=0,Lt=null;tt!==null&&At<pe.length;At++){tt.index>At?(Lt=tt,tt=null):Lt=tt.sibling;var Gt=ve(de,tt,pe[At],_e);if(Gt===null){tt===null&&(tt=Lt);break}t&&tt&&Gt.alternate===null&&a(de,tt),le=g(Gt,le,At),Vt===null?it=Gt:Vt.sibling=Gt,Vt=Gt,tt=Lt}if(At===pe.length)return i(de,tt),Pt&&En(de,At),it;if(tt===null){for(;At<pe.length;At++)tt=Ie(de,pe[At],_e),tt!==null&&(le=g(tt,le,At),Vt===null?it=tt:Vt.sibling=tt,Vt=tt);return Pt&&En(de,At),it}for(tt=c(tt);At<pe.length;At++)Lt=Ae(tt,de,At,pe[At],_e),Lt!==null&&(t&&Lt.alternate!==null&&tt.delete(Lt.key===null?At:Lt.key),le=g(Lt,le,At),Vt===null?it=Lt:Vt.sibling=Lt,Vt=Lt);return t&&tt.forEach(function(Rr){return a(de,Rr)}),Pt&&En(de,At),it}function xt(de,le,pe,_e){if(pe==null)throw Error(y(151));for(var it=null,Vt=null,tt=le,At=le=0,Lt=null,Gt=pe.next();tt!==null&&!Gt.done;At++,Gt=pe.next()){tt.index>At?(Lt=tt,tt=null):Lt=tt.sibling;var Rr=ve(de,tt,Gt.value,_e);if(Rr===null){tt===null&&(tt=Lt);break}t&&tt&&Rr.alternate===null&&a(de,tt),le=g(Rr,le,At),Vt===null?it=Rr:Vt.sibling=Rr,Vt=Rr,tt=Lt}if(Gt.done)return i(de,tt),Pt&&En(de,At),it;if(tt===null){for(;!Gt.done;At++,Gt=pe.next())Gt=Ie(de,Gt.value,_e),Gt!==null&&(le=g(Gt,le,At),Vt===null?it=Gt:Vt.sibling=Gt,Vt=Gt);return Pt&&En(de,At),it}for(tt=c(tt);!Gt.done;At++,Gt=pe.next())Gt=Ae(tt,de,At,Gt.value,_e),Gt!==null&&(t&&Gt.alternate!==null&&tt.delete(Gt.key===null?At:Gt.key),le=g(Gt,le,At),Vt===null?it=Gt:Vt.sibling=Gt,Vt=Gt);return t&&tt.forEach(function(wg){return a(de,wg)}),Pt&&En(de,At),it}function ns(de,le,pe,_e){if(typeof pe=="object"&&pe!==null&&pe.type===V&&pe.key===null&&(pe=pe.props.children),typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case L:e:{for(var it=pe.key;le!==null;){if(le.key===it){if(it=pe.type,it===V){if(le.tag===7){i(de,le.sibling),_e=x(le,pe.props.children),_e.return=de,de=_e;break e}}else if(le.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===Re&&Qr(it)===le.type){i(de,le.sibling),_e=x(le,pe.props),wl(_e,pe),_e.return=de,de=_e;break e}i(de,le);break}else a(de,le);le=le.sibling}pe.type===V?(_e=Yr(pe.props.children,de.mode,_e,pe.key),_e.return=de,de=_e):(_e=jo(pe.type,pe.key,pe.props,null,de.mode,_e),wl(_e,pe),_e.return=de,de=_e)}return T(de);case P:e:{for(it=pe.key;le!==null;){if(le.key===it)if(le.tag===4&&le.stateNode.containerInfo===pe.containerInfo&&le.stateNode.implementation===pe.implementation){i(de,le.sibling),_e=x(le,pe.children||[]),_e.return=de,de=_e;break e}else{i(de,le);break}else a(de,le);le=le.sibling}_e=Zc(pe,de.mode,_e),_e.return=de,de=_e}return T(de);case Re:return pe=Qr(pe),ns(de,le,pe,_e)}if(F(pe))return $e(de,le,pe,_e);if(ne(pe)){if(it=ne(pe),typeof it!="function")throw Error(y(150));return pe=it.call(pe),xt(de,le,pe,_e)}if(typeof pe.then=="function")return ns(de,le,Oo(pe),_e);if(pe.$$typeof===H)return ns(de,le,Eo(de,pe),_e);Do(de,pe)}return typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint"?(pe=""+pe,le!==null&&le.tag===6?(i(de,le.sibling),_e=x(le,pe),_e.return=de,de=_e):(i(de,le),_e=Kc(pe,de.mode,_e),_e.return=de,de=_e),T(de)):i(de,le)}return function(de,le,pe,_e){try{bl=0;var it=ns(de,le,pe,_e);return Ti=null,it}catch(tt){if(tt===Si||tt===To)throw tt;var Vt=ja(29,tt,null,de.mode);return Vt.lanes=_e,Vt.return=de,Vt}finally{}}}var $r=P0(!0),F0=P0(!1),hr=!1;function ld(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function od(t,a){t=t.updateQueue,a.updateQueue===t&&(a.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function fr(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function xr(t,a,i){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(qt&2)!==0){var x=c.pending;return x===null?a.next=a:(a.next=x.next,x.next=a),c.pending=a,a=vo(t),v0(t,null,i),a}return No(t,c,a,i),vo(t)}function Nl(t,a,i){if(a=a.updateQueue,a!==null&&(a=a.shared,(i&4194048)!==0)){var c=a.lanes;c&=t.pendingLanes,i|=c,a.lanes=i,an(t,i)}}function cd(t,a){var i=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,i===c)){var x=null,g=null;if(i=i.firstBaseUpdate,i!==null){do{var T={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};g===null?x=g=T:g=g.next=T,i=i.next}while(i!==null);g===null?x=g=a:g=g.next=a}else x=g=a;i={baseState:c.baseState,firstBaseUpdate:x,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},t.updateQueue=i;return}t=i.lastBaseUpdate,t===null?i.firstBaseUpdate=a:t.next=a,i.lastBaseUpdate=a}var dd=!1;function vl(){if(dd){var t=Ei;if(t!==null)throw t}}function jl(t,a,i,c){dd=!1;var x=t.updateQueue;hr=!1;var g=x.firstBaseUpdate,T=x.lastBaseUpdate,B=x.shared.pending;if(B!==null){x.shared.pending=null;var se=B,be=se.next;se.next=null,T===null?g=be:T.next=be,T=se;var De=t.alternate;De!==null&&(De=De.updateQueue,B=De.lastBaseUpdate,B!==T&&(B===null?De.firstBaseUpdate=be:B.next=be,De.lastBaseUpdate=se))}if(g!==null){var Ie=x.baseState;T=0,De=be=se=null,B=g;do{var ve=B.lane&-536870913,Ae=ve!==B.lane;if(Ae?(Bt&ve)===ve:(c&ve)===ve){ve!==0&&ve===Ai&&(dd=!0),De!==null&&(De=De.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});e:{var $e=t,xt=B;ve=a;var ns=i;switch(xt.tag){case 1:if($e=xt.payload,typeof $e=="function"){Ie=$e.call(ns,Ie,ve);break e}Ie=$e;break e;case 3:$e.flags=$e.flags&-65537|128;case 0:if($e=xt.payload,ve=typeof $e=="function"?$e.call(ns,Ie,ve):$e,ve==null)break e;Ie=O({},Ie,ve);break e;case 2:hr=!0}}ve=B.callback,ve!==null&&(t.flags|=64,Ae&&(t.flags|=8192),Ae=x.callbacks,Ae===null?x.callbacks=[ve]:Ae.push(ve))}else Ae={lane:ve,tag:B.tag,payload:B.payload,callback:B.callback,next:null},De===null?(be=De=Ae,se=Ie):De=De.next=Ae,T|=ve;if(B=B.next,B===null){if(B=x.shared.pending,B===null)break;Ae=B,B=Ae.next,Ae.next=null,x.lastBaseUpdate=Ae,x.shared.pending=null}}while(!0);De===null&&(se=Ie),x.baseState=se,x.firstBaseUpdate=be,x.lastBaseUpdate=De,g===null&&(x.shared.lanes=0),br|=T,t.lanes=T,t.memoizedState=Ie}}function U0(t,a){if(typeof t!="function")throw Error(y(191,t));t.call(a)}function z0(t,a){var i=t.callbacks;if(i!==null)for(t.callbacks=null,t=0;t<i.length;t++)U0(i[t],a)}var Ri=E(null),_o=E(0);function H0(t,a){t=Ln,U(_o,t),U(Ri,a),Ln=t|a.baseLanes}function ud(){U(_o,Ln),U(Ri,Ri.current)}function hd(){Ln=_o.current,G(Ri),G(_o)}var Ca=E(null),Ua=null;function mr(t){var a=t.alternate;U(Rs,Rs.current&1),U(Ca,t),Ua===null&&(a===null||Ri.current!==null||a.memoizedState!==null)&&(Ua=t)}function fd(t){U(Rs,Rs.current),U(Ca,t),Ua===null&&(Ua=t)}function V0(t){t.tag===22?(U(Rs,Rs.current),U(Ca,t),Ua===null&&(Ua=t)):gr()}function gr(){U(Rs,Rs.current),U(Ca,Ca.current)}function Aa(t){G(Ca),Ua===t&&(Ua=null),G(Rs)}var Rs=E(0);function Io(t){for(var a=t;a!==null;){if(a.tag===13){var i=a.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||bu(i)||wu(i)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Rn=0,vt=null,ss=null,Bs=null,Mo=!1,Oi=!1,ei=!1,ko=0,Cl=0,Di=null,dm=0;function vs(){throw Error(y(321))}function xd(t,a){if(a===null)return!1;for(var i=0;i<a.length&&i<t.length;i++)if(!d(t[i],a[i]))return!1;return!0}function md(t,a,i,c,x,g){return Rn=g,vt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,W.H=t===null||t.memoizedState===null?Eh:Od,ei=!1,g=i(c,x),ei=!1,Oi&&(g=X0(a,i,c,x)),G0(t),g}function G0(t){W.H=Sl;var a=ss!==null&&ss.next!==null;if(Rn=0,Bs=ss=vt=null,Mo=!1,Cl=0,Di=null,a)throw Error(y(300));t===null||Ls||(t=t.dependencies,t!==null&&Ao(t)&&(Ls=!0))}function X0(t,a,i,c){vt=t;var x=0;do{if(Oi&&(Di=null),Cl=0,Oi=!1,25<=x)throw Error(y(301));if(x+=1,Bs=ss=null,t.updateQueue!=null){var g=t.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}W.H=Sh,g=a(i,c)}while(Oi);return g}function um(){var t=W.H,a=t.useState()[0];return a=typeof a.then=="function"?Al(a):a,t=t.useState()[0],(ss!==null?ss.memoizedState:null)!==t&&(vt.flags|=1024),a}function gd(){var t=ko!==0;return ko=0,t}function pd(t,a,i){a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~i}function yd(t){if(Mo){for(t=t.memoizedState;t!==null;){var a=t.queue;a!==null&&(a.pending=null),t=t.next}Mo=!1}Rn=0,Bs=ss=vt=null,Oi=!1,Cl=ko=0,Di=null}function la(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bs===null?vt.memoizedState=Bs=t:Bs=Bs.next=t,Bs}function Os(){if(ss===null){var t=vt.alternate;t=t!==null?t.memoizedState:null}else t=ss.next;var a=Bs===null?vt.memoizedState:Bs.next;if(a!==null)Bs=a,ss=t;else{if(t===null)throw vt.alternate===null?Error(y(467)):Error(y(310));ss=t,t={memoizedState:ss.memoizedState,baseState:ss.baseState,baseQueue:ss.baseQueue,queue:ss.queue,next:null},Bs===null?vt.memoizedState=Bs=t:Bs=Bs.next=t}return Bs}function Bo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Al(t){var a=Cl;return Cl+=1,Di===null&&(Di=[]),t=k0(Di,t,a),a=vt,(Bs===null?a.memoizedState:Bs.next)===null&&(a=a.alternate,W.H=a===null||a.memoizedState===null?Eh:Od),t}function Lo(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Al(t);if(t.$$typeof===H)return Qs(t)}throw Error(y(438,String(t)))}function bd(t){var a=null,i=vt.updateQueue;if(i!==null&&(a=i.memoCache),a==null){var c=vt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(x){return x.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),i===null&&(i=Bo(),vt.updateQueue=i),i.memoCache=a,i=a.data[a.index],i===void 0)for(i=a.data[a.index]=Array(t),c=0;c<t;c++)i[c]=Ee;return a.index++,i}function On(t,a){return typeof a=="function"?a(t):a}function Po(t){var a=Os();return wd(a,ss,t)}function wd(t,a,i){var c=t.queue;if(c===null)throw Error(y(311));c.lastRenderedReducer=i;var x=t.baseQueue,g=c.pending;if(g!==null){if(x!==null){var T=x.next;x.next=g.next,g.next=T}a.baseQueue=x=g,c.pending=null}if(g=t.baseState,x===null)t.memoizedState=g;else{a=x.next;var B=T=null,se=null,be=a,De=!1;do{var Ie=be.lane&-536870913;if(Ie!==be.lane?(Bt&Ie)===Ie:(Rn&Ie)===Ie){var ve=be.revertLane;if(ve===0)se!==null&&(se=se.next={lane:0,revertLane:0,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),Ie===Ai&&(De=!0);else if((Rn&ve)===ve){be=be.next,ve===Ai&&(De=!0);continue}else Ie={lane:0,revertLane:be.revertLane,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},se===null?(B=se=Ie,T=g):se=se.next=Ie,vt.lanes|=ve,br|=ve;Ie=be.action,ei&&i(g,Ie),g=be.hasEagerState?be.eagerState:i(g,Ie)}else ve={lane:Ie,revertLane:be.revertLane,gesture:be.gesture,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},se===null?(B=se=ve,T=g):se=se.next=ve,vt.lanes|=Ie,br|=Ie;be=be.next}while(be!==null&&be!==a);if(se===null?T=g:se.next=B,!d(g,t.memoizedState)&&(Ls=!0,De&&(i=Ei,i!==null)))throw i;t.memoizedState=g,t.baseState=T,t.baseQueue=se,c.lastRenderedState=g}return x===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function Nd(t){var a=Os(),i=a.queue;if(i===null)throw Error(y(311));i.lastRenderedReducer=t;var c=i.dispatch,x=i.pending,g=a.memoizedState;if(x!==null){i.pending=null;var T=x=x.next;do g=t(g,T.action),T=T.next;while(T!==x);d(g,a.memoizedState)||(Ls=!0),a.memoizedState=g,a.baseQueue===null&&(a.baseState=g),i.lastRenderedState=g}return[g,c]}function Y0(t,a,i){var c=vt,x=Os(),g=Pt;if(g){if(i===void 0)throw Error(y(407));i=i()}else i=a();var T=!d((ss||x).memoizedState,i);if(T&&(x.memoizedState=i,Ls=!0),x=x.queue,Cd(Z0.bind(null,c,x,t),[t]),x.getSnapshot!==a||T||Bs!==null&&Bs.memoizedState.tag&1){if(c.flags|=2048,_i(9,{destroy:void 0},K0.bind(null,c,x,i,a),null),cs===null)throw Error(y(349));g||(Rn&127)!==0||q0(c,a,i)}return i}function q0(t,a,i){t.flags|=16384,t={getSnapshot:a,value:i},a=vt.updateQueue,a===null?(a=Bo(),vt.updateQueue=a,a.stores=[t]):(i=a.stores,i===null?a.stores=[t]:i.push(t))}function K0(t,a,i,c){a.value=i,a.getSnapshot=c,W0(a)&&Q0(t)}function Z0(t,a,i){return i(function(){W0(a)&&Q0(t)})}function W0(t){var a=t.getSnapshot;t=t.value;try{var i=a();return!d(t,i)}catch{return!0}}function Q0(t){var a=Xr(t,2);a!==null&&ga(a,t,2)}function vd(t){var a=la();if(typeof t=="function"){var i=t;if(t=i(),ei){ot(!0);try{i()}finally{ot(!1)}}}return a.memoizedState=a.baseState=t,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:On,lastRenderedState:t},a}function J0(t,a,i,c){return t.baseState=i,wd(t,ss,typeof c=="function"?c:On)}function hm(t,a,i,c,x){if(zo(t))throw Error(y(485));if(t=a.action,t!==null){var g={payload:x,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){g.listeners.push(T)}};W.T!==null?i(!0):g.isTransition=!1,c(g),i=a.pending,i===null?(g.next=a.pending=g,$0(a,g)):(g.next=i.next,a.pending=i.next=g)}}function $0(t,a){var i=a.action,c=a.payload,x=t.state;if(a.isTransition){var g=W.T,T={};W.T=T;try{var B=i(x,c),se=W.S;se!==null&&se(T,B),eh(t,a,B)}catch(be){jd(t,a,be)}finally{g!==null&&T.types!==null&&(g.types=T.types),W.T=g}}else try{g=i(x,c),eh(t,a,g)}catch(be){jd(t,a,be)}}function eh(t,a,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(c){th(t,a,c)},function(c){return jd(t,a,c)}):th(t,a,i)}function th(t,a,i){a.status="fulfilled",a.value=i,sh(a),t.state=i,a=t.pending,a!==null&&(i=a.next,i===a?t.pending=null:(i=i.next,a.next=i,$0(t,i)))}function jd(t,a,i){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=i,sh(a),a=a.next;while(a!==c)}t.action=null}function sh(t){t=t.listeners;for(var a=0;a<t.length;a++)(0,t[a])()}function ah(t,a){return a}function nh(t,a){if(Pt){var i=cs.formState;if(i!==null){e:{var c=vt;if(Pt){if(fs){t:{for(var x=fs,g=Fa;x.nodeType!==8;){if(!g){x=null;break t}if(x=za(x.nextSibling),x===null){x=null;break t}}g=x.data,x=g==="F!"||g==="F"?x:null}if(x){fs=za(x.nextSibling),c=x.data==="F!";break e}}dr(c)}c=!1}c&&(a=i[0])}}return i=la(),i.memoizedState=i.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ah,lastRenderedState:a},i.queue=c,i=jh.bind(null,vt,c),c.dispatch=i,c=vd(!1),g=Rd.bind(null,vt,!1,c.queue),c=la(),x={state:a,dispatch:null,action:t,pending:null},c.queue=x,i=hm.bind(null,vt,x,g,i),x.dispatch=i,c.memoizedState=t,[a,i,!1]}function rh(t){var a=Os();return ih(a,ss,t)}function ih(t,a,i){if(a=wd(t,a,ah)[0],t=Po(On)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=Al(a)}catch(T){throw T===Si?To:T}else c=a;a=Os();var x=a.queue,g=x.dispatch;return i!==a.memoizedState&&(vt.flags|=2048,_i(9,{destroy:void 0},fm.bind(null,x,i),null)),[c,g,t]}function fm(t,a){t.action=a}function lh(t){var a=Os(),i=ss;if(i!==null)return ih(a,i,t);Os(),a=a.memoizedState,i=Os();var c=i.queue.dispatch;return i.memoizedState=t,[a,c,!1]}function _i(t,a,i,c){return t={tag:t,create:i,deps:c,inst:a,next:null},a=vt.updateQueue,a===null&&(a=Bo(),vt.updateQueue=a),i=a.lastEffect,i===null?a.lastEffect=t.next=t:(c=i.next,i.next=t,t.next=c,a.lastEffect=t),t}function oh(){return Os().memoizedState}function Fo(t,a,i,c){var x=la();vt.flags|=t,x.memoizedState=_i(1|a,{destroy:void 0},i,c===void 0?null:c)}function Uo(t,a,i,c){var x=Os();c=c===void 0?null:c;var g=x.memoizedState.inst;ss!==null&&c!==null&&xd(c,ss.memoizedState.deps)?x.memoizedState=_i(a,g,i,c):(vt.flags|=t,x.memoizedState=_i(1|a,g,i,c))}function ch(t,a){Fo(8390656,8,t,a)}function Cd(t,a){Uo(2048,8,t,a)}function xm(t){vt.flags|=4;var a=vt.updateQueue;if(a===null)a=Bo(),vt.updateQueue=a,a.events=[t];else{var i=a.events;i===null?a.events=[t]:i.push(t)}}function dh(t){var a=Os().memoizedState;return xm({ref:a,nextImpl:t}),function(){if((qt&2)!==0)throw Error(y(440));return a.impl.apply(void 0,arguments)}}function uh(t,a){return Uo(4,2,t,a)}function hh(t,a){return Uo(4,4,t,a)}function fh(t,a){if(typeof a=="function"){t=t();var i=a(t);return function(){typeof i=="function"?i():a(null)}}if(a!=null)return t=t(),a.current=t,function(){a.current=null}}function xh(t,a,i){i=i!=null?i.concat([t]):null,Uo(4,4,fh.bind(null,a,t),i)}function Ad(){}function mh(t,a){var i=Os();a=a===void 0?null:a;var c=i.memoizedState;return a!==null&&xd(a,c[1])?c[0]:(i.memoizedState=[t,a],t)}function gh(t,a){var i=Os();a=a===void 0?null:a;var c=i.memoizedState;if(a!==null&&xd(a,c[1]))return c[0];if(c=t(),ei){ot(!0);try{t()}finally{ot(!1)}}return i.memoizedState=[c,a],c}function Ed(t,a,i){return i===void 0||(Rn&1073741824)!==0&&(Bt&261930)===0?t.memoizedState=a:(t.memoizedState=i,t=yf(),vt.lanes|=t,br|=t,i)}function ph(t,a,i,c){return d(i,a)?i:Ri.current!==null?(t=Ed(t,i,c),d(t,a)||(Ls=!0),t):(Rn&42)===0||(Rn&1073741824)!==0&&(Bt&261930)===0?(Ls=!0,t.memoizedState=i):(t=yf(),vt.lanes|=t,br|=t,a)}function yh(t,a,i,c,x){var g=Q.p;Q.p=g!==0&&8>g?g:8;var T=W.T,B={};W.T=B,Rd(t,!1,a,i);try{var se=x(),be=W.S;if(be!==null&&be(B,se),se!==null&&typeof se=="object"&&typeof se.then=="function"){var De=cm(se,c);El(t,a,De,Ta(t))}else El(t,a,c,Ta(t))}catch(Ie){El(t,a,{then:function(){},status:"rejected",reason:Ie},Ta())}finally{Q.p=g,T!==null&&B.types!==null&&(T.types=B.types),W.T=T}}function mm(){}function Sd(t,a,i,c){if(t.tag!==5)throw Error(y(476));var x=bh(t).queue;yh(t,x,a,Ne,i===null?mm:function(){return wh(t),i(c)})}function bh(t){var a=t.memoizedState;if(a!==null)return a;a={memoizedState:Ne,baseState:Ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:On,lastRenderedState:Ne},next:null};var i={};return a.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:On,lastRenderedState:i},next:null},t.memoizedState=a,t=t.alternate,t!==null&&(t.memoizedState=a),a}function wh(t){var a=bh(t);a.next===null&&(a=t.alternate.memoizedState),El(t,a.next.queue,{},Ta())}function Td(){return Qs(Vl)}function Nh(){return Os().memoizedState}function vh(){return Os().memoizedState}function gm(t){for(var a=t.return;a!==null;){switch(a.tag){case 24:case 3:var i=Ta();t=fr(i);var c=xr(a,t,i);c!==null&&(ga(c,a,i),Nl(c,a,i)),a={cache:ad()},t.payload=a;return}a=a.return}}function pm(t,a,i){var c=Ta();i={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},zo(t)?Ch(a,i):(i=Yc(t,a,i,c),i!==null&&(ga(i,t,c),Ah(i,a,c)))}function jh(t,a,i){var c=Ta();El(t,a,i,c)}function El(t,a,i,c){var x={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(zo(t))Ch(a,x);else{var g=t.alternate;if(t.lanes===0&&(g===null||g.lanes===0)&&(g=a.lastRenderedReducer,g!==null))try{var T=a.lastRenderedState,B=g(T,i);if(x.hasEagerState=!0,x.eagerState=B,d(B,T))return No(t,a,x,0),cs===null&&wo(),!1}catch{}finally{}if(i=Yc(t,a,x,c),i!==null)return ga(i,t,c),Ah(i,a,c),!0}return!1}function Rd(t,a,i,c){if(c={lane:2,revertLane:lu(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},zo(t)){if(a)throw Error(y(479))}else a=Yc(t,i,c,2),a!==null&&ga(a,t,2)}function zo(t){var a=t.alternate;return t===vt||a!==null&&a===vt}function Ch(t,a){Oi=Mo=!0;var i=t.pending;i===null?a.next=a:(a.next=i.next,i.next=a),t.pending=a}function Ah(t,a,i){if((i&4194048)!==0){var c=a.lanes;c&=t.pendingLanes,i|=c,a.lanes=i,an(t,i)}}var Sl={readContext:Qs,use:Lo,useCallback:vs,useContext:vs,useEffect:vs,useImperativeHandle:vs,useLayoutEffect:vs,useInsertionEffect:vs,useMemo:vs,useReducer:vs,useRef:vs,useState:vs,useDebugValue:vs,useDeferredValue:vs,useTransition:vs,useSyncExternalStore:vs,useId:vs,useHostTransitionStatus:vs,useFormState:vs,useActionState:vs,useOptimistic:vs,useMemoCache:vs,useCacheRefresh:vs};Sl.useEffectEvent=vs;var Eh={readContext:Qs,use:Lo,useCallback:function(t,a){return la().memoizedState=[t,a===void 0?null:a],t},useContext:Qs,useEffect:ch,useImperativeHandle:function(t,a,i){i=i!=null?i.concat([t]):null,Fo(4194308,4,fh.bind(null,a,t),i)},useLayoutEffect:function(t,a){return Fo(4194308,4,t,a)},useInsertionEffect:function(t,a){Fo(4,2,t,a)},useMemo:function(t,a){var i=la();a=a===void 0?null:a;var c=t();if(ei){ot(!0);try{t()}finally{ot(!1)}}return i.memoizedState=[c,a],c},useReducer:function(t,a,i){var c=la();if(i!==void 0){var x=i(a);if(ei){ot(!0);try{i(a)}finally{ot(!1)}}}else x=a;return c.memoizedState=c.baseState=x,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:x},c.queue=t,t=t.dispatch=pm.bind(null,vt,t),[c.memoizedState,t]},useRef:function(t){var a=la();return t={current:t},a.memoizedState=t},useState:function(t){t=vd(t);var a=t.queue,i=jh.bind(null,vt,a);return a.dispatch=i,[t.memoizedState,i]},useDebugValue:Ad,useDeferredValue:function(t,a){var i=la();return Ed(i,t,a)},useTransition:function(){var t=vd(!1);return t=yh.bind(null,vt,t.queue,!0,!1),la().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,a,i){var c=vt,x=la();if(Pt){if(i===void 0)throw Error(y(407));i=i()}else{if(i=a(),cs===null)throw Error(y(349));(Bt&127)!==0||q0(c,a,i)}x.memoizedState=i;var g={value:i,getSnapshot:a};return x.queue=g,ch(Z0.bind(null,c,g,t),[t]),c.flags|=2048,_i(9,{destroy:void 0},K0.bind(null,c,g,i,a),null),i},useId:function(){var t=la(),a=cs.identifierPrefix;if(Pt){var i=dn,c=cn;i=(c&~(1<<32-Ye(c)-1)).toString(32)+i,a="_"+a+"R_"+i,i=ko++,0<i&&(a+="H"+i.toString(32)),a+="_"}else i=dm++,a="_"+a+"r_"+i.toString(32)+"_";return t.memoizedState=a},useHostTransitionStatus:Td,useFormState:nh,useActionState:nh,useOptimistic:function(t){var a=la();a.memoizedState=a.baseState=t;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=i,a=Rd.bind(null,vt,!0,i),i.dispatch=a,[t,a]},useMemoCache:bd,useCacheRefresh:function(){return la().memoizedState=gm.bind(null,vt)},useEffectEvent:function(t){var a=la(),i={impl:t};return a.memoizedState=i,function(){if((qt&2)!==0)throw Error(y(440));return i.impl.apply(void 0,arguments)}}},Od={readContext:Qs,use:Lo,useCallback:mh,useContext:Qs,useEffect:Cd,useImperativeHandle:xh,useInsertionEffect:uh,useLayoutEffect:hh,useMemo:gh,useReducer:Po,useRef:oh,useState:function(){return Po(On)},useDebugValue:Ad,useDeferredValue:function(t,a){var i=Os();return ph(i,ss.memoizedState,t,a)},useTransition:function(){var t=Po(On)[0],a=Os().memoizedState;return[typeof t=="boolean"?t:Al(t),a]},useSyncExternalStore:Y0,useId:Nh,useHostTransitionStatus:Td,useFormState:rh,useActionState:rh,useOptimistic:function(t,a){var i=Os();return J0(i,ss,t,a)},useMemoCache:bd,useCacheRefresh:vh};Od.useEffectEvent=dh;var Sh={readContext:Qs,use:Lo,useCallback:mh,useContext:Qs,useEffect:Cd,useImperativeHandle:xh,useInsertionEffect:uh,useLayoutEffect:hh,useMemo:gh,useReducer:Nd,useRef:oh,useState:function(){return Nd(On)},useDebugValue:Ad,useDeferredValue:function(t,a){var i=Os();return ss===null?Ed(i,t,a):ph(i,ss.memoizedState,t,a)},useTransition:function(){var t=Nd(On)[0],a=Os().memoizedState;return[typeof t=="boolean"?t:Al(t),a]},useSyncExternalStore:Y0,useId:Nh,useHostTransitionStatus:Td,useFormState:lh,useActionState:lh,useOptimistic:function(t,a){var i=Os();return ss!==null?J0(i,ss,t,a):(i.baseState=t,[t,i.queue.dispatch])},useMemoCache:bd,useCacheRefresh:vh};Sh.useEffectEvent=dh;function Dd(t,a,i,c){a=t.memoizedState,i=i(c,a),i=i==null?a:O({},a,i),t.memoizedState=i,t.lanes===0&&(t.updateQueue.baseState=i)}var _d={enqueueSetState:function(t,a,i){t=t._reactInternals;var c=Ta(),x=fr(c);x.payload=a,i!=null&&(x.callback=i),a=xr(t,x,c),a!==null&&(ga(a,t,c),Nl(a,t,c))},enqueueReplaceState:function(t,a,i){t=t._reactInternals;var c=Ta(),x=fr(c);x.tag=1,x.payload=a,i!=null&&(x.callback=i),a=xr(t,x,c),a!==null&&(ga(a,t,c),Nl(a,t,c))},enqueueForceUpdate:function(t,a){t=t._reactInternals;var i=Ta(),c=fr(i);c.tag=2,a!=null&&(c.callback=a),a=xr(t,c,i),a!==null&&(ga(a,t,i),Nl(a,t,i))}};function Th(t,a,i,c,x,g,T){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,g,T):a.prototype&&a.prototype.isPureReactComponent?!u(i,c)||!u(x,g):!0}function Rh(t,a,i,c){t=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(i,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(i,c),a.state!==t&&_d.enqueueReplaceState(a,a.state,null)}function ti(t,a){var i=a;if("ref"in a){i={};for(var c in a)c!=="ref"&&(i[c]=a[c])}if(t=t.defaultProps){i===a&&(i=O({},i));for(var x in t)i[x]===void 0&&(i[x]=t[x])}return i}function Oh(t){bo(t)}function Dh(t){console.error(t)}function _h(t){bo(t)}function Ho(t,a){try{var i=t.onUncaughtError;i(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Ih(t,a,i){try{var c=t.onCaughtError;c(i.value,{componentStack:i.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Id(t,a,i){return i=fr(i),i.tag=3,i.payload={element:null},i.callback=function(){Ho(t,a)},i}function Mh(t){return t=fr(t),t.tag=3,t}function kh(t,a,i,c){var x=i.type.getDerivedStateFromError;if(typeof x=="function"){var g=c.value;t.payload=function(){return x(g)},t.callback=function(){Ih(a,i,c)}}var T=i.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(t.callback=function(){Ih(a,i,c),typeof x!="function"&&(wr===null?wr=new Set([this]):wr.add(this));var B=c.stack;this.componentDidCatch(c.value,{componentStack:B!==null?B:""})})}function ym(t,a,i,c,x){if(i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=i.alternate,a!==null&&Ci(a,i,x,!0),i=Ca.current,i!==null){switch(i.tag){case 31:case 13:return Ua===null?ec():i.alternate===null&&js===0&&(js=3),i.flags&=-257,i.flags|=65536,i.lanes=x,c===Ro?i.flags|=16384:(a=i.updateQueue,a===null?i.updateQueue=new Set([c]):a.add(c),nu(t,c,x)),!1;case 22:return i.flags|=65536,c===Ro?i.flags|=16384:(a=i.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},i.updateQueue=a):(i=a.retryQueue,i===null?a.retryQueue=new Set([c]):i.add(c)),nu(t,c,x)),!1}throw Error(y(435,i.tag))}return nu(t,c,x),ec(),!1}if(Pt)return a=Ca.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=x,c!==Jc&&(t=Error(y(422),{cause:c}),gl(Ba(t,i)))):(c!==Jc&&(a=Error(y(423),{cause:c}),gl(Ba(a,i))),t=t.current.alternate,t.flags|=65536,x&=-x,t.lanes|=x,c=Ba(c,i),x=Id(t.stateNode,c,x),cd(t,x),js!==4&&(js=2)),!1;var g=Error(y(520),{cause:c});if(g=Ba(g,i),kl===null?kl=[g]:kl.push(g),js!==4&&(js=2),a===null)return!0;c=Ba(c,i),i=a;do{switch(i.tag){case 3:return i.flags|=65536,t=x&-x,i.lanes|=t,t=Id(i.stateNode,c,t),cd(i,t),!1;case 1:if(a=i.type,g=i.stateNode,(i.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(wr===null||!wr.has(g))))return i.flags|=65536,x&=-x,i.lanes|=x,x=Mh(x),kh(x,t,i,c),cd(i,x),!1}i=i.return}while(i!==null);return!1}var Md=Error(y(461)),Ls=!1;function Js(t,a,i,c){a.child=t===null?F0(a,null,i,c):$r(a,t.child,i,c)}function Bh(t,a,i,c,x){i=i.render;var g=a.ref;if("ref"in c){var T={};for(var B in c)B!=="ref"&&(T[B]=c[B])}else T=c;return Zr(a),c=md(t,a,i,T,g,x),B=gd(),t!==null&&!Ls?(pd(t,a,x),Dn(t,a,x)):(Pt&&B&&Wc(a),a.flags|=1,Js(t,a,c,x),a.child)}function Lh(t,a,i,c,x){if(t===null){var g=i.type;return typeof g=="function"&&!qc(g)&&g.defaultProps===void 0&&i.compare===null?(a.tag=15,a.type=g,Ph(t,a,g,c,x)):(t=jo(i.type,null,c,a,a.mode,x),t.ref=a.ref,t.return=a,a.child=t)}if(g=t.child,!Hd(t,x)){var T=g.memoizedProps;if(i=i.compare,i=i!==null?i:u,i(T,c)&&t.ref===a.ref)return Dn(t,a,x)}return a.flags|=1,t=An(g,c),t.ref=a.ref,t.return=a,a.child=t}function Ph(t,a,i,c,x){if(t!==null){var g=t.memoizedProps;if(u(g,c)&&t.ref===a.ref)if(Ls=!1,a.pendingProps=c=g,Hd(t,x))(t.flags&131072)!==0&&(Ls=!0);else return a.lanes=t.lanes,Dn(t,a,x)}return kd(t,a,i,c,x)}function Fh(t,a,i,c){var x=c.children,g=t!==null?t.memoizedState:null;if(t===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(g=g!==null?g.baseLanes|i:i,t!==null){for(c=a.child=t.child,x=0;c!==null;)x=x|c.lanes|c.childLanes,c=c.sibling;c=x&~g}else c=0,a.child=null;return Uh(t,a,g,i,c)}if((i&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},t!==null&&So(a,g!==null?g.cachePool:null),g!==null?H0(a,g):ud(),V0(a);else return c=a.lanes=536870912,Uh(t,a,g!==null?g.baseLanes|i:i,i,c)}else g!==null?(So(a,g.cachePool),H0(a,g),gr(),a.memoizedState=null):(t!==null&&So(a,null),ud(),gr());return Js(t,a,x,i),a.child}function Tl(t,a){return t!==null&&t.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Uh(t,a,i,c,x){var g=rd();return g=g===null?null:{parent:ks._currentValue,pool:g},a.memoizedState={baseLanes:i,cachePool:g},t!==null&&So(a,null),ud(),V0(a),t!==null&&Ci(t,a,c,!0),a.childLanes=x,null}function Vo(t,a){return a=Xo({mode:a.mode,children:a.children},t.mode),a.ref=t.ref,t.child=a,a.return=t,a}function zh(t,a,i){return $r(a,t.child,null,i),t=Vo(a,a.pendingProps),t.flags|=2,Aa(a),a.memoizedState=null,t}function bm(t,a,i){var c=a.pendingProps,x=(a.flags&128)!==0;if(a.flags&=-129,t===null){if(Pt){if(c.mode==="hidden")return t=Vo(a,c),a.lanes=536870912,Tl(null,t);if(fd(a),(t=fs)?(t=e1(t,Fa),t=t!==null&&t.data==="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:or!==null?{id:cn,overflow:dn}:null,retryLane:536870912,hydrationErrors:null},i=C0(t),i.return=a,a.child=i,Ws=a,fs=null)):t=null,t===null)throw dr(a);return a.lanes=536870912,null}return Vo(a,c)}var g=t.memoizedState;if(g!==null){var T=g.dehydrated;if(fd(a),x)if(a.flags&256)a.flags&=-257,a=zh(t,a,i);else if(a.memoizedState!==null)a.child=t.child,a.flags|=128,a=null;else throw Error(y(558));else if(Ls||Ci(t,a,i,!1),x=(i&t.childLanes)!==0,Ls||x){if(c=cs,c!==null&&(T=oi(c,i),T!==0&&T!==g.retryLane))throw g.retryLane=T,Xr(t,T),ga(c,t,T),Md;ec(),a=zh(t,a,i)}else t=g.treeContext,fs=za(T.nextSibling),Ws=a,Pt=!0,cr=null,Fa=!1,t!==null&&S0(a,t),a=Vo(a,c),a.flags|=4096;return a}return t=An(t.child,{mode:c.mode,children:c.children}),t.ref=a.ref,a.child=t,t.return=a,t}function Go(t,a){var i=a.ref;if(i===null)t!==null&&t.ref!==null&&(a.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(y(284));(t===null||t.ref!==i)&&(a.flags|=4194816)}}function kd(t,a,i,c,x){return Zr(a),i=md(t,a,i,c,void 0,x),c=gd(),t!==null&&!Ls?(pd(t,a,x),Dn(t,a,x)):(Pt&&c&&Wc(a),a.flags|=1,Js(t,a,i,x),a.child)}function Hh(t,a,i,c,x,g){return Zr(a),a.updateQueue=null,i=X0(a,c,i,x),G0(t),c=gd(),t!==null&&!Ls?(pd(t,a,g),Dn(t,a,g)):(Pt&&c&&Wc(a),a.flags|=1,Js(t,a,i,g),a.child)}function Vh(t,a,i,c,x){if(Zr(a),a.stateNode===null){var g=wi,T=i.contextType;typeof T=="object"&&T!==null&&(g=Qs(T)),g=new i(c,g),a.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=_d,a.stateNode=g,g._reactInternals=a,g=a.stateNode,g.props=c,g.state=a.memoizedState,g.refs={},ld(a),T=i.contextType,g.context=typeof T=="object"&&T!==null?Qs(T):wi,g.state=a.memoizedState,T=i.getDerivedStateFromProps,typeof T=="function"&&(Dd(a,i,T,c),g.state=a.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(T=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),T!==g.state&&_d.enqueueReplaceState(g,g.state,null),jl(a,c,g,x),vl(),g.state=a.memoizedState),typeof g.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(t===null){g=a.stateNode;var B=a.memoizedProps,se=ti(i,B);g.props=se;var be=g.context,De=i.contextType;T=wi,typeof De=="object"&&De!==null&&(T=Qs(De));var Ie=i.getDerivedStateFromProps;De=typeof Ie=="function"||typeof g.getSnapshotBeforeUpdate=="function",B=a.pendingProps!==B,De||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(B||be!==T)&&Rh(a,g,c,T),hr=!1;var ve=a.memoizedState;g.state=ve,jl(a,c,g,x),vl(),be=a.memoizedState,B||ve!==be||hr?(typeof Ie=="function"&&(Dd(a,i,Ie,c),be=a.memoizedState),(se=hr||Th(a,i,se,c,ve,be,T))?(De||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(a.flags|=4194308)):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=be),g.props=c,g.state=be,g.context=T,c=se):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{g=a.stateNode,od(t,a),T=a.memoizedProps,De=ti(i,T),g.props=De,Ie=a.pendingProps,ve=g.context,be=i.contextType,se=wi,typeof be=="object"&&be!==null&&(se=Qs(be)),B=i.getDerivedStateFromProps,(be=typeof B=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T!==Ie||ve!==se)&&Rh(a,g,c,se),hr=!1,ve=a.memoizedState,g.state=ve,jl(a,c,g,x),vl();var Ae=a.memoizedState;T!==Ie||ve!==Ae||hr||t!==null&&t.dependencies!==null&&Ao(t.dependencies)?(typeof B=="function"&&(Dd(a,i,B,c),Ae=a.memoizedState),(De=hr||Th(a,i,De,c,ve,Ae,se)||t!==null&&t.dependencies!==null&&Ao(t.dependencies))?(be||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,Ae,se),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,Ae,se)),typeof g.componentDidUpdate=="function"&&(a.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof g.componentDidUpdate!="function"||T===t.memoizedProps&&ve===t.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===t.memoizedProps&&ve===t.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=Ae),g.props=c,g.state=Ae,g.context=se,c=De):(typeof g.componentDidUpdate!="function"||T===t.memoizedProps&&ve===t.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===t.memoizedProps&&ve===t.memoizedState||(a.flags|=1024),c=!1)}return g=c,Go(t,a),c=(a.flags&128)!==0,g||c?(g=a.stateNode,i=c&&typeof i.getDerivedStateFromError!="function"?null:g.render(),a.flags|=1,t!==null&&c?(a.child=$r(a,t.child,null,x),a.child=$r(a,null,i,x)):Js(t,a,i,x),a.memoizedState=g.state,t=a.child):t=Dn(t,a,x),t}function Gh(t,a,i,c){return qr(),a.flags|=256,Js(t,a,i,c),a.child}var Bd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ld(t){return{baseLanes:t,cachePool:I0()}}function Pd(t,a,i){return t=t!==null?t.childLanes&~i:0,a&&(t|=Sa),t}function Xh(t,a,i){var c=a.pendingProps,x=!1,g=(a.flags&128)!==0,T;if((T=g)||(T=t!==null&&t.memoizedState===null?!1:(Rs.current&2)!==0),T&&(x=!0,a.flags&=-129),T=(a.flags&32)!==0,a.flags&=-33,t===null){if(Pt){if(x?mr(a):gr(),(t=fs)?(t=e1(t,Fa),t=t!==null&&t.data!=="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:or!==null?{id:cn,overflow:dn}:null,retryLane:536870912,hydrationErrors:null},i=C0(t),i.return=a,a.child=i,Ws=a,fs=null)):t=null,t===null)throw dr(a);return wu(t)?a.lanes=32:a.lanes=536870912,null}var B=c.children;return c=c.fallback,x?(gr(),x=a.mode,B=Xo({mode:"hidden",children:B},x),c=Yr(c,x,i,null),B.return=a,c.return=a,B.sibling=c,a.child=B,c=a.child,c.memoizedState=Ld(i),c.childLanes=Pd(t,T,i),a.memoizedState=Bd,Tl(null,c)):(mr(a),Fd(a,B))}var se=t.memoizedState;if(se!==null&&(B=se.dehydrated,B!==null)){if(g)a.flags&256?(mr(a),a.flags&=-257,a=Ud(t,a,i)):a.memoizedState!==null?(gr(),a.child=t.child,a.flags|=128,a=null):(gr(),B=c.fallback,x=a.mode,c=Xo({mode:"visible",children:c.children},x),B=Yr(B,x,i,null),B.flags|=2,c.return=a,B.return=a,c.sibling=B,a.child=c,$r(a,t.child,null,i),c=a.child,c.memoizedState=Ld(i),c.childLanes=Pd(t,T,i),a.memoizedState=Bd,a=Tl(null,c));else if(mr(a),wu(B)){if(T=B.nextSibling&&B.nextSibling.dataset,T)var be=T.dgst;T=be,c=Error(y(419)),c.stack="",c.digest=T,gl({value:c,source:null,stack:null}),a=Ud(t,a,i)}else if(Ls||Ci(t,a,i,!1),T=(i&t.childLanes)!==0,Ls||T){if(T=cs,T!==null&&(c=oi(T,i),c!==0&&c!==se.retryLane))throw se.retryLane=c,Xr(t,c),ga(T,t,c),Md;bu(B)||ec(),a=Ud(t,a,i)}else bu(B)?(a.flags|=192,a.child=t.child,a=null):(t=se.treeContext,fs=za(B.nextSibling),Ws=a,Pt=!0,cr=null,Fa=!1,t!==null&&S0(a,t),a=Fd(a,c.children),a.flags|=4096);return a}return x?(gr(),B=c.fallback,x=a.mode,se=t.child,be=se.sibling,c=An(se,{mode:"hidden",children:c.children}),c.subtreeFlags=se.subtreeFlags&65011712,be!==null?B=An(be,B):(B=Yr(B,x,i,null),B.flags|=2),B.return=a,c.return=a,c.sibling=B,a.child=c,Tl(null,c),c=a.child,B=t.child.memoizedState,B===null?B=Ld(i):(x=B.cachePool,x!==null?(se=ks._currentValue,x=x.parent!==se?{parent:se,pool:se}:x):x=I0(),B={baseLanes:B.baseLanes|i,cachePool:x}),c.memoizedState=B,c.childLanes=Pd(t,T,i),a.memoizedState=Bd,Tl(t.child,c)):(mr(a),i=t.child,t=i.sibling,i=An(i,{mode:"visible",children:c.children}),i.return=a,i.sibling=null,t!==null&&(T=a.deletions,T===null?(a.deletions=[t],a.flags|=16):T.push(t)),a.child=i,a.memoizedState=null,i)}function Fd(t,a){return a=Xo({mode:"visible",children:a},t.mode),a.return=t,t.child=a}function Xo(t,a){return t=ja(22,t,null,a),t.lanes=0,t}function Ud(t,a,i){return $r(a,t.child,null,i),t=Fd(a,a.pendingProps.children),t.flags|=2,a.memoizedState=null,t}function Yh(t,a,i){t.lanes|=a;var c=t.alternate;c!==null&&(c.lanes|=a),td(t.return,a,i)}function zd(t,a,i,c,x,g){var T=t.memoizedState;T===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:i,tailMode:x,treeForkCount:g}:(T.isBackwards=a,T.rendering=null,T.renderingStartTime=0,T.last=c,T.tail=i,T.tailMode=x,T.treeForkCount=g)}function qh(t,a,i){var c=a.pendingProps,x=c.revealOrder,g=c.tail;c=c.children;var T=Rs.current,B=(T&2)!==0;if(B?(T=T&1|2,a.flags|=128):T&=1,U(Rs,T),Js(t,a,c,i),c=Pt?ml:0,!B&&t!==null&&(t.flags&128)!==0)e:for(t=a.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Yh(t,i,a);else if(t.tag===19)Yh(t,i,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===a)break e;for(;t.sibling===null;){if(t.return===null||t.return===a)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(x){case"forwards":for(i=a.child,x=null;i!==null;)t=i.alternate,t!==null&&Io(t)===null&&(x=i),i=i.sibling;i=x,i===null?(x=a.child,a.child=null):(x=i.sibling,i.sibling=null),zd(a,!1,x,i,g,c);break;case"backwards":case"unstable_legacy-backwards":for(i=null,x=a.child,a.child=null;x!==null;){if(t=x.alternate,t!==null&&Io(t)===null){a.child=x;break}t=x.sibling,x.sibling=i,i=x,x=t}zd(a,!0,i,null,g,c);break;case"together":zd(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function Dn(t,a,i){if(t!==null&&(a.dependencies=t.dependencies),br|=a.lanes,(i&a.childLanes)===0)if(t!==null){if(Ci(t,a,i,!1),(i&a.childLanes)===0)return null}else return null;if(t!==null&&a.child!==t.child)throw Error(y(153));if(a.child!==null){for(t=a.child,i=An(t,t.pendingProps),a.child=i,i.return=a;t.sibling!==null;)t=t.sibling,i=i.sibling=An(t,t.pendingProps),i.return=a;i.sibling=null}return a.child}function Hd(t,a){return(t.lanes&a)!==0?!0:(t=t.dependencies,!!(t!==null&&Ao(t)))}function wm(t,a,i){switch(a.tag){case 3:Ve(a,a.stateNode.containerInfo),ur(a,ks,t.memoizedState.cache),qr();break;case 27:case 5:jt(a);break;case 4:Ve(a,a.stateNode.containerInfo);break;case 10:ur(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,fd(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(mr(a),a.flags|=128,null):(i&a.child.childLanes)!==0?Xh(t,a,i):(mr(a),t=Dn(t,a,i),t!==null?t.sibling:null);mr(a);break;case 19:var x=(t.flags&128)!==0;if(c=(i&a.childLanes)!==0,c||(Ci(t,a,i,!1),c=(i&a.childLanes)!==0),x){if(c)return qh(t,a,i);a.flags|=128}if(x=a.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),U(Rs,Rs.current),c)break;return null;case 22:return a.lanes=0,Fh(t,a,i,a.pendingProps);case 24:ur(a,ks,t.memoizedState.cache)}return Dn(t,a,i)}function Kh(t,a,i){if(t!==null)if(t.memoizedProps!==a.pendingProps)Ls=!0;else{if(!Hd(t,i)&&(a.flags&128)===0)return Ls=!1,wm(t,a,i);Ls=(t.flags&131072)!==0}else Ls=!1,Pt&&(a.flags&1048576)!==0&&E0(a,ml,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(t=Qr(a.elementType),a.type=t,typeof t=="function")qc(t)?(c=ti(t,c),a.tag=1,a=Vh(null,a,t,c,i)):(a.tag=0,a=kd(null,a,t,c,i));else{if(t!=null){var x=t.$$typeof;if(x===q){a.tag=11,a=Bh(null,a,t,c,i);break e}else if(x===$){a.tag=14,a=Lh(null,a,t,c,i);break e}}throw a=ae(t)||t,Error(y(306,a,""))}}return a;case 0:return kd(t,a,a.type,a.pendingProps,i);case 1:return c=a.type,x=ti(c,a.pendingProps),Vh(t,a,c,x,i);case 3:e:{if(Ve(a,a.stateNode.containerInfo),t===null)throw Error(y(387));c=a.pendingProps;var g=a.memoizedState;x=g.element,od(t,a),jl(a,c,null,i);var T=a.memoizedState;if(c=T.cache,ur(a,ks,c),c!==g.cache&&sd(a,[ks],i,!0),vl(),c=T.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:T.cache},a.updateQueue.baseState=g,a.memoizedState=g,a.flags&256){a=Gh(t,a,c,i);break e}else if(c!==x){x=Ba(Error(y(424)),a),gl(x),a=Gh(t,a,c,i);break e}else{switch(t=a.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(fs=za(t.firstChild),Ws=a,Pt=!0,cr=null,Fa=!0,i=F0(a,null,c,i),a.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling}else{if(qr(),c===x){a=Dn(t,a,i);break e}Js(t,a,c,i)}a=a.child}return a;case 26:return Go(t,a),t===null?(i=i1(a.type,null,a.pendingProps,null))?a.memoizedState=i:Pt||(i=a.type,t=a.pendingProps,c=lc(xe.current).createElement(i),c[Es]=a,c[Jt]=t,$s(c,i,t),ws(c),a.stateNode=c):a.memoizedState=i1(a.type,t.memoizedProps,a.pendingProps,t.memoizedState),null;case 27:return jt(a),t===null&&Pt&&(c=a.stateNode=a1(a.type,a.pendingProps,xe.current),Ws=a,Fa=!0,x=fs,Cr(a.type)?(Nu=x,fs=za(c.firstChild)):fs=x),Js(t,a,a.pendingProps.children,i),Go(t,a),t===null&&(a.flags|=4194304),a.child;case 5:return t===null&&Pt&&((x=c=fs)&&(c=Wm(c,a.type,a.pendingProps,Fa),c!==null?(a.stateNode=c,Ws=a,fs=za(c.firstChild),Fa=!1,x=!0):x=!1),x||dr(a)),jt(a),x=a.type,g=a.pendingProps,T=t!==null?t.memoizedProps:null,c=g.children,gu(x,g)?c=null:T!==null&&gu(x,T)&&(a.flags|=32),a.memoizedState!==null&&(x=md(t,a,um,null,null,i),Vl._currentValue=x),Go(t,a),Js(t,a,c,i),a.child;case 6:return t===null&&Pt&&((t=i=fs)&&(i=Qm(i,a.pendingProps,Fa),i!==null?(a.stateNode=i,Ws=a,fs=null,t=!0):t=!1),t||dr(a)),null;case 13:return Xh(t,a,i);case 4:return Ve(a,a.stateNode.containerInfo),c=a.pendingProps,t===null?a.child=$r(a,null,c,i):Js(t,a,c,i),a.child;case 11:return Bh(t,a,a.type,a.pendingProps,i);case 7:return Js(t,a,a.pendingProps,i),a.child;case 8:return Js(t,a,a.pendingProps.children,i),a.child;case 12:return Js(t,a,a.pendingProps.children,i),a.child;case 10:return c=a.pendingProps,ur(a,a.type,c.value),Js(t,a,c.children,i),a.child;case 9:return x=a.type._context,c=a.pendingProps.children,Zr(a),x=Qs(x),c=c(x),a.flags|=1,Js(t,a,c,i),a.child;case 14:return Lh(t,a,a.type,a.pendingProps,i);case 15:return Ph(t,a,a.type,a.pendingProps,i);case 19:return qh(t,a,i);case 31:return bm(t,a,i);case 22:return Fh(t,a,i,a.pendingProps);case 24:return Zr(a),c=Qs(ks),t===null?(x=rd(),x===null&&(x=cs,g=ad(),x.pooledCache=g,g.refCount++,g!==null&&(x.pooledCacheLanes|=i),x=g),a.memoizedState={parent:c,cache:x},ld(a),ur(a,ks,x)):((t.lanes&i)!==0&&(od(t,a),jl(a,null,null,i),vl()),x=t.memoizedState,g=a.memoizedState,x.parent!==c?(x={parent:c,cache:c},a.memoizedState=x,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=x),ur(a,ks,c)):(c=g.cache,ur(a,ks,c),c!==x.cache&&sd(a,[ks],i,!0))),Js(t,a,a.pendingProps.children,i),a.child;case 29:throw a.pendingProps}throw Error(y(156,a.tag))}function _n(t){t.flags|=4}function Vd(t,a,i,c,x){if((a=(t.mode&32)!==0)&&(a=!1),a){if(t.flags|=16777216,(x&335544128)===x)if(t.stateNode.complete)t.flags|=8192;else if(vf())t.flags|=8192;else throw Jr=Ro,id}else t.flags&=-16777217}function Zh(t,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!u1(a))if(vf())t.flags|=8192;else throw Jr=Ro,id}function Yo(t,a){a!==null&&(t.flags|=4),t.flags&16384&&(a=t.tag!==22?Us():536870912,t.lanes|=a,Bi|=a)}function Rl(t,a){if(!Pt)switch(t.tailMode){case"hidden":a=t.tail;for(var i=null;a!==null;)a.alternate!==null&&(i=a),a=a.sibling;i===null?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?a||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function xs(t){var a=t.alternate!==null&&t.alternate.child===t.child,i=0,c=0;if(a)for(var x=t.child;x!==null;)i|=x.lanes|x.childLanes,c|=x.subtreeFlags&65011712,c|=x.flags&65011712,x.return=t,x=x.sibling;else for(x=t.child;x!==null;)i|=x.lanes|x.childLanes,c|=x.subtreeFlags,c|=x.flags,x.return=t,x=x.sibling;return t.subtreeFlags|=c,t.childLanes=i,a}function Nm(t,a,i){var c=a.pendingProps;switch(Qc(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xs(a),null;case 1:return xs(a),null;case 3:return i=a.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Tn(ks),Je(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(ji(a)?_n(a):t===null||t.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,$c())),xs(a),null;case 26:var x=a.type,g=a.memoizedState;return t===null?(_n(a),g!==null?(xs(a),Zh(a,g)):(xs(a),Vd(a,x,null,c,i))):g?g!==t.memoizedState?(_n(a),xs(a),Zh(a,g)):(xs(a),a.flags&=-16777217):(t=t.memoizedProps,t!==c&&_n(a),xs(a),Vd(a,x,t,c,i)),null;case 27:if(Be(a),i=xe.current,x=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==c&&_n(a);else{if(!c){if(a.stateNode===null)throw Error(y(166));return xs(a),null}t=Z.current,ji(a)?T0(a):(t=a1(x,c,i),a.stateNode=t,_n(a))}return xs(a),null;case 5:if(Be(a),x=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==c&&_n(a);else{if(!c){if(a.stateNode===null)throw Error(y(166));return xs(a),null}if(g=Z.current,ji(a))T0(a);else{var T=lc(xe.current);switch(g){case 1:g=T.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:g=T.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":g=T.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":g=T.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":g=T.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof c.is=="string"?T.createElement("select",{is:c.is}):T.createElement("select"),c.multiple?g.multiple=!0:c.size&&(g.size=c.size);break;default:g=typeof c.is=="string"?T.createElement(x,{is:c.is}):T.createElement(x)}}g[Es]=a,g[Jt]=c;e:for(T=a.child;T!==null;){if(T.tag===5||T.tag===6)g.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===a)break e;for(;T.sibling===null;){if(T.return===null||T.return===a)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}a.stateNode=g;e:switch($s(g,x,c),x){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&_n(a)}}return xs(a),Vd(a,a.type,t===null?null:t.memoizedProps,a.pendingProps,i),null;case 6:if(t&&a.stateNode!=null)t.memoizedProps!==c&&_n(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(y(166));if(t=xe.current,ji(a)){if(t=a.stateNode,i=a.memoizedProps,c=null,x=Ws,x!==null)switch(x.tag){case 27:case 5:c=x.memoizedProps}t[Es]=a,t=!!(t.nodeValue===i||c!==null&&c.suppressHydrationWarning===!0||Yf(t.nodeValue,i)),t||dr(a,!0)}else t=lc(t).createTextNode(c),t[Es]=a,a.stateNode=t}return xs(a),null;case 31:if(i=a.memoizedState,t===null||t.memoizedState!==null){if(c=ji(a),i!==null){if(t===null){if(!c)throw Error(y(318));if(t=a.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(y(557));t[Es]=a}else qr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;xs(a),t=!1}else i=$c(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=i),t=!0;if(!t)return a.flags&256?(Aa(a),a):(Aa(a),null);if((a.flags&128)!==0)throw Error(y(558))}return xs(a),null;case 13:if(c=a.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(x=ji(a),c!==null&&c.dehydrated!==null){if(t===null){if(!x)throw Error(y(318));if(x=a.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(y(317));x[Es]=a}else qr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;xs(a),x=!1}else x=$c(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=x),x=!0;if(!x)return a.flags&256?(Aa(a),a):(Aa(a),null)}return Aa(a),(a.flags&128)!==0?(a.lanes=i,a):(i=c!==null,t=t!==null&&t.memoizedState!==null,i&&(c=a.child,x=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(x=c.alternate.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==x&&(c.flags|=2048)),i!==t&&i&&(a.child.flags|=8192),Yo(a,a.updateQueue),xs(a),null);case 4:return Je(),t===null&&uu(a.stateNode.containerInfo),xs(a),null;case 10:return Tn(a.type),xs(a),null;case 19:if(G(Rs),c=a.memoizedState,c===null)return xs(a),null;if(x=(a.flags&128)!==0,g=c.rendering,g===null)if(x)Rl(c,!1);else{if(js!==0||t!==null&&(t.flags&128)!==0)for(t=a.child;t!==null;){if(g=Io(t),g!==null){for(a.flags|=128,Rl(c,!1),t=g.updateQueue,a.updateQueue=t,Yo(a,t),a.subtreeFlags=0,t=i,i=a.child;i!==null;)j0(i,t),i=i.sibling;return U(Rs,Rs.current&1|2),Pt&&En(a,c.treeForkCount),a.child}t=t.sibling}c.tail!==null&&We()>Qo&&(a.flags|=128,x=!0,Rl(c,!1),a.lanes=4194304)}else{if(!x)if(t=Io(g),t!==null){if(a.flags|=128,x=!0,t=t.updateQueue,a.updateQueue=t,Yo(a,t),Rl(c,!0),c.tail===null&&c.tailMode==="hidden"&&!g.alternate&&!Pt)return xs(a),null}else 2*We()-c.renderingStartTime>Qo&&i!==536870912&&(a.flags|=128,x=!0,Rl(c,!1),a.lanes=4194304);c.isBackwards?(g.sibling=a.child,a.child=g):(t=c.last,t!==null?t.sibling=g:a.child=g,c.last=g)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=We(),t.sibling=null,i=Rs.current,U(Rs,x?i&1|2:i&1),Pt&&En(a,c.treeForkCount),t):(xs(a),null);case 22:case 23:return Aa(a),hd(),c=a.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(i&536870912)!==0&&(a.flags&128)===0&&(xs(a),a.subtreeFlags&6&&(a.flags|=8192)):xs(a),i=a.updateQueue,i!==null&&Yo(a,i.retryQueue),i=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==i&&(a.flags|=2048),t!==null&&G(Wr),null;case 24:return i=null,t!==null&&(i=t.memoizedState.cache),a.memoizedState.cache!==i&&(a.flags|=2048),Tn(ks),xs(a),null;case 25:return null;case 30:return null}throw Error(y(156,a.tag))}function vm(t,a){switch(Qc(a),a.tag){case 1:return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 3:return Tn(ks),Je(),t=a.flags,(t&65536)!==0&&(t&128)===0?(a.flags=t&-65537|128,a):null;case 26:case 27:case 5:return Be(a),null;case 31:if(a.memoizedState!==null){if(Aa(a),a.alternate===null)throw Error(y(340));qr()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 13:if(Aa(a),t=a.memoizedState,t!==null&&t.dehydrated!==null){if(a.alternate===null)throw Error(y(340));qr()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 19:return G(Rs),null;case 4:return Je(),null;case 10:return Tn(a.type),null;case 22:case 23:return Aa(a),hd(),t!==null&&G(Wr),t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 24:return Tn(ks),null;case 25:return null;default:return null}}function Wh(t,a){switch(Qc(a),a.tag){case 3:Tn(ks),Je();break;case 26:case 27:case 5:Be(a);break;case 4:Je();break;case 31:a.memoizedState!==null&&Aa(a);break;case 13:Aa(a);break;case 19:G(Rs);break;case 10:Tn(a.type);break;case 22:case 23:Aa(a),hd(),t!==null&&G(Wr);break;case 24:Tn(ks)}}function Ol(t,a){try{var i=a.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var x=c.next;i=x;do{if((i.tag&t)===t){c=void 0;var g=i.create,T=i.inst;c=g(),T.destroy=c}i=i.next}while(i!==x)}}catch(B){es(a,a.return,B)}}function pr(t,a,i){try{var c=a.updateQueue,x=c!==null?c.lastEffect:null;if(x!==null){var g=x.next;c=g;do{if((c.tag&t)===t){var T=c.inst,B=T.destroy;if(B!==void 0){T.destroy=void 0,x=a;var se=i,be=B;try{be()}catch(De){es(x,se,De)}}}c=c.next}while(c!==g)}}catch(De){es(a,a.return,De)}}function Qh(t){var a=t.updateQueue;if(a!==null){var i=t.stateNode;try{z0(a,i)}catch(c){es(t,t.return,c)}}}function Jh(t,a,i){i.props=ti(t.type,t.memoizedProps),i.state=t.memoizedState;try{i.componentWillUnmount()}catch(c){es(t,a,c)}}function Dl(t,a){try{var i=t.ref;if(i!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof i=="function"?t.refCleanup=i(c):i.current=c}}catch(x){es(t,a,x)}}function un(t,a){var i=t.ref,c=t.refCleanup;if(i!==null)if(typeof c=="function")try{c()}catch(x){es(t,a,x)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(x){es(t,a,x)}else i.current=null}function $h(t){var a=t.type,i=t.memoizedProps,c=t.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":i.autoFocus&&c.focus();break e;case"img":i.src?c.src=i.src:i.srcSet&&(c.srcset=i.srcSet)}}catch(x){es(t,t.return,x)}}function Gd(t,a,i){try{var c=t.stateNode;Gm(c,t.type,i,a),c[Jt]=a}catch(x){es(t,t.return,x)}}function ef(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Cr(t.type)||t.tag===4}function Xd(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ef(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Cr(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Yd(t,a,i){var c=t.tag;if(c===5||c===6)t=t.stateNode,a?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(t,a):(a=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,a.appendChild(t),i=i._reactRootContainer,i!=null||a.onclick!==null||(a.onclick=ca));else if(c!==4&&(c===27&&Cr(t.type)&&(i=t.stateNode,a=null),t=t.child,t!==null))for(Yd(t,a,i),t=t.sibling;t!==null;)Yd(t,a,i),t=t.sibling}function qo(t,a,i){var c=t.tag;if(c===5||c===6)t=t.stateNode,a?i.insertBefore(t,a):i.appendChild(t);else if(c!==4&&(c===27&&Cr(t.type)&&(i=t.stateNode),t=t.child,t!==null))for(qo(t,a,i),t=t.sibling;t!==null;)qo(t,a,i),t=t.sibling}function tf(t){var a=t.stateNode,i=t.memoizedProps;try{for(var c=t.type,x=a.attributes;x.length;)a.removeAttributeNode(x[0]);$s(a,c,i),a[Es]=t,a[Jt]=i}catch(g){es(t,t.return,g)}}var In=!1,Ps=!1,qd=!1,sf=typeof WeakSet=="function"?WeakSet:Set,qs=null;function jm(t,a){if(t=t.containerInfo,xu=xc,t=M(t),k(t)){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else e:{i=(i=t.ownerDocument)&&i.defaultView||window;var c=i.getSelection&&i.getSelection();if(c&&c.rangeCount!==0){i=c.anchorNode;var x=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{i.nodeType,g.nodeType}catch{i=null;break e}var T=0,B=-1,se=-1,be=0,De=0,Ie=t,ve=null;t:for(;;){for(var Ae;Ie!==i||x!==0&&Ie.nodeType!==3||(B=T+x),Ie!==g||c!==0&&Ie.nodeType!==3||(se=T+c),Ie.nodeType===3&&(T+=Ie.nodeValue.length),(Ae=Ie.firstChild)!==null;)ve=Ie,Ie=Ae;for(;;){if(Ie===t)break t;if(ve===i&&++be===x&&(B=T),ve===g&&++De===c&&(se=T),(Ae=Ie.nextSibling)!==null)break;Ie=ve,ve=Ie.parentNode}Ie=Ae}i=B===-1||se===-1?null:{start:B,end:se}}else i=null}i=i||{start:0,end:0}}else i=null;for(mu={focusedElem:t,selectionRange:i},xc=!1,qs=a;qs!==null;)if(a=qs,t=a.child,(a.subtreeFlags&1028)!==0&&t!==null)t.return=a,qs=t;else for(;qs!==null;){switch(a=qs,g=a.alternate,t=a.flags,a.tag){case 0:if((t&4)!==0&&(t=a.updateQueue,t=t!==null?t.events:null,t!==null))for(i=0;i<t.length;i++)x=t[i],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&g!==null){t=void 0,i=a,x=g.memoizedProps,g=g.memoizedState,c=i.stateNode;try{var $e=ti(i.type,x);t=c.getSnapshotBeforeUpdate($e,g),c.__reactInternalSnapshotBeforeUpdate=t}catch(xt){es(i,i.return,xt)}}break;case 3:if((t&1024)!==0){if(t=a.stateNode.containerInfo,i=t.nodeType,i===9)yu(t);else if(i===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":yu(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(y(163))}if(t=a.sibling,t!==null){t.return=a.return,qs=t;break}qs=a.return}}function af(t,a,i){var c=i.flags;switch(i.tag){case 0:case 11:case 15:kn(t,i),c&4&&Ol(5,i);break;case 1:if(kn(t,i),c&4)if(t=i.stateNode,a===null)try{t.componentDidMount()}catch(T){es(i,i.return,T)}else{var x=ti(i.type,a.memoizedProps);a=a.memoizedState;try{t.componentDidUpdate(x,a,t.__reactInternalSnapshotBeforeUpdate)}catch(T){es(i,i.return,T)}}c&64&&Qh(i),c&512&&Dl(i,i.return);break;case 3:if(kn(t,i),c&64&&(t=i.updateQueue,t!==null)){if(a=null,i.child!==null)switch(i.child.tag){case 27:case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}try{z0(t,a)}catch(T){es(i,i.return,T)}}break;case 27:a===null&&c&4&&tf(i);case 26:case 5:kn(t,i),a===null&&c&4&&$h(i),c&512&&Dl(i,i.return);break;case 12:kn(t,i);break;case 31:kn(t,i),c&4&&lf(t,i);break;case 13:kn(t,i),c&4&&of(t,i),c&64&&(t=i.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(i=_m.bind(null,i),Jm(t,i))));break;case 22:if(c=i.memoizedState!==null||In,!c){a=a!==null&&a.memoizedState!==null||Ps,x=In;var g=Ps;In=c,(Ps=a)&&!g?Bn(t,i,(i.subtreeFlags&8772)!==0):kn(t,i),In=x,Ps=g}break;case 30:break;default:kn(t,i)}}function nf(t){var a=t.alternate;a!==null&&(t.alternate=null,nf(a)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(a=t.stateNode,a!==null&&oa(a)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var ys=null,ha=!1;function Mn(t,a,i){for(i=i.child;i!==null;)rf(t,a,i),i=i.sibling}function rf(t,a,i){if(Te&&typeof Te.onCommitFiberUnmount=="function")try{Te.onCommitFiberUnmount(Ue,i)}catch{}switch(i.tag){case 26:Ps||un(i,a),Mn(t,a,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:Ps||un(i,a);var c=ys,x=ha;Cr(i.type)&&(ys=i.stateNode,ha=!1),Mn(t,a,i),Ul(i.stateNode),ys=c,ha=x;break;case 5:Ps||un(i,a);case 6:if(c=ys,x=ha,ys=null,Mn(t,a,i),ys=c,ha=x,ys!==null)if(ha)try{(ys.nodeType===9?ys.body:ys.nodeName==="HTML"?ys.ownerDocument.body:ys).removeChild(i.stateNode)}catch(g){es(i,a,g)}else try{ys.removeChild(i.stateNode)}catch(g){es(i,a,g)}break;case 18:ys!==null&&(ha?(t=ys,Jf(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,i.stateNode),Gi(t)):Jf(ys,i.stateNode));break;case 4:c=ys,x=ha,ys=i.stateNode.containerInfo,ha=!0,Mn(t,a,i),ys=c,ha=x;break;case 0:case 11:case 14:case 15:pr(2,i,a),Ps||pr(4,i,a),Mn(t,a,i);break;case 1:Ps||(un(i,a),c=i.stateNode,typeof c.componentWillUnmount=="function"&&Jh(i,a,c)),Mn(t,a,i);break;case 21:Mn(t,a,i);break;case 22:Ps=(c=Ps)||i.memoizedState!==null,Mn(t,a,i),Ps=c;break;default:Mn(t,a,i)}}function lf(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Gi(t)}catch(i){es(a,a.return,i)}}}function of(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Gi(t)}catch(i){es(a,a.return,i)}}function Cm(t){switch(t.tag){case 31:case 13:case 19:var a=t.stateNode;return a===null&&(a=t.stateNode=new sf),a;case 22:return t=t.stateNode,a=t._retryCache,a===null&&(a=t._retryCache=new sf),a;default:throw Error(y(435,t.tag))}}function Ko(t,a){var i=Cm(t);a.forEach(function(c){if(!i.has(c)){i.add(c);var x=Im.bind(null,t,c);c.then(x,x)}})}function fa(t,a){var i=a.deletions;if(i!==null)for(var c=0;c<i.length;c++){var x=i[c],g=t,T=a,B=T;e:for(;B!==null;){switch(B.tag){case 27:if(Cr(B.type)){ys=B.stateNode,ha=!1;break e}break;case 5:ys=B.stateNode,ha=!1;break e;case 3:case 4:ys=B.stateNode.containerInfo,ha=!0;break e}B=B.return}if(ys===null)throw Error(y(160));rf(g,T,x),ys=null,ha=!1,g=x.alternate,g!==null&&(g.return=null),x.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)cf(a,t),a=a.sibling}var Ja=null;function cf(t,a){var i=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:fa(a,t),xa(t),c&4&&(pr(3,t,t.return),Ol(3,t),pr(5,t,t.return));break;case 1:fa(a,t),xa(t),c&512&&(Ps||i===null||un(i,i.return)),c&64&&In&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(i=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=i===null?c:i.concat(c))));break;case 26:var x=Ja;if(fa(a,t),xa(t),c&512&&(Ps||i===null||un(i,i.return)),c&4){var g=i!==null?i.memoizedState:null;if(c=t.memoizedState,i===null)if(c===null)if(t.stateNode===null){e:{c=t.type,i=t.memoizedProps,x=x.ownerDocument||x;t:switch(c){case"title":g=x.getElementsByTagName("title")[0],(!g||g[Br]||g[Es]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=x.createElement(c),x.head.insertBefore(g,x.querySelector("head > title"))),$s(g,c,i),g[Es]=t,ws(g),c=g;break e;case"link":var T=c1("link","href",x).get(c+(i.href||""));if(T){for(var B=0;B<T.length;B++)if(g=T[B],g.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&g.getAttribute("rel")===(i.rel==null?null:i.rel)&&g.getAttribute("title")===(i.title==null?null:i.title)&&g.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){T.splice(B,1);break t}}g=x.createElement(c),$s(g,c,i),x.head.appendChild(g);break;case"meta":if(T=c1("meta","content",x).get(c+(i.content||""))){for(B=0;B<T.length;B++)if(g=T[B],g.getAttribute("content")===(i.content==null?null:""+i.content)&&g.getAttribute("name")===(i.name==null?null:i.name)&&g.getAttribute("property")===(i.property==null?null:i.property)&&g.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&g.getAttribute("charset")===(i.charSet==null?null:i.charSet)){T.splice(B,1);break t}}g=x.createElement(c),$s(g,c,i),x.head.appendChild(g);break;default:throw Error(y(468,c))}g[Es]=t,ws(g),c=g}t.stateNode=c}else d1(x,t.type,t.stateNode);else t.stateNode=o1(x,c,t.memoizedProps);else g!==c?(g===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):g.count--,c===null?d1(x,t.type,t.stateNode):o1(x,c,t.memoizedProps)):c===null&&t.stateNode!==null&&Gd(t,t.memoizedProps,i.memoizedProps)}break;case 27:fa(a,t),xa(t),c&512&&(Ps||i===null||un(i,i.return)),i!==null&&c&4&&Gd(t,t.memoizedProps,i.memoizedProps);break;case 5:if(fa(a,t),xa(t),c&512&&(Ps||i===null||un(i,i.return)),t.flags&32){x=t.stateNode;try{$n(x,"")}catch($e){es(t,t.return,$e)}}c&4&&t.stateNode!=null&&(x=t.memoizedProps,Gd(t,x,i!==null?i.memoizedProps:x)),c&1024&&(qd=!0);break;case 6:if(fa(a,t),xa(t),c&4){if(t.stateNode===null)throw Error(y(162));c=t.memoizedProps,i=t.stateNode;try{i.nodeValue=c}catch($e){es(t,t.return,$e)}}break;case 3:if(dc=null,x=Ja,Ja=oc(a.containerInfo),fa(a,t),Ja=x,xa(t),c&4&&i!==null&&i.memoizedState.isDehydrated)try{Gi(a.containerInfo)}catch($e){es(t,t.return,$e)}qd&&(qd=!1,df(t));break;case 4:c=Ja,Ja=oc(t.stateNode.containerInfo),fa(a,t),xa(t),Ja=c;break;case 12:fa(a,t),xa(t);break;case 31:fa(a,t),xa(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Ko(t,c)));break;case 13:fa(a,t),xa(t),t.child.flags&8192&&t.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(Wo=We()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Ko(t,c)));break;case 22:x=t.memoizedState!==null;var se=i!==null&&i.memoizedState!==null,be=In,De=Ps;if(In=be||x,Ps=De||se,fa(a,t),Ps=De,In=be,xa(t),c&8192)e:for(a=t.stateNode,a._visibility=x?a._visibility&-2:a._visibility|1,x&&(i===null||se||In||Ps||si(t)),i=null,a=t;;){if(a.tag===5||a.tag===26){if(i===null){se=i=a;try{if(g=se.stateNode,x)T=g.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{B=se.stateNode;var Ie=se.memoizedProps.style,ve=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null;B.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch($e){es(se,se.return,$e)}}}else if(a.tag===6){if(i===null){se=a;try{se.stateNode.nodeValue=x?"":se.memoizedProps}catch($e){es(se,se.return,$e)}}}else if(a.tag===18){if(i===null){se=a;try{var Ae=se.stateNode;x?$f(Ae,!0):$f(se.stateNode,!1)}catch($e){es(se,se.return,$e)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===t)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;a.sibling===null;){if(a.return===null||a.return===t)break e;i===a&&(i=null),a=a.return}i===a&&(i=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=t.updateQueue,c!==null&&(i=c.retryQueue,i!==null&&(c.retryQueue=null,Ko(t,i))));break;case 19:fa(a,t),xa(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Ko(t,c)));break;case 30:break;case 21:break;default:fa(a,t),xa(t)}}function xa(t){var a=t.flags;if(a&2){try{for(var i,c=t.return;c!==null;){if(ef(c)){i=c;break}c=c.return}if(i==null)throw Error(y(160));switch(i.tag){case 27:var x=i.stateNode,g=Xd(t);qo(t,g,x);break;case 5:var T=i.stateNode;i.flags&32&&($n(T,""),i.flags&=-33);var B=Xd(t);qo(t,B,T);break;case 3:case 4:var se=i.stateNode.containerInfo,be=Xd(t);Yd(t,be,se);break;default:throw Error(y(161))}}catch(De){es(t,t.return,De)}t.flags&=-3}a&4096&&(t.flags&=-4097)}function df(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var a=t;df(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),t=t.sibling}}function kn(t,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)af(t,a.alternate,a),a=a.sibling}function si(t){for(t=t.child;t!==null;){var a=t;switch(a.tag){case 0:case 11:case 14:case 15:pr(4,a,a.return),si(a);break;case 1:un(a,a.return);var i=a.stateNode;typeof i.componentWillUnmount=="function"&&Jh(a,a.return,i),si(a);break;case 27:Ul(a.stateNode);case 26:case 5:un(a,a.return),si(a);break;case 22:a.memoizedState===null&&si(a);break;case 30:si(a);break;default:si(a)}t=t.sibling}}function Bn(t,a,i){for(i=i&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,x=t,g=a,T=g.flags;switch(g.tag){case 0:case 11:case 15:Bn(x,g,i),Ol(4,g);break;case 1:if(Bn(x,g,i),c=g,x=c.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(be){es(c,c.return,be)}if(c=g,x=c.updateQueue,x!==null){var B=c.stateNode;try{var se=x.shared.hiddenCallbacks;if(se!==null)for(x.shared.hiddenCallbacks=null,x=0;x<se.length;x++)U0(se[x],B)}catch(be){es(c,c.return,be)}}i&&T&64&&Qh(g),Dl(g,g.return);break;case 27:tf(g);case 26:case 5:Bn(x,g,i),i&&c===null&&T&4&&$h(g),Dl(g,g.return);break;case 12:Bn(x,g,i);break;case 31:Bn(x,g,i),i&&T&4&&lf(x,g);break;case 13:Bn(x,g,i),i&&T&4&&of(x,g);break;case 22:g.memoizedState===null&&Bn(x,g,i),Dl(g,g.return);break;case 30:break;default:Bn(x,g,i)}a=a.sibling}}function Kd(t,a){var i=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),t=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(t=a.memoizedState.cachePool.pool),t!==i&&(t!=null&&t.refCount++,i!=null&&pl(i))}function Zd(t,a){t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&pl(t))}function $a(t,a,i,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)uf(t,a,i,c),a=a.sibling}function uf(t,a,i,c){var x=a.flags;switch(a.tag){case 0:case 11:case 15:$a(t,a,i,c),x&2048&&Ol(9,a);break;case 1:$a(t,a,i,c);break;case 3:$a(t,a,i,c),x&2048&&(t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&pl(t)));break;case 12:if(x&2048){$a(t,a,i,c),t=a.stateNode;try{var g=a.memoizedProps,T=g.id,B=g.onPostCommit;typeof B=="function"&&B(T,a.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(se){es(a,a.return,se)}}else $a(t,a,i,c);break;case 31:$a(t,a,i,c);break;case 13:$a(t,a,i,c);break;case 23:break;case 22:g=a.stateNode,T=a.alternate,a.memoizedState!==null?g._visibility&2?$a(t,a,i,c):_l(t,a):g._visibility&2?$a(t,a,i,c):(g._visibility|=2,Ii(t,a,i,c,(a.subtreeFlags&10256)!==0||!1)),x&2048&&Kd(T,a);break;case 24:$a(t,a,i,c),x&2048&&Zd(a.alternate,a);break;default:$a(t,a,i,c)}}function Ii(t,a,i,c,x){for(x=x&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var g=t,T=a,B=i,se=c,be=T.flags;switch(T.tag){case 0:case 11:case 15:Ii(g,T,B,se,x),Ol(8,T);break;case 23:break;case 22:var De=T.stateNode;T.memoizedState!==null?De._visibility&2?Ii(g,T,B,se,x):_l(g,T):(De._visibility|=2,Ii(g,T,B,se,x)),x&&be&2048&&Kd(T.alternate,T);break;case 24:Ii(g,T,B,se,x),x&&be&2048&&Zd(T.alternate,T);break;default:Ii(g,T,B,se,x)}a=a.sibling}}function _l(t,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var i=t,c=a,x=c.flags;switch(c.tag){case 22:_l(i,c),x&2048&&Kd(c.alternate,c);break;case 24:_l(i,c),x&2048&&Zd(c.alternate,c);break;default:_l(i,c)}a=a.sibling}}var Il=8192;function Mi(t,a,i){if(t.subtreeFlags&Il)for(t=t.child;t!==null;)hf(t,a,i),t=t.sibling}function hf(t,a,i){switch(t.tag){case 26:Mi(t,a,i),t.flags&Il&&t.memoizedState!==null&&dg(i,Ja,t.memoizedState,t.memoizedProps);break;case 5:Mi(t,a,i);break;case 3:case 4:var c=Ja;Ja=oc(t.stateNode.containerInfo),Mi(t,a,i),Ja=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=Il,Il=16777216,Mi(t,a,i),Il=c):Mi(t,a,i));break;default:Mi(t,a,i)}}function ff(t){var a=t.alternate;if(a!==null&&(t=a.child,t!==null)){a.child=null;do a=t.sibling,t.sibling=null,t=a;while(t!==null)}}function Ml(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var i=0;i<a.length;i++){var c=a[i];qs=c,mf(c,t)}ff(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)xf(t),t=t.sibling}function xf(t){switch(t.tag){case 0:case 11:case 15:Ml(t),t.flags&2048&&pr(9,t,t.return);break;case 3:Ml(t);break;case 12:Ml(t);break;case 22:var a=t.stateNode;t.memoizedState!==null&&a._visibility&2&&(t.return===null||t.return.tag!==13)?(a._visibility&=-3,Zo(t)):Ml(t);break;default:Ml(t)}}function Zo(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var i=0;i<a.length;i++){var c=a[i];qs=c,mf(c,t)}ff(t)}for(t=t.child;t!==null;){switch(a=t,a.tag){case 0:case 11:case 15:pr(8,a,a.return),Zo(a);break;case 22:i=a.stateNode,i._visibility&2&&(i._visibility&=-3,Zo(a));break;default:Zo(a)}t=t.sibling}}function mf(t,a){for(;qs!==null;){var i=qs;switch(i.tag){case 0:case 11:case 15:pr(8,i,a);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var c=i.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:pl(i.memoizedState.cache)}if(c=i.child,c!==null)c.return=i,qs=c;else e:for(i=t;qs!==null;){c=qs;var x=c.sibling,g=c.return;if(nf(c),c===i){qs=null;break e}if(x!==null){x.return=g,qs=x;break e}qs=g}}}var Am={getCacheForType:function(t){var a=Qs(ks),i=a.data.get(t);return i===void 0&&(i=t(),a.data.set(t,i)),i},cacheSignal:function(){return Qs(ks).controller.signal}},Em=typeof WeakMap=="function"?WeakMap:Map,qt=0,cs=null,_t=null,Bt=0,$t=0,Ea=null,yr=!1,ki=!1,Wd=!1,Ln=0,js=0,br=0,ai=0,Qd=0,Sa=0,Bi=0,kl=null,ma=null,Jd=!1,Wo=0,gf=0,Qo=1/0,Jo=null,wr=null,Gs=0,Nr=null,Li=null,Pn=0,$d=0,eu=null,pf=null,Bl=0,tu=null;function Ta(){return(qt&2)!==0&&Bt!==0?Bt&-Bt:W.T!==null?lu():ta()}function yf(){if(Sa===0)if((Bt&536870912)===0||Pt){var t=Mt;Mt<<=1,(Mt&3932160)===0&&(Mt=262144),Sa=t}else Sa=536870912;return t=Ca.current,t!==null&&(t.flags|=32),Sa}function ga(t,a,i){(t===cs&&($t===2||$t===9)||t.cancelPendingCommit!==null)&&(Pi(t,0),vr(t,Bt,Sa,!1)),sn(t,i),((qt&2)===0||t!==cs)&&(t===cs&&((qt&2)===0&&(ai|=i),js===4&&vr(t,Bt,Sa,!1)),hn(t))}function bf(t,a,i){if((qt&6)!==0)throw Error(y(327));var c=!i&&(a&127)===0&&(a&t.expiredLanes)===0||Ks(t,a),x=c?Rm(t,a):au(t,a,!0),g=c;do{if(x===0){ki&&!c&&vr(t,a,0,!1);break}else{if(i=t.current.alternate,g&&!Sm(i)){x=au(t,a,!1),g=!1;continue}if(x===2){if(g=a,t.errorRecoveryDisabledLanes&g)var T=0;else T=t.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){a=T;e:{var B=t;x=kl;var se=B.current.memoizedState.isDehydrated;if(se&&(Pi(B,T).flags|=256),T=au(B,T,!1),T!==2){if(Wd&&!se){B.errorRecoveryDisabledLanes|=g,ai|=g,x=4;break e}g=ma,ma=x,g!==null&&(ma===null?ma=g:ma.push.apply(ma,g))}x=T}if(g=!1,x!==2)continue}}if(x===1){Pi(t,0),vr(t,a,0,!0);break}e:{switch(c=t,g=x,g){case 0:case 1:throw Error(y(345));case 4:if((a&4194048)!==a)break;case 6:vr(c,a,Sa,!yr);break e;case 2:ma=null;break;case 3:case 5:break;default:throw Error(y(329))}if((a&62914560)===a&&(x=Wo+300-We(),10<x)){if(vr(c,a,Sa,!yr),kr(c,0,!0)!==0)break e;Pn=a,c.timeoutHandle=Wf(wf.bind(null,c,i,ma,Jo,Jd,a,Sa,ai,Bi,yr,g,"Throttled",-0,0),x);break e}wf(c,i,ma,Jo,Jd,a,Sa,ai,Bi,yr,g,null,-0,0)}}break}while(!0);hn(t)}function wf(t,a,i,c,x,g,T,B,se,be,De,Ie,ve,Ae){if(t.timeoutHandle=-1,Ie=a.subtreeFlags,Ie&8192||(Ie&16785408)===16785408){Ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ca},hf(a,g,Ie);var $e=(g&62914560)===g?Wo-We():(g&4194048)===g?gf-We():0;if($e=ug(Ie,$e),$e!==null){Pn=g,t.cancelPendingCommit=$e(Tf.bind(null,t,a,g,i,c,x,T,B,se,De,Ie,null,ve,Ae)),vr(t,g,T,!be);return}}Tf(t,a,g,i,c,x,T,B,se)}function Sm(t){for(var a=t;;){var i=a.tag;if((i===0||i===11||i===15)&&a.flags&16384&&(i=a.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var c=0;c<i.length;c++){var x=i[c],g=x.getSnapshot;x=x.value;try{if(!d(g(),x))return!1}catch{return!1}}if(i=a.child,a.subtreeFlags&16384&&i!==null)i.return=a,a=i;else{if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function vr(t,a,i,c){a&=~Qd,a&=~ai,t.suspendedLanes|=a,t.pingedLanes&=~a,c&&(t.warmLanes|=a),c=t.expirationTimes;for(var x=a;0<x;){var g=31-Ye(x),T=1<<g;c[g]=-1,x&=~T}i!==0&&ao(t,i,a)}function $o(){return(qt&6)===0?(Ll(0),!1):!0}function su(){if(_t!==null){if($t===0)var t=_t.return;else t=_t,Sn=Kr=null,yd(t),Ti=null,bl=0,t=_t;for(;t!==null;)Wh(t.alternate,t),t=t.return;_t=null}}function Pi(t,a){var i=t.timeoutHandle;i!==-1&&(t.timeoutHandle=-1,qm(i)),i=t.cancelPendingCommit,i!==null&&(t.cancelPendingCommit=null,i()),Pn=0,su(),cs=t,_t=i=An(t.current,null),Bt=a,$t=0,Ea=null,yr=!1,ki=Ks(t,a),Wd=!1,Bi=Sa=Qd=ai=br=js=0,ma=kl=null,Jd=!1,(a&8)!==0&&(a|=a&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=a;0<c;){var x=31-Ye(c),g=1<<x;a|=t[x],c&=~g}return Ln=a,wo(),i}function Nf(t,a){vt=null,W.H=Sl,a===Si||a===To?(a=B0(),$t=3):a===id?(a=B0(),$t=4):$t=a===Md?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ea=a,_t===null&&(js=1,Ho(t,Ba(a,t.current)))}function vf(){var t=Ca.current;return t===null?!0:(Bt&4194048)===Bt?Ua===null:(Bt&62914560)===Bt||(Bt&536870912)!==0?t===Ua:!1}function jf(){var t=W.H;return W.H=Sl,t===null?Sl:t}function Cf(){var t=W.A;return W.A=Am,t}function ec(){js=4,yr||(Bt&4194048)!==Bt&&Ca.current!==null||(ki=!0),(br&134217727)===0&&(ai&134217727)===0||cs===null||vr(cs,Bt,Sa,!1)}function au(t,a,i){var c=qt;qt|=2;var x=jf(),g=Cf();(cs!==t||Bt!==a)&&(Jo=null,Pi(t,a)),a=!1;var T=js;e:do try{if($t!==0&&_t!==null){var B=_t,se=Ea;switch($t){case 8:su(),T=6;break e;case 3:case 2:case 9:case 6:Ca.current===null&&(a=!0);var be=$t;if($t=0,Ea=null,Fi(t,B,se,be),i&&ki){T=0;break e}break;default:be=$t,$t=0,Ea=null,Fi(t,B,se,be)}}Tm(),T=js;break}catch(De){Nf(t,De)}while(!0);return a&&t.shellSuspendCounter++,Sn=Kr=null,qt=c,W.H=x,W.A=g,_t===null&&(cs=null,Bt=0,wo()),T}function Tm(){for(;_t!==null;)Af(_t)}function Rm(t,a){var i=qt;qt|=2;var c=jf(),x=Cf();cs!==t||Bt!==a?(Jo=null,Qo=We()+500,Pi(t,a)):ki=Ks(t,a);e:do try{if($t!==0&&_t!==null){a=_t;var g=Ea;t:switch($t){case 1:$t=0,Ea=null,Fi(t,a,g,1);break;case 2:case 9:if(M0(g)){$t=0,Ea=null,Ef(a);break}a=function(){$t!==2&&$t!==9||cs!==t||($t=7),hn(t)},g.then(a,a);break e;case 3:$t=7;break e;case 4:$t=5;break e;case 7:M0(g)?($t=0,Ea=null,Ef(a)):($t=0,Ea=null,Fi(t,a,g,7));break;case 5:var T=null;switch(_t.tag){case 26:T=_t.memoizedState;case 5:case 27:var B=_t;if(T?u1(T):B.stateNode.complete){$t=0,Ea=null;var se=B.sibling;if(se!==null)_t=se;else{var be=B.return;be!==null?(_t=be,tc(be)):_t=null}break t}}$t=0,Ea=null,Fi(t,a,g,5);break;case 6:$t=0,Ea=null,Fi(t,a,g,6);break;case 8:su(),js=6;break e;default:throw Error(y(462))}}Om();break}catch(De){Nf(t,De)}while(!0);return Sn=Kr=null,W.H=c,W.A=x,qt=i,_t!==null?0:(cs=null,Bt=0,wo(),js)}function Om(){for(;_t!==null&&!ye();)Af(_t)}function Af(t){var a=Kh(t.alternate,t,Ln);t.memoizedProps=t.pendingProps,a===null?tc(t):_t=a}function Ef(t){var a=t,i=a.alternate;switch(a.tag){case 15:case 0:a=Hh(i,a,a.pendingProps,a.type,void 0,Bt);break;case 11:a=Hh(i,a,a.pendingProps,a.type.render,a.ref,Bt);break;case 5:yd(a);default:Wh(i,a),a=_t=j0(a,Ln),a=Kh(i,a,Ln)}t.memoizedProps=t.pendingProps,a===null?tc(t):_t=a}function Fi(t,a,i,c){Sn=Kr=null,yd(a),Ti=null,bl=0;var x=a.return;try{if(ym(t,x,a,i,Bt)){js=1,Ho(t,Ba(i,t.current)),_t=null;return}}catch(g){if(x!==null)throw _t=x,g;js=1,Ho(t,Ba(i,t.current)),_t=null;return}a.flags&32768?(Pt||c===1?t=!0:ki||(Bt&536870912)!==0?t=!1:(yr=t=!0,(c===2||c===9||c===3||c===6)&&(c=Ca.current,c!==null&&c.tag===13&&(c.flags|=16384))),Sf(a,t)):tc(a)}function tc(t){var a=t;do{if((a.flags&32768)!==0){Sf(a,yr);return}t=a.return;var i=Nm(a.alternate,a,Ln);if(i!==null){_t=i;return}if(a=a.sibling,a!==null){_t=a;return}_t=a=t}while(a!==null);js===0&&(js=5)}function Sf(t,a){do{var i=vm(t.alternate,t);if(i!==null){i.flags&=32767,_t=i;return}if(i=t.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!a&&(t=t.sibling,t!==null)){_t=t;return}_t=t=i}while(t!==null);js=6,_t=null}function Tf(t,a,i,c,x,g,T,B,se){t.cancelPendingCommit=null;do sc();while(Gs!==0);if((qt&6)!==0)throw Error(y(327));if(a!==null){if(a===t.current)throw Error(y(177));if(g=a.lanes|a.childLanes,g|=Xc,Da(t,i,g,T,B,se),t===cs&&(_t=cs=null,Bt=0),Li=a,Nr=t,Pn=i,$d=g,eu=x,pf=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,Mm(pt,function(){return If(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=W.T,W.T=null,x=Q.p,Q.p=2,T=qt,qt|=4;try{jm(t,a,i)}finally{qt=T,Q.p=x,W.T=c}}Gs=1,Rf(),Of(),Df()}}function Rf(){if(Gs===1){Gs=0;var t=Nr,a=Li,i=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||i){i=W.T,W.T=null;var c=Q.p;Q.p=2;var x=qt;qt|=4;try{cf(a,t);var g=mu,T=M(t.containerInfo),B=g.focusedElem,se=g.selectionRange;if(T!==B&&B&&B.ownerDocument&&S(B.ownerDocument.documentElement,B)){if(se!==null&&k(B)){var be=se.start,De=se.end;if(De===void 0&&(De=be),"selectionStart"in B)B.selectionStart=be,B.selectionEnd=Math.min(De,B.value.length);else{var Ie=B.ownerDocument||document,ve=Ie&&Ie.defaultView||window;if(ve.getSelection){var Ae=ve.getSelection(),$e=B.textContent.length,xt=Math.min(se.start,$e),ns=se.end===void 0?xt:Math.min(se.end,$e);!Ae.extend&&xt>ns&&(T=ns,ns=xt,xt=T);var de=b(B,xt),le=b(B,ns);if(de&&le&&(Ae.rangeCount!==1||Ae.anchorNode!==de.node||Ae.anchorOffset!==de.offset||Ae.focusNode!==le.node||Ae.focusOffset!==le.offset)){var pe=Ie.createRange();pe.setStart(de.node,de.offset),Ae.removeAllRanges(),xt>ns?(Ae.addRange(pe),Ae.extend(le.node,le.offset)):(pe.setEnd(le.node,le.offset),Ae.addRange(pe))}}}}for(Ie=[],Ae=B;Ae=Ae.parentNode;)Ae.nodeType===1&&Ie.push({element:Ae,left:Ae.scrollLeft,top:Ae.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<Ie.length;B++){var _e=Ie[B];_e.element.scrollLeft=_e.left,_e.element.scrollTop=_e.top}}xc=!!xu,mu=xu=null}finally{qt=x,Q.p=c,W.T=i}}t.current=a,Gs=2}}function Of(){if(Gs===2){Gs=0;var t=Nr,a=Li,i=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||i){i=W.T,W.T=null;var c=Q.p;Q.p=2;var x=qt;qt|=4;try{af(t,a.alternate,a)}finally{qt=x,Q.p=c,W.T=i}}Gs=3}}function Df(){if(Gs===4||Gs===3){Gs=0,Fe();var t=Nr,a=Li,i=Pn,c=pf;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Gs=5:(Gs=0,Li=Nr=null,_f(t,t.pendingLanes));var x=t.pendingLanes;if(x===0&&(wr=null),Xa(i),a=a.stateNode,Te&&typeof Te.onCommitFiberRoot=="function")try{Te.onCommitFiberRoot(Ue,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=W.T,x=Q.p,Q.p=2,W.T=null;try{for(var g=t.onRecoverableError,T=0;T<c.length;T++){var B=c[T];g(B.value,{componentStack:B.stack})}}finally{W.T=a,Q.p=x}}(Pn&3)!==0&&sc(),hn(t),x=t.pendingLanes,(i&261930)!==0&&(x&42)!==0?t===tu?Bl++:(Bl=0,tu=t):Bl=0,Ll(0)}}function _f(t,a){(t.pooledCacheLanes&=a)===0&&(a=t.pooledCache,a!=null&&(t.pooledCache=null,pl(a)))}function sc(){return Rf(),Of(),Df(),If()}function If(){if(Gs!==5)return!1;var t=Nr,a=$d;$d=0;var i=Xa(Pn),c=W.T,x=Q.p;try{Q.p=32>i?32:i,W.T=null,i=eu,eu=null;var g=Nr,T=Pn;if(Gs=0,Li=Nr=null,Pn=0,(qt&6)!==0)throw Error(y(331));var B=qt;if(qt|=4,xf(g.current),uf(g,g.current,T,i),qt=B,Ll(0,!1),Te&&typeof Te.onPostCommitFiberRoot=="function")try{Te.onPostCommitFiberRoot(Ue,g)}catch{}return!0}finally{Q.p=x,W.T=c,_f(t,a)}}function Mf(t,a,i){a=Ba(i,a),a=Id(t.stateNode,a,2),t=xr(t,a,2),t!==null&&(sn(t,2),hn(t))}function es(t,a,i){if(t.tag===3)Mf(t,t,i);else for(;a!==null;){if(a.tag===3){Mf(a,t,i);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(wr===null||!wr.has(c))){t=Ba(i,t),i=Mh(2),c=xr(a,i,2),c!==null&&(kh(i,c,a,t),sn(c,2),hn(c));break}}a=a.return}}function nu(t,a,i){var c=t.pingCache;if(c===null){c=t.pingCache=new Em;var x=new Set;c.set(a,x)}else x=c.get(a),x===void 0&&(x=new Set,c.set(a,x));x.has(i)||(Wd=!0,x.add(i),t=Dm.bind(null,t,a,i),a.then(t,t))}function Dm(t,a,i){var c=t.pingCache;c!==null&&c.delete(a),t.pingedLanes|=t.suspendedLanes&i,t.warmLanes&=~i,cs===t&&(Bt&i)===i&&(js===4||js===3&&(Bt&62914560)===Bt&&300>We()-Wo?(qt&2)===0&&Pi(t,0):Qd|=i,Bi===Bt&&(Bi=0)),hn(t)}function kf(t,a){a===0&&(a=Us()),t=Xr(t,a),t!==null&&(sn(t,a),hn(t))}function _m(t){var a=t.memoizedState,i=0;a!==null&&(i=a.retryLane),kf(t,i)}function Im(t,a){var i=0;switch(t.tag){case 31:case 13:var c=t.stateNode,x=t.memoizedState;x!==null&&(i=x.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(y(314))}c!==null&&c.delete(a),kf(t,i)}function Mm(t,a){return Tt(t,a)}var ac=null,Ui=null,ru=!1,nc=!1,iu=!1,jr=0;function hn(t){t!==Ui&&t.next===null&&(Ui===null?ac=Ui=t:Ui=Ui.next=t),nc=!0,ru||(ru=!0,Bm())}function Ll(t,a){if(!iu&&nc){iu=!0;do for(var i=!1,c=ac;c!==null;){if(t!==0){var x=c.pendingLanes;if(x===0)var g=0;else{var T=c.suspendedLanes,B=c.pingedLanes;g=(1<<31-Ye(42|t)+1)-1,g&=x&~(T&~B),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(i=!0,Ff(c,g))}else g=Bt,g=kr(c,c===cs?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||Ks(c,g)||(i=!0,Ff(c,g));c=c.next}while(i);iu=!1}}function km(){Bf()}function Bf(){nc=ru=!1;var t=0;jr!==0&&Ym()&&(t=jr);for(var a=We(),i=null,c=ac;c!==null;){var x=c.next,g=Lf(c,a);g===0?(c.next=null,i===null?ac=x:i.next=x,x===null&&(Ui=i)):(i=c,(t!==0||(g&3)!==0)&&(nc=!0)),c=x}Gs!==0&&Gs!==5||Ll(t),jr!==0&&(jr=0)}function Lf(t,a){for(var i=t.suspendedLanes,c=t.pingedLanes,x=t.expirationTimes,g=t.pendingLanes&-62914561;0<g;){var T=31-Ye(g),B=1<<T,se=x[T];se===-1?((B&i)===0||(B&c)!==0)&&(x[T]=nl(B,a)):se<=a&&(t.expiredLanes|=B),g&=~B}if(a=cs,i=Bt,i=kr(t,t===a?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,i===0||t===a&&($t===2||$t===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&He(c),t.callbackNode=null,t.callbackPriority=0;if((i&3)===0||Ks(t,i)){if(a=i&-i,a===t.callbackPriority)return a;switch(c!==null&&He(c),Xa(i)){case 2:case 8:i=_s;break;case 32:i=pt;break;case 268435456:i=ds;break;default:i=pt}return c=Pf.bind(null,t),i=Tt(i,c),t.callbackPriority=a,t.callbackNode=i,a}return c!==null&&c!==null&&He(c),t.callbackPriority=2,t.callbackNode=null,2}function Pf(t,a){if(Gs!==0&&Gs!==5)return t.callbackNode=null,t.callbackPriority=0,null;var i=t.callbackNode;if(sc()&&t.callbackNode!==i)return null;var c=Bt;return c=kr(t,t===cs?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(bf(t,c,a),Lf(t,We()),t.callbackNode!=null&&t.callbackNode===i?Pf.bind(null,t):null)}function Ff(t,a){if(sc())return null;bf(t,a,!0)}function Bm(){Km(function(){(qt&6)!==0?Tt(st,km):Bf()})}function lu(){if(jr===0){var t=Ai;t===0&&(t=Mr,Mr<<=1,(Mr&261888)===0&&(Mr=256)),jr=t}return jr}function Uf(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:er(""+t)}function zf(t,a){var i=a.ownerDocument.createElement("input");return i.name=a.name,i.value=a.value,t.id&&i.setAttribute("form",t.id),a.parentNode.insertBefore(i,a),t=new FormData(t),i.parentNode.removeChild(i),t}function Lm(t,a,i,c,x){if(a==="submit"&&i&&i.stateNode===x){var g=Uf((x[Jt]||null).action),T=c.submitter;T&&(a=(a=T[Jt]||null)?Uf(a.formAction):T.getAttribute("formAction"),a!==null&&(g=a,T=null));var B=new zs("action","action",null,c,x);t.push({event:B,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(jr!==0){var se=T?zf(x,T):new FormData(x);Sd(i,{pending:!0,data:se,method:x.method,action:g},null,se)}}else typeof g=="function"&&(B.preventDefault(),se=T?zf(x,T):new FormData(x),Sd(i,{pending:!0,data:se,method:x.method,action:g},g,se))},currentTarget:x}]})}}for(var ou=0;ou<xl.length;ou++){var cu=xl[ou],Pm=cu.toLowerCase(),Fm=cu[0].toUpperCase()+cu.slice(1);Qa(Pm,"on"+Fm)}Qa(ua,"onAnimationEnd"),Qa(Zs,"onAnimationIteration"),Qa(Qt,"onAnimationStart"),Qa("dblclick","onDoubleClick"),Qa("focusin","onFocus"),Qa("focusout","onBlur"),Qa(Vs,"onTransitionRun"),Qa(ia,"onTransitionStart"),Qa(lr,"onTransitionCancel"),Qa(Cn,"onTransitionEnd"),ya("onMouseEnter",["mouseout","mouseover"]),ya("onMouseLeave",["mouseout","mouseover"]),ya("onPointerEnter",["pointerout","pointerover"]),ya("onPointerLeave",["pointerout","pointerover"]),Zt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Zt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Zt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Zt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Zt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Zt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Um=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Pl));function Hf(t,a){a=(a&4)!==0;for(var i=0;i<t.length;i++){var c=t[i],x=c.event;c=c.listeners;e:{var g=void 0;if(a)for(var T=c.length-1;0<=T;T--){var B=c[T],se=B.instance,be=B.currentTarget;if(B=B.listener,se!==g&&x.isPropagationStopped())break e;g=B,x.currentTarget=be;try{g(x)}catch(De){bo(De)}x.currentTarget=null,g=se}else for(T=0;T<c.length;T++){if(B=c[T],se=B.instance,be=B.currentTarget,B=B.listener,se!==g&&x.isPropagationStopped())break e;g=B,x.currentTarget=be;try{g(x)}catch(De){bo(De)}x.currentTarget=null,g=se}}}}function It(t,a){var i=a[Kn];i===void 0&&(i=a[Kn]=new Set);var c=t+"__bubble";i.has(c)||(Vf(a,t,2,!1),i.add(c))}function du(t,a,i){var c=0;a&&(c|=4),Vf(i,t,c,a)}var rc="_reactListening"+Math.random().toString(36).slice(2);function uu(t){if(!t[rc]){t[rc]=!0,Me.forEach(function(i){i!=="selectionchange"&&(Um.has(i)||du(i,!1,t),du(i,!0,t))});var a=t.nodeType===9?t:t.ownerDocument;a===null||a[rc]||(a[rc]=!0,du("selectionchange",!1,a))}}function Vf(t,a,i,c){switch(y1(a)){case 2:var x=xg;break;case 8:x=mg;break;default:x=Eu}i=x.bind(null,a,i,t),x=void 0,!ll||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(x=!0),c?x!==void 0?t.addEventListener(a,i,{capture:!0,passive:x}):t.addEventListener(a,i,!0):x!==void 0?t.addEventListener(a,i,{passive:x}):t.addEventListener(a,i,!1)}function hu(t,a,i,c,x){var g=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var T=c.tag;if(T===3||T===4){var B=c.stateNode.containerInfo;if(B===x)break;if(T===4)for(T=c.return;T!==null;){var se=T.tag;if((se===3||se===4)&&T.stateNode.containerInfo===x)return;T=T.return}for(;B!==null;){if(T=bs(B),T===null)return;if(se=T.tag,se===5||se===6||se===26||se===27){c=g=T;continue e}B=B.parentNode}}c=c.return}lo(function(){var be=g,De=il(i),Ie=[];e:{var ve=yo.get(t);if(ve!==void 0){var Ae=zs,$e=t;switch(t){case"keypress":if(nn(i)===0)break e;case"keydown":case"keyup":Ae=gi;break;case"focusin":$e="focus",Ae=dl;break;case"focusout":$e="blur",Ae=dl;break;case"beforeblur":case"afterblur":Ae=dl;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ae=Yt;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ae=xi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ae=Hc;break;case ua:case Zs:case Qt:Ae=Ct;break;case Cn:Ae=wn;break;case"scroll":case"scrollend":Ae=oo;break;case"wheel":Ae=Vc;break;case"copy":case"cut":case"paste":Ae=mi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ae=Wt;break;case"toggle":case"beforetoggle":Ae=hl}var xt=(a&4)!==0,ns=!xt&&(t==="scroll"||t==="scrollend"),de=xt?ve!==null?ve+"Capture":null:ve;xt=[];for(var le=be,pe;le!==null;){var _e=le;if(pe=_e.stateNode,_e=_e.tag,_e!==5&&_e!==26&&_e!==27||pe===null||de===null||(_e=bt(le,de),_e!=null&&xt.push(Fl(le,_e,pe))),ns)break;le=le.return}0<xt.length&&(ve=new Ae(ve,$e,null,i,De),Ie.push({event:ve,listeners:xt}))}}if((a&7)===0){e:{if(ve=t==="mouseover"||t==="pointerover",Ae=t==="mouseout"||t==="pointerout",ve&&i!==Lr&&($e=i.relatedTarget||i.fromElement)&&(bs($e)||$e[pa]))break e;if((Ae||ve)&&(ve=De.window===De?De:(ve=De.ownerDocument)?ve.defaultView||ve.parentWindow:window,Ae?($e=i.relatedTarget||i.toElement,Ae=be,$e=$e?bs($e):null,$e!==null&&(ns=N($e),xt=$e.tag,$e!==ns||xt!==5&&xt!==27&&xt!==6)&&($e=null)):(Ae=null,$e=be),Ae!==$e)){if(xt=Yt,_e="onMouseLeave",de="onMouseEnter",le="mouse",(t==="pointerout"||t==="pointerover")&&(xt=Wt,_e="onPointerLeave",de="onPointerEnter",le="pointer"),ns=Ae==null?ve:Zn(Ae),pe=$e==null?ve:Zn($e),ve=new xt(_e,le+"leave",Ae,i,De),ve.target=ns,ve.relatedTarget=pe,_e=null,bs(De)===be&&(xt=new xt(de,le+"enter",$e,i,De),xt.target=pe,xt.relatedTarget=ns,_e=xt),ns=_e,Ae&&$e)t:{for(xt=zm,de=Ae,le=$e,pe=0,_e=de;_e;_e=xt(_e))pe++;_e=0;for(var it=le;it;it=xt(it))_e++;for(;0<pe-_e;)de=xt(de),pe--;for(;0<_e-pe;)le=xt(le),_e--;for(;pe--;){if(de===le||le!==null&&de===le.alternate){xt=de;break t}de=xt(de),le=xt(le)}xt=null}else xt=null;Ae!==null&&Gf(Ie,ve,Ae,xt,!1),$e!==null&&ns!==null&&Gf(Ie,ns,$e,xt,!0)}}e:{if(ve=be?Zn(be):window,Ae=ve.nodeName&&ve.nodeName.toLowerCase(),Ae==="select"||Ae==="input"&&ve.type==="file")var Vt=va;else if(fl(ve))if(po)Vt=l;else{Vt=n;var tt=s}else Ae=ve.nodeName,!Ae||Ae.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?be&&is(be.elementType)&&(Vt=va):Vt=r;if(Vt&&(Vt=Vt(t,be))){Na(Ie,Vt,i,De);break e}tt&&tt(t,ve,be),t==="focusout"&&be&&ve.type==="number"&&be.memoizedProps.value!=null&&z(ve,"number",ve.value)}switch(tt=be?Zn(be):window,t){case"focusin":(fl(tt)||tt.contentEditable==="true")&&(re=tt,ie=be,he=null);break;case"focusout":he=ie=re=null;break;case"mousedown":je=!0;break;case"contextmenu":case"mouseup":case"dragend":je=!1,Pe(Ie,i,De);break;case"selectionchange":if(X)break;case"keydown":case"keyup":Pe(Ie,i,De)}var At;if(Ur)e:{switch(t){case"compositionstart":var Lt="onCompositionStart";break e;case"compositionend":Lt="onCompositionEnd";break e;case"compositionupdate":Lt="onCompositionUpdate";break e}Lt=void 0}else ir?go(t,i)&&(Lt="onCompositionEnd"):t==="keydown"&&i.keyCode===229&&(Lt="onCompositionStart");Lt&&(mo&&i.locale!=="ko"&&(ir||Lt!=="onCompositionStart"?Lt==="onCompositionEnd"&&ir&&(At=tr()):(Za=De,Wa="value"in Za?Za.value:Za.textContent,ir=!0)),tt=ic(be,Lt),0<tt.length&&(Lt=new ho(Lt,t,null,i,De),Ie.push({event:Lt,listeners:tt}),At?Lt.data=At:(At=rr(i),At!==null&&(Lt.data=At)))),(At=xo?on(t,i):yi(t,i))&&(Lt=ic(be,"onBeforeInput"),0<Lt.length&&(tt=new ho("onBeforeInput","beforeinput",null,i,De),Ie.push({event:tt,listeners:Lt}),tt.data=At)),Lm(Ie,t,be,i,De)}Hf(Ie,a)})}function Fl(t,a,i){return{instance:t,listener:a,currentTarget:i}}function ic(t,a){for(var i=a+"Capture",c=[];t!==null;){var x=t,g=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||g===null||(x=bt(t,i),x!=null&&c.unshift(Fl(t,x,g)),x=bt(t,a),x!=null&&c.push(Fl(t,x,g))),t.tag===3)return c;t=t.return}return[]}function zm(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Gf(t,a,i,c,x){for(var g=a._reactName,T=[];i!==null&&i!==c;){var B=i,se=B.alternate,be=B.stateNode;if(B=B.tag,se!==null&&se===c)break;B!==5&&B!==26&&B!==27||be===null||(se=be,x?(be=bt(i,g),be!=null&&T.unshift(Fl(i,be,se))):x||(be=bt(i,g),be!=null&&T.push(Fl(i,be,se)))),i=i.return}T.length!==0&&t.push({event:a,listeners:T})}var Hm=/\r\n?/g,Vm=/\u0000|\uFFFD/g;function Xf(t){return(typeof t=="string"?t:""+t).replace(Hm,`
`).replace(Vm,"")}function Yf(t,a){return a=Xf(a),Xf(t)===a}function as(t,a,i,c,x,g){switch(i){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||$n(t,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&$n(t,""+c);break;case"className":Qn(t,"class",c);break;case"tabIndex":Qn(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Qn(t,i,c);break;case"style":nt(t,c,g);break;case"data":if(a!=="object"){Qn(t,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||i!=="href")){t.removeAttribute(i);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(i);break}c=er(""+c),t.setAttribute(i,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(i==="formAction"?(a!=="input"&&as(t,a,"name",x.name,x,null),as(t,a,"formEncType",x.formEncType,x,null),as(t,a,"formMethod",x.formMethod,x,null),as(t,a,"formTarget",x.formTarget,x,null)):(as(t,a,"encType",x.encType,x,null),as(t,a,"method",x.method,x,null),as(t,a,"target",x.target,x,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(i);break}c=er(""+c),t.setAttribute(i,c);break;case"onClick":c!=null&&(t.onclick=ca);break;case"onScroll":c!=null&&It("scroll",t);break;case"onScrollEnd":c!=null&&It("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(y(61));if(i=c.__html,i!=null){if(x.children!=null)throw Error(y(60));t.innerHTML=i}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}i=er(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(i,""+c):t.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(i,""):t.removeAttribute(i);break;case"capture":case"download":c===!0?t.setAttribute(i,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(i,c):t.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(i,c):t.removeAttribute(i);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(i):t.setAttribute(i,c);break;case"popover":It("beforetoggle",t),It("toggle",t),Wn(t,"popover",c);break;case"xlinkActuate":ba(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":ba(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":ba(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":ba(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":ba(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":ba(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":ba(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":ba(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":ba(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Wn(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=io.get(i)||i,Wn(t,i,c))}}function fu(t,a,i,c,x,g){switch(i){case"style":nt(t,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(y(61));if(i=c.__html,i!=null){if(x.children!=null)throw Error(y(60));t.innerHTML=i}}break;case"children":typeof c=="string"?$n(t,c):(typeof c=="number"||typeof c=="bigint")&&$n(t,""+c);break;case"onScroll":c!=null&&It("scroll",t);break;case"onScrollEnd":c!=null&&It("scrollend",t);break;case"onClick":c!=null&&(t.onclick=ca);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ro.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(x=i.endsWith("Capture"),a=i.slice(2,x?i.length-7:void 0),g=t[Jt]||null,g=g!=null?g[i]:null,typeof g=="function"&&t.removeEventListener(a,g,x),typeof c=="function")){typeof g!="function"&&g!==null&&(i in t?t[i]=null:t.hasAttribute(i)&&t.removeAttribute(i)),t.addEventListener(a,c,x);break e}i in t?t[i]=c:c===!0?t.setAttribute(i,""):Wn(t,i,c)}}}function $s(t,a,i){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":It("error",t),It("load",t);var c=!1,x=!1,g;for(g in i)if(i.hasOwnProperty(g)){var T=i[g];if(T!=null)switch(g){case"src":c=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(y(137,a));default:as(t,a,g,T,i,null)}}x&&as(t,a,"srcSet",i.srcSet,i,null),c&&as(t,a,"src",i.src,i,null);return;case"input":It("invalid",t);var B=g=T=x=null,se=null,be=null;for(c in i)if(i.hasOwnProperty(c)){var De=i[c];if(De!=null)switch(c){case"name":x=De;break;case"type":T=De;break;case"checked":se=De;break;case"defaultChecked":be=De;break;case"value":g=De;break;case"defaultValue":B=De;break;case"children":case"dangerouslySetInnerHTML":if(De!=null)throw Error(y(137,a));break;default:as(t,a,c,De,i,null)}}ge(t,g,B,se,be,T,x,!1);return;case"select":It("invalid",t),c=T=g=null;for(x in i)if(i.hasOwnProperty(x)&&(B=i[x],B!=null))switch(x){case"value":g=B;break;case"defaultValue":T=B;break;case"multiple":c=B;default:as(t,a,x,B,i,null)}a=g,i=T,t.multiple=!!c,a!=null?et(t,!!c,a,!1):i!=null&&et(t,!!c,i,!0);return;case"textarea":It("invalid",t),g=x=c=null;for(T in i)if(i.hasOwnProperty(T)&&(B=i[T],B!=null))switch(T){case"value":c=B;break;case"defaultValue":x=B;break;case"children":g=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(y(91));break;default:as(t,a,T,B,i,null)}na(t,c,x,g);return;case"option":for(se in i)if(i.hasOwnProperty(se)&&(c=i[se],c!=null))switch(se){case"selected":t.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:as(t,a,se,c,i,null)}return;case"dialog":It("beforetoggle",t),It("toggle",t),It("cancel",t),It("close",t);break;case"iframe":case"object":It("load",t);break;case"video":case"audio":for(c=0;c<Pl.length;c++)It(Pl[c],t);break;case"image":It("error",t),It("load",t);break;case"details":It("toggle",t);break;case"embed":case"source":case"link":It("error",t),It("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(be in i)if(i.hasOwnProperty(be)&&(c=i[be],c!=null))switch(be){case"children":case"dangerouslySetInnerHTML":throw Error(y(137,a));default:as(t,a,be,c,i,null)}return;default:if(is(a)){for(De in i)i.hasOwnProperty(De)&&(c=i[De],c!==void 0&&fu(t,a,De,c,i,void 0));return}}for(B in i)i.hasOwnProperty(B)&&(c=i[B],c!=null&&as(t,a,B,c,i,null))}function Gm(t,a,i,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,g=null,T=null,B=null,se=null,be=null,De=null;for(Ae in i){var Ie=i[Ae];if(i.hasOwnProperty(Ae)&&Ie!=null)switch(Ae){case"checked":break;case"value":break;case"defaultValue":se=Ie;default:c.hasOwnProperty(Ae)||as(t,a,Ae,null,c,Ie)}}for(var ve in c){var Ae=c[ve];if(Ie=i[ve],c.hasOwnProperty(ve)&&(Ae!=null||Ie!=null))switch(ve){case"type":g=Ae;break;case"name":x=Ae;break;case"checked":be=Ae;break;case"defaultChecked":De=Ae;break;case"value":T=Ae;break;case"defaultValue":B=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(y(137,a));break;default:Ae!==Ie&&as(t,a,ve,Ae,c,Ie)}}Is(t,T,B,se,be,De,g,x);return;case"select":Ae=T=B=ve=null;for(g in i)if(se=i[g],i.hasOwnProperty(g)&&se!=null)switch(g){case"value":break;case"multiple":Ae=se;default:c.hasOwnProperty(g)||as(t,a,g,null,c,se)}for(x in c)if(g=c[x],se=i[x],c.hasOwnProperty(x)&&(g!=null||se!=null))switch(x){case"value":ve=g;break;case"defaultValue":B=g;break;case"multiple":T=g;default:g!==se&&as(t,a,x,g,c,se)}a=B,i=T,c=Ae,ve!=null?et(t,!!i,ve,!1):!!c!=!!i&&(a!=null?et(t,!!i,a,!0):et(t,!!i,i?[]:"",!1));return;case"textarea":Ae=ve=null;for(B in i)if(x=i[B],i.hasOwnProperty(B)&&x!=null&&!c.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:as(t,a,B,null,c,x)}for(T in c)if(x=c[T],g=i[T],c.hasOwnProperty(T)&&(x!=null||g!=null))switch(T){case"value":ve=x;break;case"defaultValue":Ae=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(y(91));break;default:x!==g&&as(t,a,T,x,c,g)}Ss(t,ve,Ae);return;case"option":for(var $e in i)if(ve=i[$e],i.hasOwnProperty($e)&&ve!=null&&!c.hasOwnProperty($e))switch($e){case"selected":t.selected=!1;break;default:as(t,a,$e,null,c,ve)}for(se in c)if(ve=c[se],Ae=i[se],c.hasOwnProperty(se)&&ve!==Ae&&(ve!=null||Ae!=null))switch(se){case"selected":t.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:as(t,a,se,ve,c,Ae)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xt in i)ve=i[xt],i.hasOwnProperty(xt)&&ve!=null&&!c.hasOwnProperty(xt)&&as(t,a,xt,null,c,ve);for(be in c)if(ve=c[be],Ae=i[be],c.hasOwnProperty(be)&&ve!==Ae&&(ve!=null||Ae!=null))switch(be){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(y(137,a));break;default:as(t,a,be,ve,c,Ae)}return;default:if(is(a)){for(var ns in i)ve=i[ns],i.hasOwnProperty(ns)&&ve!==void 0&&!c.hasOwnProperty(ns)&&fu(t,a,ns,void 0,c,ve);for(De in c)ve=c[De],Ae=i[De],!c.hasOwnProperty(De)||ve===Ae||ve===void 0&&Ae===void 0||fu(t,a,De,ve,c,Ae);return}}for(var de in i)ve=i[de],i.hasOwnProperty(de)&&ve!=null&&!c.hasOwnProperty(de)&&as(t,a,de,null,c,ve);for(Ie in c)ve=c[Ie],Ae=i[Ie],!c.hasOwnProperty(Ie)||ve===Ae||ve==null&&Ae==null||as(t,a,Ie,ve,c,Ae)}function qf(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Xm(){if(typeof performance.getEntriesByType=="function"){for(var t=0,a=0,i=performance.getEntriesByType("resource"),c=0;c<i.length;c++){var x=i[c],g=x.transferSize,T=x.initiatorType,B=x.duration;if(g&&B&&qf(T)){for(T=0,B=x.responseEnd,c+=1;c<i.length;c++){var se=i[c],be=se.startTime;if(be>B)break;var De=se.transferSize,Ie=se.initiatorType;De&&qf(Ie)&&(se=se.responseEnd,T+=De*(se<B?1:(B-be)/(se-be)))}if(--c,a+=8*(g+T)/(x.duration/1e3),t++,10<t)break}}if(0<t)return a/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var xu=null,mu=null;function lc(t){return t.nodeType===9?t:t.ownerDocument}function Kf(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Zf(t,a){if(t===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&a==="foreignObject"?0:t}function gu(t,a){return t==="textarea"||t==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var pu=null;function Ym(){var t=window.event;return t&&t.type==="popstate"?t===pu?!1:(pu=t,!0):(pu=null,!1)}var Wf=typeof setTimeout=="function"?setTimeout:void 0,qm=typeof clearTimeout=="function"?clearTimeout:void 0,Qf=typeof Promise=="function"?Promise:void 0,Km=typeof queueMicrotask=="function"?queueMicrotask:typeof Qf<"u"?function(t){return Qf.resolve(null).then(t).catch(Zm)}:Wf;function Zm(t){setTimeout(function(){throw t})}function Cr(t){return t==="head"}function Jf(t,a){var i=a,c=0;do{var x=i.nextSibling;if(t.removeChild(i),x&&x.nodeType===8)if(i=x.data,i==="/$"||i==="/&"){if(c===0){t.removeChild(x),Gi(a);return}c--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")c++;else if(i==="html")Ul(t.ownerDocument.documentElement);else if(i==="head"){i=t.ownerDocument.head,Ul(i);for(var g=i.firstChild;g;){var T=g.nextSibling,B=g.nodeName;g[Br]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&g.rel.toLowerCase()==="stylesheet"||i.removeChild(g),g=T}}else i==="body"&&Ul(t.ownerDocument.body);i=x}while(i);Gi(a)}function $f(t,a){var i=t;t=0;do{var c=i.nextSibling;if(i.nodeType===1?a?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(a?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),c&&c.nodeType===8)if(i=c.data,i==="/$"){if(t===0)break;t--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||t++;i=c}while(i)}function yu(t){var a=t.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var i=a;switch(a=a.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":yu(i),oa(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}t.removeChild(i)}}function Wm(t,a,i,c){for(;t.nodeType===1;){var x=i;if(t.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[Br])switch(a){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(g=t.getAttribute("rel"),g==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(g!==x.rel||t.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||t.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||t.getAttribute("title")!==(x.title==null?null:x.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(g=t.getAttribute("src"),(g!==(x.src==null?null:x.src)||t.getAttribute("type")!==(x.type==null?null:x.type)||t.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&g&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(a==="input"&&t.type==="hidden"){var g=x.name==null?null:""+x.name;if(x.type==="hidden"&&t.getAttribute("name")===g)return t}else return t;if(t=za(t.nextSibling),t===null)break}return null}function Qm(t,a,i){if(a==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!i||(t=za(t.nextSibling),t===null))return null;return t}function e1(t,a){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!a||(t=za(t.nextSibling),t===null))return null;return t}function bu(t){return t.data==="$?"||t.data==="$~"}function wu(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function Jm(t,a){var i=t.ownerDocument;if(t.data==="$~")t._reactRetry=a;else if(t.data!=="$?"||i.readyState!=="loading")a();else{var c=function(){a(),i.removeEventListener("DOMContentLoaded",c)};i.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function za(t){for(;t!=null;t=t.nextSibling){var a=t.nodeType;if(a===1||a===3)break;if(a===8){if(a=t.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return t}var Nu=null;function t1(t){t=t.nextSibling;for(var a=0;t;){if(t.nodeType===8){var i=t.data;if(i==="/$"||i==="/&"){if(a===0)return za(t.nextSibling);a--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||a++}t=t.nextSibling}return null}function s1(t){t=t.previousSibling;for(var a=0;t;){if(t.nodeType===8){var i=t.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(a===0)return t;a--}else i!=="/$"&&i!=="/&"||a++}t=t.previousSibling}return null}function a1(t,a,i){switch(a=lc(i),t){case"html":if(t=a.documentElement,!t)throw Error(y(452));return t;case"head":if(t=a.head,!t)throw Error(y(453));return t;case"body":if(t=a.body,!t)throw Error(y(454));return t;default:throw Error(y(451))}}function Ul(t){for(var a=t.attributes;a.length;)t.removeAttributeNode(a[0]);oa(t)}var Ha=new Map,n1=new Set;function oc(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Fn=Q.d;Q.d={f:$m,r:eg,D:tg,C:sg,L:ag,m:ng,X:ig,S:rg,M:lg};function $m(){var t=Fn.f(),a=$o();return t||a}function eg(t){var a=Xt(t);a!==null&&a.tag===5&&a.type==="form"?wh(a):Fn.r(t)}var zi=typeof document>"u"?null:document;function r1(t,a,i){var c=zi;if(c&&typeof a=="string"&&a){var x=Ot(a);x='link[rel="'+t+'"][href="'+x+'"]',typeof i=="string"&&(x+='[crossorigin="'+i+'"]'),n1.has(x)||(n1.add(x),t={rel:t,crossOrigin:i,href:a},c.querySelector(x)===null&&(a=c.createElement("link"),$s(a,"link",t),ws(a),c.head.appendChild(a)))}}function tg(t){Fn.D(t),r1("dns-prefetch",t,null)}function sg(t,a){Fn.C(t,a),r1("preconnect",t,a)}function ag(t,a,i){Fn.L(t,a,i);var c=zi;if(c&&t&&a){var x='link[rel="preload"][as="'+Ot(a)+'"]';a==="image"&&i&&i.imageSrcSet?(x+='[imagesrcset="'+Ot(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(x+='[imagesizes="'+Ot(i.imageSizes)+'"]')):x+='[href="'+Ot(t)+'"]';var g=x;switch(a){case"style":g=Hi(t);break;case"script":g=Vi(t)}Ha.has(g)||(t=O({rel:"preload",href:a==="image"&&i&&i.imageSrcSet?void 0:t,as:a},i),Ha.set(g,t),c.querySelector(x)!==null||a==="style"&&c.querySelector(zl(g))||a==="script"&&c.querySelector(Hl(g))||(a=c.createElement("link"),$s(a,"link",t),ws(a),c.head.appendChild(a)))}}function ng(t,a){Fn.m(t,a);var i=zi;if(i&&t){var c=a&&typeof a.as=="string"?a.as:"script",x='link[rel="modulepreload"][as="'+Ot(c)+'"][href="'+Ot(t)+'"]',g=x;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Vi(t)}if(!Ha.has(g)&&(t=O({rel:"modulepreload",href:t},a),Ha.set(g,t),i.querySelector(x)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(Hl(g)))return}c=i.createElement("link"),$s(c,"link",t),ws(c),i.head.appendChild(c)}}}function rg(t,a,i){Fn.S(t,a,i);var c=zi;if(c&&t){var x=aa(c).hoistableStyles,g=Hi(t);a=a||"default";var T=x.get(g);if(!T){var B={loading:0,preload:null};if(T=c.querySelector(zl(g)))B.loading=5;else{t=O({rel:"stylesheet",href:t,"data-precedence":a},i),(i=Ha.get(g))&&vu(t,i);var se=T=c.createElement("link");ws(se),$s(se,"link",t),se._p=new Promise(function(be,De){se.onload=be,se.onerror=De}),se.addEventListener("load",function(){B.loading|=1}),se.addEventListener("error",function(){B.loading|=2}),B.loading|=4,cc(T,a,c)}T={type:"stylesheet",instance:T,count:1,state:B},x.set(g,T)}}}function ig(t,a){Fn.X(t,a);var i=zi;if(i&&t){var c=aa(i).hoistableScripts,x=Vi(t),g=c.get(x);g||(g=i.querySelector(Hl(x)),g||(t=O({src:t,async:!0},a),(a=Ha.get(x))&&ju(t,a),g=i.createElement("script"),ws(g),$s(g,"link",t),i.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(x,g))}}function lg(t,a){Fn.M(t,a);var i=zi;if(i&&t){var c=aa(i).hoistableScripts,x=Vi(t),g=c.get(x);g||(g=i.querySelector(Hl(x)),g||(t=O({src:t,async:!0,type:"module"},a),(a=Ha.get(x))&&ju(t,a),g=i.createElement("script"),ws(g),$s(g,"link",t),i.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(x,g))}}function i1(t,a,i,c){var x=(x=xe.current)?oc(x):null;if(!x)throw Error(y(446));switch(t){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(a=Hi(i.href),i=aa(x).hoistableStyles,c=i.get(a),c||(c={type:"style",instance:null,count:0,state:null},i.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){t=Hi(i.href);var g=aa(x).hoistableStyles,T=g.get(t);if(T||(x=x.ownerDocument||x,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(t,T),(g=x.querySelector(zl(t)))&&!g._p&&(T.instance=g,T.state.loading=5),Ha.has(t)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},Ha.set(t,i),g||og(x,t,i,T.state))),a&&c===null)throw Error(y(528,""));return T}if(a&&c!==null)throw Error(y(529,""));return null;case"script":return a=i.async,i=i.src,typeof i=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Vi(i),i=aa(x).hoistableScripts,c=i.get(a),c||(c={type:"script",instance:null,count:0,state:null},i.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(y(444,t))}}function Hi(t){return'href="'+Ot(t)+'"'}function zl(t){return'link[rel="stylesheet"]['+t+"]"}function l1(t){return O({},t,{"data-precedence":t.precedence,precedence:null})}function og(t,a,i,c){t.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=t.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),$s(a,"link",i),ws(a),t.head.appendChild(a))}function Vi(t){return'[src="'+Ot(t)+'"]'}function Hl(t){return"script[async]"+t}function o1(t,a,i){if(a.count++,a.instance===null)switch(a.type){case"style":var c=t.querySelector('style[data-href~="'+Ot(i.href)+'"]');if(c)return a.instance=c,ws(c),c;var x=O({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),ws(c),$s(c,"style",x),cc(c,i.precedence,t),a.instance=c;case"stylesheet":x=Hi(i.href);var g=t.querySelector(zl(x));if(g)return a.state.loading|=4,a.instance=g,ws(g),g;c=l1(i),(x=Ha.get(x))&&vu(c,x),g=(t.ownerDocument||t).createElement("link"),ws(g);var T=g;return T._p=new Promise(function(B,se){T.onload=B,T.onerror=se}),$s(g,"link",c),a.state.loading|=4,cc(g,i.precedence,t),a.instance=g;case"script":return g=Vi(i.src),(x=t.querySelector(Hl(g)))?(a.instance=x,ws(x),x):(c=i,(x=Ha.get(g))&&(c=O({},i),ju(c,x)),t=t.ownerDocument||t,x=t.createElement("script"),ws(x),$s(x,"link",c),t.head.appendChild(x),a.instance=x);case"void":return null;default:throw Error(y(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,cc(c,i.precedence,t));return a.instance}function cc(t,a,i){for(var c=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=c.length?c[c.length-1]:null,g=x,T=0;T<c.length;T++){var B=c[T];if(B.dataset.precedence===a)g=B;else if(g!==x)break}g?g.parentNode.insertBefore(t,g.nextSibling):(a=i.nodeType===9?i.head:i,a.insertBefore(t,a.firstChild))}function vu(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.title==null&&(t.title=a.title)}function ju(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.integrity==null&&(t.integrity=a.integrity)}var dc=null;function c1(t,a,i){if(dc===null){var c=new Map,x=dc=new Map;x.set(i,c)}else x=dc,c=x.get(i),c||(c=new Map,x.set(i,c));if(c.has(t))return c;for(c.set(t,null),i=i.getElementsByTagName(t),x=0;x<i.length;x++){var g=i[x];if(!(g[Br]||g[Es]||t==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var T=g.getAttribute(a)||"";T=t+T;var B=c.get(T);B?B.push(g):c.set(T,[g])}}return c}function d1(t,a,i){t=t.ownerDocument||t,t.head.insertBefore(i,a==="title"?t.querySelector("head > title"):null)}function cg(t,a,i){if(i===1||a.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return t=a.disabled,typeof a.precedence=="string"&&t==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function u1(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function dg(t,a,i,c){if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var x=Hi(c.href),g=a.querySelector(zl(x));if(g){a=g._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(t.count++,t=uc.bind(t),a.then(t,t)),i.state.loading|=4,i.instance=g,ws(g);return}g=a.ownerDocument||a,c=l1(c),(x=Ha.get(x))&&vu(c,x),g=g.createElement("link"),ws(g);var T=g;T._p=new Promise(function(B,se){T.onload=B,T.onerror=se}),$s(g,"link",c),i.instance=g}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(i,a),(a=i.state.preload)&&(i.state.loading&3)===0&&(t.count++,i=uc.bind(t),a.addEventListener("load",i),a.addEventListener("error",i))}}var Cu=0;function ug(t,a){return t.stylesheets&&t.count===0&&fc(t,t.stylesheets),0<t.count||0<t.imgCount?function(i){var c=setTimeout(function(){if(t.stylesheets&&fc(t,t.stylesheets),t.unsuspend){var g=t.unsuspend;t.unsuspend=null,g()}},6e4+a);0<t.imgBytes&&Cu===0&&(Cu=62500*Xm());var x=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&fc(t,t.stylesheets),t.unsuspend)){var g=t.unsuspend;t.unsuspend=null,g()}},(t.imgBytes>Cu?50:800)+a);return t.unsuspend=i,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(x)}}:null}function uc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)fc(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var hc=null;function fc(t,a){t.stylesheets=null,t.unsuspend!==null&&(t.count++,hc=new Map,a.forEach(hg,t),hc=null,uc.call(t))}function hg(t,a){if(!(a.state.loading&4)){var i=hc.get(t);if(i)var c=i.get(null);else{i=new Map,hc.set(t,i);for(var x=t.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<x.length;g++){var T=x[g];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(i.set(T.dataset.precedence,T),c=T)}c&&i.set(null,c)}x=a.instance,T=x.getAttribute("data-precedence"),g=i.get(T)||c,g===c&&i.set(null,x),i.set(T,x),this.count++,c=uc.bind(this),x.addEventListener("load",c),x.addEventListener("error",c),g?g.parentNode.insertBefore(x,g.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(x,t.firstChild)),a.state.loading|=4}}var Vl={$$typeof:H,Provider:null,Consumer:null,_currentValue:Ne,_currentValue2:Ne,_threadCount:0};function fg(t,a,i,c,x,g,T,B,se){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=tn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tn(0),this.hiddenUpdates=tn(null),this.identifierPrefix=c,this.onUncaughtError=x,this.onCaughtError=g,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=se,this.incompleteTransitions=new Map}function h1(t,a,i,c,x,g,T,B,se,be,De,Ie){return t=new fg(t,a,i,T,se,be,De,Ie,B),a=1,g===!0&&(a|=24),g=ja(3,null,null,a),t.current=g,g.stateNode=t,a=ad(),a.refCount++,t.pooledCache=a,a.refCount++,g.memoizedState={element:c,isDehydrated:i,cache:a},ld(g),t}function f1(t){return t?(t=wi,t):wi}function x1(t,a,i,c,x,g){x=f1(x),c.context===null?c.context=x:c.pendingContext=x,c=fr(a),c.payload={element:i},g=g===void 0?null:g,g!==null&&(c.callback=g),i=xr(t,c,a),i!==null&&(ga(i,t,a),Nl(i,t,a))}function m1(t,a){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var i=t.retryLane;t.retryLane=i!==0&&i<a?i:a}}function Au(t,a){m1(t,a),(t=t.alternate)&&m1(t,a)}function g1(t){if(t.tag===13||t.tag===31){var a=Xr(t,67108864);a!==null&&ga(a,t,67108864),Au(t,67108864)}}function p1(t){if(t.tag===13||t.tag===31){var a=Ta();a=Ys(a);var i=Xr(t,a);i!==null&&ga(i,t,a),Au(t,a)}}var xc=!0;function xg(t,a,i,c){var x=W.T;W.T=null;var g=Q.p;try{Q.p=2,Eu(t,a,i,c)}finally{Q.p=g,W.T=x}}function mg(t,a,i,c){var x=W.T;W.T=null;var g=Q.p;try{Q.p=8,Eu(t,a,i,c)}finally{Q.p=g,W.T=x}}function Eu(t,a,i,c){if(xc){var x=Su(c);if(x===null)hu(t,a,c,mc,i),b1(t,c);else if(pg(x,t,a,i,c))c.stopPropagation();else if(b1(t,c),a&4&&-1<gg.indexOf(t)){for(;x!==null;){var g=Xt(x);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var T=en(g.pendingLanes);if(T!==0){var B=g;for(B.pendingLanes|=2,B.entangledLanes|=2;T;){var se=1<<31-Ye(T);B.entanglements[1]|=se,T&=~se}hn(g),(qt&6)===0&&(Qo=We()+500,Ll(0))}}break;case 31:case 13:B=Xr(g,2),B!==null&&ga(B,g,2),$o(),Au(g,2)}if(g=Su(c),g===null&&hu(t,a,c,mc,i),g===x)break;x=g}x!==null&&c.stopPropagation()}else hu(t,a,c,null,i)}}function Su(t){return t=il(t),Tu(t)}var mc=null;function Tu(t){if(mc=null,t=bs(t),t!==null){var a=N(t);if(a===null)t=null;else{var i=a.tag;if(i===13){if(t=A(a),t!==null)return t;t=null}else if(i===31){if(t=R(a),t!==null)return t;t=null}else if(i===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;t=null}else a!==t&&(t=null)}}return mc=t,null}function y1(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(rt()){case st:return 2;case _s:return 8;case pt:case ct:return 32;case ds:return 268435456;default:return 32}default:return 32}}var Ru=!1,Ar=null,Er=null,Sr=null,Gl=new Map,Xl=new Map,Tr=[],gg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function b1(t,a){switch(t){case"focusin":case"focusout":Ar=null;break;case"dragenter":case"dragleave":Er=null;break;case"mouseover":case"mouseout":Sr=null;break;case"pointerover":case"pointerout":Gl.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xl.delete(a.pointerId)}}function Yl(t,a,i,c,x,g){return t===null||t.nativeEvent!==g?(t={blockedOn:a,domEventName:i,eventSystemFlags:c,nativeEvent:g,targetContainers:[x]},a!==null&&(a=Xt(a),a!==null&&g1(a)),t):(t.eventSystemFlags|=c,a=t.targetContainers,x!==null&&a.indexOf(x)===-1&&a.push(x),t)}function pg(t,a,i,c,x){switch(a){case"focusin":return Ar=Yl(Ar,t,a,i,c,x),!0;case"dragenter":return Er=Yl(Er,t,a,i,c,x),!0;case"mouseover":return Sr=Yl(Sr,t,a,i,c,x),!0;case"pointerover":var g=x.pointerId;return Gl.set(g,Yl(Gl.get(g)||null,t,a,i,c,x)),!0;case"gotpointercapture":return g=x.pointerId,Xl.set(g,Yl(Xl.get(g)||null,t,a,i,c,x)),!0}return!1}function w1(t){var a=bs(t.target);if(a!==null){var i=N(a);if(i!==null){if(a=i.tag,a===13){if(a=A(i),a!==null){t.blockedOn=a,qe(t.priority,function(){p1(i)});return}}else if(a===31){if(a=R(i),a!==null){t.blockedOn=a,qe(t.priority,function(){p1(i)});return}}else if(a===3&&i.stateNode.current.memoizedState.isDehydrated){t.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}t.blockedOn=null}function gc(t){if(t.blockedOn!==null)return!1;for(var a=t.targetContainers;0<a.length;){var i=Su(t.nativeEvent);if(i===null){i=t.nativeEvent;var c=new i.constructor(i.type,i);Lr=c,i.target.dispatchEvent(c),Lr=null}else return a=Xt(i),a!==null&&g1(a),t.blockedOn=i,!1;a.shift()}return!0}function N1(t,a,i){gc(t)&&i.delete(a)}function yg(){Ru=!1,Ar!==null&&gc(Ar)&&(Ar=null),Er!==null&&gc(Er)&&(Er=null),Sr!==null&&gc(Sr)&&(Sr=null),Gl.forEach(N1),Xl.forEach(N1)}function pc(t,a){t.blockedOn===a&&(t.blockedOn=null,Ru||(Ru=!0,h.unstable_scheduleCallback(h.unstable_NormalPriority,yg)))}var yc=null;function v1(t){yc!==t&&(yc=t,h.unstable_scheduleCallback(h.unstable_NormalPriority,function(){yc===t&&(yc=null);for(var a=0;a<t.length;a+=3){var i=t[a],c=t[a+1],x=t[a+2];if(typeof c!="function"){if(Tu(c||i)===null)continue;break}var g=Xt(i);g!==null&&(t.splice(a,3),a-=3,Sd(g,{pending:!0,data:x,method:i.method,action:c},c,x))}}))}function Gi(t){function a(se){return pc(se,t)}Ar!==null&&pc(Ar,t),Er!==null&&pc(Er,t),Sr!==null&&pc(Sr,t),Gl.forEach(a),Xl.forEach(a);for(var i=0;i<Tr.length;i++){var c=Tr[i];c.blockedOn===t&&(c.blockedOn=null)}for(;0<Tr.length&&(i=Tr[0],i.blockedOn===null);)w1(i),i.blockedOn===null&&Tr.shift();if(i=(t.ownerDocument||t).$$reactFormReplay,i!=null)for(c=0;c<i.length;c+=3){var x=i[c],g=i[c+1],T=x[Jt]||null;if(typeof g=="function")T||v1(i);else if(T){var B=null;if(g&&g.hasAttribute("formAction")){if(x=g,T=g[Jt]||null)B=T.formAction;else if(Tu(x)!==null)continue}else B=T.action;typeof B=="function"?i[c+1]=B:(i.splice(c,3),c-=3),v1(i)}}}function j1(){function t(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(T){return x=T})},focusReset:"manual",scroll:"manual"})}function a(){x!==null&&(x(),x=null),c||setTimeout(i,20)}function i(){if(!c&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,x=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(i,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),x!==null&&(x(),x=null)}}}function Ou(t){this._internalRoot=t}bc.prototype.render=Ou.prototype.render=function(t){var a=this._internalRoot;if(a===null)throw Error(y(409));var i=a.current,c=Ta();x1(i,c,t,a,null,null)},bc.prototype.unmount=Ou.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var a=t.containerInfo;x1(t.current,2,null,t,null,null),$o(),a[pa]=null}};function bc(t){this._internalRoot=t}bc.prototype.unstable_scheduleHydration=function(t){if(t){var a=ta();t={blockedOn:null,target:t,priority:a};for(var i=0;i<Tr.length&&a!==0&&a<Tr[i].priority;i++);Tr.splice(i,0,t),i===0&&w1(t)}};var C1=p.version;if(C1!=="19.2.0")throw Error(y(527,C1,"19.2.0"));Q.findDOMNode=function(t){var a=t._reactInternals;if(a===void 0)throw typeof t.render=="function"?Error(y(188)):(t=Object.keys(t).join(","),Error(y(268,t)));return t=w(a),t=t!==null?C(t):null,t=t===null?null:t.stateNode,t};var bg={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wc.isDisabled&&wc.supportsFiber)try{Ue=wc.inject(bg),Te=wc}catch{}}return Kl.createRoot=function(t,a){if(!v(t))throw Error(y(299));var i=!1,c="",x=Oh,g=Dh,T=_h;return a!=null&&(a.unstable_strictMode===!0&&(i=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(x=a.onUncaughtError),a.onCaughtError!==void 0&&(g=a.onCaughtError),a.onRecoverableError!==void 0&&(T=a.onRecoverableError)),a=h1(t,1,!1,null,null,i,c,null,x,g,T,j1),t[pa]=a.current,uu(t),new Ou(a)},Kl.hydrateRoot=function(t,a,i){if(!v(t))throw Error(y(299));var c=!1,x="",g=Oh,T=Dh,B=_h,se=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(x=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(T=i.onCaughtError),i.onRecoverableError!==void 0&&(B=i.onRecoverableError),i.formState!==void 0&&(se=i.formState)),a=h1(t,1,!0,a,i??null,c,x,se,g,T,B,j1),a.context=f1(null),i=a.current,c=Ta(),c=Ys(c),x=fr(c),x.callback=null,xr(i,x,c),i=c,a.current.lanes=i,sn(a,i),hn(a),t[pa]=a.current,uu(t),new bc(a)},Kl.version="19.2.0",Kl}var M1;function Rg(){if(M1)return Iu.exports;M1=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(p){console.error(p)}}return h(),Iu.exports=Tg(),Iu.exports}var Og=Rg();const Dg=Mc(Og);_x();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $l(){return $l=Object.assign?Object.assign.bind():function(h){for(var p=1;p<arguments.length;p++){var f=arguments[p];for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(h[y]=f[y])}return h},$l.apply(this,arguments)}var Dr;(function(h){h.Pop="POP",h.Push="PUSH",h.Replace="REPLACE"})(Dr||(Dr={}));const k1="popstate";function _g(h){h===void 0&&(h={});function p(y,v){let{pathname:N,search:A,hash:R}=y.location;return e0("",{pathname:N,search:A,hash:R},v.state&&v.state.usr||null,v.state&&v.state.key||"default")}function f(y,v){return typeof v=="string"?v:Tc(v)}return Mg(p,f,null,h)}function Ds(h,p){if(h===!1||h===null||typeof h>"u")throw new Error(p)}function l0(h,p){if(!h){typeof console<"u"&&console.warn(p);try{throw new Error(p)}catch{}}}function Ig(){return Math.random().toString(36).substr(2,8)}function B1(h,p){return{usr:h.state,key:h.key,idx:p}}function e0(h,p,f,y){return f===void 0&&(f=null),$l({pathname:typeof h=="string"?h:h.pathname,search:"",hash:""},typeof p=="string"?$i(p):p,{state:f,key:p&&p.key||y||Ig()})}function Tc(h){let{pathname:p="/",search:f="",hash:y=""}=h;return f&&f!=="?"&&(p+=f.charAt(0)==="?"?f:"?"+f),y&&y!=="#"&&(p+=y.charAt(0)==="#"?y:"#"+y),p}function $i(h){let p={};if(h){let f=h.indexOf("#");f>=0&&(p.hash=h.substr(f),h=h.substr(0,f));let y=h.indexOf("?");y>=0&&(p.search=h.substr(y),h=h.substr(0,y)),h&&(p.pathname=h)}return p}function Mg(h,p,f,y){y===void 0&&(y={});let{window:v=document.defaultView,v5Compat:N=!1}=y,A=v.history,R=Dr.Pop,j=null,w=C();w==null&&(w=0,A.replaceState($l({},A.state,{idx:w}),""));function C(){return(A.state||{idx:null}).idx}function O(){R=Dr.Pop;let Y=C(),ee=Y==null?null:Y-w;w=Y,j&&j({action:R,location:V.location,delta:ee})}function _(Y,ee){R=Dr.Push;let K=e0(V.location,Y,ee);w=C()+1;let H=B1(K,w),q=V.createHref(K);try{A.pushState(H,"",q)}catch(te){if(te instanceof DOMException&&te.name==="DataCloneError")throw te;v.location.assign(q)}N&&j&&j({action:R,location:V.location,delta:1})}function L(Y,ee){R=Dr.Replace;let K=e0(V.location,Y,ee);w=C();let H=B1(K,w),q=V.createHref(K);A.replaceState(H,"",q),N&&j&&j({action:R,location:V.location,delta:0})}function P(Y){let ee=v.location.origin!=="null"?v.location.origin:v.location.href,K=typeof Y=="string"?Y:Tc(Y);return K=K.replace(/ $/,"%20"),Ds(ee,"No window.location.(origin|href) available to create URL for href: "+K),new URL(K,ee)}let V={get action(){return R},get location(){return h(v,A)},listen(Y){if(j)throw new Error("A history only accepts one active listener");return v.addEventListener(k1,O),j=Y,()=>{v.removeEventListener(k1,O),j=null}},createHref(Y){return p(v,Y)},createURL:P,encodeLocation(Y){let ee=P(Y);return{pathname:ee.pathname,search:ee.search,hash:ee.hash}},push:_,replace:L,go(Y){return A.go(Y)}};return V}var L1;(function(h){h.data="data",h.deferred="deferred",h.redirect="redirect",h.error="error"})(L1||(L1={}));function kg(h,p,f){return f===void 0&&(f="/"),Bg(h,p,f)}function Bg(h,p,f,y){let v=typeof p=="string"?$i(p):p,N=o0(v.pathname||"/",f);if(N==null)return null;let A=Ix(h);Lg(A);let R=null;for(let j=0;R==null&&j<A.length;++j){let w=Zg(N);R=Yg(A[j],w)}return R}function Ix(h,p,f,y){p===void 0&&(p=[]),f===void 0&&(f=[]),y===void 0&&(y="");let v=(N,A,R)=>{let j={relativePath:R===void 0?N.path||"":R,caseSensitive:N.caseSensitive===!0,childrenIndex:A,route:N};j.relativePath.startsWith("/")&&(Ds(j.relativePath.startsWith(y),'Absolute route path "'+j.relativePath+'" nested under path '+('"'+y+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),j.relativePath=j.relativePath.slice(y.length));let w=_r([y,j.relativePath]),C=f.concat(j);N.children&&N.children.length>0&&(Ds(N.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+w+'".')),Ix(N.children,p,C,w)),!(N.path==null&&!N.index)&&p.push({path:w,score:Gg(w,N.index),routesMeta:C})};return h.forEach((N,A)=>{var R;if(N.path===""||!((R=N.path)!=null&&R.includes("?")))v(N,A);else for(let j of Mx(N.path))v(N,A,j)}),p}function Mx(h){let p=h.split("/");if(p.length===0)return[];let[f,...y]=p,v=f.endsWith("?"),N=f.replace(/\?$/,"");if(y.length===0)return v?[N,""]:[N];let A=Mx(y.join("/")),R=[];return R.push(...A.map(j=>j===""?N:[N,j].join("/"))),v&&R.push(...A),R.map(j=>h.startsWith("/")&&j===""?"/":j)}function Lg(h){h.sort((p,f)=>p.score!==f.score?f.score-p.score:Xg(p.routesMeta.map(y=>y.childrenIndex),f.routesMeta.map(y=>y.childrenIndex)))}const Pg=/^:[\w-]+$/,Fg=3,Ug=2,zg=1,Hg=10,Vg=-2,P1=h=>h==="*";function Gg(h,p){let f=h.split("/"),y=f.length;return f.some(P1)&&(y+=Vg),p&&(y+=Ug),f.filter(v=>!P1(v)).reduce((v,N)=>v+(Pg.test(N)?Fg:N===""?zg:Hg),y)}function Xg(h,p){return h.length===p.length&&h.slice(0,-1).every((y,v)=>y===p[v])?h[h.length-1]-p[p.length-1]:0}function Yg(h,p,f){let{routesMeta:y}=h,v={},N="/",A=[];for(let R=0;R<y.length;++R){let j=y[R],w=R===y.length-1,C=N==="/"?p:p.slice(N.length)||"/",O=qg({path:j.relativePath,caseSensitive:j.caseSensitive,end:w},C),_=j.route;if(!O)return null;Object.assign(v,O.params),A.push({params:v,pathname:_r([N,O.pathname]),pathnameBase:ep(_r([N,O.pathnameBase])),route:_}),O.pathnameBase!=="/"&&(N=_r([N,O.pathnameBase]))}return A}function qg(h,p){typeof h=="string"&&(h={path:h,caseSensitive:!1,end:!0});let[f,y]=Kg(h.path,h.caseSensitive,h.end),v=p.match(f);if(!v)return null;let N=v[0],A=N.replace(/(.)\/+$/,"$1"),R=v.slice(1);return{params:y.reduce((w,C,O)=>{let{paramName:_,isOptional:L}=C;if(_==="*"){let V=R[O]||"";A=N.slice(0,N.length-V.length).replace(/(.)\/+$/,"$1")}const P=R[O];return L&&!P?w[_]=void 0:w[_]=(P||"").replace(/%2F/g,"/"),w},{}),pathname:N,pathnameBase:A,pattern:h}}function Kg(h,p,f){p===void 0&&(p=!1),f===void 0&&(f=!0),l0(h==="*"||!h.endsWith("*")||h.endsWith("/*"),'Route path "'+h+'" will be treated as if it were '+('"'+h.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+h.replace(/\*$/,"/*")+'".'));let y=[],v="^"+h.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(A,R,j)=>(y.push({paramName:R,isOptional:j!=null}),j?"/?([^\\/]+)?":"/([^\\/]+)"));return h.endsWith("*")?(y.push({paramName:"*"}),v+=h==="*"||h==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):f?v+="\\/*$":h!==""&&h!=="/"&&(v+="(?:(?=\\/|$))"),[new RegExp(v,p?void 0:"i"),y]}function Zg(h){try{return h.split("/").map(p=>decodeURIComponent(p).replace(/\//g,"%2F")).join("/")}catch(p){return l0(!1,'The URL path "'+h+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+p+").")),h}}function o0(h,p){if(p==="/")return h;if(!h.toLowerCase().startsWith(p.toLowerCase()))return null;let f=p.endsWith("/")?p.length-1:p.length,y=h.charAt(f);return y&&y!=="/"?null:h.slice(f)||"/"}const Wg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Qg=h=>Wg.test(h);function Jg(h,p){p===void 0&&(p="/");let{pathname:f,search:y="",hash:v=""}=typeof h=="string"?$i(h):h,N;if(f)if(Qg(f))N=f;else{if(f.includes("//")){let A=f;f=f.replace(/\/\/+/g,"/"),l0(!1,"Pathnames cannot have embedded double slashes - normalizing "+(A+" -> "+f))}f.startsWith("/")?N=F1(f.substring(1),"/"):N=F1(f,p)}else N=p;return{pathname:N,search:tp(y),hash:sp(v)}}function F1(h,p){let f=p.replace(/\/+$/,"").split("/");return h.split("/").forEach(v=>{v===".."?f.length>1&&f.pop():v!=="."&&f.push(v)}),f.length>1?f.join("/"):"/"}function Lu(h,p,f,y){return"Cannot include a '"+h+"' character in a manually specified "+("`to."+p+"` field ["+JSON.stringify(y)+"].  Please separate it out to the ")+("`to."+f+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function $g(h){return h.filter((p,f)=>f===0||p.route.path&&p.route.path.length>0)}function c0(h,p){let f=$g(h);return p?f.map((y,v)=>v===f.length-1?y.pathname:y.pathnameBase):f.map(y=>y.pathnameBase)}function d0(h,p,f,y){y===void 0&&(y=!1);let v;typeof h=="string"?v=$i(h):(v=$l({},h),Ds(!v.pathname||!v.pathname.includes("?"),Lu("?","pathname","search",v)),Ds(!v.pathname||!v.pathname.includes("#"),Lu("#","pathname","hash",v)),Ds(!v.search||!v.search.includes("#"),Lu("#","search","hash",v)));let N=h===""||v.pathname==="",A=N?"/":v.pathname,R;if(A==null)R=f;else{let O=p.length-1;if(!y&&A.startsWith("..")){let _=A.split("/");for(;_[0]==="..";)_.shift(),O-=1;v.pathname=_.join("/")}R=O>=0?p[O]:"/"}let j=Jg(v,R),w=A&&A!=="/"&&A.endsWith("/"),C=(N||A===".")&&f.endsWith("/");return!j.pathname.endsWith("/")&&(w||C)&&(j.pathname+="/"),j}const _r=h=>h.join("/").replace(/\/\/+/g,"/"),ep=h=>h.replace(/\/+$/,"").replace(/^\/*/,"/"),tp=h=>!h||h==="?"?"":h.startsWith("?")?h:"?"+h,sp=h=>!h||h==="#"?"":h.startsWith("#")?h:"#"+h;function ap(h){return h!=null&&typeof h.status=="number"&&typeof h.statusText=="string"&&typeof h.internal=="boolean"&&"data"in h}const kx=["post","put","patch","delete"];new Set(kx);const np=["get",...kx];new Set(np);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function eo(){return eo=Object.assign?Object.assign.bind():function(h){for(var p=1;p<arguments.length;p++){var f=arguments[p];for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(h[y]=f[y])}return h},eo.apply(this,arguments)}const u0=D.createContext(null),rp=D.createContext(null),Ir=D.createContext(null),kc=D.createContext(null),qn=D.createContext({outlet:null,matches:[],isDataRoute:!1}),Bx=D.createContext(null);function ip(h,p){let{relative:f}=p===void 0?{}:p;el()||Ds(!1);let{basename:y,navigator:v}=D.useContext(Ir),{hash:N,pathname:A,search:R}=Px(h,{relative:f}),j=A;return y!=="/"&&(j=A==="/"?y:_r([y,A])),v.createHref({pathname:j,search:R,hash:N})}function el(){return D.useContext(kc)!=null}function Ga(){return el()||Ds(!1),D.useContext(kc).location}function Lx(h){D.useContext(Ir).static||D.useLayoutEffect(h)}function As(){let{isDataRoute:h}=D.useContext(qn);return h?bp():lp()}function lp(){el()||Ds(!1);let h=D.useContext(u0),{basename:p,future:f,navigator:y}=D.useContext(Ir),{matches:v}=D.useContext(qn),{pathname:N}=Ga(),A=JSON.stringify(c0(v,f.v7_relativeSplatPath)),R=D.useRef(!1);return Lx(()=>{R.current=!0}),D.useCallback(function(w,C){if(C===void 0&&(C={}),!R.current)return;if(typeof w=="number"){y.go(w);return}let O=d0(w,JSON.parse(A),N,C.relative==="path");h==null&&p!=="/"&&(O.pathname=O.pathname==="/"?p:_r([p,O.pathname])),(C.replace?y.replace:y.push)(O,C.state,C)},[p,y,A,N,h])}function tl(){let{matches:h}=D.useContext(qn),p=h[h.length-1];return p?p.params:{}}function Px(h,p){let{relative:f}=p===void 0?{}:p,{future:y}=D.useContext(Ir),{matches:v}=D.useContext(qn),{pathname:N}=Ga(),A=JSON.stringify(c0(v,y.v7_relativeSplatPath));return D.useMemo(()=>d0(h,JSON.parse(A),N,f==="path"),[h,A,N,f])}function op(h,p){return cp(h,p)}function cp(h,p,f,y){el()||Ds(!1);let{navigator:v}=D.useContext(Ir),{matches:N}=D.useContext(qn),A=N[N.length-1],R=A?A.params:{};A&&A.pathname;let j=A?A.pathnameBase:"/";A&&A.route;let w=Ga(),C;if(p){var O;let Y=typeof p=="string"?$i(p):p;j==="/"||(O=Y.pathname)!=null&&O.startsWith(j)||Ds(!1),C=Y}else C=w;let _=C.pathname||"/",L=_;if(j!=="/"){let Y=j.replace(/^\//,"").split("/");L="/"+_.replace(/^\//,"").split("/").slice(Y.length).join("/")}let P=kg(h,{pathname:L}),V=xp(P&&P.map(Y=>Object.assign({},Y,{params:Object.assign({},R,Y.params),pathname:_r([j,v.encodeLocation?v.encodeLocation(Y.pathname).pathname:Y.pathname]),pathnameBase:Y.pathnameBase==="/"?j:_r([j,v.encodeLocation?v.encodeLocation(Y.pathnameBase).pathname:Y.pathnameBase])})),N,f,y);return p&&V?D.createElement(kc.Provider,{value:{location:eo({pathname:"/",search:"",hash:"",state:null,key:"default"},C),navigationType:Dr.Pop}},V):V}function dp(){let h=yp(),p=ap(h)?h.status+" "+h.statusText:h instanceof Error?h.message:JSON.stringify(h),f=h instanceof Error?h.stack:null,v={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},p),f?D.createElement("pre",{style:v},f):null,null)}const up=D.createElement(dp,null);class hp extends D.Component{constructor(p){super(p),this.state={location:p.location,revalidation:p.revalidation,error:p.error}}static getDerivedStateFromError(p){return{error:p}}static getDerivedStateFromProps(p,f){return f.location!==p.location||f.revalidation!=="idle"&&p.revalidation==="idle"?{error:p.error,location:p.location,revalidation:p.revalidation}:{error:p.error!==void 0?p.error:f.error,location:f.location,revalidation:p.revalidation||f.revalidation}}componentDidCatch(p,f){console.error("React Router caught the following error during render",p,f)}render(){return this.state.error!==void 0?D.createElement(qn.Provider,{value:this.props.routeContext},D.createElement(Bx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function fp(h){let{routeContext:p,match:f,children:y}=h,v=D.useContext(u0);return v&&v.static&&v.staticContext&&(f.route.errorElement||f.route.ErrorBoundary)&&(v.staticContext._deepestRenderedBoundaryId=f.route.id),D.createElement(qn.Provider,{value:p},y)}function xp(h,p,f,y){var v;if(p===void 0&&(p=[]),f===void 0&&(f=null),y===void 0&&(y=null),h==null){var N;if(!f)return null;if(f.errors)h=f.matches;else if((N=y)!=null&&N.v7_partialHydration&&p.length===0&&!f.initialized&&f.matches.length>0)h=f.matches;else return null}let A=h,R=(v=f)==null?void 0:v.errors;if(R!=null){let C=A.findIndex(O=>O.route.id&&(R==null?void 0:R[O.route.id])!==void 0);C>=0||Ds(!1),A=A.slice(0,Math.min(A.length,C+1))}let j=!1,w=-1;if(f&&y&&y.v7_partialHydration)for(let C=0;C<A.length;C++){let O=A[C];if((O.route.HydrateFallback||O.route.hydrateFallbackElement)&&(w=C),O.route.id){let{loaderData:_,errors:L}=f,P=O.route.loader&&_[O.route.id]===void 0&&(!L||L[O.route.id]===void 0);if(O.route.lazy||P){j=!0,w>=0?A=A.slice(0,w+1):A=[A[0]];break}}}return A.reduceRight((C,O,_)=>{let L,P=!1,V=null,Y=null;f&&(L=R&&O.route.id?R[O.route.id]:void 0,V=O.route.errorElement||up,j&&(w<0&&_===0?(wp("route-fallback"),P=!0,Y=null):w===_&&(P=!0,Y=O.route.hydrateFallbackElement||null)));let ee=p.concat(A.slice(0,_+1)),K=()=>{let H;return L?H=V:P?H=Y:O.route.Component?H=D.createElement(O.route.Component,null):O.route.element?H=O.route.element:H=C,D.createElement(fp,{match:O,routeContext:{outlet:C,matches:ee,isDataRoute:f!=null},children:H})};return f&&(O.route.ErrorBoundary||O.route.errorElement||_===0)?D.createElement(hp,{location:f.location,revalidation:f.revalidation,component:V,error:L,children:K(),routeContext:{outlet:null,matches:ee,isDataRoute:!0}}):K()},null)}var Fx=(function(h){return h.UseBlocker="useBlocker",h.UseRevalidator="useRevalidator",h.UseNavigateStable="useNavigate",h})(Fx||{}),Ux=(function(h){return h.UseBlocker="useBlocker",h.UseLoaderData="useLoaderData",h.UseActionData="useActionData",h.UseRouteError="useRouteError",h.UseNavigation="useNavigation",h.UseRouteLoaderData="useRouteLoaderData",h.UseMatches="useMatches",h.UseRevalidator="useRevalidator",h.UseNavigateStable="useNavigate",h.UseRouteId="useRouteId",h})(Ux||{});function mp(h){let p=D.useContext(u0);return p||Ds(!1),p}function gp(h){let p=D.useContext(rp);return p||Ds(!1),p}function pp(h){let p=D.useContext(qn);return p||Ds(!1),p}function zx(h){let p=pp(),f=p.matches[p.matches.length-1];return f.route.id||Ds(!1),f.route.id}function yp(){var h;let p=D.useContext(Bx),f=gp(),y=zx();return p!==void 0?p:(h=f.errors)==null?void 0:h[y]}function bp(){let{router:h}=mp(Fx.UseNavigateStable),p=zx(Ux.UseNavigateStable),f=D.useRef(!1);return Lx(()=>{f.current=!0}),D.useCallback(function(v,N){N===void 0&&(N={}),f.current&&(typeof v=="number"?h.navigate(v):h.navigate(v,eo({fromRouteId:p},N)))},[h,p])}const U1={};function wp(h,p,f){U1[h]||(U1[h]=!0)}function Np(h,p){h==null||h.v7_startTransition,h==null||h.v7_relativeSplatPath}function Ki(h){let{to:p,replace:f,state:y,relative:v}=h;el()||Ds(!1);let{future:N,static:A}=D.useContext(Ir),{matches:R}=D.useContext(qn),{pathname:j}=Ga(),w=As(),C=d0(p,c0(R,N.v7_relativeSplatPath),j,v==="path"),O=JSON.stringify(C);return D.useEffect(()=>w(JSON.parse(O),{replace:f,state:y,relative:v}),[w,O,v,f,y]),null}function gt(h){Ds(!1)}function vp(h){let{basename:p="/",children:f=null,location:y,navigationType:v=Dr.Pop,navigator:N,static:A=!1,future:R}=h;el()&&Ds(!1);let j=p.replace(/^\/*/,"/"),w=D.useMemo(()=>({basename:j,navigator:N,static:A,future:eo({v7_relativeSplatPath:!1},R)}),[j,R,N,A]);typeof y=="string"&&(y=$i(y));let{pathname:C="/",search:O="",hash:_="",state:L=null,key:P="default"}=y,V=D.useMemo(()=>{let Y=o0(C,j);return Y==null?null:{location:{pathname:Y,search:O,hash:_,state:L,key:P},navigationType:v}},[j,C,O,_,L,P,v]);return V==null?null:D.createElement(Ir.Provider,{value:w},D.createElement(kc.Provider,{children:f,value:V}))}function jp(h){let{children:p,location:f}=h;return op(t0(p),f)}new Promise(()=>{});function t0(h,p){p===void 0&&(p=[]);let f=[];return D.Children.forEach(h,(y,v)=>{if(!D.isValidElement(y))return;let N=[...p,v];if(y.type===D.Fragment){f.push.apply(f,t0(y.props.children,N));return}y.type!==gt&&Ds(!1),!y.props.index||!y.props.children||Ds(!1);let A={id:y.props.id||N.join("-"),caseSensitive:y.props.caseSensitive,element:y.props.element,Component:y.props.Component,index:y.props.index,path:y.props.path,loader:y.props.loader,action:y.props.action,errorElement:y.props.errorElement,ErrorBoundary:y.props.ErrorBoundary,hasErrorBoundary:y.props.ErrorBoundary!=null||y.props.errorElement!=null,shouldRevalidate:y.props.shouldRevalidate,handle:y.props.handle,lazy:y.props.lazy};y.props.children&&(A.children=t0(y.props.children,N)),f.push(A)}),f}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function s0(){return s0=Object.assign?Object.assign.bind():function(h){for(var p=1;p<arguments.length;p++){var f=arguments[p];for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(h[y]=f[y])}return h},s0.apply(this,arguments)}function Cp(h,p){if(h==null)return{};var f={},y=Object.keys(h),v,N;for(N=0;N<y.length;N++)v=y[N],!(p.indexOf(v)>=0)&&(f[v]=h[v]);return f}function Ap(h){return!!(h.metaKey||h.altKey||h.ctrlKey||h.shiftKey)}function Ep(h,p){return h.button===0&&(!p||p==="_self")&&!Ap(h)}const Sp=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Tp="6";try{window.__reactRouterVersion=Tp}catch{}const Rp="startTransition",z1=Cg[Rp];function Op(h){let{basename:p,children:f,future:y,window:v}=h,N=D.useRef();N.current==null&&(N.current=_g({window:v,v5Compat:!0}));let A=N.current,[R,j]=D.useState({action:A.action,location:A.location}),{v7_startTransition:w}=y||{},C=D.useCallback(O=>{w&&z1?z1(()=>j(O)):j(O)},[j,w]);return D.useLayoutEffect(()=>A.listen(C),[A,C]),D.useEffect(()=>Np(y),[y]),D.createElement(vp,{basename:p,children:f,location:R.location,navigationType:R.action,navigator:A,future:y})}const Dp=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",_p=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Sc=D.forwardRef(function(p,f){let{onClick:y,relative:v,reloadDocument:N,replace:A,state:R,target:j,to:w,preventScrollReset:C,viewTransition:O}=p,_=Cp(p,Sp),{basename:L}=D.useContext(Ir),P,V=!1;if(typeof w=="string"&&_p.test(w)&&(P=w,Dp))try{let H=new URL(window.location.href),q=w.startsWith("//")?new URL(H.protocol+w):new URL(w),te=o0(q.pathname,L);q.origin===H.origin&&te!=null?w=te+q.search+q.hash:V=!0}catch{}let Y=ip(w,{relative:v}),ee=Ip(w,{replace:A,state:R,target:j,preventScrollReset:C,relative:v,viewTransition:O});function K(H){y&&y(H),H.defaultPrevented||ee(H)}return D.createElement("a",s0({},_,{href:P||Y,onClick:V||N?y:K,ref:f,target:j}))});var H1;(function(h){h.UseScrollRestoration="useScrollRestoration",h.UseSubmit="useSubmit",h.UseSubmitFetcher="useSubmitFetcher",h.UseFetcher="useFetcher",h.useViewTransitionState="useViewTransitionState"})(H1||(H1={}));var V1;(function(h){h.UseFetcher="useFetcher",h.UseFetchers="useFetchers",h.UseScrollRestoration="useScrollRestoration"})(V1||(V1={}));function Ip(h,p){let{target:f,replace:y,state:v,preventScrollReset:N,relative:A,viewTransition:R}=p===void 0?{}:p,j=As(),w=Ga(),C=Px(h,{relative:A});return D.useCallback(O=>{if(Ep(O,f)){O.preventDefault();let _=y!==void 0?y:Tc(w)===Tc(C);j(h,{replace:_,state:v,preventScrollReset:N,relative:A,viewTransition:R})}},[w,j,C,y,v,f,h,N,A,R])}const Mp=()=>!!Xs(),Xs=()=>{const h=localStorage.getItem("token");return h||null},G1=h=>{h.token&&localStorage.setItem("token",h.token),h.role&&localStorage.setItem("role",h.role),h.name&&localStorage.setItem("name",h.name),h.companyName!==void 0&&(h.companyName?localStorage.setItem("companyName",h.companyName):localStorage.removeItem("companyName")),h.email&&localStorage.setItem("email",h.email),h.id&&localStorage.setItem("userId",h.id),h.phone!==void 0&&(h.phone?localStorage.setItem("phone",h.phone):localStorage.removeItem("phone")),h.contactNumber!==void 0&&(h.contactNumber?localStorage.setItem("contactNumber",h.contactNumber):localStorage.removeItem("contactNumber")),h.emergencyContact!==void 0&&(h.emergencyContact?localStorage.setItem("emergencyContact",h.emergencyContact):localStorage.removeItem("emergencyContact")),h.pickupAddress!==void 0&&(h.pickupAddress?localStorage.setItem("pickupAddress",h.pickupAddress):localStorage.removeItem("pickupAddress")),h.cnic!==void 0&&(h.cnic?localStorage.setItem("cnic",h.cnic):localStorage.removeItem("cnic")),h.bankName!==void 0&&(h.bankName?localStorage.setItem("bankName",h.bankName):localStorage.removeItem("bankName")),h.accountHolderName!==void 0&&(h.accountHolderName?localStorage.setItem("accountHolderName",h.accountHolderName):localStorage.removeItem("accountHolderName")),h.accountNumber!==void 0&&(h.accountNumber?localStorage.setItem("accountNumber",h.accountNumber):localStorage.removeItem("accountNumber")),h.iban!==void 0&&(h.iban?localStorage.setItem("iban",h.iban):localStorage.removeItem("iban")),h.bankAccountDetails!==void 0&&(h.bankAccountDetails?localStorage.setItem("bankAccountDetails",h.bankAccountDetails):localStorage.removeItem("bankAccountDetails")),h.vehicleType!==void 0&&(h.vehicleType?localStorage.setItem("vehicleType",h.vehicleType):localStorage.removeItem("vehicleType")),h.vehicleNumber!==void 0&&(h.vehicleNumber?localStorage.setItem("vehicleNumber",h.vehicleNumber):localStorage.removeItem("vehicleNumber")),h.vehicleModel!==void 0&&(h.vehicleModel?localStorage.setItem("vehicleModel",h.vehicleModel):localStorage.removeItem("vehicleModel")),h.portalActive!==void 0&&(h.portalActive===null?localStorage.removeItem("portalActive"):localStorage.setItem("portalActive",String(!!h.portalActive))),h.weightBracketsCount!==void 0&&(h.weightBracketsCount===null||h.weightBracketsCount===void 0?localStorage.removeItem("weightBracketsCount"):localStorage.setItem("weightBracketsCount",String(Number(h.weightBracketsCount)))),h.commissionRate!==void 0&&(h.commissionRate===null?localStorage.removeItem("commissionRate"):localStorage.setItem("commissionRate",String(h.commissionRate))),h.commissionType!==void 0&&(h.commissionType?localStorage.setItem("commissionType",String(h.commissionType)):localStorage.removeItem("commissionType")),h.commissionValue!==void 0&&(h.commissionValue===null?localStorage.removeItem("commissionValue"):localStorage.setItem("commissionValue",String(h.commissionValue))),h.commissionStatus!==void 0&&(h.commissionStatus?localStorage.setItem("commissionStatus",String(h.commissionStatus)):localStorage.removeItem("commissionStatus")),h.isCommissionApproved!==void 0&&(h.isCommissionApproved===null?localStorage.removeItem("isCommissionApproved"):localStorage.setItem("isCommissionApproved",String(!!h.isCommissionApproved)))},X1=()=>(localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("name"),localStorage.removeItem("companyName"),localStorage.removeItem("email"),localStorage.removeItem("userId"),localStorage.removeItem("phone"),localStorage.removeItem("contactNumber"),localStorage.removeItem("emergencyContact"),localStorage.removeItem("pickupAddress"),localStorage.removeItem("cnic"),localStorage.removeItem("bankName"),localStorage.removeItem("accountHolderName"),localStorage.removeItem("accountNumber"),localStorage.removeItem("iban"),localStorage.removeItem("bankAccountDetails"),localStorage.removeItem("vehicleType"),localStorage.removeItem("vehicleNumber"),localStorage.removeItem("vehicleModel"),localStorage.removeItem("portalActive"),localStorage.removeItem("weightBracketsCount"),localStorage.removeItem("commissionRate"),localStorage.removeItem("commissionType"),localStorage.removeItem("commissionValue"),localStorage.removeItem("commissionStatus"),localStorage.removeItem("isCommissionApproved"),fetch("/api/auth/logout",{method:"POST",credentials:"include"})),Hx=D.createContext(),kp=({children:h})=>{const[p,f]=D.useState(null),[y,v]=D.useState(!0),N=async j=>{const w=j||Xs(),C=await fetch("/api/auth/me",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json",...w?{Authorization:`Bearer ${w}`}:{}}});if(!C.ok){const H=await C.json().catch(()=>({})),q=new Error((H==null?void 0:H.message)||`Failed to fetch profile (HTTP ${C.status})`);throw q.status=C.status,q}const O=await C.json(),_=O==null?void 0:O.user,L=_==null?void 0:_.role,P=typeof(_==null?void 0:_.portalActive)=="boolean"?_.portalActive:null,V=String((_==null?void 0:_.commissionStatus)||"").toUpperCase(),Y=(_==null?void 0:_.isCommissionApproved)===!0,ee=L==="SHIPPER"?P!==null?P:Y||V==="APPROVED":P!==null?P:!0,K={token:w,id:(_==null?void 0:_._id)||(_==null?void 0:_.id),role:L,name:_==null?void 0:_.name,email:_==null?void 0:_.email,companyName:(_==null?void 0:_.companyName)||null,phone:(_==null?void 0:_.phone)||null,contactNumber:(_==null?void 0:_.contactNumber)||null,emergencyContact:(_==null?void 0:_.emergencyContact)||null,pickupAddress:(_==null?void 0:_.pickupAddress)||(_==null?void 0:_.address)||null,cnic:(_==null?void 0:_.cnic)||(_==null?void 0:_.cnicNumber)||null,bankName:(_==null?void 0:_.bankName)||null,accountHolderName:(_==null?void 0:_.accountHolderName)||null,accountNumber:(_==null?void 0:_.accountNumber)||null,iban:(_==null?void 0:_.iban)||null,bankAccountDetails:(_==null?void 0:_.bankAccountDetails)||null,vehicleType:(_==null?void 0:_.vehicleType)||null,vehicleNumber:(_==null?void 0:_.vehicleNumber)||null,vehicleModel:(_==null?void 0:_.vehicleModel)||null,portalActive:ee,weightBracketsCount:(_==null?void 0:_.weightBracketsCount)!==void 0&&(_==null?void 0:_.weightBracketsCount)!==null?Number(_.weightBracketsCount):null,commissionRate:(_==null?void 0:_.commissionRate)??null,commissionType:(_==null?void 0:_.commissionType)??null,commissionValue:(_==null?void 0:_.commissionValue)??null,commissionStatus:V,isCommissionApproved:(_==null?void 0:_.isCommissionApproved)??null};return G1(K),f(K),K};D.useEffect(()=>{(async()=>{try{if(Mp()){const w=Xs();await N(w)}}catch(w){console.error("Auth check failed:",w);try{await X1()}finally{f(null)}}finally{v(!1)}})()},[]);const A=async({token:j})=>(G1({token:j}),N(j)),R=async()=>{try{return await X1(),f(null),!0}catch(j){return console.error("Logout failed:",j),!1}};return e.jsx(Hx.Provider,{value:{user:p,loading:y,login:A,logout:R,refreshMe:N},children:!y&&h})},Fs=()=>{const h=D.useContext(Hx);if(!h)throw new Error("useAuth must be used within an AuthProvider");return h};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bp=h=>h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Lp=h=>h.replace(/^([A-Z])|[\s-_]+(\w)/g,(p,f,y)=>y?y.toUpperCase():f.toLowerCase()),Y1=h=>{const p=Lp(h);return p.charAt(0).toUpperCase()+p.slice(1)},Vx=(...h)=>h.filter((p,f,y)=>!!p&&p.trim()!==""&&y.indexOf(p)===f).join(" ").trim(),Pp=h=>{for(const p in h)if(p.startsWith("aria-")||p==="role"||p==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Fp={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Up=D.forwardRef(({color:h="currentColor",size:p=24,strokeWidth:f=2,absoluteStrokeWidth:y,className:v="",children:N,iconNode:A,...R},j)=>D.createElement("svg",{ref:j,...Fp,width:p,height:p,stroke:h,strokeWidth:y?Number(f)*24/Number(p):f,className:Vx("lucide",v),...!N&&!Pp(R)&&{"aria-hidden":"true"},...R},[...A.map(([w,C])=>D.createElement(w,C)),...Array.isArray(N)?N:[N]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=(h,p)=>{const f=D.forwardRef(({className:y,...v},N)=>D.createElement(Up,{ref:N,iconNode:p,className:Vx(`lucide-${Bp(Y1(h))}`,`lucide-${h}`,y),...v}));return f.displayName=Y1(h),f};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zp=[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]],Hp=at("arrow-down-to-line",zp);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vp=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],h0=at("arrow-left",Vp);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gp=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Xp=at("bell",Gp);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yp=[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]],qp=at("bike",Yp);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kp=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Wi=at("building-2",Kp);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=[["path",{d:"M14.564 14.558a3 3 0 1 1-4.122-4.121",key:"1rnrzw"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M20 20H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 .819-.175",key:"1x3arw"}],["path",{d:"M9.695 4.024A2 2 0 0 1 10.004 4h3.993a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v7.344",key:"1i84u0"}]],Wp=at("camera-off",Zp);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qp=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Ql=at("camera",Qp);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jp=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],a0=at("check",Jp);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $p=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Xn=at("circle-alert",$p);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e2=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Yn=at("circle-check-big",e2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t2=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],xn=at("circle-x",t2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s2=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],a2=at("clipboard-list",s2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n2=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],r2=at("clipboard",n2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i2=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],mn=at("clock",i2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l2=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],o2=at("copy",l2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c2=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],ts=at("dollar-sign",c2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Rc=at("download",d2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Qi=at("eye-off",u2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ji=at("eye",h2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f2=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Pu=at("file-text",f2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],sl=at("funnel",x2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Gx=at("globe",m2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],p2=at("house",g2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],b2=at("info",y2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w2=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],N2=at("key",w2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],vc=at("layout-dashboard",v2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],C2=at("loader-circle",j2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A2=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],Zi=at("loader",A2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Xx=at("log-out",E2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Oc=at("mail",S2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],gn=at("map-pin",T2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],O2=at("menu",R2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],St=at("package",D2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Vn=at("phone",_2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],f0=at("play",I2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],n0=at("plus",M2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k2=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Yx=at("printer",k2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],ii=at("qr-code",B2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],Gn=at("refresh-ccw",L2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],F2=at("refresh-cw",P2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],r0=at("rotate-ccw",U2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],x0=at("save",z2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H2=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],q1=at("scale",H2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],K1=at("scan",V2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],al=at("search",G2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],m0=at("shield",X2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],q2=at("square",Y2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K2=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],g0=at("trash-2",K2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],W2=at("trending-up",Z2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],J2=at("triangle-alert",Q2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],gs=at("truck",$2);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ey=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Fu=at("type",ey);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ty=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],sy=at("upload",ty);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ay=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],to=at("user",ay);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ny=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ri=at("users",ny);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],iy=at("wallet",ry);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],p0=at("x",ly),oy=({children:h,title:p})=>{const{user:f,logout:y}=Fs(),[v,N]=D.useState(!1),[A,R]=D.useState([]),[j,w]=D.useState(!1),C=As(),O=Ga(),_=(f==null?void 0:f.token)||Xs(),L=async()=>{try{await y(),C("/")}catch(q){console.error("Failed to log out",q)}},P=()=>N(!v),V=async()=>{if(!(!_||(f==null?void 0:f.role)!=="CEO"&&(f==null?void 0:f.role)!=="MANAGER"))try{const q=await fetch("/api/notifications",{headers:{Authorization:`Bearer ${_}`}});if(q.ok){const te=await q.json();R(te.filter(ce=>!ce.read))}}catch(q){console.error("Failed to fetch notifications:",q)}},Y=async q=>{try{(await fetch(`/api/notifications/${q}/mark-read`,{method:"PATCH",headers:{Authorization:`Bearer ${_}`}})).ok&&await V()}catch(te){console.error("Failed to mark notification as read:",te)}};D.useEffect(()=>{if(f&&(f.role==="CEO"||f.role==="MANAGER")){V();const q=setInterval(V,1e4);return()=>clearInterval(q)}},[f,_]);let ee="User",K=(f==null?void 0:f.role)||"User";(f==null?void 0:f.role)==="CEO"?(ee="Abdul Rehman Qasim",K="CEO"):(f==null?void 0:f.role)==="MANAGER"?(ee=f.name||"Manager",K="MANAGER"):(f==null?void 0:f.role)==="SHIPPER"?(ee=f.companyName||f.name||"Shipper",K="SHIPPER"):f!=null&&f.name&&(ee=f.name);const H=()=>{if(!f)return[];const q=[{icon:Xx,label:"Logout",action:L,variant:"danger"}];switch(f.role){case"CEO":return[{icon:vc,label:"Dashboard",path:"/dashboard/ceo"},{icon:ri,label:"Users",path:"/ceo/users"},{icon:gs,label:"Riders",path:"/ceo/riders"},{icon:St,label:"Orders",path:"/ceo/orders"},{icon:St,label:"Integrated Orders",path:"/ceo/integrated-orders"},{icon:ii,label:"Assign by Scan",path:"/ceo/assign-scan"},{icon:ts,label:"Commission",path:"/ceo/commission"},{icon:Pu,label:"Finance  Company",path:"/ceo/finance/company"},{icon:Pu,label:"Finance  Invoice",path:"/ceo/finance/invoice"},{icon:gs,label:"Logistics",path:"/ceo/logistics"},{icon:K1,label:"Warehouse Scan",path:"/ceo/warehouse-scan"},{icon:Wi,label:"Company Profile",path:"/ceo/company-profile"},...q];case"MANAGER":return[{icon:vc,label:"Overview",path:"/manager/dashboard"},{icon:St,label:"All Orders",path:"/manager/orders"},{icon:gs,label:"Riders",path:"/manager/riders"},{icon:ts,label:"Commission",path:"/manager/commission"},{icon:Pu,label:"Finance  Invoice",path:"/manager/finance/invoice"},{icon:gs,label:"Logistics",path:"/manager/logistics"},{icon:K1,label:"Warehouse Scan",path:"/manager/warehouse-scan"},...q];case"SHIPPER":return[{icon:vc,label:"Dashboard",path:"/shipper/dashboard"},{icon:St,label:"My Orders",path:"/shipper/orders"},{icon:St,label:"Integrations",path:"/shipper/integrations"},{icon:St,label:"Integrated Orders",path:"/shipper/integrated-orders"},{icon:St,label:"Create Booking",path:"/shipper/create"},{icon:ts,label:"Finance",path:"/shipper/finance"},...q];case"RIDER":return[{icon:vc,label:"Dashboard",path:"/rider/dashboard"},{icon:St,label:"All Orders",path:"/rider/history"},{icon:ii,label:"Scanner",path:"/rider/scan"},{icon:ts,label:"Finance",path:"/rider/finance"},...q];default:return q}};return e.jsxs("div",{className:"min-h-screen bg-[#F8F9FA] flex",children:[v&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>N(!1)}),e.jsx("aside",{className:`
        fixed top-0 left-0 bottom-0 z-50 w-64 bg-white border-r border-gray-200 transform transition-transform duration-200 ease-in-out
        lg:translate-x-0
        ${v?"translate-x-0":"-translate-x-full"}
      `,children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-100 flex items-center gap-3",children:e.jsx("img",{src:"/assets/logo.png",alt:"LahoreLink Logistics",className:"h-8"})}),e.jsx("div",{className:"p-4 flex-1 overflow-y-auto",children:f&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 px-3 py-3 bg-gray-50 rounded-lg mb-6 border border-gray-100",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold",children:(ee==null?void 0:ee.charAt(0))||"U"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-secondary truncate",children:ee}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:K})]})]}),e.jsx("nav",{className:"space-y-1",children:H().map((q,te)=>{const ce=q.icon;return e.jsxs("button",{onClick:q.action||(()=>q.path&&C(q.path)),className:`
                          w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors
                          ${q.variant==="danger"?"text-red-600 hover:bg-red-50":q!=null&&q.path&&O.pathname===q.path?"bg-primary/10 text-primary":"text-gray-600 hover:bg-gray-50 hover:text-secondary"}`,children:[e.jsx(ce,{className:"w-5 h-5"}),q.label]},te)})})]})})]})}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 lg:ml-64",children:[e.jsxs("header",{className:"bg-white border-b border-gray-200 h-16 flex items-center justify-between px-4 lg:px-8 sticky top-0 z-30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:P,className:"lg:hidden p-2 -ml-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:e.jsx(O2,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-xl font-bold text-secondary",children:p})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[((f==null?void 0:f.role)==="CEO"||(f==null?void 0:f.role)==="MANAGER")&&e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>w(!j),className:"relative p-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:[e.jsx(Xp,{className:"w-5 h-5"}),A.length>0&&e.jsx("span",{className:"absolute top-0 right-0 w-4 h-4 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:A.length})]}),j&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto",children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsx("h4",{className:"font-bold text-secondary",children:"Notifications"})}),A.length===0?e.jsx("div",{className:"p-4 text-sm text-gray-500",children:"No new notifications"}):e.jsx("div",{className:"divide-y divide-gray-100",children:A.map(q=>{var te;return e.jsx("div",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:((te=q.shipper)==null?void 0:te.name)||"Shipper"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:q.message}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[q.totalPendingParcels," pending parcels"]})]}),e.jsx("button",{onClick:()=>Y(q._id),className:"ml-2 px-2 py-1 text-xs bg-primary text-white rounded hover:bg-primary-hover",children:"Mark as picked up"})]})},q._id)})})]})]}),e.jsx("div",{className:"hidden md:block text-sm text-gray-500",children:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),e.jsx("main",{className:"flex-1 p-4 lg:p-8 overflow-y-auto",children:h})]})]})},Et=({children:h,allowedRoles:p=[],noLayout:f=!1})=>{const{user:y,loading:v}=Fs(),N=Ga(),A=["/pending-approval","/shipper/pending-approval"],R=w=>w?w.portalActive===!0:!1;if(v)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."});if(!y)return e.jsx(Ki,{to:"/",state:{from:N},replace:!0});if(p.length>0&&!p.includes(y.role)){const w=y.role==="CEO"?"/dashboard/ceo":y.role==="MANAGER"?"/manager/dashboard":y.role==="SHIPPER"?"/shipper/dashboard":"/rider/dashboard";return e.jsx(Ki,{to:w,replace:!0})}if(y.role==="SHIPPER"&&!R(y)&&!A.includes(N.pathname))return e.jsx(Ki,{to:"/pending-approval",replace:!0});if(f)return h;const j=()=>{switch(y.role){case"CEO":return"Executive Dashboard";case"MANAGER":return"Operations Dashboard";case"SHIPPER":return"Shipper Dashboard";case"RIDER":return"Rider Dashboard";default:return"Dashboard"}};return e.jsx(oy,{title:j(),children:h})},qx=D.createContext(null),cy=({children:h})=>{const[p,f]=D.useState([]),y=D.useCallback(A=>{f(R=>R.filter(j=>j.id!==A))},[]),N={showToast:D.useCallback(({title:A,description:R,type:j="info",duration:w=4e3})=>{const C=Date.now()+Math.random(),O={id:C,title:A,description:R,type:j};f(_=>[..._,O]),w>0&&setTimeout(()=>{y(C)},w)},[y])};return e.jsxs(qx.Provider,{value:N,children:[h,e.jsx("div",{className:"fixed top-4 right-4 z-[9999] flex flex-col space-y-2 pointer-events-none",children:p.map(A=>e.jsx("div",{className:"pointer-events-auto max-w-sm w-full",children:e.jsxs("div",{className:`rounded-lg shadow-lg border px-4 py-3 bg-white flex items-start justify-between space-x-3 ${A.type==="success"?"border-green-200":A.type==="error"?"border-red-200":"border-gray-200"}`,children:[e.jsxs("div",{children:[A.title&&e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:A.title}),A.description&&e.jsx("div",{className:"mt-0.5 text-xs text-gray-600",children:A.description})]}),e.jsx("button",{type:"button",onClick:()=>y(A.id),className:"ml-2 text-gray-400 hover:text-gray-600 text-sm leading-none",children:""})]})},A.id))})]})},Kx=()=>{const h=D.useContext(qx);if(!h)throw new Error("useToast must be used within a ToastProvider");return h},zt=({children:h,variant:p="primary",fullWidth:f=!1,className:y="",...v})=>{const N="px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 text-sm",A={primary:"bg-primary hover:bg-primary-hover text-white shadow-md shadow-primary/20",secondary:"bg-secondary hover:bg-black text-white",outline:"border border-gray-300 text-secondary hover:bg-gray-50 bg-white",ghost:"text-gray-600 hover:text-primary hover:bg-primary/5"};return e.jsx("button",{className:`${N} ${A[p]} ${f?"w-full":""} ${y}`,...v,children:h})},ht=({label:h,error:p,className:f="",rightElement:y,...v})=>{const N=`w-full px-4 py-2.5 rounded-lg border ${p?"border-red-500 focus:ring-red-200":"border-gray-200 focus:border-primary focus:ring-primary/20"} bg-white text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 transition-all duration-200`;return e.jsxs("div",{className:`w-full ${f}`,children:[h&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:h}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:`${N} ${y?"pr-10":""}`,...v}),y&&e.jsx("div",{className:"absolute inset-y-0 right-3 flex items-center",children:y})]}),p&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p})]})},dy=()=>{const[h,p]=D.useState({email:"",password:""}),[f,y]=D.useState(""),[v,N]=D.useState(!1),[A,R]=D.useState({}),[j,w]=D.useState(!1),C=As(),{login:O}=Fs(),_=()=>{const V={};return h.email?/\S+@\S+\.\S+/.test(h.email)||(V.email="Email is invalid"):V.email="Email is required",h.password||(V.password="Password is required"),R(V),Object.keys(V).length===0},L=V=>{const{name:Y,value:ee}=V.target;p(K=>({...K,[Y]:ee})),A[Y]&&R(K=>({...K,[Y]:""}))},P=async V=>{if(V.preventDefault(),!!_()){y(""),N(!0);try{const Y=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:h.email.trim(),password:h.password})}),ee=await Y.json();if(!Y.ok)throw new Error((ee==null?void 0:ee.message)||`Login failed (HTTP ${Y.status})`);O({token:ee.token,role:ee.role,name:ee.name,email:h.email,id:ee.id});const K={CEO:"/dashboard/ceo",MANAGER:"/manager/dashboard",SHIPPER:"/shipper/dashboard",RIDER:"/rider/dashboard"}[ee.role]||"/";C(K)}catch(Y){y(Y.message||"Failed to log in. Please try again.")}finally{N(!1)}}};return e.jsxs("div",{className:"min-h-screen flex bg-[#F8F9FA]",children:[e.jsxs("div",{className:"hidden lg:flex flex-1 bg-secondary relative overflow-hidden flex-col justify-between p-12 text-white",children:[e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-primary rounded-full mix-blend-multiply filter blur-3xl opacity-20 -translate-y-1/2 translate-x-1/2"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-primary rounded-full mix-blend-multiply filter blur-3xl opacity-20 translate-y-1/2 -translate-x-1/2"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"w-20 h-20 bg-white rounded-lg flex items-center justify-center mb-6 shadow-lg shadow-green-900/50",children:e.jsx("img",{src:"/assets/logo.png",alt:""})}),e.jsx("h1",{className:"text-4xl font-bold mb-4 tracking-tight",children:"LahoreLink Logistics"}),e.jsx("p",{className:"text-gray-400 text-lg max-w-md",children:"Smart logistics dashboard for same-day deliveries. Manage your fleet, shipments, and COD with ease."})]}),e.jsxs("div",{className:"relative z-10 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white/5 rounded-lg backdrop-blur-sm border border-white/10",children:e.jsx(W2,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Real-time Tracking"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Monitor orders as they move through the city."})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white/5 rounded-lg backdrop-blur-sm border border-white/10",children:e.jsx(m0,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Secure COD Workflows"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Automated reconciliation for cash on delivery."})]})]})]}),e.jsx("div",{className:"text-xs text-gray-500 relative z-10",children:" 2023 LahoreLink Logistics Inc."})]}),e.jsx("div",{className:"flex-1 flex flex-col justify-center items-center p-6 lg:p-12",children:e.jsxs("div",{className:"w-full max-w-md space-y-8",children:[e.jsxs("div",{className:"text-center lg:text-left",children:[e.jsx("div",{className:"lg:hidden flex justify-center",children:e.jsx("div",{className:"w-[200px] h-[200px] flex items-center justify-center ",children:e.jsx("img",{src:"/assets/logo.png",alt:""})})}),e.jsx("h2",{className:"text-3xl font-bold text-secondary",children:"Welcome back"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Please enter your details to sign in."})]}),e.jsxs("form",{onSubmit:P,className:"mt-8 space-y-6 bg-white p-8 rounded-2xl shadow-sm border border-gray-100",children:[f&&e.jsxs("div",{className:"p-3 rounded-lg bg-red-50 border border-red-100 flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(Xn,{className:"w-4 h-4"}),f]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ht,{label:"Email",name:"email",type:"email",value:h.email,onChange:L,placeholder:"name@company.com",required:!0,error:A.email}),A.email&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:A.email})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Password",name:"password",type:j?"text":"password",value:h.password,onChange:L,placeholder:"",required:!0,error:A.password,rightElement:e.jsx("button",{type:"button",onClick:()=>w(V=>!V),className:"text-gray-400 hover:text-gray-600","aria-label":j?"Hide password":"Show password",children:j?e.jsx(Qi,{className:"w-4 h-4"}):e.jsx(Ji,{className:"w-4 h-4"})})}),A.password&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:A.password})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary transition-colors"}),e.jsx("span",{className:"text-gray-500 group-hover:text-gray-700",children:"Remember me"})]}),e.jsx(Sc,{to:"/forgot-password",className:"font-medium text-primary hover:text-primary-hover hover:underline",children:"Forgot password?"})]}),e.jsx(zt,{type:"submit",fullWidth:!0,disabled:v,className:"h-11 text-base shadow-lg shadow-primary/25 flex items-center justify-center gap-2",children:v?e.jsxs(e.Fragment,{children:[e.jsx(C2,{className:"w-4 h-4 animate-spin"}),"Signing in..."]}):"Sign in to Dashboard"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Sign up"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[e.jsx(Sc,{to:"/signup/shipper",className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 transition-colors text-center",children:"Sign up as Shipper"}),e.jsx(Sc,{to:"/signup/rider",className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 transition-colors text-center",children:"Sign up as Rider"})]})]}),e.jsxs("p",{className:"text-center text-sm text-gray-500",children:["Having trouble logging in? ",e.jsx("a",{href:"#",className:"font-medium text-secondary hover:underline",children:"Contact Administrator"})]})]})})]})},rs=({icon:h,title:p,count:f,bgColor:y})=>e.jsx("div",{className:`bg-white p-5 rounded-xl border border-gray-100 shadow-sm ${y}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[h&&e.jsx(h,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:p}),e.jsx("h3",{className:"text-xl font-bold text-secondary",children:f})]})]})}),zn=({icon:h,title:p,count:f,onClick:y,colorClass:v="text-green-600"})=>e.jsxs("div",{onClick:y,className:`bg-white rounded-xl p-4 shadow-sm border border-gray-100 flex flex-col justify-between h-28 relative overflow-hidden transition-colors ${y?"active:bg-gray-50 cursor-pointer":"cursor-default"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:`p-1.5 rounded-full bg-gray-50 ${v}`,children:e.jsx(h,{size:20})}),e.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider text-right max-w-[70%] leading-tight",children:p})]}),e.jsx("div",{className:"mt-auto",children:e.jsx("span",{className:"text-2xl font-bold text-gray-800",children:f})})]}),uy=({options:h,active:p,onChange:f})=>!h||h.length===0?null:e.jsx("div",{className:"flex justify-center gap-2 mb-4 px-2 overflow-x-auto",children:h.map(y=>e.jsx("button",{onClick:()=>f==null?void 0:f(y.value),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${p===y.value?"bg-black text-white":"bg-white text-gray-500 border border-gray-200"}`,children:y.label},y.value))}),hy=({options:h,value:p,onChange:f})=>!h||h.length===0?null:e.jsx("div",{className:"bg-[#085233] rounded-lg p-1 flex text-xs font-semibold",children:h.map(y=>e.jsx("button",{onClick:()=>f==null?void 0:f(y.value),className:`px-3 py-1 rounded-md transition-all ${p===y.value?"bg-white text-[#0B6D45] shadow-sm":"text-green-100"}`,children:y.label},y.value))}),fy=({kpis:h})=>{if(!h||h.length===0)return null;const p=h[0],f=h[1],y=h[2];return e.jsxs("div",{className:"mb-2",children:[(p==null?void 0:p.prefix)&&e.jsxs("p",{className:"text-green-100 text-sm",children:[p.prefix," ",e.jsx(Xn,{className:"inline w-3 h-3 ml-1"})]}),e.jsxs("div",{className:"flex justify-between items-end mt-1",children:[p&&e.jsxs("div",{children:[e.jsx("span",{className:"text-3xl font-bold",children:p.value}),e.jsx("p",{className:"text-xs text-green-100 mt-1",children:p.label})]}),f&&e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-2xl font-bold",children:f.value}),e.jsx("p",{className:"text-xs text-green-100 mt-1",children:f.label})]}),y&&e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-2xl font-bold",children:y.value}),e.jsx("p",{className:"text-xs text-green-100 mt-1",children:y.label})]})]})]})},y0=({heroTitle:h,heroCount:p,onRefresh:f,toggles:y,kpis:v,periodOptions:N,activePeriod:A,onPeriodChange:R,statCards:j})=>e.jsxs("div",{className:"space-y-4 md:hidden",children:[e.jsxs("div",{className:"bg-[#0B6D45] p-6 rounded-b-3xl text-white shadow-lg -mx-4 -mt-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:h}),typeof p<"u"&&e.jsxs("div",{className:"flex items-center gap-2 mt-1 opacity-80",children:[e.jsx("span",{className:"text-2xl font-bold",children:p}),f&&e.jsx(Gn,{className:"w-4 h-4 cursor-pointer",onClick:f})]})]}),y&&e.jsx(hy,{options:y.options,value:y.value,onChange:y.onChange})]}),e.jsx(fy,{kpis:v})]}),e.jsx(uy,{options:N,active:A,onChange:R}),j&&j.length>0&&e.jsx("div",{className:"grid grid-cols-1 min-[360px]:grid-cols-2 gap-3 px-1",children:j.map(w=>e.jsx(zn,{icon:w.icon,title:w.title,count:w.value,onClick:w.onClick,colorClass:w.colorClass},w.key||w.title))})]}),xy=()=>typeof window>"u"?!1:window.matchMedia("(max-width: 767px)").matches,b0=()=>{const[h,p]=D.useState(xy);return D.useEffect(()=>{if(typeof window>"u")return;const f=window.matchMedia("(max-width: 767px)"),y=()=>{p(f.matches)};return y(),typeof f.addEventListener=="function"?f.addEventListener("change",y):f.addListener(y),window.addEventListener("orientationchange",y),()=>{typeof f.removeEventListener=="function"?f.removeEventListener("change",y):f.removeListener(y),window.removeEventListener("orientationchange",y)}},[]),h},my=()=>{const[h,p]=D.useState([]),[f,y]=D.useState([]),[v,N]=D.useState(!0),[A,R]=D.useState(""),[j,w]=D.useState("today"),[C,O]=D.useState(null),{user:_}=Fs(),L=As(),P=b0(),V=(_==null?void 0:_.token)||Xs(),Y=async()=>{if(!V){R("Unauthorized access. Token missing."),N(!1);return}N(!0),R("");try{const[ae,F,W]=await Promise.all([fetch("/api/users",{headers:{Authorization:`Bearer ${V}`}}),fetch("/api/orders",{headers:{Authorization:`Bearer ${V}`}}),fetch(`/api/dashboard/ceo?period=${j}`,{headers:{Authorization:`Bearer ${V}`}})]),Q=await ae.json(),Ne=await F.json(),Se=await W.json();if(!ae.ok)throw new Error(Q.message||"Failed users");if(!F.ok)throw new Error(Ne.message||"Failed orders");if(!W.ok)throw new Error(Se.message||"Failed stats");p(Q),y(Ne),O(Se.stats)}catch(ae){R(ae.message)}finally{N(!1)}};D.useEffect(()=>{V&&Y()},[V,j]);const ee=D.useMemo(()=>{const ae=h.length,F=f.length,W=f.filter(Ne=>Ne.status==="DELIVERED").reduce((Ne,Se)=>Ne+Number(Se.amountCollected||Se.codAmount||0),0),Q=h.filter(Ne=>Ne.role==="RIDER"&&Ne.status==="ACTIVE").length;return{totalUsers:ae,totalOrders:F,totalRevenue:W,activeRiders:Q}},[h,f]),K=()=>{const ae=[];for(let F=6;F>=0;F--){const W=new Date;W.setDate(W.getDate()-F),ae.push(W)}return ae},H=D.useMemo(()=>K().map(F=>{const W=F.toDateString(),Q=f.filter(Ne=>Ne.status==="DELIVERED"&&new Date(Ne.deliveredAt||Ne.createdAt).toDateString()===W).reduce((Ne,Se)=>Ne+Number(Se.amountCollected||Se.codAmount||0),0);return{day:F,value:Q}}),[f]),q=D.useMemo(()=>K().map(F=>{const W=F.toDateString(),Q=f.filter(Ne=>new Date(Ne.createdAt).toDateString()===W).length;return{day:F,count:Q}}),[f]),te=D.useMemo(()=>{const Q=Math.max(...H.map(fe=>fe.value),1),Ne=560/(H.length-1),Se=H.map((fe,E)=>{const G=20+E*Ne,U=140-fe.value/Q*120;return`${G},${U}`});return Se.length===0?"":"M "+Se.map(fe=>fe.replace(","," ")).join(" L ")},[H]),ce=ae=>typeof ae=="number"||typeof ae=="string"?ae:"",$=ae=>{const F=Number(ae);return Number.isNaN(F)?"":F.toLocaleString()},Re=[{label:"7 DAYS",value:"7days"},{label:"15 DAYS",value:"15days"},{label:"30 DAYS",value:"30days"}],oe=j==="month"?"30days":j,Ee=j==="7days"?"7 Days Orders":j==="15days"?"15 Days Orders":j==="month"?"30 Days Orders":"Today's Orders",me=[{key:"totalOrders",icon:St,title:"Total Orders",value:(C==null?void 0:C.totalOrders)||0,colorClass:"text-gray-600"},{key:"unassignedOrders",icon:St,title:"Unassigned",value:(C==null?void 0:C.unassignedOrders)||0,colorClass:"text-amber-600"},{key:"assignedOrders",icon:gs,title:"Assigned",value:(C==null?void 0:C.assignedOrders)||0,colorClass:"text-blue-600"},{key:"warehouseOrdersCount",icon:St,title:"At Warehouse",value:(C==null?void 0:C.warehouseOrdersCount)||0,colorClass:"text-cyan-600"},{key:"completedOrders",icon:gs,title:"Delivered",value:(C==null?void 0:C.completedOrders)||0,colorClass:"text-green-700"},{key:"pendingOrders",icon:mn,title:"Pending",value:(C==null?void 0:C.pendingOrders)||0,colorClass:"text-orange-600"},{key:"totalServiceCharges",icon:ts,title:"Service Charges",value:`PKR ${$((C==null?void 0:C.totalServiceCharges)||0)}`,colorClass:"text-emerald-600"},{key:"totalCod",icon:ts,title:"Total COD",value:`PKR ${$((C==null?void 0:C.totalCod)||0)}`,colorClass:"text-green-600"},{key:"totalShippers",icon:ri,title:"Total Shippers",value:(C==null?void 0:C.totalShippers)||0,colorClass:"text-indigo-600"},{key:"totalRiders",icon:gs,title:"Total Riders",value:(C==null?void 0:C.totalRiders)||0,colorClass:"text-purple-600"}],ne=()=>e.jsxs("div",{className:"space-y-8",children:[A&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:A}),e.jsx(y0,{heroTitle:Ee,heroCount:ce(C==null?void 0:C.totalOrders),onRefresh:Y,kpis:[{prefix:"PKR",value:$(C==null?void 0:C.totalServiceCharges),label:"Service Charges"},{value:ce((C==null?void 0:C.pendingOrders)||0),label:"Pending Orders"},{value:ce((C==null?void 0:C.totalOrders)||0),label:"Total Orders"}],periodOptions:Re,activePeriod:oe,onPeriodChange:ae=>{ae==="7days"?w("7days"):ae==="15days"?w("15days"):ae==="30days"&&w("month")},statCards:me})]}),J=()=>e.jsxs("div",{className:"space-y-8",children:[A&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:A}),e.jsx("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-secondary",children:"Warehouse Operations"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Scan parcels to mark as arrived at LLL warehouse"})]}),e.jsxs("button",{onClick:()=>L("/ceo/scanner"),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-hover flex items-center gap-2",children:[e.jsx(ii,{className:"w-4 h-4"}),"Scan Parcel"]})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:j==="7days"?"Last 7 Days Stats":j==="15days"?"Last 15 Days Stats":j==="month"?"This Month Stats":"Today's Stats"}),e.jsx("button",{onClick:Y,className:"text-gray-400 hover:text-primary",children:e.jsx(Gn,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx("button",{onClick:()=>w("today"),className:`px-3 py-1.5 text-xs rounded-full ${j==="today"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"Today"}),e.jsx("button",{onClick:()=>w("7days"),className:`px-3 py-1.5 text-xs rounded-full ${j==="7days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"7 Days"}),e.jsx("button",{onClick:()=>w("15days"),className:`px-3 py-1.5 text-xs rounded-full ${j==="15days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"15 Days"}),e.jsx("button",{onClick:()=>w("month"),className:`px-3 py-1.5 text-xs rounded-full ${j==="month"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"This Month"})]})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(rs,{icon:St,title:"Total Orders",count:(C==null?void 0:C.totalOrders)||0}),e.jsx(rs,{icon:gs,title:"Completed Orders",count:(C==null?void 0:C.completedOrders)||0}),e.jsx(rs,{icon:mn,title:"Pending Orders",count:(C==null?void 0:C.pendingOrders)||0}),e.jsx(rs,{icon:ri,title:"Assigned Orders",count:(C==null?void 0:C.assignedOrders)||0}),e.jsx(rs,{icon:St,title:"Unassigned Orders",count:(C==null?void 0:C.unassignedOrders)||0}),e.jsx(rs,{icon:ts,title:"Total COD",count:`PKR ${((C==null?void 0:C.totalCod)||0).toLocaleString()}`}),e.jsx(rs,{icon:ts,title:"Total Service Charges",count:`PKR ${((C==null?void 0:C.totalServiceCharges)||0).toLocaleString()}`}),e.jsx(rs,{icon:St,title:"At LLL Warehouse",count:(C==null?void 0:C.warehouseOrdersCount)||0})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Users"}),e.jsx(ri,{className:"w-5 h-5 text-blue-500"})]}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:v?"":ee.totalUsers})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Orders"}),e.jsx(St,{className:"w-5 h-5 text-primary"})]}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:v?"":ee.totalOrders})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Revenue"}),e.jsx(ts,{className:"w-5 h-5 text-emerald-500"})]}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:v?"":`PKR ${ee.totalRevenue.toLocaleString()}`})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Active Riders"}),e.jsx(gs,{className:"w-5 h-5 text-orange-500"})]}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:v?"":ee.activeRiders})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm lg:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Revenue Analytics"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Last 7 days"})]}),e.jsx("svg",{viewBox:"0 0 600 160",className:"w-full h-40",children:e.jsx("path",{d:te,fill:"none",stroke:"#14B8A6",strokeWidth:"2"})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Orders Volume"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Weekly"})]}),e.jsx("div",{className:"flex items-end gap-2 h-40",children:q.map((ae,F)=>{const W=Math.max(...q.map(Se=>Se.count),1),Q=Math.round(ae.count/W*160),Ne=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];return e.jsxs("div",{className:"flex flex-col items-center justify-end",children:[e.jsx("div",{style:{height:`${Q}px`},className:"w-8 bg-secondary/90 rounded"}),e.jsx("span",{className:"mt-1 text-[10px] text-gray-500",children:Ne[F]})]},F)})})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Recent System Activity"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2 px-3",children:"User/Order"}),e.jsx("th",{className:"py-2 px-3",children:"Role/Status"}),e.jsx("th",{className:"py-2 px-3",children:"Action"}),e.jsx("th",{className:"py-2 px-3",children:"Date"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:f.flatMap(ae=>(ae.statusHistory||[]).map(F=>({bookingId:ae.bookingId,status:F.status,time:F.timestamp}))).sort((ae,F)=>new Date(F.time)-new Date(ae.time)).slice(0,5).map((ae,F)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3",children:ae.bookingId}),e.jsx("td",{className:"py-2 px-3",children:ae.status}),e.jsx("td",{className:"py-2 px-3",children:"Status updated"}),e.jsx("td",{className:"py-2 px-3",children:new Date(ae.time).toLocaleString()})]},F))})]})})]})]});return P?e.jsx(ne,{}):e.jsx(J,{})},gy=()=>{const[h,p]=D.useState([]),[f,y]=D.useState(!0),[v,N]=D.useState(""),A=typeof window<"u"?localStorage.getItem("token"):null,[R,j]=D.useState({name:"",email:"",phone:"",password:"",confirmPassword:"",role:"SHIPPER",companyName:"",address:"",cnicNumber:"",contactNumber:"",emergencyContact:"",pickupAddress:"",bankAccountDetails:"",vehicleInfo:"",cnic:""}),[w,C]=D.useState({}),[O,_]=D.useState(!1),[L,P]=D.useState(!1),[V,Y]=D.useState(null),[ee,K]=D.useState({newPassword:"",confirmPassword:""}),[H,q]=D.useState({}),[te,ce]=D.useState(null),[$,Re]=D.useState([]),[oe,Ee]=D.useState([]),[me,ne]=D.useState([]),[J,ae]=D.useState(null),F=async()=>{y(!0),N("");try{const[E,G,U]=await Promise.all([fetch("/api/users/shippers",{headers:{Authorization:A?`Bearer ${A}`:""}}),fetch("/api/users/riders",{headers:{Authorization:A?`Bearer ${A}`:""}}),fetch("/api/users/managers",{headers:{Authorization:A?`Bearer ${A}`:""}})]),Z=await E.json(),we=await G.json(),xe=await U.json();if(!E.ok)throw new Error(Z.message||"Failed to fetch shippers");if(!G.ok)throw new Error(we.message||"Failed to fetch riders");if(!U.ok)throw new Error(xe.message||"Failed to fetch managers");Re(Z),Ee(we),ne(xe),p([...Z,...we,...xe])}catch(E){N(E.message)}finally{y(!1)}};D.useEffect(()=>{F()},[]);const W=()=>{const E={};return(!R.password||R.password.length<8)&&(E.password="Password must be at least 8 characters"),R.confirmPassword?R.password!==R.confirmPassword&&(E.confirmPassword="Passwords do not match"):E.confirmPassword="Please confirm your password",C(E),Object.keys(E).length===0},Q=async E=>{if(E.preventDefault(),N(""),C({}),!!W())try{const G={name:R.name,email:R.email,phone:R.phone,password:R.password,role:R.role};if(R.role==="SHIPPER"&&(Object.assign(G,{companyName:R.companyName,address:R.address,cnicNumber:R.cnicNumber,contactNumber:R.contactNumber,emergencyContact:R.emergencyContact,pickupAddress:R.pickupAddress,bankAccountDetails:R.bankAccountDetails}),!R.companyName))throw new Error("Business Name is required for Shipper");if(R.role==="RIDER"&&(Object.assign(G,{vehicleInfo:R.vehicleInfo}),!R.vehicleInfo))throw new Error("Vehicle Info is required for Rider");if(R.role==="MANAGER"){if(!R.cnic)throw new Error("CNIC is required for Manager");Object.assign(G,{cnic:R.cnic})}const U=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:A?`Bearer ${A}`:""},body:JSON.stringify(G)}),Z=await U.json();if(!U.ok)throw new Error(Z.message||"Failed to create user");j({name:"",email:"",phone:"",password:"",confirmPassword:"",role:R.role,companyName:"",address:"",cnicNumber:"",contactNumber:"",emergencyContact:"",pickupAddress:"",bankAccountDetails:"",vehicleInfo:"",cnic:""}),C({}),_(!1),await F()}catch(G){N(G.message)}},Ne=()=>{const E={};return(!ee.newPassword||ee.newPassword.length<8)&&(E.newPassword="Password must be at least 8 characters"),ee.confirmPassword?ee.newPassword!==ee.confirmPassword&&(E.confirmPassword="Passwords do not match"):E.confirmPassword="Please confirm your password",q(E),Object.keys(E).length===0},Se=async E=>{if(E.preventDefault(),q({}),ce(null),!!Ne())try{const G=await fetch(`/api/users/${V._id}/reset-password`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:A?`Bearer ${A}`:""},body:JSON.stringify({newPassword:ee.newPassword})}),U=await G.json();if(!G.ok)throw new Error(U.message||"Failed to reset password");ce({message:"Password updated successfully",password:U.password})}catch(G){q({submit:G.message})}},fe=async(E,G)=>{try{const U=await fetch(`/api/users/${E}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:A?`Bearer ${A}`:""},body:JSON.stringify({status:G})}),Z=await U.json();if(!U.ok)throw new Error(Z.message||"Failed to update status");await F()}catch(U){N(U.message)}};return e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ri,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Users"})]}),e.jsx(zt,{onClick:()=>_(!0),children:"Create User"})]})}),v&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:v}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary mb-4",children:"Shippers"}),f?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):$.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No shippers found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[e.jsx("th",{className:"py-3 px-4",children:"Shipper Name"}),e.jsx("th",{className:"py-3 px-4",children:"Email"}),e.jsx("th",{className:"py-3 px-4",children:"Total Orders"}),e.jsx("th",{className:"py-3 px-4",children:"Total COD"}),e.jsx("th",{className:"py-3 px-4",children:"Status"}),e.jsx("th",{className:"py-3 px-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:$.map(E=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>ae({...E,__type:"SHIPPER"}),children:[e.jsx("td",{className:"py-3 px-4 font-medium",children:E.name}),e.jsx("td",{className:"py-3 px-4",children:E.email}),e.jsx("td",{className:"py-3 px-4",children:""}),e.jsx("td",{className:"py-3 px-4",children:""}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${E.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:E.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:G=>{G.stopPropagation(),fe(E._id,E.status==="ACTIVE"?"INACTIVE":"ACTIVE")},children:E.status==="ACTIVE"?"Deactivate":"Activate"})})]},E._id))})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary mb-4",children:"Managers"}),f?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):me.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No managers found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[e.jsx("th",{className:"py-3 px-4",children:"Manager Name"}),e.jsx("th",{className:"py-3 px-4",children:"Email"}),e.jsx("th",{className:"py-3 px-4",children:"Status"}),e.jsx("th",{className:"py-3 px-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:me.map(E=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>ae({...E,__type:"MANAGER"}),children:[e.jsx("td",{className:"py-3 px-4 font-medium",children:E.name}),e.jsx("td",{className:"py-3 px-4",children:E.email}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${E.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:E.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:G=>{G.stopPropagation(),fe(E._id,E.status==="ACTIVE"?"INACTIVE":"ACTIVE")},children:E.status==="ACTIVE"?"Deactivate":"Activate"}),e.jsx("button",{className:"px-2 py-1 text-xs border border-blue-200 text-blue-600 rounded hover:bg-blue-50",onClick:G=>{G.stopPropagation(),Y(E),K({newPassword:"",confirmPassword:""}),q({}),ce(null)},children:"Reset Password"})]})})]},E._id))})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary mb-4",children:"Riders"}),f?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):oe.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No riders found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[e.jsx("th",{className:"py-3 px-4",children:"Rider Name"}),e.jsx("th",{className:"py-3 px-4",children:"Email"}),e.jsx("th",{className:"py-3 px-4",children:"Assigned Orders"}),e.jsx("th",{className:"py-3 px-4",children:"COD Collected"}),e.jsx("th",{className:"py-3 px-4",children:"Service Charges"}),e.jsx("th",{className:"py-3 px-4",children:"Status"}),e.jsx("th",{className:"py-3 px-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:oe.map(E=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>ae({...E,__type:"RIDER"}),children:[e.jsx("td",{className:"py-3 px-4 font-medium",children:E.name}),e.jsx("td",{className:"py-3 px-4",children:E.email}),e.jsx("td",{className:"py-3 px-4",children:""}),e.jsx("td",{className:"py-3 px-4",children:""}),e.jsx("td",{className:"py-3 px-4",children:""}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${E.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:E.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:G=>{G.stopPropagation(),fe(E._id,E.status==="ACTIVE"?"INACTIVE":"ACTIVE")},children:E.status==="ACTIVE"?"Deactivate":"Activate"}),e.jsx("button",{className:"px-2 py-1 text-xs border border-blue-200 text-blue-600 rounded hover:bg-blue-50",onClick:G=>{G.stopPropagation(),Y(E),K({newPassword:"",confirmPassword:""}),q({}),ce(null)},children:"Reset Password"})]})})]},E._id))})]})})]}),V&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>{Y(null),K({newPassword:"",confirmPassword:""}),q({}),ce(null)},children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",onClick:E=>E.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Reset Password"}),e.jsx("button",{onClick:()=>{Y(null),K({newPassword:"",confirmPassword:""}),q({}),ce(null)},className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:Se,className:"p-6 space-y-4",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Reset password for ",e.jsx("span",{className:"font-semibold",children:V.name})," (",V.email,")"]})}),te?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 text-green-700 rounded-lg",children:[e.jsx("p",{className:"font-semibold mb-2",children:te.message}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"New Password (copy this):"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:te.password,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg bg-gray-50 font-mono"}),e.jsx("button",{type:"button",onClick:()=>{navigator.clipboard.writeText(te.password),alert("Password copied to clipboard!")},className:"px-3 py-2 text-sm bg-primary text-white rounded-lg hover:bg-primary-hover",children:"Copy"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>{Y(null),K({newPassword:"",confirmPassword:""}),q({}),ce(null)},className:"px-4 py-2 text-sm bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Close"})})]}):e.jsxs(e.Fragment,{children:[H.submit&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 text-red-600 text-sm rounded",children:H.submit}),e.jsxs("div",{children:[e.jsx(ht,{label:"New Password",type:"password",value:ee.newPassword,onChange:E=>K({...ee,newPassword:E.target.value}),required:!0}),H.newPassword&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:H.newPassword})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Confirm Password",type:"password",value:ee.confirmPassword,onChange:E=>K({...ee,confirmPassword:E.target.value}),required:!0}),H.confirmPassword&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:H.confirmPassword})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>{Y(null),K({newPassword:"",confirmPassword:""}),q({}),ce(null)},children:"Cancel"}),e.jsx(zt,{type:"submit",children:"Reset Password"})]})]})]})]})}),J&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>ae(null),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden",onClick:E=>E.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:J.__type==="SHIPPER"?"Shipper Details":J.__type==="RIDER"?"Rider Details":J.__type==="MANAGER"?"Manager Details":"User Details"}),e.jsx("button",{onClick:()=>ae(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Name"}),e.jsx("p",{className:"text-sm font-semibold",children:J.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Role"}),e.jsx("p",{className:"text-sm",children:J.role||J.__type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Email"}),e.jsx("p",{className:"text-sm",children:J.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Phone"}),e.jsx("p",{className:"text-sm",children:J.phone||J.contactNumber||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Status"}),e.jsx("p",{className:"text-sm",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${J.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:J.status})})]}),J.__type==="SHIPPER"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Business Name"}),e.jsx("p",{className:"text-sm",children:J.companyName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"CNIC"}),e.jsx("p",{className:"text-sm",children:J.cnicNumber||J.cnic||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Contact Number"}),e.jsx("p",{className:"text-sm",children:J.contactNumber||J.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Emergency Contact"}),e.jsx("p",{className:"text-sm",children:J.emergencyContact||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Pickup Address"}),e.jsx("p",{className:"text-sm",children:J.pickupAddress||J.address||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Bank Name"}),e.jsx("p",{className:"text-sm",children:J.bankName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Account Holder Name"}),e.jsx("p",{className:"text-sm",children:J.accountHolderName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Account Number"}),e.jsx("p",{className:"text-sm",children:J.accountNumber||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"IBAN"}),e.jsx("p",{className:"text-sm",children:J.iban||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Legacy Bank Details"}),e.jsx("p",{className:"text-sm",children:J.bankAccountDetails||"N/A"})]})]}),J.__type==="RIDER"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Vehicle Info"}),e.jsx("p",{className:"text-sm",children:J.vehicleInfo||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"CNIC"}),e.jsx("p",{className:"text-sm",children:J.cnic||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Assigned Orders"}),e.jsx("p",{className:"text-sm font-semibold",children:J.assignedOrders??""})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"COD Collected"}),e.jsx("p",{className:"text-sm font-semibold",children:J.codCollected??""})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Service Charges"}),e.jsx("p",{className:"text-sm font-semibold",children:J.serviceCharges??""})]})]}),J.__type==="MANAGER"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Email"}),e.jsx("p",{className:"text-sm",children:J.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Phone"}),e.jsx("p",{className:"text-sm",children:J.phone||"N/A"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>ae(null),className:"px-4 py-2 text-sm bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Close"})})]})]})}),O&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>_(!1),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden",onClick:E=>E.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Create User"}),e.jsx("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:E=>{Q(E)},className:"p-6 space-y-3 max-h-[70vh] overflow-y-auto",children:[v&&e.jsx("p",{className:"text-sm text-red-600",children:v}),e.jsx(ht,{label:"Name",value:R.name,onChange:E=>j({...R,name:E.target.value}),required:!0}),e.jsx(ht,{label:"Email",type:"email",value:R.email,onChange:E=>j({...R,email:E.target.value}),required:!0}),e.jsx(ht,{label:"Phone",value:R.phone,onChange:E=>j({...R,phone:E.target.value})}),e.jsxs("div",{children:[e.jsx(ht,{label:"Password",type:L?"text":"password",value:R.password,onChange:E=>j({...R,password:E.target.value}),required:!0,rightElement:e.jsx("button",{type:"button",onClick:()=>P(E=>!E),className:"text-gray-400 hover:text-gray-600","aria-label":L?"Hide password":"Show password",children:L?e.jsx(Qi,{className:"w-4 h-4"}):e.jsx(Ji,{className:"w-4 h-4"})})}),w.password&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:w.password})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Confirm Password",type:"password",value:R.confirmPassword,onChange:E=>j({...R,confirmPassword:E.target.value}),required:!0}),w.confirmPassword&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:w.confirmPassword})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Role"}),e.jsxs("select",{className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white",value:R.role,onChange:E=>j({...R,role:E.target.value}),children:[e.jsx("option",{value:"SHIPPER",children:"Shipper"}),e.jsx("option",{value:"RIDER",children:"Rider"}),e.jsx("option",{value:"MANAGER",children:"Manager"})]})]}),R.role==="SHIPPER"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(ht,{label:"Business Name",value:R.companyName,onChange:E=>j({...R,companyName:E.target.value}),required:!0}),e.jsx(ht,{label:"CNIC Number",value:R.cnicNumber,onChange:E=>j({...R,cnicNumber:E.target.value})}),e.jsx(ht,{label:"Contact Number",value:R.contactNumber,onChange:E=>j({...R,contactNumber:E.target.value})}),e.jsx(ht,{label:"Emergency Contact",value:R.emergencyContact,onChange:E=>j({...R,emergencyContact:E.target.value})}),e.jsx(ht,{label:"Pickup Address",value:R.pickupAddress,onChange:E=>j({...R,pickupAddress:E.target.value})}),e.jsx(ht,{label:"Bank Account Details",value:R.bankAccountDetails,onChange:E=>j({...R,bankAccountDetails:E.target.value})}),e.jsx(ht,{label:"Business Address",value:R.address,onChange:E=>j({...R,address:E.target.value})})]}),R.role==="RIDER"&&e.jsx(ht,{label:"Vehicle Info",value:R.vehicleInfo,onChange:E=>j({...R,vehicleInfo:E.target.value}),required:!0}),R.role==="MANAGER"&&e.jsx(ht,{label:"CNIC",value:R.cnic,onChange:E=>j({...R,cnic:E.target.value}),required:!0}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>_(!1),children:"Cancel"}),e.jsx(zt,{type:"submit",children:"Create"})]})]})]})})]})},py=()=>{const{user:h}=Fs(),p=(h==null?void 0:h.token)||Xs(),f=As(),[y,v]=D.useState([]),[N,A]=D.useState([]),[R,j]=D.useState([]),[w,C]=D.useState(null),[O,_]=D.useState(!0),[L,P]=D.useState(""),[V,Y]=D.useState(""),[ee,K]=D.useState([]),[H,q]=D.useState("all"),[te,ce]=D.useState(""),[$,Re]=D.useState("ALL"),[oe,Ee]=D.useState(""),me=async()=>{if(p){_(!0),P("");try{const E=await fetch("/api/orders",{headers:{Authorization:`Bearer ${p}`}}),G=await E.json();if(!E.ok)throw new Error(G.message||"Failed to fetch orders");v(Array.isArray(G)?G:[])}catch(E){P(E.message||"Failed to fetch orders")}finally{_(!1)}}},ne=async()=>{if(p)try{const E=await fetch("/api/users/riders",{headers:{Authorization:`Bearer ${p}`}}),G=await E.json();E.ok&&Array.isArray(G)&&A(G)}catch{}},J=async()=>{if(p)try{const E=await fetch("/api/users/shippers?active=true",{headers:{Authorization:`Bearer ${p}`}}),G=await E.json();E.ok&&Array.isArray(G)&&j(G)}catch{}};D.useEffect(()=>{me(),ne(),J()},[p]);const ae=async E=>{if(E&&E.preventDefault(),!(!V.trim()||!p))try{const G=await fetch(`/api/orders?q=${encodeURIComponent(V.trim())}`,{headers:{Authorization:`Bearer ${p}`}}),U=await G.json();G.ok&&Array.isArray(U)&&U.length>0?f(`/ceo/orders/${U[0]._id}`):P("No order found for the provided ID")}catch(G){P(G.message||"Failed to search order")}};D.useEffect(()=>{const E=V.trim().toLowerCase();if(E.length<2){K([]);return}K(y.filter(G=>{var U,Z,we,xe;return((U=G.bookingId)==null?void 0:U.toLowerCase().includes(E))||((Z=G.trackingId)==null?void 0:Z.toLowerCase().includes(E))||((we=G.consigneeName)==null?void 0:we.toLowerCase().includes(E))||((xe=G.destinationCity)==null?void 0:xe.toLowerCase().includes(E))}).slice(0,8))},[V,y]);const F=fn.useMemo(()=>{if(!Array.isArray(y))return[];let E=y;if(H!=="all"){const U=new Date;let Z=new Date(U),we=new Date(U);if(H==="today")Z.setHours(0,0,0,0),we.setHours(23,59,59,999);else if(H==="week"){const xe=U.getDay(),Ge=xe===0?-6:1-xe;Z=new Date(U),Z.setDate(U.getDate()+Ge),Z.setHours(0,0,0,0),we=new Date(Z),we.setDate(Z.getDate()+6),we.setHours(23,59,59,999)}else H==="month"&&(Z=new Date(U.getFullYear(),U.getMonth(),1,0,0,0,0),we=new Date(U.getFullYear(),U.getMonth()+1,0,23,59,59,999));E=E.filter(xe=>{const Ge=new Date(xe==null?void 0:xe.createdAt);return Number.isNaN(Ge.getTime())?!1:Ge.getTime()>=Z.getTime()&&Ge.getTime()<=we.getTime()})}te==="unassigned"?E=E.filter(U=>!U.assignedRider):te&&(E=E.filter(U=>U.assignedRider&&U.assignedRider._id===te)),$==="PENDING"?E=E.filter(U=>!["DELIVERED","RETURNED","FAILED"].includes(U.status)):$==="OUT_FOR_DELIVERY"?E=E.filter(U=>U.status==="OUT_FOR_DELIVERY"):$==="DELIVERED"?E=E.filter(U=>U.status==="DELIVERED"):$==="RETURNED"&&(E=E.filter(U=>U.status==="RETURNED")),oe&&(E=E.filter(U=>U.shipper&&U.shipper._id===oe));const G=V.trim().toLowerCase();return G&&(E=E.filter(U=>{var Z,we;return((Z=U.bookingId)==null?void 0:Z.toLowerCase().includes(G))||((we=U.trackingId)==null?void 0:we.toLowerCase().includes(G))})),E},[y,H,te,$,oe,V]),W=async(E,G)=>{if(!(!p||!E))try{const U=await fetch(`/api/orders/${E}/assign`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify({riderId:G||null})}),Z=await U.json();if(!U.ok)throw new Error(Z.message||"Failed to assign rider");C(null),await me()}catch(U){P(U.message||"Failed to assign rider")}},Q=fn.useMemo(()=>[...R].sort((E,G)=>{const U=(E.companyName||E.name||"").toLowerCase(),Z=(G.companyName||G.name||"").toLowerCase();return U.localeCompare(Z)}),[R]),Ne=E=>({CREATED:"Pending",ASSIGNED:"In LLL Warehouse",AT_LLL_WAREHOUSE:"In LLL Warehouse",OUT_FOR_DELIVERY:"Out for delivery",RETURNED:"Returned",DELIVERED:"Delivered",FAILED:"Failed"})[E]||E,Se=E=>{const G=E.bookingState==="BOOKED",U=G?"bg-green-100 text-green-700 border-green-200":"bg-amber-100 text-amber-700 border-amber-200",Z=G?"Booked":"Unbooked";return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs border ${U}`,children:Z})},fe=E=>E.isIntegrated?e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs border border-blue-200 bg-blue-50 text-blue-700",children:"Integrated"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs border border-gray-200 bg-gray-50 text-gray-700",children:"Manual"});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"All Orders"}),e.jsx("div",{className:"flex flex-col md:flex-row md:items-center gap-3 w-full md:w-auto",children:e.jsxs("form",{onSubmit:ae,className:"relative flex flex-col sm:flex-row sm:flex-wrap items-stretch gap-2 w-full sm:justify-end",children:[e.jsx(al,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:V,onChange:E=>Y(E.target.value),type:"text",placeholder:"Enter Booking/Tracking ID",className:"w-full sm:w-auto pl-9 pr-4 py-1.5 text-sm border border-gray-200 rounded-lg"}),e.jsxs("select",{value:te,onChange:E=>ce(E.target.value),className:"w-full sm:w-auto pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white","aria-label":"Filter by Assigned Rider",children:[e.jsx("option",{value:"",children:"All Riders"}),e.jsx("option",{value:"unassigned",children:"Unassigned"}),N.map(E=>e.jsx("option",{value:E._id,children:E.name||"Unnamed"},E._id))]}),e.jsxs("select",{value:$,onChange:E=>Re(E.target.value),className:"w-full sm:w-auto pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white","aria-label":"Filter by Order Status",children:[e.jsx("option",{value:"ALL",children:"All Statuses"}),e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"OUT_FOR_DELIVERY",children:"Out for Delivery"}),e.jsx("option",{value:"DELIVERED",children:"Delivered"}),e.jsx("option",{value:"RETURNED",children:"Returned"})]}),e.jsxs("select",{value:H,onChange:E=>q(E.target.value),className:"w-full sm:w-auto pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white","aria-label":"Filter by Date Range",children:[e.jsx("option",{value:"all",children:"All Orders"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"})]}),e.jsxs("select",{value:oe,onChange:E=>Ee(E.target.value),className:"w-full sm:w-auto pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white","aria-label":"Filter by Shipper",children:[e.jsx("option",{value:"",children:"All Shippers"}),Q.map(E=>e.jsx("option",{value:E._id,children:(E.companyName||E.name||"Unnamed")+(E.email?` - ${E.email}`:"")},E._id))]}),ee.length>0&&e.jsx("ul",{className:"absolute left-0 top-full mt-1 w-full sm:w-80 bg-white border border-gray-200 rounded-lg shadow z-10",children:ee.map(E=>e.jsxs("li",{className:"px-3 py-2 text-sm hover:bg-gray-50 cursor-pointer",onMouseDown:()=>{f(`/ceo/orders/${E._id}`)},children:[e.jsx("span",{className:"font-mono text-xs mr-2",children:E.bookingId}),e.jsx("span",{children:E.consigneeName}),e.jsxs("span",{className:"text-xs text-gray-500",children:["  ",E.destinationCity]})]},E._id))})]})})]}),e.jsxs("div",{className:"p-6",children:[L&&e.jsx("p",{className:"text-sm text-red-600",children:L}),O?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):F.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No orders found for selected filters."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2 px-3",children:"Shipper"}),e.jsx("th",{className:"py-2 px-3",children:"Order ID"}),e.jsx("th",{className:"py-2 px-3",children:"Source"}),e.jsx("th",{className:"py-2 px-3",children:"Booking"}),e.jsx("th",{className:"py-2 px-3",children:"Consignee"}),e.jsx("th",{className:"py-2 px-3",children:"COD"}),e.jsx("th",{className:"py-2 px-3",children:"Date"}),e.jsx("th",{className:"py-2 px-3",children:"Delivery Status"}),e.jsx("th",{className:"py-2 px-3",children:"Payment"}),e.jsx("th",{className:"py-2 px-3",children:"Rider"}),e.jsx("th",{className:"py-2 px-3",children:"Actions"})]})}),e.jsx("tbody",{children:F.map(E=>{var G,U,Z;return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 cursor-pointer",onClick:()=>f(`/ceo/orders/${E._id}`),children:[e.jsx("td",{className:"py-2 px-3 text-xs text-gray-700",children:((G=E.shipper)==null?void 0:G.companyName)||((U=E.shipper)==null?void 0:U.name)||"Unknown"}),e.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:E.bookingId||E.trackingId||"-"}),e.jsx("td",{className:"py-2 px-3",children:fe(E)}),e.jsx("td",{className:"py-2 px-3",children:Se(E)}),e.jsx("td",{className:"py-2 px-3 text-secondary",children:E.consigneeName}),e.jsxs("td",{className:"py-2 px-3",children:["PKR ",Number(E.codAmount||0).toLocaleString()]}),e.jsx("td",{className:"py-2 px-3",children:E.createdAt?new Date(E.createdAt).toLocaleDateString():"-"}),e.jsx("td",{className:"py-2 px-3 text-xs",children:Ne(E.status)}),e.jsx("td",{className:"py-2 px-3 text-xs",children:E.paymentType||"-"}),e.jsx("td",{className:"py-2 px-3 text-xs",children:((Z=E.assignedRider)==null?void 0:Z.name)||"Unassigned"}),e.jsx("td",{className:"py-2 px-3",children:(E.status==="CREATED"||E.assignedRider)&&e.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:we=>{we.stopPropagation(),C(E)},children:E.assignedRider?"Change Assignment":"Assign"})})]},E._id)})})]})})]})]}),w&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Assign Rider"}),e.jsx("button",{onClick:()=>C(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(xn,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-2 max-h-80 overflow-y-auto",children:[e.jsxs("button",{onClick:()=>W(w._id,null),className:"w-full flex items-center gap-3 p-3 rounded-lg border border-red-200 hover:border-red-300 hover:bg-red-50 text-left mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-100 flex items-center justify-center text-red-600",children:e.jsx(xn,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-700",children:"Unassign"}),e.jsx("div",{className:"text-xs text-red-500",children:"Remove rider assignment"})]})]}),N.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No riders found."}),N.map(E=>e.jsxs("button",{onClick:()=>W(w._id,E._id),className:"w-full flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-primary hover:bg-primary/5 text-left",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600",children:e.jsx(gs,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-secondary",children:E.name}),e.jsx("div",{className:"text-xs text-gray-500",children:E.email})]})]},E._id))]})]})})]})},yy=()=>{const{user:h}=Fs(),p=(h==null?void 0:h.token)||Xs(),[f,y]=D.useState([]),[v,N]=D.useState(!0),[A,R]=D.useState(""),[j,w]=D.useState(""),[C,O]=D.useState(null),[_,L]=D.useState({}),P=async()=>{if(p){N(!0),R("");try{const H=await fetch("/api/orders/integrated/pending",{headers:{Authorization:`Bearer ${p}`}}),q=await H.json();if(!H.ok)throw new Error((q==null?void 0:q.message)||"Failed to load integrated orders");y(Array.isArray(q)?q:[])}catch(H){R(H.message||"Failed to load integrated orders")}finally{N(!1)}}};D.useEffect(()=>{P()},[p]);const V=D.useMemo(()=>{const H=j.trim().toLowerCase();return H?f.filter(q=>{var te,ce;return String((q==null?void 0:q.bookingId)||"").toLowerCase().includes(H)||String((q==null?void 0:q.consigneeName)||"").toLowerCase().includes(H)||String((q==null?void 0:q.destinationCity)||"").toLowerCase().includes(H)||String(((te=q==null?void 0:q.shipper)==null?void 0:te.companyName)||((ce=q==null?void 0:q.shipper)==null?void 0:ce.name)||"").toLowerCase().includes(H)}):f},[f,j]),Y=H=>{const q=(H==null?void 0:H.bookingState)==="BOOKED",te=(H==null?void 0:H.isDeleted)===!0,ce=te?"Deleted":q?"Booked":"Pending Approval",$=te?"bg-red-50 text-red-700 border-red-200":q?"bg-green-50 text-green-700 border-green-200":"bg-amber-50 text-amber-800 border-amber-200";return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs border ${$}`,children:ce})},ee=async H=>{if(p)try{L(ce=>({...ce,[H]:!0}));const q=await fetch(`/api/orders/${H}/book`,{method:"PATCH",headers:{Authorization:`Bearer ${p}`}}),te=await q.json();if(!q.ok)throw new Error((te==null?void 0:te.message)||"Failed to book order");y(ce=>ce.filter($=>$._id!==H))}catch(q){R(q.message||"Failed to book order")}finally{L(q=>({...q,[H]:!1}))}},K=async H=>{if(p)try{L(ce=>({...ce,[H]:!0}));const q=await fetch(`/api/orders/${H}/reject`,{method:"PATCH",headers:{Authorization:`Bearer ${p}`}}),te=await q.json();if(!q.ok)throw new Error((te==null?void 0:te.message)||"Failed to delete order");y(ce=>ce.filter($=>$._id!==H)),O(null)}catch(q){R(q.message||"Failed to delete order")}finally{L(q=>({...q,[H]:!1}))}};return e.jsxs("div",{className:"space-y-6",children:[A&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:A}),e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(St,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Integrated Orders"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto",children:[e.jsx("input",{value:j,onChange:H=>w(H.target.value),type:"text",placeholder:"Search orders...",className:"pl-3 pr-4 py-1.5 text-sm border border-gray-200 rounded-lg w-full sm:w-auto"}),e.jsxs("button",{onClick:P,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 flex items-center gap-2",disabled:v,children:[e.jsx(Gn,{className:`w-4 h-4 ${v?"animate-spin":""}`}),"Refresh"]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:e.jsx("div",{className:"p-6",children:v?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):V.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No integrated orders pending approval."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2 px-3",children:"Order ID"}),e.jsx("th",{className:"py-2 px-3",children:"Shipper"}),e.jsx("th",{className:"py-2 px-3",children:"Customer"}),e.jsx("th",{className:"py-2 px-3",children:"City"}),e.jsx("th",{className:"py-2 px-3",children:"COD / Amount"}),e.jsx("th",{className:"py-2 px-3",children:"Status"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:V.map(H=>{var ce,$;const q=!!_[H._id],te=Number((H==null?void 0:H.codAmount)||0);return e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:H.bookingId}),e.jsx("td",{className:"py-2 px-3 text-xs text-gray-700",children:((ce=H.shipper)==null?void 0:ce.companyName)||(($=H.shipper)==null?void 0:$.name)||""}),e.jsx("td",{className:"py-2 px-3 text-secondary",children:H.consigneeName||""}),e.jsx("td",{className:"py-2 px-3",children:H.destinationCity||""}),e.jsxs("td",{className:"py-2 px-3",children:["PKR ",te.toLocaleString()]}),e.jsx("td",{className:"py-2 px-3",children:Y(H)}),e.jsx("td",{className:"py-2 px-3",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>ee(H._id),disabled:q,className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary disabled:opacity-60",children:q?"Working...":"Book"}),e.jsxs("button",{onClick:()=>O(H),disabled:q,className:"px-3 py-1.5 text-xs bg-red-50 hover:bg-red-100 text-red-700 rounded border border-red-200 flex items-center gap-2 disabled:opacity-60",children:[e.jsx(g0,{className:"w-4 h-4"})," Delete"]})]})})]},H._id)})})]})})})}),C&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>O(null),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",onClick:H=>H.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Confirm Delete"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Are you sure you want to delete this integrated order?"})]}),e.jsxs("div",{className:"p-6 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>O(null),className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Cancel"}),e.jsx("button",{onClick:()=>K(C._id),className:"px-3 py-1.5 text-xs bg-red-600 hover:bg-red-700 text-white rounded border border-red-600",disabled:!!_[C._id],children:"Confirm"})]})]})})]})},by=()=>{const[h,p]=D.useState([]),[f,y]=D.useState([]),[v,N]=D.useState(!0),[A,R]=D.useState(""),j=typeof window<"u"?localStorage.getItem("token"):null,w=async()=>{N(!0),R("");try{const[P,V]=await Promise.all([fetch("/api/users/riders",{headers:{Authorization:j?`Bearer ${j}`:""}}),fetch("/api/orders",{headers:{Authorization:j?`Bearer ${j}`:""}})]),Y=await P.json(),ee=await V.json();if(!P.ok)throw new Error(Y.message||"Failed riders");if(!V.ok)throw new Error(ee.message||"Failed orders");p(Y),y(ee)}catch(P){R(P.message)}finally{N(!1)}};D.useEffect(()=>{w()},[]);const C=new Date().toDateString(),O=f.filter(P=>new Date(P.createdAt).toDateString()===C),_=f.filter(P=>P.status==="DELIVERED"&&new Date(P.deliveredAt||P.createdAt).toDateString()===C),L=h.filter(P=>P.status==="ACTIVE");return e.jsxs("div",{className:"space-y-8",children:[A&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:A}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Active Riders"}),e.jsx(gs,{className:"w-5 h-5 text-primary"})]}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:v?"":L.length})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Orders Today"}),e.jsx(St,{className:"w-5 h-5 text-primary"})]}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:v?"":O.length})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Delivered Today"}),e.jsx(St,{className:"w-5 h-5 text-emerald-500"})]}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:v?"":_.length})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Rider Load"}),e.jsx("button",{onClick:w,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2 px-3",children:"Rider"}),e.jsx("th",{className:"py-2 px-3",children:"Assigned"}),e.jsx("th",{className:"py-2 px-3",children:"OFD"}),e.jsx("th",{className:"py-2 px-3",children:"Delivered"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:h.map(P=>{const V=f.filter(K=>K.assignedRider&&(K.assignedRider._id===P._id||K.assignedRider===P._id)),Y=V.filter(K=>K.status==="OUT_FOR_DELIVERY"),ee=V.filter(K=>K.status==="DELIVERED");return e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3",children:P.name}),e.jsx("td",{className:"py-2 px-3",children:V.length}),e.jsx("td",{className:"py-2 px-3",children:Y.length}),e.jsx("td",{className:"py-2 px-3",children:ee.length})]},P._id)})})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Rider Orders & Status"}),e.jsx("button",{onClick:w,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2 px-3",children:"Rider"}),e.jsx("th",{className:"py-2 px-3",children:"Booking"}),e.jsx("th",{className:"py-2 px-3",children:"Status"}),e.jsx("th",{className:"py-2 px-3",children:"City"}),e.jsx("th",{className:"py-2 px-3",children:"COD/Collected"}),e.jsx("th",{className:"py-2 px-3",children:"Updated"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:f.filter(P=>!!P.assignedRider&&["OUT_FOR_DELIVERY","DELIVERED","RETURNED","FAILED","ASSIGNED"].includes(P.status)).map(P=>{var V,Y;return e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3",children:typeof P.assignedRider=="object"?(V=P.assignedRider)==null?void 0:V.name:((Y=h.find(ee=>ee._id===P.assignedRider))==null?void 0:Y.name)||""}),e.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:P.bookingId}),e.jsx("td",{className:"py-2 px-3",children:P.status}),e.jsx("td",{className:"py-2 px-3",children:P.destinationCity}),e.jsx("td",{className:"py-2 px-3",children:P.status==="DELIVERED"?`Rs ${Number(P.amountCollected||P.codAmount||0).toLocaleString()}`:`Rs ${Number(P.codAmount||0).toLocaleString()}`}),e.jsx("td",{className:"py-2 px-3 text-xs text-gray-500",children:new Date(P.updatedAt||P.createdAt).toLocaleString()})]},P._id)})})]})})]})]})},wy=()=>{const[h,p]=D.useState(!0),[f,y]=D.useState(!1),[v,N]=D.useState(!1),[A,R]=D.useState(""),[j,w]=D.useState(""),[C,O]=D.useState(""),{user:_}=Fs(),L=(_==null?void 0:_.token)||Xs(),[P,V]=D.useState({companyName:"",logoUrl:"",address:{line1:"",city:"",country:""},phone:"",alternatePhone:"",email:"",website:"",ntn:"",strn:"",footerNote:""}),Y=async()=>{if(!L){R("Unauthorized access. Please login."),p(!1);return}try{p(!0),R("");const te=await fetch("/api/company-profile",{method:"GET",headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"}}),ce=await te.json();if(!te.ok)throw new Error(ce.message||"Failed to load company profile");ce.success&&ce.data&&(V(ce.data),O(ce.data.logoUrl||""))}catch(te){console.error("Error loading profile:",te),R(te.message)}finally{p(!1)}},ee=async()=>{if(!L){R("Unauthorized access. Please login.");return}if(!P.companyName.trim()){R("Company name is required");return}if(!P.address.line1.trim()||!P.address.city.trim()||!P.address.country.trim()){R("Complete address is required");return}if(!P.phone.trim()){R("Phone number is required");return}if(!P.email.trim()){R("Email is required");return}try{y(!0),R(""),w("");const te=await fetch("/api/company-profile",{method:"PUT",headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"},body:JSON.stringify(P)}),ce=await te.json();if(!te.ok)throw new Error(ce.message||"Failed to save company profile");ce.success&&(w("Company profile saved successfully!"),V(ce.data),setTimeout(()=>w(""),5e3))}catch(te){console.error("Error saving profile:",te),R(te.message)}finally{y(!1)}},K=async te=>{if(!te)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(te.type)){R("Please upload a valid image file (JPEG, PNG, GIF, or WebP)");return}if(te.size>5*1024*1024){R("File size must be less than 5MB");return}try{N(!0),R("");const $=new FormData;$.append("logo",te);const Re=await fetch("/api/company-profile/logo",{method:"POST",headers:{Authorization:`Bearer ${L}`},body:$}),oe=await Re.json();if(!Re.ok)throw new Error(oe.message||"Failed to upload logo");if(oe.success){const Ee=oe.data.logoUrl;V(me=>({...me,logoUrl:Ee})),O(Ee),w("Logo uploaded successfully!"),setTimeout(()=>w(""),3e3)}}catch($){console.error("Error uploading logo:",$),R($.message)}finally{N(!1)}},H=te=>{const ce=te.target.files[0];ce&&K(ce)},q=(te,ce)=>{if(te.includes(".")){const[$,Re]=te.split(".");V(oe=>({...oe,[$]:{...oe[$],[Re]:ce}}))}else V($=>({...$,[te]:ce}))};return D.useEffect(()=>{Y()},[]),h?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Zi,{className:"w-6 h-6 animate-spin text-green-600"}),e.jsx("span",{className:"text-gray-600",children:"Loading company profile..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(Wi,{className:"w-8 h-8 text-green-600"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Company Profile"})]}),e.jsx("p",{className:"text-gray-600",children:"Manage your company information that appears across the platform and on invoices."})]}),A&&e.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-2",children:[e.jsx(Xn,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-red-700",children:A})]}),j&&e.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4 flex items-start space-x-2",children:[e.jsx(Yn,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-green-700",children:j})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 p-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Company Logo"}),e.jsx("div",{className:"mb-4",children:C?e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:C,alt:"Company Logo",className:"w-32 h-32 object-contain border-2 border-gray-200 rounded-lg bg-gray-50"}),e.jsx("button",{onClick:()=>{O(""),V(te=>({...te,logoUrl:""}))},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:e.jsx(p0,{className:"w-4 h-4"})})]}):e.jsx("div",{className:"w-32 h-32 bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center mx-auto",children:e.jsx(Ql,{className:"w-8 h-8 text-gray-400"})})}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",id:"logo-upload",className:"hidden",accept:"image/*",onChange:H,disabled:v}),e.jsx("label",{htmlFor:"logo-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:v?e.jsxs(e.Fragment,{children:[e.jsx(Zi,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(sy,{className:"w-4 h-4 mr-2"}),"Upload Logo"]})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Max 5MB. Supports JPEG, PNG, GIF, WebP"})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Wi,{className:"w-5 h-5 mr-2 text-green-600"}),"Basic Information"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Company Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:P.companyName,onChange:te=>q("companyName",te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"LahoreLink Courier Services"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Oc,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"email",value:P.email,onChange:te=>q("email",te.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"finance@lahorelink.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),e.jsxs("div",{className:"relative",children:[e.jsx(Gx,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"url",value:P.website,onChange:te=>q("website",te.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"www.lahorelink.com"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(gn,{className:"w-5 h-5 mr-2 text-green-600"}),"Address Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Address Line 1 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:P.address.line1,onChange:te=>q("address.line1",te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Office # 123, Main Boulevard, Gulberg III"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["City ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:P.address.city,onChange:te=>q("address.city",te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Lahore"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Country ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:P.address.country,onChange:te=>q("address.country",te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Pakistan"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Vn,{className:"w-5 h-5 mr-2 text-green-600"}),"Contact Information"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Primary Phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Vn,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"tel",value:P.phone,onChange:te=>q("phone",te.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"+92-42-111-LINK (5465)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alternate Phone"}),e.jsxs("div",{className:"relative",children:[e.jsx(Vn,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"tel",value:P.alternatePhone,onChange:te=>q("alternatePhone",te.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"+92-42-XXX-XXXX"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"NTN (Optional)"}),e.jsx("input",{type:"text",value:P.ntn,onChange:te=>q("ntn",te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Enter NTN"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"STRN (Optional)"}),e.jsx("input",{type:"text",value:P.strn,onChange:te=>q("strn",te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Enter STRN"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Footer Note"}),e.jsx("textarea",{value:P.footerNote,onChange:te=>q("footerNote",te.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"For support contact: +92-42-111-LINK (5465) | Email: support@lahorelink.com"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This text will appear at the bottom of invoices and other documents"})]})]})]})]}),e.jsx("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50 rounded-b-lg",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:ee,disabled:f,className:"inline-flex items-center px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?e.jsxs(e.Fragment,{children:[e.jsx(Zi,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(x0,{className:"w-4 h-4 mr-2"}),"Save Profile"]})})})})]})]})})},Va=h=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0}).format(Number(h||0)),jc=h=>{if(!h)return"";const p=new Date(h);return Number.isNaN(p.getTime())?"":p.toLocaleDateString("en-PK",{year:"numeric",month:"short",day:"numeric"})},Ny=h=>{if(!h)return"";const p=new Date(h);return Number.isNaN(p.getTime())?"":p.toLocaleString("en-PK")},vy=()=>{const h=Xs(),[p,f]=D.useState(!1),[y,v]=D.useState(""),[N,A]=D.useState([]),[R,j]=D.useState([]),[w,C]=D.useState(null),[O,_]=D.useState(!1),[L,P]=D.useState([]),[V,Y]=D.useState(null),[ee,K]=D.useState(null),[H,q]=D.useState(""),[te,ce]=D.useState(""),[$,Re]=D.useState("all"),[oe,Ee]=D.useState("all"),[me,ne]=D.useState("all"),J=async(U={})=>{f(!0),v("");try{const Z={Authorization:h?`Bearer ${h}`:""},we=new URLSearchParams,xe=U.range??$;xe&&xe!=="custom"&&xe!=="all"?xe==="today"?we.set("range","today"):xe==="7"?we.set("range","7d"):xe==="15"?we.set("range","15d"):xe==="30"&&we.set("range","30d"):xe==="all"&&we.set("range","all");const Ge=U.from??H,Ve=U.to??te;Ge&&we.set("from",Ge),Ve&&we.set("to",Ve),oe&&oe!=="all"&&we.set("shipperId",oe),me&&me!=="all"&&we.set("riderId",me);const Je=await fetch(`/api/finance/company/summary?${we.toString()}`,{headers:Z}),jt=await Je.json();if(!Je.ok)throw new Error(jt.message||"Failed to load company finance summary");const Be=jt.metrics||{};C(Be);try{const[lt,Ke]=await Promise.all([fetch("/api/finance/summary/shipper",{headers:Z}),fetch("/api/finance/summary/rider",{headers:Z})]),ft=lt.ok?await lt.json().catch(()=>[]):[],Oe=Ke.ok?await Ke.json().catch(()=>[]):[];Array.isArray(ft)&&ft.length>0?A(ft):A([]),Array.isArray(Oe)&&Oe.length>0?j(Oe):j([])}catch{A([]),j([])}}catch(Z){v(Z.message||"Failed to load company finance")}finally{f(!1)}},ae=async(U={})=>{_(!0);try{const Z=new URLSearchParams,we=U.range??$;we&&we!=="custom"&&we!=="all"?we==="today"?Z.set("range","today"):we==="7"?Z.set("range","7d"):we==="15"?Z.set("range","15d"):we==="30"&&Z.set("range","30d"):we==="all"&&Z.set("range","all");const xe=U.from??H,Ge=U.to??te;xe&&Z.set("from",xe),Ge&&Z.set("to",Ge);const Ve=U.shipperFilter??oe;Ve&&Ve!=="all"&&Z.set("shipperId",Ve);const Je=U.riderFilter??me;Je&&Je!=="all"&&Z.set("riderId",Je);const jt={Authorization:h?`Bearer ${h}`:""},Be=await fetch(`/api/finance/company/ledger?${Z.toString()}`,{headers:jt}),lt=await Be.json();if(!Be.ok)throw new Error(lt.message||"Failed to load company ledger");P(Array.isArray(lt.rows)?lt.rows:[]),Y(lt.totals||null),K(lt.activePeriod||null)}catch(Z){v(Z.message||"Failed to load company ledger"),P([]),Y(null)}finally{_(!1)}};D.useEffect(()=>{J()},[h]),D.useEffect(()=>{h&&ae({range:$})},[h]);const F=U=>{Re(U);let Z="",we="";if(U==="all")Z="",we="";else{const xe=new Date,Ge=new Date(xe);Ge.setHours(23,59,59,999);let Ve;if(U==="current")Ve=new Date(xe.getFullYear(),xe.getMonth(),1);else if(Ve=new Date(xe),Ve.setHours(0,0,0,0),U!=="today"){const jt=Number(U);!Number.isNaN(jt)&&jt>0&&(Ve=new Date(Ge),Ve.setDate(Ve.getDate()-(jt-1)),Ve.setHours(0,0,0,0))}const Je=jt=>{const Be=jt.getFullYear(),lt=String(jt.getMonth()+1).padStart(2,"0"),Ke=String(jt.getDate()).padStart(2,"0");return`${Be}-${lt}-${Ke}`};Z=Je(Ve),we=Je(Ge)}q(Z),ce(we),ae({range:U,from:Z,to:we}),J({range:U,from:Z,to:we})},W=D.useMemo(()=>{const U=w||{},Z=Number(U.ordersCount||0),we=Number(U.totalCod||0),xe=Number(U.totalServiceCharges||0),Ge=Number(U.totalCompanyCommission||0),Ve=xe+Ge,Je=Number(U.companyProfit||0),jt=Number(U.deliveredOrders||0),Be=Number(U.returnedOrders||0),lt=Number(U.totalAmount||we+xe),Ke=Number(U.unpaidRiderBalances||0);return{totalOrders:Z,totalCod:we,totalServiceCharges:xe,totalCompanyCommission:Ge,companyEarnings:Ve,companyProfit:Je,deliveredOrders:jt,returnedOrders:Be,totalAmount:lt,unpaidRiderBalances:Ke}},[w]),Q=D.useMemo(()=>$==="today"?"today":$==="7"?"last 7 days":$==="15"?"last 15 days":$==="30"?"last 30 days":$==="all"?"all time":$==="current"?"current month":"custom",[$]),Ne=D.useMemo(()=>(Array.isArray(N)?N:[]).map(Z=>({id:Z._id,name:Z.shipperName||Z.shipperEmail||"Shipper"})),[N]),Se=D.useMemo(()=>(Array.isArray(R)?R:[]).map(Z=>({id:Z._id,name:Z.riderName||"Rider"})),[R]),fe=()=>{ae({}),J({})},E=()=>{q(""),ce(""),Re("all"),Ee("all"),ne("all"),ae({range:"all",from:"",to:"",shipperFilter:"all",riderFilter:"all"}),J({range:"all",from:"",to:""})},G=async()=>{if(window.confirm("Close current finance month? This will lock the current period and start a new active month."))try{v(""),f(!0);const Z=await fetch("/api/finance/company/close-month",{method:"POST",headers:{"Content-Type":"application/json",Authorization:h?`Bearer ${h}`:""}}),we=await Z.json();if(!Z.ok)throw new Error(we.message||"Failed to close current month");await J(),Re("all"),q(""),ce(""),Ee("all"),ne("all"),await ae({range:"all",from:"",to:""})}catch(Z){v(Z.message||"Failed to close current month")}finally{f(!1)}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ts,{className:"w-6 h-6 text-green-600"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Company Finance"})]}),e.jsx("div",{className:"flex flex-col items-stretch sm:flex-row sm:items-center gap-2 text-xs",children:[{key:"today",label:"Today"},{key:"7",label:"7 Days"},{key:"30",label:"30 Days"},{key:"all",label:"All Time"}].map(U=>e.jsx("button",{type:"button",onClick:()=>F(U.key),className:`px-3 py-1.5 rounded-full border text-xs whitespace-nowrap ${$===U.key?"bg-black text-white border-black":"bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100"}`,children:U.label},U.key))})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"button",onClick:()=>Re("custom"),className:"inline-flex items-center px-4 py-2 border border-gray-200 rounded-full text-xs font-medium text-gray-700 hover:bg-gray-50",children:"Custom Range"})})]}),y&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:y}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Orders"}),e.jsx("div",{className:"mt-1 text-2xl font-bold text-secondary",children:p?"...":W.totalOrders})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Total COD"}),e.jsx("div",{className:"mt-1 text-xl font-bold text-secondary",children:p?"...":Va(W.totalCod)})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Service Charges"}),e.jsx("div",{className:"mt-1 text-xl font-bold text-secondary",children:p?"...":Va(W.totalServiceCharges)})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Company Earnings"}),e.jsx("div",{className:"mt-1 text-xl font-bold text-secondary",children:p?"...":Va(W.companyEarnings)})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Delivery Outcomes"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Range: ",Q]})]}),e.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"border border-gray-100 rounded-xl px-4 py-3",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Delivered Orders"}),e.jsx("div",{className:"mt-1 text-2xl font-bold text-secondary",children:p?"...":W.deliveredOrders})]}),e.jsxs("div",{className:"border border-gray-100 rounded-xl px-4 py-3",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Returned Orders"}),e.jsx("div",{className:"mt-1 text-2xl font-bold text-secondary",children:p?"...":W.returnedOrders})]}),e.jsxs("div",{className:"border border-gray-100 rounded-xl px-4 py-3",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Total Amount (COD + Charges)"}),e.jsx("div",{className:"mt-1 text-xl font-bold text-secondary",children:p?"...":Va(W.totalAmount)})]})]}),e.jsxs("div",{className:"px-6 pb-6 text-sm text-gray-700",children:[e.jsx("span",{children:"Unpaid rider balances:"}),e.jsx("span",{className:"ml-2 font-semibold text-secondary",children:p?"...":`Rs ${Number(W.unpaidRiderBalances||0).toLocaleString()}`})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(sl,{className:"w-4 h-4 text-gray-500"}),e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Company Journal / Ledger"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-end gap-2 text-xs text-gray-500 w-full md:w-auto",children:[ee&&e.jsxs("span",{className:"whitespace-normal sm:whitespace-nowrap",children:["Active Period:"," ",jc(ee.periodStart)," - ",ee.periodEnd?jc(ee.periodEnd):"Open"]}),e.jsx("select",{value:ee&&ee._id||"current",disabled:!0,className:"w-full sm:w-auto px-3 py-1.5 border border-gray-200 rounded-lg bg-gray-50 text-xs text-gray-600",children:ee&&e.jsxs("option",{value:ee._id||"current",children:[jc(ee.periodStart)," - ",ee.periodEnd?jc(ee.periodEnd):"Open"]})}),e.jsx(zt,{variant:"outline",onClick:G,className:"w-full sm:w-auto text-xs",children:"Close Current Month"})]})]}),e.jsxs("div",{className:"p-6 flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"mb-4 flex flex-wrap gap-2 text-xs",children:[{key:"today",label:"Today"},{key:"7",label:"7 Days"},{key:"15",label:"15 Days"},{key:"30",label:"30 Days"},{key:"current",label:"Current Month"},{key:"all",label:"All Time"}].map(U=>e.jsx("button",{type:"button",onClick:()=>F(U.key),className:`px-3 py-1.5 rounded-full border whitespace-nowrap ${$===U.key?"bg-black text-white border-black":"bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100"}`,children:U.label},U.key))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4 text-xs",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-500 mb-1",children:"From"}),e.jsx("input",{type:"date",value:H,onChange:U=>{q(U.target.value),Re("custom")},className:"px-3 py-2 text-sm border border-gray-200 rounded-lg"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-500 mb-1",children:"To"}),e.jsx("input",{type:"date",value:te,onChange:U=>{ce(U.target.value),Re("custom")},className:"px-3 py-2 text-sm border border-gray-200 rounded-lg"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-500 mb-1",children:"Shipper"}),e.jsxs("select",{value:oe,onChange:U=>Ee(U.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"all",children:"All Shippers"}),Ne.map(U=>e.jsx("option",{value:U.id,children:U.name},U.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-500 mb-1",children:"Rider"}),e.jsxs("select",{value:me,onChange:U=>ne(U.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"all",children:"All Riders"}),Se.map(U=>e.jsx("option",{value:U.id,children:U.name},U.id))]})]})]}),e.jsxs("div",{className:"mb-4 flex flex-wrap gap-2 text-xs",children:[e.jsx(zt,{onClick:fe,className:"px-4 py-2 text-xs",children:"Apply Filters"}),e.jsx(zt,{variant:"outline",onClick:E,className:"px-4 py-2 text-xs",children:"Reset"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-[950px] md:min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b bg-gray-50",children:[e.jsx("th",{className:"py-3 px-4",children:"Date / Time"}),e.jsx("th",{className:"py-3 px-4",children:"Shipper"}),e.jsx("th",{className:"py-3 px-4",children:"Order / CN"}),e.jsx("th",{className:"py-3 px-4 text-right",children:"COD"}),e.jsx("th",{className:"py-3 px-4 text-right",children:"Service Charges"}),e.jsx("th",{className:"py-3 px-4 text-right",children:"Rider Payout"}),e.jsx("th",{className:"py-3 px-4 text-right",children:"Company Profit"}),e.jsx("th",{className:"py-3 px-4 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:O?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"py-10 px-4 text-center text-gray-500",children:"Loading ledger"})}):L.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"py-10 px-4 text-center text-gray-500",children:"No records found"})}):L.map(U=>{const Z=Number(U.companyProfit||0),we=Z>0?"text-green-700":Z<0?"text-red-600":"text-secondary";return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-xs text-gray-600",children:Ny(U.date)}),e.jsx("td",{className:"py-3 px-4 text-sm",children:U.shipperName||""}),e.jsx("td",{className:"py-3 px-4 text-xs text-gray-700",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-mono text-[11px]",children:U.bookingId||""}),e.jsx("span",{className:"font-mono text-[11px] text-gray-500",children:U.trackingId||""})]})}),e.jsx("td",{className:"py-3 px-4 text-right",children:Va(U.cod||0)}),e.jsx("td",{className:"py-3 px-4 text-right",children:Va(U.serviceCharges||0)}),e.jsx("td",{className:"py-3 px-4 text-right",children:Va(U.riderPayout||0)}),e.jsx("td",{className:`py-3 px-4 text-right font-semibold ${we}`,children:Va(Z)}),e.jsx("td",{className:"py-3 px-4 text-center text-xs text-gray-600",children:U.status||""})]},U.id)})})]})})]}),e.jsx("div",{className:"w-full lg:w-72 xl:w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-gray-50 border border-gray-100 rounded-xl p-4 text-sm",children:[e.jsx("h4",{className:"font-bold text-secondary mb-3 text-sm",children:"Summary (Filtered)"}),e.jsxs("div",{className:"space-y-2 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Orders"}),e.jsx("span",{className:"font-semibold text-secondary",children:(V==null?void 0:V.totalOrders)||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Total COD"}),e.jsx("span",{className:"font-semibold text-secondary",children:Va((V==null?void 0:V.totalCod)||0)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Service Charges"}),e.jsx("span",{className:"font-semibold text-secondary",children:Va((V==null?void 0:V.totalServiceCharges)||0)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Rider Payout"}),e.jsx("span",{className:"font-semibold text-secondary",children:Va((V==null?void 0:V.totalRiderPayoutPaid)||0)})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-200 mt-2",children:[e.jsx("span",{children:"Company Profit"}),e.jsx("span",{className:"font-semibold text-secondary",children:Va((V==null?void 0:V.totalCompanyProfit)||0)})]})]})]})})]})]})]})};var Qe;(function(h){h[h.QR_CODE=0]="QR_CODE",h[h.AZTEC=1]="AZTEC",h[h.CODABAR=2]="CODABAR",h[h.CODE_39=3]="CODE_39",h[h.CODE_93=4]="CODE_93",h[h.CODE_128=5]="CODE_128",h[h.DATA_MATRIX=6]="DATA_MATRIX",h[h.MAXICODE=7]="MAXICODE",h[h.ITF=8]="ITF",h[h.EAN_13=9]="EAN_13",h[h.EAN_8=10]="EAN_8",h[h.PDF_417=11]="PDF_417",h[h.RSS_14=12]="RSS_14",h[h.RSS_EXPANDED=13]="RSS_EXPANDED",h[h.UPC_A=14]="UPC_A",h[h.UPC_E=15]="UPC_E",h[h.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Qe||(Qe={}));var Z1=new Map([[Qe.QR_CODE,"QR_CODE"],[Qe.AZTEC,"AZTEC"],[Qe.CODABAR,"CODABAR"],[Qe.CODE_39,"CODE_39"],[Qe.CODE_93,"CODE_93"],[Qe.CODE_128,"CODE_128"],[Qe.DATA_MATRIX,"DATA_MATRIX"],[Qe.MAXICODE,"MAXICODE"],[Qe.ITF,"ITF"],[Qe.EAN_13,"EAN_13"],[Qe.EAN_8,"EAN_8"],[Qe.PDF_417,"PDF_417"],[Qe.RSS_14,"RSS_14"],[Qe.RSS_EXPANDED,"RSS_EXPANDED"],[Qe.UPC_A,"UPC_A"],[Qe.UPC_E,"UPC_E"],[Qe.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),W1;(function(h){h[h.UNKNOWN=0]="UNKNOWN",h[h.URL=1]="URL"})(W1||(W1={}));function jy(h){return Object.values(Qe).includes(h)}var Dc;(function(h){h[h.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",h[h.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Dc||(Dc={}));var Cy=(function(){function h(){}return h.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",h.SCAN_DEFAULT_FPS=2,h.DEFAULT_DISABLE_FLIP=!1,h.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,h.DEFAULT_SUPPORTED_SCAN_TYPE=[Dc.SCAN_TYPE_CAMERA,Dc.SCAN_TYPE_FILE],h})(),Zx=(function(){function h(p,f){this.format=p,this.formatName=f}return h.prototype.toString=function(){return this.formatName},h.create=function(p){if(!Z1.has(p))throw"".concat(p," not in html5QrcodeSupportedFormatsTextMap");return new h(p,Z1.get(p))},h})(),Q1=(function(){function h(){}return h.createFromText=function(p){var f={text:p};return{decodedText:p,result:f}},h.createFromQrcodeResult=function(p){return{decodedText:p.text,result:p}},h})(),i0;(function(h){h[h.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",h[h.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",h[h.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(i0||(i0={}));var Ay=(function(){function h(){}return h.createFrom=function(p){return{errorMessage:p,type:i0.UNKWOWN_ERROR}},h})(),Ey=(function(){function h(p){this.verbose=p}return h.prototype.log=function(p){this.verbose&&console.log(p)},h.prototype.warn=function(p){this.verbose&&console.warn(p)},h.prototype.logError=function(p,f){(this.verbose||f===!0)&&console.error(p)},h.prototype.logErrors=function(p){if(p.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(p)},h})();function Hn(h){return typeof h>"u"||h===null}var qi=(function(){function h(){}return h.codeParseError=function(p){return"QR code parse error, error = ".concat(p)},h.errorGettingUserMedia=function(p){return"Error getting userMedia, error = ".concat(p)},h.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},h.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},h.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},h.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},h.scannerPaused=function(){return"Scanner paused"},h})(),Wx=(function(){function h(){}return h.isMediaStreamConstraintsValid=function(p,f){if(typeof p!="object"){var y=typeof p;return f.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(y,"."),!0),!1}for(var v=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],N=new Set(v),A=Object.keys(p),R=0,j=A;R<j.length;R++){var w=j[R];if(N.has(w))return f.logError("".concat(w," is not supported videoConstaints."),!0),!1}return!0},h})(),Jl={exports:{}},Sy=Jl.exports,J1;function Ty(){return J1||(J1=1,(function(h,p){(function(f,y){y(p)})(Sy,(function(f){function y(I){return I==null}var v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,s){I.__proto__=s}||function(I,s){for(var n in s)s.hasOwnProperty(n)&&(I[n]=s[n])};function N(I,s){v(I,s);function n(){this.constructor=I}I.prototype=s===null?Object.create(s):(n.prototype=s.prototype,new n)}function A(I,s){var n=Object.setPrototypeOf;n?n(I,s):I.__proto__=s}function R(I,s){s===void 0&&(s=I.constructor);var n=Error.captureStackTrace;n&&n(I,s)}var j=(function(I){N(s,I);function s(n){var r=this.constructor,l=I.call(this,n)||this;return Object.defineProperty(l,"name",{value:r.name,enumerable:!1}),A(l,r.prototype),R(l),l}return s})(Error);class w extends j{constructor(s=void 0){super(s),this.message=s}getKind(){return this.constructor.kind}}w.kind="Exception";class C extends w{}C.kind="ArgumentException";class O extends w{}O.kind="IllegalArgumentException";class _{constructor(s){if(this.binarizer=s,s===null)throw new O("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(s,n){return this.binarizer.getBlackRow(s,n)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(s,n,r,l){const o=this.binarizer.getLuminanceSource().crop(s,n,r,l);return new _(this.binarizer.createBinarizer(o))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const s=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new _(this.binarizer.createBinarizer(s))}rotateCounterClockwise45(){const s=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new _(this.binarizer.createBinarizer(s))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class L extends w{static getChecksumInstance(){return new L}}L.kind="ChecksumException";class P{constructor(s){this.source=s}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class V{static arraycopy(s,n,r,l,o){for(;o--;)r[l++]=s[n++]}static currentTimeMillis(){return Date.now()}}class Y extends w{}Y.kind="IndexOutOfBoundsException";class ee extends Y{constructor(s=void 0,n=void 0){super(n),this.index=s,this.message=n}}ee.kind="ArrayIndexOutOfBoundsException";class K{static fill(s,n){for(let r=0,l=s.length;r<l;r++)s[r]=n}static fillWithin(s,n,r,l){K.rangeCheck(s.length,n,r);for(let o=n;o<r;o++)s[o]=l}static rangeCheck(s,n,r){if(n>r)throw new O("fromIndex("+n+") > toIndex("+r+")");if(n<0)throw new ee(n);if(r>s)throw new ee(r)}static asList(...s){return s}static create(s,n,r){return Array.from({length:s}).map(o=>Array.from({length:n}).fill(r))}static createInt32Array(s,n,r){return Array.from({length:s}).map(o=>Int32Array.from({length:n}).fill(r))}static equals(s,n){if(!s||!n||!s.length||!n.length||s.length!==n.length)return!1;for(let r=0,l=s.length;r<l;r++)if(s[r]!==n[r])return!1;return!0}static hashCode(s){if(s===null)return 0;let n=1;for(const r of s)n=31*n+r;return n}static fillUint8Array(s,n){for(let r=0;r!==s.length;r++)s[r]=n}static copyOf(s,n){return s.slice(0,n)}static copyOfUint8Array(s,n){if(s.length<=n){const r=new Uint8Array(n);return r.set(s),r}return s.slice(0,n)}static copyOfRange(s,n,r){const l=r-n,o=new Int32Array(l);return V.arraycopy(s,n,o,0,l),o}static binarySearch(s,n,r){r===void 0&&(r=K.numberComparator);let l=0,o=s.length-1;for(;l<=o;){const d=o+l>>1,u=r(n,s[d]);if(u>0)l=d+1;else if(u<0)o=d-1;else return d}return-l-1}static numberComparator(s,n){return s-n}}class H{static numberOfTrailingZeros(s){let n;if(s===0)return 32;let r=31;return n=s<<16,n!==0&&(r-=16,s=n),n=s<<8,n!==0&&(r-=8,s=n),n=s<<4,n!==0&&(r-=4,s=n),n=s<<2,n!==0&&(r-=2,s=n),r-(s<<1>>>31)}static numberOfLeadingZeros(s){if(s===0)return 32;let n=1;return s>>>16||(n+=16,s<<=16),s>>>24||(n+=8,s<<=8),s>>>28||(n+=4,s<<=4),s>>>30||(n+=2,s<<=2),n-=s>>>31,n}static toHexString(s){return s.toString(16)}static toBinaryString(s){return String(parseInt(String(s),2))}static bitCount(s){return s=s-(s>>>1&1431655765),s=(s&858993459)+(s>>>2&858993459),s=s+(s>>>4)&252645135,s=s+(s>>>8),s=s+(s>>>16),s&63}static truncDivision(s,n){return Math.trunc(s/n)}static parseInt(s,n=void 0){return parseInt(s,n)}}H.MIN_VALUE_32_BITS=-2147483648,H.MAX_VALUE=Number.MAX_SAFE_INTEGER;class q{constructor(s,n){s===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=s,n==null?this.bits=q.makeArray(s):this.bits=n)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(s){if(s>this.bits.length*32){const n=q.makeArray(s);V.arraycopy(this.bits,0,n,0,this.bits.length),this.bits=n}}get(s){return(this.bits[Math.floor(s/32)]&1<<(s&31))!==0}set(s){this.bits[Math.floor(s/32)]|=1<<(s&31)}flip(s){this.bits[Math.floor(s/32)]^=1<<(s&31)}getNextSet(s){const n=this.size;if(s>=n)return n;const r=this.bits;let l=Math.floor(s/32),o=r[l];o&=~((1<<(s&31))-1);const d=r.length;for(;o===0;){if(++l===d)return n;o=r[l]}const u=l*32+H.numberOfTrailingZeros(o);return u>n?n:u}getNextUnset(s){const n=this.size;if(s>=n)return n;const r=this.bits;let l=Math.floor(s/32),o=~r[l];o&=~((1<<(s&31))-1);const d=r.length;for(;o===0;){if(++l===d)return n;o=~r[l]}const u=l*32+H.numberOfTrailingZeros(o);return u>n?n:u}setBulk(s,n){this.bits[Math.floor(s/32)]=n}setRange(s,n){if(n<s||s<0||n>this.size)throw new O;if(n===s)return;n--;const r=Math.floor(s/32),l=Math.floor(n/32),o=this.bits;for(let d=r;d<=l;d++){const u=d>r?0:s&31,b=(2<<(d<l?31:n&31))-(1<<u);o[d]|=b}}clear(){const s=this.bits.length,n=this.bits;for(let r=0;r<s;r++)n[r]=0}isRange(s,n,r){if(n<s||s<0||n>this.size)throw new O;if(n===s)return!0;n--;const l=Math.floor(s/32),o=Math.floor(n/32),d=this.bits;for(let u=l;u<=o;u++){const m=u>l?0:s&31,S=(2<<(u<o?31:n&31))-(1<<m)&4294967295;if((d[u]&S)!==(r?S:0))return!1}return!0}appendBit(s){this.ensureCapacity(this.size+1),s&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(s,n){if(n<0||n>32)throw new O("Num bits must be between 0 and 32");this.ensureCapacity(this.size+n);for(let r=n;r>0;r--)this.appendBit((s>>r-1&1)===1)}appendBitArray(s){const n=s.size;this.ensureCapacity(this.size+n);for(let r=0;r<n;r++)this.appendBit(s.get(r))}xor(s){if(this.size!==s.size)throw new O("Sizes don't match");const n=this.bits;for(let r=0,l=n.length;r<l;r++)n[r]^=s.bits[r]}toBytes(s,n,r,l){for(let o=0;o<l;o++){let d=0;for(let u=0;u<8;u++)this.get(s)&&(d|=1<<7-u),s++;n[r+o]=d}}getBitArray(){return this.bits}reverse(){const s=new Int32Array(this.bits.length),n=Math.floor((this.size-1)/32),r=n+1,l=this.bits;for(let o=0;o<r;o++){let d=l[o];d=d>>1&1431655765|(d&1431655765)<<1,d=d>>2&858993459|(d&858993459)<<2,d=d>>4&252645135|(d&252645135)<<4,d=d>>8&16711935|(d&16711935)<<8,d=d>>16&65535|(d&65535)<<16,s[n-o]=d}if(this.size!==r*32){const o=r*32-this.size;let d=s[0]>>>o;for(let u=1;u<r;u++){const m=s[u];d|=m<<32-o,s[u-1]=d,d=m>>>o}s[r-1]=d}this.bits=s}static makeArray(s){return new Int32Array(Math.floor((s+31)/32))}equals(s){if(!(s instanceof q))return!1;const n=s;return this.size===n.size&&K.equals(this.bits,n.bits)}hashCode(){return 31*this.size+K.hashCode(this.bits)}toString(){let s="";for(let n=0,r=this.size;n<r;n++)(n&7)===0&&(s+=" "),s+=this.get(n)?"X":".";return s}clone(){return new q(this.size,this.bits.slice())}}var te;(function(I){I[I.OTHER=0]="OTHER",I[I.PURE_BARCODE=1]="PURE_BARCODE",I[I.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",I[I.TRY_HARDER=3]="TRY_HARDER",I[I.CHARACTER_SET=4]="CHARACTER_SET",I[I.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",I[I.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",I[I.ASSUME_GS1=7]="ASSUME_GS1",I[I.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",I[I.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",I[I.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(te||(te={}));var ce=te;class $ extends w{static getFormatInstance(){return new $}}$.kind="FormatException";var Re;(function(I){I[I.Cp437=0]="Cp437",I[I.ISO8859_1=1]="ISO8859_1",I[I.ISO8859_2=2]="ISO8859_2",I[I.ISO8859_3=3]="ISO8859_3",I[I.ISO8859_4=4]="ISO8859_4",I[I.ISO8859_5=5]="ISO8859_5",I[I.ISO8859_6=6]="ISO8859_6",I[I.ISO8859_7=7]="ISO8859_7",I[I.ISO8859_8=8]="ISO8859_8",I[I.ISO8859_9=9]="ISO8859_9",I[I.ISO8859_10=10]="ISO8859_10",I[I.ISO8859_11=11]="ISO8859_11",I[I.ISO8859_13=12]="ISO8859_13",I[I.ISO8859_14=13]="ISO8859_14",I[I.ISO8859_15=14]="ISO8859_15",I[I.ISO8859_16=15]="ISO8859_16",I[I.SJIS=16]="SJIS",I[I.Cp1250=17]="Cp1250",I[I.Cp1251=18]="Cp1251",I[I.Cp1252=19]="Cp1252",I[I.Cp1256=20]="Cp1256",I[I.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",I[I.UTF8=22]="UTF8",I[I.ASCII=23]="ASCII",I[I.Big5=24]="Big5",I[I.GB18030=25]="GB18030",I[I.EUC_KR=26]="EUC_KR"})(Re||(Re={}));class oe{constructor(s,n,r,...l){this.valueIdentifier=s,this.name=r,typeof n=="number"?this.values=Int32Array.from([n]):this.values=n,this.otherEncodingNames=l,oe.VALUE_IDENTIFIER_TO_ECI.set(s,this),oe.NAME_TO_ECI.set(r,this);const o=this.values;for(let d=0,u=o.length;d!==u;d++){const m=o[d];oe.VALUES_TO_ECI.set(m,this)}for(const d of l)oe.NAME_TO_ECI.set(d,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(s){if(s<0||s>=900)throw new $("incorect value");const n=oe.VALUES_TO_ECI.get(s);if(n===void 0)throw new $("incorect value");return n}static getCharacterSetECIByName(s){const n=oe.NAME_TO_ECI.get(s);if(n===void 0)throw new $("incorect value");return n}equals(s){if(!(s instanceof oe))return!1;const n=s;return this.getName()===n.getName()}}oe.VALUE_IDENTIFIER_TO_ECI=new Map,oe.VALUES_TO_ECI=new Map,oe.NAME_TO_ECI=new Map,oe.Cp437=new oe(Re.Cp437,Int32Array.from([0,2]),"Cp437"),oe.ISO8859_1=new oe(Re.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),oe.ISO8859_2=new oe(Re.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),oe.ISO8859_3=new oe(Re.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),oe.ISO8859_4=new oe(Re.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),oe.ISO8859_5=new oe(Re.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),oe.ISO8859_6=new oe(Re.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),oe.ISO8859_7=new oe(Re.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),oe.ISO8859_8=new oe(Re.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),oe.ISO8859_9=new oe(Re.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),oe.ISO8859_10=new oe(Re.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),oe.ISO8859_11=new oe(Re.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),oe.ISO8859_13=new oe(Re.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),oe.ISO8859_14=new oe(Re.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),oe.ISO8859_15=new oe(Re.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),oe.ISO8859_16=new oe(Re.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),oe.SJIS=new oe(Re.SJIS,20,"SJIS","Shift_JIS"),oe.Cp1250=new oe(Re.Cp1250,21,"Cp1250","windows-1250"),oe.Cp1251=new oe(Re.Cp1251,22,"Cp1251","windows-1251"),oe.Cp1252=new oe(Re.Cp1252,23,"Cp1252","windows-1252"),oe.Cp1256=new oe(Re.Cp1256,24,"Cp1256","windows-1256"),oe.UnicodeBigUnmarked=new oe(Re.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),oe.UTF8=new oe(Re.UTF8,26,"UTF8","UTF-8"),oe.ASCII=new oe(Re.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),oe.Big5=new oe(Re.Big5,28,"Big5"),oe.GB18030=new oe(Re.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),oe.EUC_KR=new oe(Re.EUC_KR,30,"EUC_KR","EUC-KR");class Ee extends w{}Ee.kind="UnsupportedOperationException";class me{static decode(s,n){const r=this.encodingName(n);return this.customDecoder?this.customDecoder(s,r):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(r)?this.decodeFallback(s,r):new TextDecoder(r).decode(s)}static shouldDecodeOnFallback(s){return!me.isBrowser()&&s==="ISO-8859-1"}static encode(s,n){const r=this.encodingName(n);return this.customEncoder?this.customEncoder(s,r):typeof TextEncoder>"u"?this.encodeFallback(s):new TextEncoder().encode(s)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(s){return typeof s=="string"?s:s.getName()}static encodingCharacterSet(s){return s instanceof oe?s:oe.getCharacterSetECIByName(s)}static decodeFallback(s,n){const r=this.encodingCharacterSet(n);if(me.isDecodeFallbackSupported(r)){let l="";for(let o=0,d=s.length;o<d;o++){let u=s[o].toString(16);u.length<2&&(u="0"+u),l+="%"+u}return decodeURIComponent(l)}if(r.equals(oe.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(s.buffer));throw new Ee(`Encoding ${this.encodingName(n)} not supported by fallback.`)}static isDecodeFallbackSupported(s){return s.equals(oe.UTF8)||s.equals(oe.ISO8859_1)||s.equals(oe.ASCII)}static encodeFallback(s){const r=btoa(unescape(encodeURIComponent(s))).split(""),l=[];for(let o=0;o<r.length;o++)l.push(r[o].charCodeAt(0));return new Uint8Array(l)}}class ne{static castAsNonUtf8Char(s,n=null){const r=n?n.getName():this.ISO88591;return me.decode(new Uint8Array([s]),r)}static guessEncoding(s,n){if(n!=null&&n.get(ce.CHARACTER_SET)!==void 0)return n.get(ce.CHARACTER_SET).toString();const r=s.length;let l=!0,o=!0,d=!0,u=0,m=0,b=0,S=0,M=0,k=0,X=0,re=0,ie=0,he=0,je=0;const Pe=s.length>3&&s[0]===239&&s[1]===187&&s[2]===191;for(let Le=0;Le<r&&(l||o||d);Le++){const ke=s[Le]&255;d&&(u>0?(ke&128)===0?d=!1:u--:(ke&128)!==0&&((ke&64)===0?d=!1:(u++,(ke&32)===0?m++:(u++,(ke&16)===0?b++:(u++,(ke&8)===0?S++:d=!1))))),l&&(ke>127&&ke<160?l=!1:ke>159&&(ke<192||ke===215||ke===247)&&je++),o&&(M>0?ke<64||ke===127||ke>252?o=!1:M--:ke===128||ke===160||ke>239?o=!1:ke>160&&ke<224?(k++,re=0,X++,X>ie&&(ie=X)):ke>127?(M++,X=0,re++,re>he&&(he=re)):(X=0,re=0))}return d&&u>0&&(d=!1),o&&M>0&&(o=!1),d&&(Pe||m+b+S>0)?ne.UTF8:o&&(ne.ASSUME_SHIFT_JIS||ie>=3||he>=3)?ne.SHIFT_JIS:l&&o?ie===2&&k===2||je*10>=r?ne.SHIFT_JIS:ne.ISO88591:l?ne.ISO88591:o?ne.SHIFT_JIS:d?ne.UTF8:ne.PLATFORM_DEFAULT_ENCODING}static format(s,...n){let r=-1;function l(d,u,m,b,S,M){if(d==="%%")return"%";if(n[++r]===void 0)return;d=b?parseInt(b.substr(1)):void 0;let k=S?parseInt(S.substr(1)):void 0,X;switch(M){case"s":X=n[r];break;case"c":X=n[r][0];break;case"f":X=parseFloat(n[r]).toFixed(d);break;case"p":X=parseFloat(n[r]).toPrecision(d);break;case"e":X=parseFloat(n[r]).toExponential(d);break;case"x":X=parseInt(n[r]).toString(k||16);break;case"d":X=parseFloat(parseInt(n[r],k||10).toPrecision(d)).toFixed(0);break}X=typeof X=="object"?JSON.stringify(X):(+X).toString(k);let re=parseInt(m),ie=m&&m[0]+""=="0"?"0":" ";for(;X.length<re;)X=u!==void 0?X+ie:ie+X;return X}let o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return s.replace(o,l)}static getBytes(s,n){return me.encode(s,n)}static getCharCode(s,n=0){return s.charCodeAt(n)}static getCharAt(s){return String.fromCharCode(s)}}ne.SHIFT_JIS=oe.SJIS.getName(),ne.GB2312="GB2312",ne.ISO88591=oe.ISO8859_1.getName(),ne.EUC_JP="EUC_JP",ne.UTF8=oe.UTF8.getName(),ne.PLATFORM_DEFAULT_ENCODING=ne.UTF8,ne.ASSUME_SHIFT_JIS=!1;class J{constructor(s=""){this.value=s}enableDecoding(s){return this.encoding=s,this}append(s){return typeof s=="string"?this.value+=s.toString():this.encoding?this.value+=ne.castAsNonUtf8Char(s,this.encoding):this.value+=String.fromCharCode(s),this}appendChars(s,n,r){for(let l=n;n<n+r;l++)this.append(s[l]);return this}length(){return this.value.length}charAt(s){return this.value.charAt(s)}deleteCharAt(s){this.value=this.value.substr(0,s)+this.value.substring(s+1)}setCharAt(s,n){this.value=this.value.substr(0,s)+n+this.value.substr(s+1)}substring(s,n){return this.value.substring(s,n)}setLengthToZero(){this.value=""}toString(){return this.value}insert(s,n){this.value=this.value.substr(0,s)+n+this.value.substr(s+n.length)}}class ae{constructor(s,n,r,l){if(this.width=s,this.height=n,this.rowSize=r,this.bits=l,n==null&&(n=s),this.height=n,s<1||n<1)throw new O("Both dimensions must be greater than 0");r==null&&(r=Math.floor((s+31)/32)),this.rowSize=r,l==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(s){const n=s.length,r=s[0].length,l=new ae(r,n);for(let o=0;o<n;o++){const d=s[o];for(let u=0;u<r;u++)d[u]&&l.set(u,o)}return l}static parseFromString(s,n,r){if(s===null)throw new O("stringRepresentation cannot be null");const l=new Array(s.length);let o=0,d=0,u=-1,m=0,b=0;for(;b<s.length;)if(s.charAt(b)===`
`||s.charAt(b)==="\r"){if(o>d){if(u===-1)u=o-d;else if(o-d!==u)throw new O("row lengths do not match");d=o,m++}b++}else if(s.substring(b,b+n.length)===n)b+=n.length,l[o]=!0,o++;else if(s.substring(b,b+r.length)===r)b+=r.length,l[o]=!1,o++;else throw new O("illegal character encountered: "+s.substring(b));if(o>d){if(u===-1)u=o-d;else if(o-d!==u)throw new O("row lengths do not match");m++}const S=new ae(u,m);for(let M=0;M<o;M++)l[M]&&S.set(Math.floor(M%u),Math.floor(M/u));return S}get(s,n){const r=n*this.rowSize+Math.floor(s/32);return(this.bits[r]>>>(s&31)&1)!==0}set(s,n){const r=n*this.rowSize+Math.floor(s/32);this.bits[r]|=1<<(s&31)&4294967295}unset(s,n){const r=n*this.rowSize+Math.floor(s/32);this.bits[r]&=~(1<<(s&31)&4294967295)}flip(s,n){const r=n*this.rowSize+Math.floor(s/32);this.bits[r]^=1<<(s&31)&4294967295}xor(s){if(this.width!==s.getWidth()||this.height!==s.getHeight()||this.rowSize!==s.getRowSize())throw new O("input matrix dimensions do not match");const n=new q(Math.floor(this.width/32)+1),r=this.rowSize,l=this.bits;for(let o=0,d=this.height;o<d;o++){const u=o*r,m=s.getRow(o,n).getBitArray();for(let b=0;b<r;b++)l[u+b]^=m[b]}}clear(){const s=this.bits,n=s.length;for(let r=0;r<n;r++)s[r]=0}setRegion(s,n,r,l){if(n<0||s<0)throw new O("Left and top must be nonnegative");if(l<1||r<1)throw new O("Height and width must be at least 1");const o=s+r,d=n+l;if(d>this.height||o>this.width)throw new O("The region must fit inside the matrix");const u=this.rowSize,m=this.bits;for(let b=n;b<d;b++){const S=b*u;for(let M=s;M<o;M++)m[S+Math.floor(M/32)]|=1<<(M&31)&4294967295}}getRow(s,n){n==null||n.getSize()<this.width?n=new q(this.width):n.clear();const r=this.rowSize,l=this.bits,o=s*r;for(let d=0;d<r;d++)n.setBulk(d*32,l[o+d]);return n}setRow(s,n){V.arraycopy(n.getBitArray(),0,this.bits,s*this.rowSize,this.rowSize)}rotate180(){const s=this.getWidth(),n=this.getHeight();let r=new q(s),l=new q(s);for(let o=0,d=Math.floor((n+1)/2);o<d;o++)r=this.getRow(o,r),l=this.getRow(n-1-o,l),r.reverse(),l.reverse(),this.setRow(o,l),this.setRow(n-1-o,r)}getEnclosingRectangle(){const s=this.width,n=this.height,r=this.rowSize,l=this.bits;let o=s,d=n,u=-1,m=-1;for(let b=0;b<n;b++)for(let S=0;S<r;S++){const M=l[b*r+S];if(M!==0){if(b<d&&(d=b),b>m&&(m=b),S*32<o){let k=0;for(;(M<<31-k&4294967295)===0;)k++;S*32+k<o&&(o=S*32+k)}if(S*32+31>u){let k=31;for(;!(M>>>k);)k--;S*32+k>u&&(u=S*32+k)}}}return u<o||m<d?null:Int32Array.from([o,d,u-o+1,m-d+1])}getTopLeftOnBit(){const s=this.rowSize,n=this.bits;let r=0;for(;r<n.length&&n[r]===0;)r++;if(r===n.length)return null;const l=r/s;let o=r%s*32;const d=n[r];let u=0;for(;(d<<31-u&4294967295)===0;)u++;return o+=u,Int32Array.from([o,l])}getBottomRightOnBit(){const s=this.rowSize,n=this.bits;let r=n.length-1;for(;r>=0&&n[r]===0;)r--;if(r<0)return null;const l=Math.floor(r/s);let o=Math.floor(r%s)*32;const d=n[r];let u=31;for(;!(d>>>u);)u--;return o+=u,Int32Array.from([o,l])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(s){if(!(s instanceof ae))return!1;const n=s;return this.width===n.width&&this.height===n.height&&this.rowSize===n.rowSize&&K.equals(this.bits,n.bits)}hashCode(){let s=this.width;return s=31*s+this.width,s=31*s+this.height,s=31*s+this.rowSize,s=31*s+K.hashCode(this.bits),s}toString(s="X ",n="  ",r=`
`){return this.buildToString(s,n,r)}buildToString(s,n,r){let l=new J;for(let o=0,d=this.height;o<d;o++){for(let u=0,m=this.width;u<m;u++)l.append(this.get(u,o)?s:n);l.append(r)}return l.toString()}clone(){return new ae(this.width,this.height,this.rowSize,this.bits.slice())}}class F extends w{static getNotFoundInstance(){return new F}}F.kind="NotFoundException";class W extends P{constructor(s){super(s),this.luminances=W.EMPTY,this.buckets=new Int32Array(W.LUMINANCE_BUCKETS)}getBlackRow(s,n){const r=this.getLuminanceSource(),l=r.getWidth();n==null||n.getSize()<l?n=new q(l):n.clear(),this.initArrays(l);const o=r.getRow(s,this.luminances),d=this.buckets;for(let m=0;m<l;m++)d[(o[m]&255)>>W.LUMINANCE_SHIFT]++;const u=W.estimateBlackPoint(d);if(l<3)for(let m=0;m<l;m++)(o[m]&255)<u&&n.set(m);else{let m=o[0]&255,b=o[1]&255;for(let S=1;S<l-1;S++){const M=o[S+1]&255;(b*4-m-M)/2<u&&n.set(S),m=b,b=M}}return n}getBlackMatrix(){const s=this.getLuminanceSource(),n=s.getWidth(),r=s.getHeight(),l=new ae(n,r);this.initArrays(n);const o=this.buckets;for(let m=1;m<5;m++){const b=Math.floor(r*m/5),S=s.getRow(b,this.luminances),M=Math.floor(n*4/5);for(let k=Math.floor(n/5);k<M;k++){const X=S[k]&255;o[X>>W.LUMINANCE_SHIFT]++}}const d=W.estimateBlackPoint(o),u=s.getMatrix();for(let m=0;m<r;m++){const b=m*n;for(let S=0;S<n;S++)(u[b+S]&255)<d&&l.set(S,m)}return l}createBinarizer(s){return new W(s)}initArrays(s){this.luminances.length<s&&(this.luminances=new Uint8ClampedArray(s));const n=this.buckets;for(let r=0;r<W.LUMINANCE_BUCKETS;r++)n[r]=0}static estimateBlackPoint(s){const n=s.length;let r=0,l=0,o=0;for(let S=0;S<n;S++)s[S]>o&&(l=S,o=s[S]),s[S]>r&&(r=s[S]);let d=0,u=0;for(let S=0;S<n;S++){const M=S-l,k=s[S]*M*M;k>u&&(d=S,u=k)}if(l>d){const S=l;l=d,d=S}if(d-l<=n/16)throw new F;let m=d-1,b=-1;for(let S=d-1;S>l;S--){const M=S-l,k=M*M*(d-S)*(r-s[S]);k>b&&(m=S,b=k)}return m<<W.LUMINANCE_SHIFT}}W.LUMINANCE_BITS=5,W.LUMINANCE_SHIFT=8-W.LUMINANCE_BITS,W.LUMINANCE_BUCKETS=1<<W.LUMINANCE_BITS,W.EMPTY=Uint8ClampedArray.from([0]);class Q extends W{constructor(s){super(s),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const s=this.getLuminanceSource(),n=s.getWidth(),r=s.getHeight();if(n>=Q.MINIMUM_DIMENSION&&r>=Q.MINIMUM_DIMENSION){const l=s.getMatrix();let o=n>>Q.BLOCK_SIZE_POWER;(n&Q.BLOCK_SIZE_MASK)!==0&&o++;let d=r>>Q.BLOCK_SIZE_POWER;(r&Q.BLOCK_SIZE_MASK)!==0&&d++;const u=Q.calculateBlackPoints(l,o,d,n,r),m=new ae(n,r);Q.calculateThresholdForBlock(l,o,d,n,r,u,m),this.matrix=m}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(s){return new Q(s)}static calculateThresholdForBlock(s,n,r,l,o,d,u){const m=o-Q.BLOCK_SIZE,b=l-Q.BLOCK_SIZE;for(let S=0;S<r;S++){let M=S<<Q.BLOCK_SIZE_POWER;M>m&&(M=m);const k=Q.cap(S,2,r-3);for(let X=0;X<n;X++){let re=X<<Q.BLOCK_SIZE_POWER;re>b&&(re=b);const ie=Q.cap(X,2,n-3);let he=0;for(let Pe=-2;Pe<=2;Pe++){const Le=d[k+Pe];he+=Le[ie-2]+Le[ie-1]+Le[ie]+Le[ie+1]+Le[ie+2]}const je=he/25;Q.thresholdBlock(s,re,M,je,l,u)}}}static cap(s,n,r){return s<n?n:s>r?r:s}static thresholdBlock(s,n,r,l,o,d){for(let u=0,m=r*o+n;u<Q.BLOCK_SIZE;u++,m+=o)for(let b=0;b<Q.BLOCK_SIZE;b++)(s[m+b]&255)<=l&&d.set(n+b,r+u)}static calculateBlackPoints(s,n,r,l,o){const d=o-Q.BLOCK_SIZE,u=l-Q.BLOCK_SIZE,m=new Array(r);for(let b=0;b<r;b++){m[b]=new Int32Array(n);let S=b<<Q.BLOCK_SIZE_POWER;S>d&&(S=d);for(let M=0;M<n;M++){let k=M<<Q.BLOCK_SIZE_POWER;k>u&&(k=u);let X=0,re=255,ie=0;for(let je=0,Pe=S*l+k;je<Q.BLOCK_SIZE;je++,Pe+=l){for(let Le=0;Le<Q.BLOCK_SIZE;Le++){const ke=s[Pe+Le]&255;X+=ke,ke<re&&(re=ke),ke>ie&&(ie=ke)}if(ie-re>Q.MIN_DYNAMIC_RANGE)for(je++,Pe+=l;je<Q.BLOCK_SIZE;je++,Pe+=l)for(let Le=0;Le<Q.BLOCK_SIZE;Le++)X+=s[Pe+Le]&255}let he=X>>Q.BLOCK_SIZE_POWER*2;if(ie-re<=Q.MIN_DYNAMIC_RANGE&&(he=re/2,b>0&&M>0)){const je=(m[b-1][M]+2*m[b][M-1]+m[b-1][M-1])/4;re<je&&(he=je)}m[b][M]=he}}return m}}Q.BLOCK_SIZE_POWER=3,Q.BLOCK_SIZE=1<<Q.BLOCK_SIZE_POWER,Q.BLOCK_SIZE_MASK=Q.BLOCK_SIZE-1,Q.MINIMUM_DIMENSION=Q.BLOCK_SIZE*5,Q.MIN_DYNAMIC_RANGE=24;class Ne{constructor(s,n){this.width=s,this.height=n}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(s,n,r,l){throw new Ee("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Ee("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Ee("This luminance source does not support rotation by 45 degrees.")}toString(){const s=new Uint8ClampedArray(this.width);let n=new J;for(let r=0;r<this.height;r++){const l=this.getRow(r,s);for(let o=0;o<this.width;o++){const d=l[o]&255;let u;d<64?u="#":d<128?u="+":d<192?u=".":u=" ",n.append(u)}n.append(`
`)}return n.toString()}}class Se extends Ne{constructor(s){super(s.getWidth(),s.getHeight()),this.delegate=s}getRow(s,n){const r=this.delegate.getRow(s,n),l=this.getWidth();for(let o=0;o<l;o++)r[o]=255-(r[o]&255);return r}getMatrix(){const s=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),r=new Uint8ClampedArray(n);for(let l=0;l<n;l++)r[l]=255-(s[l]&255);return r}isCropSupported(){return this.delegate.isCropSupported()}crop(s,n,r,l){return new Se(this.delegate.crop(s,n,r,l))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new Se(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new Se(this.delegate.rotateCounterClockwise45())}}class fe extends Ne{constructor(s){super(s.width,s.height),this.canvas=s,this.tempCanvasElement=null,this.buffer=fe.makeBufferFromCanvasImageData(s)}static makeBufferFromCanvasImageData(s){const n=s.getContext("2d").getImageData(0,0,s.width,s.height);return fe.toGrayscaleBuffer(n.data,s.width,s.height)}static toGrayscaleBuffer(s,n,r){const l=new Uint8ClampedArray(n*r);for(let o=0,d=0,u=s.length;o<u;o+=4,d++){let m;if(s[o+3]===0)m=255;else{const S=s[o],M=s[o+1],k=s[o+2];m=306*S+601*M+117*k+512>>10}l[d]=m}return l}getRow(s,n){if(s<0||s>=this.getHeight())throw new O("Requested row is outside the image: "+s);const r=this.getWidth(),l=s*r;return n===null?n=this.buffer.slice(l,l+r):(n.length<r&&(n=new Uint8ClampedArray(r)),n.set(this.buffer.slice(l,l+r))),n}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(s,n,r,l){return super.crop(s,n,r,l),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const s=this.canvas.ownerDocument.createElement("canvas");s.width=this.canvas.width,s.height=this.canvas.height,this.tempCanvasElement=s}return this.tempCanvasElement}rotate(s){const n=this.getTempCanvasElement(),r=n.getContext("2d"),l=s*fe.DEGREE_TO_RADIANS,o=this.canvas.width,d=this.canvas.height,u=Math.ceil(Math.abs(Math.cos(l))*o+Math.abs(Math.sin(l))*d),m=Math.ceil(Math.abs(Math.sin(l))*o+Math.abs(Math.cos(l))*d);return n.width=u,n.height=m,r.translate(u/2,m/2),r.rotate(l),r.drawImage(this.canvas,o/-2,d/-2),this.buffer=fe.makeBufferFromCanvasImageData(n),this}invert(){return new Se(this)}}fe.DEGREE_TO_RADIANS=Math.PI/180;class E{constructor(s,n,r){this.deviceId=s,this.label=n,this.kind="videoinput",this.groupId=r||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var G=(globalThis||Nc||self||window||void 0)&&(globalThis||Nc||self||window||void 0).__awaiter||function(I,s,n,r){function l(o){return o instanceof n?o:new n(function(d){d(o)})}return new(n||(n=Promise))(function(o,d){function u(S){try{b(r.next(S))}catch(M){d(M)}}function m(S){try{b(r.throw(S))}catch(M){d(M)}}function b(S){S.done?o(S.value):l(S.value).then(u,m)}b((r=r.apply(I,s||[])).next())})};class U{constructor(s,n=500,r){this.reader=s,this.timeBetweenScansMillis=n,this._hints=r,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(s){this._timeBetweenDecodingAttempts=s<0?0:s}set hints(s){this._hints=s||null}get hints(){return this._hints}listVideoInputDevices(){return G(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const s=yield navigator.mediaDevices.enumerateDevices(),n=[];for(const r of s){const l=r.kind==="video"?"videoinput":r.kind;if(l!=="videoinput")continue;const o=r.deviceId||r.id,d=r.label||`Video device ${n.length+1}`,u=r.groupId,m={deviceId:o,label:d,kind:l,groupId:u};n.push(m)}return n})}getVideoInputDevices(){return G(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(n=>new E(n.deviceId,n.label))})}findDeviceById(s){return G(this,void 0,void 0,function*(){const n=yield this.listVideoInputDevices();return n?n.find(r=>r.deviceId===s):null})}decodeFromInputVideoDevice(s,n){return G(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(s,n)})}decodeOnceFromVideoDevice(s,n){return G(this,void 0,void 0,function*(){this.reset();let r;s?r={deviceId:{exact:s}}:r={facingMode:"environment"};const l={video:r};return yield this.decodeOnceFromConstraints(l,n)})}decodeOnceFromConstraints(s,n){return G(this,void 0,void 0,function*(){const r=yield navigator.mediaDevices.getUserMedia(s);return yield this.decodeOnceFromStream(r,n)})}decodeOnceFromStream(s,n){return G(this,void 0,void 0,function*(){this.reset();const r=yield this.attachStreamToVideo(s,n);return yield this.decodeOnce(r)})}decodeFromInputVideoDeviceContinuously(s,n,r){return G(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(s,n,r)})}decodeFromVideoDevice(s,n,r){return G(this,void 0,void 0,function*(){let l;s?l={deviceId:{exact:s}}:l={facingMode:"environment"};const o={video:l};return yield this.decodeFromConstraints(o,n,r)})}decodeFromConstraints(s,n,r){return G(this,void 0,void 0,function*(){const l=yield navigator.mediaDevices.getUserMedia(s);return yield this.decodeFromStream(l,n,r)})}decodeFromStream(s,n,r){return G(this,void 0,void 0,function*(){this.reset();const l=yield this.attachStreamToVideo(s,n);return yield this.decodeContinuously(l,r)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(s,n){return G(this,void 0,void 0,function*(){const r=this.prepareVideoElement(n);return this.addVideoSource(r,s),this.videoElement=r,this.stream=s,yield this.playVideoOnLoadAsync(r),r})}playVideoOnLoadAsync(s){return new Promise((n,r)=>this.playVideoOnLoad(s,()=>n()))}playVideoOnLoad(s,n){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(s),s.addEventListener("ended",this.videoEndedListener),s.addEventListener("canplay",this.videoCanPlayListener),s.addEventListener("playing",n),this.tryPlayVideo(s)}isVideoPlaying(s){return s.currentTime>0&&!s.paused&&!s.ended&&s.readyState>2}tryPlayVideo(s){return G(this,void 0,void 0,function*(){if(this.isVideoPlaying(s)){console.warn("Trying to play video that is already playing.");return}try{yield s.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(s,n){const r=document.getElementById(s);if(!r)throw new C(`element with id '${s}' not found`);if(r.nodeName.toLowerCase()!==n.toLowerCase())throw new C(`element with id '${s}' must be an ${n} element`);return r}decodeFromImage(s,n){if(!s&&!n)throw new C("either imageElement with a src set or an url must be provided");return n&&!s?this.decodeFromImageUrl(n):this.decodeFromImageElement(s)}decodeFromVideo(s,n){if(!s&&!n)throw new C("Either an element with a src set or an URL must be provided");return n&&!s?this.decodeFromVideoUrl(n):this.decodeFromVideoElement(s)}decodeFromVideoContinuously(s,n,r){if(s===void 0&&n===void 0)throw new C("Either an element with a src set or an URL must be provided");return n&&!s?this.decodeFromVideoUrlContinuously(n,r):this.decodeFromVideoElementContinuously(s,r)}decodeFromImageElement(s){if(!s)throw new C("An image element must be provided.");this.reset();const n=this.prepareImageElement(s);this.imageElement=n;let r;return this.isImageLoaded(n)?r=this.decodeOnce(n,!1,!0):r=this._decodeOnLoadImage(n),r}decodeFromVideoElement(s){const n=this._decodeFromVideoElementSetup(s);return this._decodeOnLoadVideo(n)}decodeFromVideoElementContinuously(s,n){const r=this._decodeFromVideoElementSetup(s);return this._decodeOnLoadVideoContinuously(r,n)}_decodeFromVideoElementSetup(s){if(!s)throw new C("A video element must be provided.");this.reset();const n=this.prepareVideoElement(s);return this.videoElement=n,n}decodeFromImageUrl(s){if(!s)throw new C("An URL must be provided.");this.reset();const n=this.prepareImageElement();this.imageElement=n;const r=this._decodeOnLoadImage(n);return n.src=s,r}decodeFromVideoUrl(s){if(!s)throw new C("An URL must be provided.");this.reset();const n=this.prepareVideoElement(),r=this.decodeFromVideoElement(n);return n.src=s,r}decodeFromVideoUrlContinuously(s,n){if(!s)throw new C("An URL must be provided.");this.reset();const r=this.prepareVideoElement(),l=this.decodeFromVideoElementContinuously(r,n);return r.src=s,l}_decodeOnLoadImage(s){return new Promise((n,r)=>{this.imageLoadedListener=()=>this.decodeOnce(s,!1,!0).then(n,r),s.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(s){return G(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(s),yield this.decodeOnce(s)})}_decodeOnLoadVideoContinuously(s,n){return G(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(s),this.decodeContinuously(s,n)})}isImageLoaded(s){return!(!s.complete||s.naturalWidth===0)}prepareImageElement(s){let n;return typeof s>"u"&&(n=document.createElement("img"),n.width=200,n.height=200),typeof s=="string"&&(n=this.getMediaElement(s,"img")),s instanceof HTMLImageElement&&(n=s),n}prepareVideoElement(s){let n;return!s&&typeof document<"u"&&(n=document.createElement("video"),n.width=200,n.height=200),typeof s=="string"&&(n=this.getMediaElement(s,"video")),s instanceof HTMLVideoElement&&(n=s),n.setAttribute("autoplay","true"),n.setAttribute("muted","true"),n.setAttribute("playsinline","true"),n}decodeOnce(s,n=!0,r=!0){this._stopAsyncDecode=!1;const l=(o,d)=>{if(this._stopAsyncDecode){d(new F("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const u=this.decode(s);o(u)}catch(u){const m=n&&u instanceof F,S=(u instanceof L||u instanceof $)&&r;if(m||S)return setTimeout(l,this._timeBetweenDecodingAttempts,o,d);d(u)}};return new Promise((o,d)=>l(o,d))}decodeContinuously(s,n){this._stopContinuousDecode=!1;const r=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const l=this.decode(s);n(l,null),setTimeout(r,this.timeBetweenScansMillis)}catch(l){n(null,l);const o=l instanceof L||l instanceof $,d=l instanceof F;(o||d)&&setTimeout(r,this._timeBetweenDecodingAttempts)}};r()}decode(s){const n=this.createBinaryBitmap(s);return this.decodeBitmap(n)}_isHTMLVideoElement(s){return s.videoWidth!==0}drawFrameOnCanvas(s,n,r){n||(n={sx:0,sy:0,sWidth:s.videoWidth,sHeight:s.videoHeight,dx:0,dy:0,dWidth:s.videoWidth,dHeight:s.videoHeight}),r||(r=this.captureCanvasContext),r.drawImage(s,n.sx,n.sy,n.sWidth,n.sHeight,n.dx,n.dy,n.dWidth,n.dHeight)}drawImageOnCanvas(s,n,r=this.captureCanvasContext){n||(n={sx:0,sy:0,sWidth:s.naturalWidth,sHeight:s.naturalHeight,dx:0,dy:0,dWidth:s.naturalWidth,dHeight:s.naturalHeight}),r||(r=this.captureCanvasContext),r.drawImage(s,n.sx,n.sy,n.sWidth,n.sHeight,n.dx,n.dy,n.dWidth,n.dHeight)}createBinaryBitmap(s){this.getCaptureCanvasContext(s),this._isHTMLVideoElement(s)?this.drawFrameOnCanvas(s):this.drawImageOnCanvas(s);const n=this.getCaptureCanvas(s),r=new fe(n),l=new Q(r);return new _(l)}getCaptureCanvasContext(s){if(!this.captureCanvasContext){const r=this.getCaptureCanvas(s).getContext("2d");this.captureCanvasContext=r}return this.captureCanvasContext}getCaptureCanvas(s){if(!this.captureCanvas){const n=this.createCaptureCanvas(s);this.captureCanvas=n}return this.captureCanvas}decodeBitmap(s){return this.reader.decode(s,this._hints)}createCaptureCanvas(s){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const n=document.createElement("canvas");let r,l;return typeof s<"u"&&(s instanceof HTMLVideoElement?(r=s.videoWidth,l=s.videoHeight):s instanceof HTMLImageElement&&(r=s.naturalWidth||s.width,l=s.naturalHeight||s.height)),n.style.width=r+"px",n.style.height=l+"px",n.width=r,n.height=l,n}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(s=>s.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(s,n){try{s.srcObject=n}catch{s.src=URL.createObjectURL(n)}}cleanVideoSource(s){try{s.srcObject=null}catch{s.src=""}this.videoElement.removeAttribute("src")}}class Z{constructor(s,n,r=n==null?0:8*n.length,l,o,d=V.currentTimeMillis()){this.text=s,this.rawBytes=n,this.numBits=r,this.resultPoints=l,this.format=o,this.timestamp=d,this.text=s,this.rawBytes=n,r==null?this.numBits=n==null?0:8*n.length:this.numBits=r,this.resultPoints=l,this.format=o,this.resultMetadata=null,d==null?this.timestamp=V.currentTimeMillis():this.timestamp=d}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(s,n){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(s,n)}putAllMetadata(s){s!==null&&(this.resultMetadata===null?this.resultMetadata=s:this.resultMetadata=new Map(s))}addResultPoints(s){const n=this.resultPoints;if(n===null)this.resultPoints=s;else if(s!==null&&s.length>0){const r=new Array(n.length+s.length);V.arraycopy(n,0,r,0,n.length),V.arraycopy(s,0,r,n.length,s.length),this.resultPoints=r}}getTimestamp(){return this.timestamp}toString(){return this.text}}var we;(function(I){I[I.AZTEC=0]="AZTEC",I[I.CODABAR=1]="CODABAR",I[I.CODE_39=2]="CODE_39",I[I.CODE_93=3]="CODE_93",I[I.CODE_128=4]="CODE_128",I[I.DATA_MATRIX=5]="DATA_MATRIX",I[I.EAN_8=6]="EAN_8",I[I.EAN_13=7]="EAN_13",I[I.ITF=8]="ITF",I[I.MAXICODE=9]="MAXICODE",I[I.PDF_417=10]="PDF_417",I[I.QR_CODE=11]="QR_CODE",I[I.RSS_14=12]="RSS_14",I[I.RSS_EXPANDED=13]="RSS_EXPANDED",I[I.UPC_A=14]="UPC_A",I[I.UPC_E=15]="UPC_E",I[I.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(we||(we={}));var xe=we,Ge;(function(I){I[I.OTHER=0]="OTHER",I[I.ORIENTATION=1]="ORIENTATION",I[I.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",I[I.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",I[I.ISSUE_NUMBER=4]="ISSUE_NUMBER",I[I.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",I[I.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",I[I.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",I[I.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",I[I.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",I[I.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Ge||(Ge={}));var Ve=Ge;class Je{constructor(s,n,r,l,o=-1,d=-1){this.rawBytes=s,this.text=n,this.byteSegments=r,this.ecLevel=l,this.structuredAppendSequenceNumber=o,this.structuredAppendParity=d,this.numBits=s==null?0:8*s.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(s){this.numBits=s}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(s){this.errorsCorrected=s}getErasures(){return this.erasures}setErasures(s){this.erasures=s}getOther(){return this.other}setOther(s){this.other=s}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class jt{exp(s){return this.expTable[s]}log(s){if(s===0)throw new O;return this.logTable[s]}static addOrSubtract(s,n){return s^n}}class Be{constructor(s,n){if(n.length===0)throw new O;this.field=s;const r=n.length;if(r>1&&n[0]===0){let l=1;for(;l<r&&n[l]===0;)l++;l===r?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(r-l),V.arraycopy(n,l,this.coefficients,0,this.coefficients.length))}else this.coefficients=n}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(s){return this.coefficients[this.coefficients.length-1-s]}evaluateAt(s){if(s===0)return this.getCoefficient(0);const n=this.coefficients;let r;if(s===1){r=0;for(let d=0,u=n.length;d!==u;d++){const m=n[d];r=jt.addOrSubtract(r,m)}return r}r=n[0];const l=n.length,o=this.field;for(let d=1;d<l;d++)r=jt.addOrSubtract(o.multiply(s,r),n[d]);return r}addOrSubtract(s){if(!this.field.equals(s.field))throw new O("GenericGFPolys do not have same GenericGF field");if(this.isZero())return s;if(s.isZero())return this;let n=this.coefficients,r=s.coefficients;if(n.length>r.length){const d=n;n=r,r=d}let l=new Int32Array(r.length);const o=r.length-n.length;V.arraycopy(r,0,l,0,o);for(let d=o;d<r.length;d++)l[d]=jt.addOrSubtract(n[d-o],r[d]);return new Be(this.field,l)}multiply(s){if(!this.field.equals(s.field))throw new O("GenericGFPolys do not have same GenericGF field");if(this.isZero()||s.isZero())return this.field.getZero();const n=this.coefficients,r=n.length,l=s.coefficients,o=l.length,d=new Int32Array(r+o-1),u=this.field;for(let m=0;m<r;m++){const b=n[m];for(let S=0;S<o;S++)d[m+S]=jt.addOrSubtract(d[m+S],u.multiply(b,l[S]))}return new Be(u,d)}multiplyScalar(s){if(s===0)return this.field.getZero();if(s===1)return this;const n=this.coefficients.length,r=this.field,l=new Int32Array(n),o=this.coefficients;for(let d=0;d<n;d++)l[d]=r.multiply(o[d],s);return new Be(r,l)}multiplyByMonomial(s,n){if(s<0)throw new O;if(n===0)return this.field.getZero();const r=this.coefficients,l=r.length,o=new Int32Array(l+s),d=this.field;for(let u=0;u<l;u++)o[u]=d.multiply(r[u],n);return new Be(d,o)}divide(s){if(!this.field.equals(s.field))throw new O("GenericGFPolys do not have same GenericGF field");if(s.isZero())throw new O("Divide by 0");const n=this.field;let r=n.getZero(),l=this;const o=s.getCoefficient(s.getDegree()),d=n.inverse(o);for(;l.getDegree()>=s.getDegree()&&!l.isZero();){const u=l.getDegree()-s.getDegree(),m=n.multiply(l.getCoefficient(l.getDegree()),d),b=s.multiplyByMonomial(u,m),S=n.buildMonomial(u,m);r=r.addOrSubtract(S),l=l.addOrSubtract(b)}return[r,l]}toString(){let s="";for(let n=this.getDegree();n>=0;n--){let r=this.getCoefficient(n);if(r!==0){if(r<0?(s+=" - ",r=-r):s.length>0&&(s+=" + "),n===0||r!==1){const l=this.field.log(r);l===0?s+="1":l===1?s+="a":(s+="a^",s+=l)}n!==0&&(n===1?s+="x":(s+="x^",s+=n))}}return s}}class lt extends w{}lt.kind="ArithmeticException";class Ke extends jt{constructor(s,n,r){super(),this.primitive=s,this.size=n,this.generatorBase=r;const l=new Int32Array(n);let o=1;for(let u=0;u<n;u++)l[u]=o,o*=2,o>=n&&(o^=s,o&=n-1);this.expTable=l;const d=new Int32Array(n);for(let u=0;u<n-1;u++)d[l[u]]=u;this.logTable=d,this.zero=new Be(this,Int32Array.from([0])),this.one=new Be(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(s,n){if(s<0)throw new O;if(n===0)return this.zero;const r=new Int32Array(s+1);return r[0]=n,new Be(this,r)}inverse(s){if(s===0)throw new lt;return this.expTable[this.size-this.logTable[s]-1]}multiply(s,n){return s===0||n===0?0:this.expTable[(this.logTable[s]+this.logTable[n])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+H.toHexString(this.primitive)+","+this.size+")"}equals(s){return s===this}}Ke.AZTEC_DATA_12=new Ke(4201,4096,1),Ke.AZTEC_DATA_10=new Ke(1033,1024,1),Ke.AZTEC_DATA_6=new Ke(67,64,1),Ke.AZTEC_PARAM=new Ke(19,16,1),Ke.QR_CODE_FIELD_256=new Ke(285,256,0),Ke.DATA_MATRIX_FIELD_256=new Ke(301,256,1),Ke.AZTEC_DATA_8=Ke.DATA_MATRIX_FIELD_256,Ke.MAXICODE_FIELD_64=Ke.AZTEC_DATA_6;class ft extends w{}ft.kind="ReedSolomonException";class Oe extends w{}Oe.kind="IllegalStateException";class mt{constructor(s){this.field=s}decode(s,n){const r=this.field,l=new Be(r,s),o=new Int32Array(n);let d=!0;for(let X=0;X<n;X++){const re=l.evaluateAt(r.exp(X+r.getGeneratorBase()));o[o.length-1-X]=re,re!==0&&(d=!1)}if(d)return;const u=new Be(r,o),m=this.runEuclideanAlgorithm(r.buildMonomial(n,1),u,n),b=m[0],S=m[1],M=this.findErrorLocations(b),k=this.findErrorMagnitudes(S,M);for(let X=0;X<M.length;X++){const re=s.length-1-r.log(M[X]);if(re<0)throw new ft("Bad error location");s[re]=Ke.addOrSubtract(s[re],k[X])}}runEuclideanAlgorithm(s,n,r){if(s.getDegree()<n.getDegree()){const X=s;s=n,n=X}const l=this.field;let o=s,d=n,u=l.getZero(),m=l.getOne();for(;d.getDegree()>=(r/2|0);){let X=o,re=u;if(o=d,u=m,o.isZero())throw new ft("r_{i-1} was zero");d=X;let ie=l.getZero();const he=o.getCoefficient(o.getDegree()),je=l.inverse(he);for(;d.getDegree()>=o.getDegree()&&!d.isZero();){const Pe=d.getDegree()-o.getDegree(),Le=l.multiply(d.getCoefficient(d.getDegree()),je);ie=ie.addOrSubtract(l.buildMonomial(Pe,Le)),d=d.addOrSubtract(o.multiplyByMonomial(Pe,Le))}if(m=ie.multiply(u).addOrSubtract(re),d.getDegree()>=o.getDegree())throw new Oe("Division algorithm failed to reduce polynomial?")}const b=m.getCoefficient(0);if(b===0)throw new ft("sigmaTilde(0) was zero");const S=l.inverse(b),M=m.multiplyScalar(S),k=d.multiplyScalar(S);return[M,k]}findErrorLocations(s){const n=s.getDegree();if(n===1)return Int32Array.from([s.getCoefficient(1)]);const r=new Int32Array(n);let l=0;const o=this.field;for(let d=1;d<o.getSize()&&l<n;d++)s.evaluateAt(d)===0&&(r[l]=o.inverse(d),l++);if(l!==n)throw new ft("Error locator degree does not match number of roots");return r}findErrorMagnitudes(s,n){const r=n.length,l=new Int32Array(r),o=this.field;for(let d=0;d<r;d++){const u=o.inverse(n[d]);let m=1;for(let b=0;b<r;b++)if(d!==b){const S=o.multiply(n[b],u),M=(S&1)===0?S|1:S&-2;m=o.multiply(m,M)}l[d]=o.multiply(s.evaluateAt(u),o.inverse(m)),o.getGeneratorBase()!==0&&(l[d]=o.multiply(l[d],u))}return l}}var yt;(function(I){I[I.UPPER=0]="UPPER",I[I.LOWER=1]="LOWER",I[I.MIXED=2]="MIXED",I[I.DIGIT=3]="DIGIT",I[I.PUNCT=4]="PUNCT",I[I.BINARY=5]="BINARY"})(yt||(yt={}));class Ze{decode(s){this.ddata=s;let n=s.getBits(),r=this.extractBits(n),l=this.correctBits(r),o=Ze.convertBoolArrayToByteArray(l),d=Ze.getEncodedData(l),u=new Je(o,d,null,null);return u.setNumBits(l.length),u}static highLevelDecode(s){return this.getEncodedData(s)}static getEncodedData(s){let n=s.length,r=yt.UPPER,l=yt.UPPER,o="",d=0;for(;d<n;)if(l===yt.BINARY){if(n-d<5)break;let u=Ze.readCode(s,d,5);if(d+=5,u===0){if(n-d<11)break;u=Ze.readCode(s,d,11)+31,d+=11}for(let m=0;m<u;m++){if(n-d<8){d=n;break}const b=Ze.readCode(s,d,8);o+=ne.castAsNonUtf8Char(b),d+=8}l=r}else{let u=l===yt.DIGIT?4:5;if(n-d<u)break;let m=Ze.readCode(s,d,u);d+=u;let b=Ze.getCharacter(l,m);b.startsWith("CTRL_")?(r=l,l=Ze.getTable(b.charAt(5)),b.charAt(6)==="L"&&(r=l)):(o+=b,l=r)}return o}static getTable(s){switch(s){case"L":return yt.LOWER;case"P":return yt.PUNCT;case"M":return yt.MIXED;case"D":return yt.DIGIT;case"B":return yt.BINARY;case"U":default:return yt.UPPER}}static getCharacter(s,n){switch(s){case yt.UPPER:return Ze.UPPER_TABLE[n];case yt.LOWER:return Ze.LOWER_TABLE[n];case yt.MIXED:return Ze.MIXED_TABLE[n];case yt.PUNCT:return Ze.PUNCT_TABLE[n];case yt.DIGIT:return Ze.DIGIT_TABLE[n];default:throw new Oe("Bad table")}}correctBits(s){let n,r;this.ddata.getNbLayers()<=2?(r=6,n=Ke.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(r=8,n=Ke.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(r=10,n=Ke.AZTEC_DATA_10):(r=12,n=Ke.AZTEC_DATA_12);let l=this.ddata.getNbDatablocks(),o=s.length/r;if(o<l)throw new $;let d=s.length%r,u=new Int32Array(o);for(let k=0;k<o;k++,d+=r)u[k]=Ze.readCode(s,d,r);try{new mt(n).decode(u,o-l)}catch(k){throw new $(k)}let m=(1<<r)-1,b=0;for(let k=0;k<l;k++){let X=u[k];if(X===0||X===m)throw new $;(X===1||X===m-1)&&b++}let S=new Array(l*r-b),M=0;for(let k=0;k<l;k++){let X=u[k];if(X===1||X===m-1)S.fill(X>1,M,M+r-1),M+=r-1;else for(let re=r-1;re>=0;--re)S[M++]=(X&1<<re)!==0}return S}extractBits(s){let n=this.ddata.isCompact(),r=this.ddata.getNbLayers(),l=(n?11:14)+r*4,o=new Int32Array(l),d=new Array(this.totalBitsInLayer(r,n));if(n)for(let u=0;u<o.length;u++)o[u]=u;else{let u=l+1+2*H.truncDivision(H.truncDivision(l,2)-1,15),m=l/2,b=H.truncDivision(u,2);for(let S=0;S<m;S++){let M=S+H.truncDivision(S,15);o[m-S-1]=b-M-1,o[m+S]=b+M+1}}for(let u=0,m=0;u<r;u++){let b=(r-u)*4+(n?9:12),S=u*2,M=l-1-S;for(let k=0;k<b;k++){let X=k*2;for(let re=0;re<2;re++)d[m+X+re]=s.get(o[S+re],o[S+k]),d[m+2*b+X+re]=s.get(o[S+k],o[M-re]),d[m+4*b+X+re]=s.get(o[M-re],o[M-k]),d[m+6*b+X+re]=s.get(o[M-k],o[S+re])}m+=b*8}return d}static readCode(s,n,r){let l=0;for(let o=n;o<n+r;o++)l<<=1,s[o]&&(l|=1);return l}static readByte(s,n){let r=s.length-n;return r>=8?Ze.readCode(s,n,8):Ze.readCode(s,n,r)<<8-r}static convertBoolArrayToByteArray(s){let n=new Uint8Array((s.length+7)/8);for(let r=0;r<n.length;r++)n[r]=Ze.readByte(s,8*r);return n}totalBitsInLayer(s,n){return((n?88:112)+16*s)*s}}Ze.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Ze.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Ze.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Ze.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Ze.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Xe{constructor(){}static round(s){return s===NaN?0:s<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:s>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:s+(s<0?-.5:.5)|0}static distance(s,n,r,l){const o=s-r,d=n-l;return Math.sqrt(o*o+d*d)}static sum(s){let n=0;for(let r=0,l=s.length;r!==l;r++){const o=s[r];n+=o}return n}}class Tt{static floatToIntBits(s){return s}}Tt.MAX_VALUE=Number.MAX_SAFE_INTEGER;class He{constructor(s,n){this.x=s,this.y=n}getX(){return this.x}getY(){return this.y}equals(s){if(s instanceof He){const n=s;return this.x===n.x&&this.y===n.y}return!1}hashCode(){return 31*Tt.floatToIntBits(this.x)+Tt.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(s){const n=this.distance(s[0],s[1]),r=this.distance(s[1],s[2]),l=this.distance(s[0],s[2]);let o,d,u;if(r>=n&&r>=l?(d=s[0],o=s[1],u=s[2]):l>=r&&l>=n?(d=s[1],o=s[0],u=s[2]):(d=s[2],o=s[0],u=s[1]),this.crossProductZ(o,d,u)<0){const m=o;o=u,u=m}s[0]=o,s[1]=d,s[2]=u}static distance(s,n){return Xe.distance(s.x,s.y,n.x,n.y)}static crossProductZ(s,n,r){const l=n.x,o=n.y;return(r.x-l)*(s.y-o)-(r.y-o)*(s.x-l)}}class ye{constructor(s,n){this.bits=s,this.points=n}getBits(){return this.bits}getPoints(){return this.points}}class Fe extends ye{constructor(s,n,r,l,o){super(s,n),this.compact=r,this.nbDatablocks=l,this.nbLayers=o}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class We{constructor(s,n,r,l){this.image=s,this.height=s.getHeight(),this.width=s.getWidth(),n==null&&(n=We.INIT_SIZE),r==null&&(r=s.getWidth()/2|0),l==null&&(l=s.getHeight()/2|0);const o=n/2|0;if(this.leftInit=r-o,this.rightInit=r+o,this.upInit=l-o,this.downInit=l+o,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new F}detect(){let s=this.leftInit,n=this.rightInit,r=this.upInit,l=this.downInit,o=!1,d=!0,u=!1,m=!1,b=!1,S=!1,M=!1;const k=this.width,X=this.height;for(;d;){d=!1;let re=!0;for(;(re||!m)&&n<k;)re=this.containsBlackPoint(r,l,n,!1),re?(n++,d=!0,m=!0):m||n++;if(n>=k){o=!0;break}let ie=!0;for(;(ie||!b)&&l<X;)ie=this.containsBlackPoint(s,n,l,!0),ie?(l++,d=!0,b=!0):b||l++;if(l>=X){o=!0;break}let he=!0;for(;(he||!S)&&s>=0;)he=this.containsBlackPoint(r,l,s,!1),he?(s--,d=!0,S=!0):S||s--;if(s<0){o=!0;break}let je=!0;for(;(je||!M)&&r>=0;)je=this.containsBlackPoint(s,n,r,!0),je?(r--,d=!0,M=!0):M||r--;if(r<0){o=!0;break}d&&(u=!0)}if(!o&&u){const re=n-s;let ie=null;for(let Le=1;ie===null&&Le<re;Le++)ie=this.getBlackPointOnSegment(s,l-Le,s+Le,l);if(ie==null)throw new F;let he=null;for(let Le=1;he===null&&Le<re;Le++)he=this.getBlackPointOnSegment(s,r+Le,s+Le,r);if(he==null)throw new F;let je=null;for(let Le=1;je===null&&Le<re;Le++)je=this.getBlackPointOnSegment(n,r+Le,n-Le,r);if(je==null)throw new F;let Pe=null;for(let Le=1;Pe===null&&Le<re;Le++)Pe=this.getBlackPointOnSegment(n,l-Le,n-Le,l);if(Pe==null)throw new F;return this.centerEdges(Pe,ie,je,he)}else throw new F}getBlackPointOnSegment(s,n,r,l){const o=Xe.round(Xe.distance(s,n,r,l)),d=(r-s)/o,u=(l-n)/o,m=this.image;for(let b=0;b<o;b++){const S=Xe.round(s+b*d),M=Xe.round(n+b*u);if(m.get(S,M))return new He(S,M)}return null}centerEdges(s,n,r,l){const o=s.getX(),d=s.getY(),u=n.getX(),m=n.getY(),b=r.getX(),S=r.getY(),M=l.getX(),k=l.getY(),X=We.CORR;return o<this.width/2?[new He(M-X,k+X),new He(u+X,m+X),new He(b-X,S-X),new He(o+X,d-X)]:[new He(M+X,k+X),new He(u+X,m-X),new He(b-X,S+X),new He(o-X,d-X)]}containsBlackPoint(s,n,r,l){const o=this.image;if(l){for(let d=s;d<=n;d++)if(o.get(d,r))return!0}else for(let d=s;d<=n;d++)if(o.get(r,d))return!0;return!1}}We.INIT_SIZE=10,We.CORR=1;class rt{static checkAndNudgePoints(s,n){const r=s.getWidth(),l=s.getHeight();let o=!0;for(let d=0;d<n.length&&o;d+=2){const u=Math.floor(n[d]),m=Math.floor(n[d+1]);if(u<-1||u>r||m<-1||m>l)throw new F;o=!1,u===-1?(n[d]=0,o=!0):u===r&&(n[d]=r-1,o=!0),m===-1?(n[d+1]=0,o=!0):m===l&&(n[d+1]=l-1,o=!0)}o=!0;for(let d=n.length-2;d>=0&&o;d-=2){const u=Math.floor(n[d]),m=Math.floor(n[d+1]);if(u<-1||u>r||m<-1||m>l)throw new F;o=!1,u===-1?(n[d]=0,o=!0):u===r&&(n[d]=r-1,o=!0),m===-1?(n[d+1]=0,o=!0):m===l&&(n[d+1]=l-1,o=!0)}}}class st{constructor(s,n,r,l,o,d,u,m,b){this.a11=s,this.a21=n,this.a31=r,this.a12=l,this.a22=o,this.a32=d,this.a13=u,this.a23=m,this.a33=b}static quadrilateralToQuadrilateral(s,n,r,l,o,d,u,m,b,S,M,k,X,re,ie,he){const je=st.quadrilateralToSquare(s,n,r,l,o,d,u,m);return st.squareToQuadrilateral(b,S,M,k,X,re,ie,he).times(je)}transformPoints(s){const n=s.length,r=this.a11,l=this.a12,o=this.a13,d=this.a21,u=this.a22,m=this.a23,b=this.a31,S=this.a32,M=this.a33;for(let k=0;k<n;k+=2){const X=s[k],re=s[k+1],ie=o*X+m*re+M;s[k]=(r*X+d*re+b)/ie,s[k+1]=(l*X+u*re+S)/ie}}transformPointsWithValues(s,n){const r=this.a11,l=this.a12,o=this.a13,d=this.a21,u=this.a22,m=this.a23,b=this.a31,S=this.a32,M=this.a33,k=s.length;for(let X=0;X<k;X++){const re=s[X],ie=n[X],he=o*re+m*ie+M;s[X]=(r*re+d*ie+b)/he,n[X]=(l*re+u*ie+S)/he}}static squareToQuadrilateral(s,n,r,l,o,d,u,m){const b=s-r+o-u,S=n-l+d-m;if(b===0&&S===0)return new st(r-s,o-r,s,l-n,d-l,n,0,0,1);{const M=r-o,k=u-o,X=l-d,re=m-d,ie=M*re-k*X,he=(b*re-k*S)/ie,je=(M*S-b*X)/ie;return new st(r-s+he*r,u-s+je*u,s,l-n+he*l,m-n+je*m,n,he,je,1)}}static quadrilateralToSquare(s,n,r,l,o,d,u,m){return st.squareToQuadrilateral(s,n,r,l,o,d,u,m).buildAdjoint()}buildAdjoint(){return new st(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(s){return new st(this.a11*s.a11+this.a21*s.a12+this.a31*s.a13,this.a11*s.a21+this.a21*s.a22+this.a31*s.a23,this.a11*s.a31+this.a21*s.a32+this.a31*s.a33,this.a12*s.a11+this.a22*s.a12+this.a32*s.a13,this.a12*s.a21+this.a22*s.a22+this.a32*s.a23,this.a12*s.a31+this.a22*s.a32+this.a32*s.a33,this.a13*s.a11+this.a23*s.a12+this.a33*s.a13,this.a13*s.a21+this.a23*s.a22+this.a33*s.a23,this.a13*s.a31+this.a23*s.a32+this.a33*s.a33)}}class _s extends rt{sampleGrid(s,n,r,l,o,d,u,m,b,S,M,k,X,re,ie,he,je,Pe,Le){const ke=st.quadrilateralToQuadrilateral(l,o,d,u,m,b,S,M,k,X,re,ie,he,je,Pe,Le);return this.sampleGridWithTransform(s,n,r,ke)}sampleGridWithTransform(s,n,r,l){if(n<=0||r<=0)throw new F;const o=new ae(n,r),d=new Float32Array(2*n);for(let u=0;u<r;u++){const m=d.length,b=u+.5;for(let S=0;S<m;S+=2)d[S]=S/2+.5,d[S+1]=b;l.transformPoints(d),rt.checkAndNudgePoints(s,d);try{for(let S=0;S<m;S+=2)s.get(Math.floor(d[S]),Math.floor(d[S+1]))&&o.set(S/2,u)}catch{throw new F}}return o}}class pt{static setGridSampler(s){pt.gridSampler=s}static getInstance(){return pt.gridSampler}}pt.gridSampler=new _s;class ct{constructor(s,n){this.x=s,this.y=n}toResultPoint(){return new He(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class ds{constructor(s){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=s}detect(){return this.detectMirror(!1)}detectMirror(s){let n=this.getMatrixCenter(),r=this.getBullsEyeCorners(n);if(s){let d=r[0];r[0]=r[2],r[2]=d}this.extractParameters(r);let l=this.sampleGrid(this.image,r[this.shift%4],r[(this.shift+1)%4],r[(this.shift+2)%4],r[(this.shift+3)%4]),o=this.getMatrixCornerPoints(r);return new Fe(l,o,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(s){if(!this.isValidPoint(s[0])||!this.isValidPoint(s[1])||!this.isValidPoint(s[2])||!this.isValidPoint(s[3]))throw new F;let n=2*this.nbCenterLayers,r=new Int32Array([this.sampleLine(s[0],s[1],n),this.sampleLine(s[1],s[2],n),this.sampleLine(s[2],s[3],n),this.sampleLine(s[3],s[0],n)]);this.shift=this.getRotation(r,n);let l=0;for(let d=0;d<4;d++){let u=r[(this.shift+d)%4];this.compact?(l<<=7,l+=u>>1&127):(l<<=10,l+=(u>>2&992)+(u>>1&31))}let o=this.getCorrectedParameterData(l,this.compact);this.compact?(this.nbLayers=(o>>6)+1,this.nbDataBlocks=(o&63)+1):(this.nbLayers=(o>>11)+1,this.nbDataBlocks=(o&2047)+1)}getRotation(s,n){let r=0;s.forEach((l,o,d)=>{let u=(l>>n-2<<1)+(l&1);r=(r<<3)+u}),r=((r&1)<<11)+(r>>1);for(let l=0;l<4;l++)if(H.bitCount(r^this.EXPECTED_CORNER_BITS[l])<=2)return l;throw new F}getCorrectedParameterData(s,n){let r,l;n?(r=7,l=2):(r=10,l=4);let o=r-l,d=new Int32Array(r);for(let m=r-1;m>=0;--m)d[m]=s&15,s>>=4;try{new mt(Ke.AZTEC_PARAM).decode(d,o)}catch{throw new F}let u=0;for(let m=0;m<l;m++)u=(u<<4)+d[m];return u}getBullsEyeCorners(s){let n=s,r=s,l=s,o=s,d=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let M=this.getFirstDifferent(n,d,1,-1),k=this.getFirstDifferent(r,d,1,1),X=this.getFirstDifferent(l,d,-1,1),re=this.getFirstDifferent(o,d,-1,-1);if(this.nbCenterLayers>2){let ie=this.distancePoint(re,M)*this.nbCenterLayers/(this.distancePoint(o,n)*(this.nbCenterLayers+2));if(ie<.75||ie>1.25||!this.isWhiteOrBlackRectangle(M,k,X,re))break}n=M,r=k,l=X,o=re,d=!d}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new F;this.compact=this.nbCenterLayers===5;let u=new He(n.getX()+.5,n.getY()-.5),m=new He(r.getX()+.5,r.getY()+.5),b=new He(l.getX()-.5,l.getY()+.5),S=new He(o.getX()-.5,o.getY()-.5);return this.expandSquare([u,m,b,S],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let s,n,r,l;try{let u=new We(this.image).detect();s=u[0],n=u[1],r=u[2],l=u[3]}catch{let m=this.image.getWidth()/2,b=this.image.getHeight()/2;s=this.getFirstDifferent(new ct(m+7,b-7),!1,1,-1).toResultPoint(),n=this.getFirstDifferent(new ct(m+7,b+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new ct(m-7,b+7),!1,-1,1).toResultPoint(),l=this.getFirstDifferent(new ct(m-7,b-7),!1,-1,-1).toResultPoint()}let o=Xe.round((s.getX()+l.getX()+n.getX()+r.getX())/4),d=Xe.round((s.getY()+l.getY()+n.getY()+r.getY())/4);try{let u=new We(this.image,15,o,d).detect();s=u[0],n=u[1],r=u[2],l=u[3]}catch{s=this.getFirstDifferent(new ct(o+7,d-7),!1,1,-1).toResultPoint(),n=this.getFirstDifferent(new ct(o+7,d+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new ct(o-7,d+7),!1,-1,1).toResultPoint(),l=this.getFirstDifferent(new ct(o-7,d-7),!1,-1,-1).toResultPoint()}return o=Xe.round((s.getX()+l.getX()+n.getX()+r.getX())/4),d=Xe.round((s.getY()+l.getY()+n.getY()+r.getY())/4),new ct(o,d)}getMatrixCornerPoints(s){return this.expandSquare(s,2*this.nbCenterLayers,this.getDimension())}sampleGrid(s,n,r,l,o){let d=pt.getInstance(),u=this.getDimension(),m=u/2-this.nbCenterLayers,b=u/2+this.nbCenterLayers;return d.sampleGrid(s,u,u,m,m,b,m,b,b,m,b,n.getX(),n.getY(),r.getX(),r.getY(),l.getX(),l.getY(),o.getX(),o.getY())}sampleLine(s,n,r){let l=0,o=this.distanceResultPoint(s,n),d=o/r,u=s.getX(),m=s.getY(),b=d*(n.getX()-s.getX())/o,S=d*(n.getY()-s.getY())/o;for(let M=0;M<r;M++)this.image.get(Xe.round(u+M*b),Xe.round(m+M*S))&&(l|=1<<r-M-1);return l}isWhiteOrBlackRectangle(s,n,r,l){let o=3;s=new ct(s.getX()-o,s.getY()+o),n=new ct(n.getX()-o,n.getY()-o),r=new ct(r.getX()+o,r.getY()-o),l=new ct(l.getX()+o,l.getY()+o);let d=this.getColor(l,s);if(d===0)return!1;let u=this.getColor(s,n);return u!==d||(u=this.getColor(n,r),u!==d)?!1:(u=this.getColor(r,l),u===d)}getColor(s,n){let r=this.distancePoint(s,n),l=(n.getX()-s.getX())/r,o=(n.getY()-s.getY())/r,d=0,u=s.getX(),m=s.getY(),b=this.image.get(s.getX(),s.getY()),S=Math.ceil(r);for(let k=0;k<S;k++)u+=l,m+=o,this.image.get(Xe.round(u),Xe.round(m))!==b&&d++;let M=d/r;return M>.1&&M<.9?0:M<=.1===b?1:-1}getFirstDifferent(s,n,r,l){let o=s.getX()+r,d=s.getY()+l;for(;this.isValid(o,d)&&this.image.get(o,d)===n;)o+=r,d+=l;for(o-=r,d-=l;this.isValid(o,d)&&this.image.get(o,d)===n;)o+=r;for(o-=r;this.isValid(o,d)&&this.image.get(o,d)===n;)d+=l;return d-=l,new ct(o,d)}expandSquare(s,n,r){let l=r/(2*n),o=s[0].getX()-s[2].getX(),d=s[0].getY()-s[2].getY(),u=(s[0].getX()+s[2].getX())/2,m=(s[0].getY()+s[2].getY())/2,b=new He(u+l*o,m+l*d),S=new He(u-l*o,m-l*d);o=s[1].getX()-s[3].getX(),d=s[1].getY()-s[3].getY(),u=(s[1].getX()+s[3].getX())/2,m=(s[1].getY()+s[3].getY())/2;let M=new He(u+l*o,m+l*d),k=new He(u-l*o,m-l*d);return[b,M,S,k]}isValid(s,n){return s>=0&&s<this.image.getWidth()&&n>0&&n<this.image.getHeight()}isValidPoint(s){let n=Xe.round(s.getX()),r=Xe.round(s.getY());return this.isValid(n,r)}distancePoint(s,n){return Xe.distance(s.getX(),s.getY(),n.getX(),n.getY())}distanceResultPoint(s,n){return Xe.distance(s.getX(),s.getY(),n.getX(),n.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(H.truncDivision(this.nbLayers-4,8)+1)+15}}class ue{decode(s,n=null){let r=null,l=new ds(s.getBlackMatrix()),o=null,d=null;try{let S=l.detectMirror(!1);o=S.getPoints(),this.reportFoundResultPoints(n,o),d=new Ze().decode(S)}catch(S){r=S}if(d==null)try{let S=l.detectMirror(!0);o=S.getPoints(),this.reportFoundResultPoints(n,o),d=new Ze().decode(S)}catch(S){throw r??S}let u=new Z(d.getText(),d.getRawBytes(),d.getNumBits(),o,xe.AZTEC,V.currentTimeMillis()),m=d.getByteSegments();m!=null&&u.putMetadata(Ve.BYTE_SEGMENTS,m);let b=d.getECLevel();return b!=null&&u.putMetadata(Ve.ERROR_CORRECTION_LEVEL,b),u}reportFoundResultPoints(s,n){if(s!=null){let r=s.get(ce.NEED_RESULT_POINT_CALLBACK);r!=null&&n.forEach((l,o,d)=>{r.foundPossibleResultPoint(l)})}}reset(){}}class ze extends U{constructor(s=500){super(new ue,s)}}class Ue{decode(s,n){try{return this.doDecode(s,n)}catch{if(n&&n.get(ce.TRY_HARDER)===!0&&s.isRotateSupported()){const o=s.rotateCounterClockwise(),d=this.doDecode(o,n),u=d.getResultMetadata();let m=270;u!==null&&u.get(Ve.ORIENTATION)===!0&&(m=m+u.get(Ve.ORIENTATION)%360),d.putMetadata(Ve.ORIENTATION,m);const b=d.getResultPoints();if(b!==null){const S=o.getHeight();for(let M=0;M<b.length;M++)b[M]=new He(S-b[M].getY()-1,b[M].getX())}return d}else throw new F}}reset(){}doDecode(s,n){const r=s.getWidth(),l=s.getHeight();let o=new q(r);const d=n&&n.get(ce.TRY_HARDER)===!0,u=Math.max(1,l>>(d?8:5));let m;d?m=l:m=15;const b=Math.trunc(l/2);for(let S=0;S<m;S++){const M=Math.trunc((S+1)/2),k=(S&1)===0,X=b+u*(k?M:-M);if(X<0||X>=l)break;try{o=s.getBlackRow(X,o)}catch{continue}for(let re=0;re<2;re++){if(re===1&&(o.reverse(),n&&n.get(ce.NEED_RESULT_POINT_CALLBACK)===!0)){const ie=new Map;n.forEach((he,je)=>ie.set(je,he)),ie.delete(ce.NEED_RESULT_POINT_CALLBACK),n=ie}try{const ie=this.decodeRow(X,o,n);if(re===1){ie.putMetadata(Ve.ORIENTATION,180);const he=ie.getResultPoints();he!==null&&(he[0]=new He(r-he[0].getX()-1,he[0].getY()),he[1]=new He(r-he[1].getX()-1,he[1].getY()))}return ie}catch{}}}throw new F}static recordPattern(s,n,r){const l=r.length;for(let b=0;b<l;b++)r[b]=0;const o=s.getSize();if(n>=o)throw new F;let d=!s.get(n),u=0,m=n;for(;m<o;){if(s.get(m)!==d)r[u]++;else{if(++u===l)break;r[u]=1,d=!d}m++}if(!(u===l||u===l-1&&m===o))throw new F}static recordPatternInReverse(s,n,r){let l=r.length,o=s.get(n);for(;n>0&&l>=0;)s.get(--n)!==o&&(l--,o=!o);if(l>=0)throw new F;Ue.recordPattern(s,n+1,r)}static patternMatchVariance(s,n,r){const l=s.length;let o=0,d=0;for(let b=0;b<l;b++)o+=s[b],d+=n[b];if(o<d)return Number.POSITIVE_INFINITY;const u=o/d;r*=u;let m=0;for(let b=0;b<l;b++){const S=s[b],M=n[b]*u,k=S>M?S-M:M-S;if(k>r)return Number.POSITIVE_INFINITY;m+=k}return m/o}}class Te extends Ue{static findStartPattern(s){const n=s.getSize(),r=s.getNextSet(0);let l=0,o=Int32Array.from([0,0,0,0,0,0]),d=r,u=!1;const m=6;for(let b=r;b<n;b++)if(s.get(b)!==u)o[l]++;else{if(l===m-1){let S=Te.MAX_AVG_VARIANCE,M=-1;for(let k=Te.CODE_START_A;k<=Te.CODE_START_C;k++){const X=Ue.patternMatchVariance(o,Te.CODE_PATTERNS[k],Te.MAX_INDIVIDUAL_VARIANCE);X<S&&(S=X,M=k)}if(M>=0&&s.isRange(Math.max(0,d-(b-d)/2),d,!1))return Int32Array.from([d,b,M]);d+=o[0]+o[1],o=o.slice(2,o.length-1),o[l-1]=0,o[l]=0,l--}else l++;o[l]=1,u=!u}throw new F}static decodeCode(s,n,r){Ue.recordPattern(s,r,n);let l=Te.MAX_AVG_VARIANCE,o=-1;for(let d=0;d<Te.CODE_PATTERNS.length;d++){const u=Te.CODE_PATTERNS[d],m=this.patternMatchVariance(n,u,Te.MAX_INDIVIDUAL_VARIANCE);m<l&&(l=m,o=d)}if(o>=0)return o;throw new F}decodeRow(s,n,r){const l=r&&r.get(ce.ASSUME_GS1)===!0,o=Te.findStartPattern(n),d=o[2];let u=0;const m=new Uint8Array(20);m[u++]=d;let b;switch(d){case Te.CODE_START_A:b=Te.CODE_CODE_A;break;case Te.CODE_START_B:b=Te.CODE_CODE_B;break;case Te.CODE_START_C:b=Te.CODE_CODE_C;break;default:throw new $}let S=!1,M=!1,k="",X=o[0],re=o[1];const ie=Int32Array.from([0,0,0,0,0,0]);let he=0,je=0,Pe=d,Le=0,ke=!0,Rt=!1,wt=!1;for(;!S;){const Cn=M;switch(M=!1,he=je,je=Te.decodeCode(n,ie,re),m[u++]=je,je!==Te.CODE_STOP&&(ke=!0),je!==Te.CODE_STOP&&(Le++,Pe+=Le*je),X=re,re+=ie.reduce((yo,xl)=>yo+xl,0),je){case Te.CODE_START_A:case Te.CODE_START_B:case Te.CODE_START_C:throw new $}switch(b){case Te.CODE_CODE_A:if(je<64)wt===Rt?k+=String.fromCharCode(32+je):k+=String.fromCharCode(32+je+128),wt=!1;else if(je<96)wt===Rt?k+=String.fromCharCode(je-64):k+=String.fromCharCode(je+64),wt=!1;else switch(je!==Te.CODE_STOP&&(ke=!1),je){case Te.CODE_FNC_1:l&&(k.length===0?k+="]C1":k+="");break;case Te.CODE_FNC_2:case Te.CODE_FNC_3:break;case Te.CODE_FNC_4_A:!Rt&&wt?(Rt=!0,wt=!1):Rt&&wt?(Rt=!1,wt=!1):wt=!0;break;case Te.CODE_SHIFT:M=!0,b=Te.CODE_CODE_B;break;case Te.CODE_CODE_B:b=Te.CODE_CODE_B;break;case Te.CODE_CODE_C:b=Te.CODE_CODE_C;break;case Te.CODE_STOP:S=!0;break}break;case Te.CODE_CODE_B:if(je<96)wt===Rt?k+=String.fromCharCode(32+je):k+=String.fromCharCode(32+je+128),wt=!1;else switch(je!==Te.CODE_STOP&&(ke=!1),je){case Te.CODE_FNC_1:l&&(k.length===0?k+="]C1":k+="");break;case Te.CODE_FNC_2:case Te.CODE_FNC_3:break;case Te.CODE_FNC_4_B:!Rt&&wt?(Rt=!0,wt=!1):Rt&&wt?(Rt=!1,wt=!1):wt=!0;break;case Te.CODE_SHIFT:M=!0,b=Te.CODE_CODE_A;break;case Te.CODE_CODE_A:b=Te.CODE_CODE_A;break;case Te.CODE_CODE_C:b=Te.CODE_CODE_C;break;case Te.CODE_STOP:S=!0;break}break;case Te.CODE_CODE_C:if(je<100)je<10&&(k+="0"),k+=je;else switch(je!==Te.CODE_STOP&&(ke=!1),je){case Te.CODE_FNC_1:l&&(k.length===0?k+="]C1":k+="");break;case Te.CODE_CODE_A:b=Te.CODE_CODE_A;break;case Te.CODE_CODE_B:b=Te.CODE_CODE_B;break;case Te.CODE_STOP:S=!0;break}break}Cn&&(b=b===Te.CODE_CODE_A?Te.CODE_CODE_B:Te.CODE_CODE_A)}const Ns=re-X;if(re=n.getNextUnset(re),!n.isRange(re,Math.min(n.getSize(),re+(re-X)/2),!1))throw new F;if(Pe-=Le*he,Pe%103!==he)throw new L;const ua=k.length;if(ua===0)throw new F;ua>0&&ke&&(b===Te.CODE_CODE_C?k=k.substring(0,ua-2):k=k.substring(0,ua-1));const Zs=(o[1]+o[0])/2,Qt=X+Ns/2,Vs=m.length,ia=new Uint8Array(Vs);for(let Cn=0;Cn<Vs;Cn++)ia[Cn]=m[Cn];const lr=[new He(Zs,s),new He(Qt,s)];return new Z(k,ia,0,lr,xe.CODE_128,new Date().getTime())}}Te.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Te.MAX_AVG_VARIANCE=.25,Te.MAX_INDIVIDUAL_VARIANCE=.7,Te.CODE_SHIFT=98,Te.CODE_CODE_C=99,Te.CODE_CODE_B=100,Te.CODE_CODE_A=101,Te.CODE_FNC_1=102,Te.CODE_FNC_2=97,Te.CODE_FNC_3=96,Te.CODE_FNC_4_A=101,Te.CODE_FNC_4_B=100,Te.CODE_START_A=103,Te.CODE_START_B=104,Te.CODE_START_C=105,Te.CODE_STOP=106;class ot extends Ue{constructor(s=!1,n=!1){super(),this.usingCheckDigit=s,this.extendedMode=n,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(s,n,r){let l=this.counters;l.fill(0),this.decodeRowResult="";let o=ot.findAsteriskPattern(n,l),d=n.getNextSet(o[1]),u=n.getSize(),m,b;do{ot.recordPattern(n,d,l);let ie=ot.toNarrowWidePattern(l);if(ie<0)throw new F;m=ot.patternToChar(ie),this.decodeRowResult+=m,b=d;for(let he of l)d+=he;d=n.getNextSet(d)}while(m!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let S=0;for(let ie of l)S+=ie;let M=d-b-S;if(d!==u&&M*2<S)throw new F;if(this.usingCheckDigit){let ie=this.decodeRowResult.length-1,he=0;for(let je=0;je<ie;je++)he+=ot.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(je));if(this.decodeRowResult.charAt(ie)!==ot.ALPHABET_STRING.charAt(he%43))throw new L;this.decodeRowResult=this.decodeRowResult.substring(0,ie)}if(this.decodeRowResult.length===0)throw new F;let k;this.extendedMode?k=ot.decodeExtended(this.decodeRowResult):k=this.decodeRowResult;let X=(o[1]+o[0])/2,re=b+S/2;return new Z(k,null,0,[new He(X,s),new He(re,s)],xe.CODE_39,new Date().getTime())}static findAsteriskPattern(s,n){let r=s.getSize(),l=s.getNextSet(0),o=0,d=l,u=!1,m=n.length;for(let b=l;b<r;b++)if(s.get(b)!==u)n[o]++;else{if(o===m-1){if(this.toNarrowWidePattern(n)===ot.ASTERISK_ENCODING&&s.isRange(Math.max(0,d-Math.floor((b-d)/2)),d,!1))return[d,b];d+=n[0]+n[1],n.copyWithin(0,2,2+o-1),n[o-1]=0,n[o]=0,o--}else o++;n[o]=1,u=!u}throw new F}static toNarrowWidePattern(s){let n=s.length,r=0,l;do{let o=2147483647;for(let m of s)m<o&&m>r&&(o=m);r=o,l=0;let d=0,u=0;for(let m=0;m<n;m++){let b=s[m];b>r&&(u|=1<<n-1-m,l++,d+=b)}if(l===3){for(let m=0;m<n&&l>0;m++){let b=s[m];if(b>r&&(l--,b*2>=d))return-1}return u}}while(l>3);return-1}static patternToChar(s){for(let n=0;n<ot.CHARACTER_ENCODINGS.length;n++)if(ot.CHARACTER_ENCODINGS[n]===s)return ot.ALPHABET_STRING.charAt(n);if(s===ot.ASTERISK_ENCODING)return"*";throw new F}static decodeExtended(s){let n=s.length,r="";for(let l=0;l<n;l++){let o=s.charAt(l);if(o==="+"||o==="$"||o==="%"||o==="/"){let d=s.charAt(l+1),u="\0";switch(o){case"+":if(d>="A"&&d<="Z")u=String.fromCharCode(d.charCodeAt(0)+32);else throw new $;break;case"$":if(d>="A"&&d<="Z")u=String.fromCharCode(d.charCodeAt(0)-64);else throw new $;break;case"%":if(d>="A"&&d<="E")u=String.fromCharCode(d.charCodeAt(0)-38);else if(d>="F"&&d<="J")u=String.fromCharCode(d.charCodeAt(0)-11);else if(d>="K"&&d<="O")u=String.fromCharCode(d.charCodeAt(0)+16);else if(d>="P"&&d<="T")u=String.fromCharCode(d.charCodeAt(0)+43);else if(d==="U")u="\0";else if(d==="V")u="@";else if(d==="W")u="`";else if(d==="X"||d==="Y"||d==="Z")u="";else throw new $;break;case"/":if(d>="A"&&d<="O")u=String.fromCharCode(d.charCodeAt(0)-32);else if(d==="Z")u=":";else throw new $;break}r+=u,l++}else r+=o}return r}}ot.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",ot.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],ot.ASTERISK_ENCODING=148;class Ye extends Ue{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(s,n,r){let l=this.decodeStart(n),o=this.decodeEnd(n),d=new J;Ye.decodeMiddle(n,l[1],o[0],d);let u=d.toString(),m=null;r!=null&&(m=r.get(ce.ALLOWED_LENGTHS)),m==null&&(m=Ye.DEFAULT_ALLOWED_LENGTHS);let b=u.length,S=!1,M=0;for(let re of m){if(b===re){S=!0;break}re>M&&(M=re)}if(!S&&b>M&&(S=!0),!S)throw new $;const k=[new He(l[1],s),new He(o[0],s)];return new Z(u,null,0,k,xe.ITF,new Date().getTime())}static decodeMiddle(s,n,r,l){let o=new Int32Array(10),d=new Int32Array(5),u=new Int32Array(5);for(o.fill(0),d.fill(0),u.fill(0);n<r;){Ue.recordPattern(s,n,o);for(let b=0;b<5;b++){let S=2*b;d[b]=o[S],u[b]=o[S+1]}let m=Ye.decodeDigit(d);l.append(m.toString()),m=this.decodeDigit(u),l.append(m.toString()),o.forEach(function(b){n+=b})}}decodeStart(s){let n=Ye.skipWhiteSpace(s),r=Ye.findGuardPattern(s,n,Ye.START_PATTERN);return this.narrowLineWidth=(r[1]-r[0])/4,this.validateQuietZone(s,r[0]),r}validateQuietZone(s,n){let r=this.narrowLineWidth*10;r=r<n?r:n;for(let l=n-1;r>0&&l>=0&&!s.get(l);l--)r--;if(r!==0)throw new F}static skipWhiteSpace(s){const n=s.getSize(),r=s.getNextSet(0);if(r===n)throw new F;return r}decodeEnd(s){s.reverse();try{let n=Ye.skipWhiteSpace(s),r;try{r=Ye.findGuardPattern(s,n,Ye.END_PATTERN_REVERSED[0])}catch(o){o instanceof F&&(r=Ye.findGuardPattern(s,n,Ye.END_PATTERN_REVERSED[1]))}this.validateQuietZone(s,r[0]);let l=r[0];return r[0]=s.getSize()-r[1],r[1]=s.getSize()-l,r}finally{s.reverse()}}static findGuardPattern(s,n,r){let l=r.length,o=new Int32Array(l),d=s.getSize(),u=!1,m=0,b=n;o.fill(0);for(let S=n;S<d;S++)if(s.get(S)!==u)o[m]++;else{if(m===l-1){if(Ue.patternMatchVariance(o,r,Ye.MAX_INDIVIDUAL_VARIANCE)<Ye.MAX_AVG_VARIANCE)return[b,S];b+=o[0]+o[1],V.arraycopy(o,2,o,0,m-1),o[m-1]=0,o[m]=0,m--}else m++;o[m]=1,u=!u}throw new F}static decodeDigit(s){let n=Ye.MAX_AVG_VARIANCE,r=-1,l=Ye.PATTERNS.length;for(let o=0;o<l;o++){let d=Ye.PATTERNS[o],u=Ue.patternMatchVariance(s,d,Ye.MAX_INDIVIDUAL_VARIANCE);u<n?(n=u,r=o):u===n&&(r=-1)}if(r>=0)return r%10;throw new F}}Ye.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Ye.MAX_AVG_VARIANCE=.38,Ye.MAX_INDIVIDUAL_VARIANCE=.5,Ye.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Ye.START_PATTERN=Int32Array.from([1,1,1,1]),Ye.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Kt extends Ue{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(s){let n=!1,r,l=0,o=Int32Array.from([0,0,0]);for(;!n;){o=Int32Array.from([0,0,0]),r=Kt.findGuardPattern(s,l,!1,this.START_END_PATTERN,o);let d=r[0];l=r[1];let u=d-(l-d);u>=0&&(n=s.isRange(u,d,!1))}return r}static checkChecksum(s){return Kt.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let n=s.length;if(n===0)return!1;let r=parseInt(s.charAt(n-1),10);return Kt.getStandardUPCEANChecksum(s.substring(0,n-1))===r}static getStandardUPCEANChecksum(s){let n=s.length,r=0;for(let l=n-1;l>=0;l-=2){let o=s.charAt(l).charCodeAt(0)-48;if(o<0||o>9)throw new $;r+=o}r*=3;for(let l=n-2;l>=0;l-=2){let o=s.charAt(l).charCodeAt(0)-48;if(o<0||o>9)throw new $;r+=o}return(1e3-r)%10}static decodeEnd(s,n){return Kt.findGuardPattern(s,n,!1,Kt.START_END_PATTERN,new Int32Array(Kt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(s,n,r,l){return this.findGuardPattern(s,n,r,l,new Int32Array(l.length))}static findGuardPattern(s,n,r,l,o){let d=s.getSize();n=r?s.getNextUnset(n):s.getNextSet(n);let u=0,m=n,b=l.length,S=r;for(let M=n;M<d;M++)if(s.get(M)!==S)o[u]++;else{if(u===b-1){if(Ue.patternMatchVariance(o,l,Kt.MAX_INDIVIDUAL_VARIANCE)<Kt.MAX_AVG_VARIANCE)return Int32Array.from([m,M]);m+=o[0]+o[1];let k=o.slice(2,o.length-1);for(let X=0;X<u-1;X++)o[X]=k[X];o[u-1]=0,o[u]=0,u--}else u++;o[u]=1,S=!S}throw new F}static decodeDigit(s,n,r,l){this.recordPattern(s,r,n);let o=this.MAX_AVG_VARIANCE,d=-1,u=l.length;for(let m=0;m<u;m++){let b=l[m],S=Ue.patternMatchVariance(n,b,Kt.MAX_INDIVIDUAL_VARIANCE);S<o&&(o=S,d=m)}if(d>=0)return d;throw new F}}Kt.MAX_AVG_VARIANCE=.48,Kt.MAX_INDIVIDUAL_VARIANCE=.7,Kt.START_END_PATTERN=Int32Array.from([1,1,1]),Kt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Kt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Kt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class pn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(s,n,r){let l=this.decodeRowStringBuffer,o=this.decodeMiddle(n,r,l),d=l.toString(),u=pn.parseExtensionString(d),m=[new He((r[0]+r[1])/2,s),new He(o,s)],b=new Z(d,null,0,m,xe.UPC_EAN_EXTENSION,new Date().getTime());return u!=null&&b.putAllMetadata(u),b}decodeMiddle(s,n,r){let l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let o=s.getSize(),d=n[1],u=0;for(let b=0;b<5&&d<o;b++){let S=Kt.decodeDigit(s,l,d,Kt.L_AND_G_PATTERNS);r+=String.fromCharCode(48+S%10);for(let M of l)d+=M;S>=10&&(u|=1<<4-b),b!==4&&(d=s.getNextSet(d),d=s.getNextUnset(d))}if(r.length!==5)throw new F;let m=this.determineCheckDigit(u);if(pn.extensionChecksum(r.toString())!==m)throw new F;return d}static extensionChecksum(s){let n=s.length,r=0;for(let l=n-2;l>=0;l-=2)r+=s.charAt(l).charCodeAt(0)-48;r*=3;for(let l=n-1;l>=0;l-=2)r+=s.charAt(l).charCodeAt(0)-48;return r*=3,r%10}determineCheckDigit(s){for(let n=0;n<10;n++)if(s===this.CHECK_DIGIT_ENCODINGS[n])return n;throw new F}static parseExtensionString(s){if(s.length!==5)return null;let n=pn.parseExtension5String(s);return n==null?null:new Map([[Ve.SUGGESTED_PRICE,n]])}static parseExtension5String(s){let n;switch(s.charAt(0)){case"0":n="";break;case"5":n="$";break;case"9":switch(s){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}n="";break;default:n="";break}let r=parseInt(s.substring(1)),l=(r/100).toString(),o=r%100,d=o<10?"0"+o:o.toString();return n+l+"."+d}}class li{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(s,n,r){let l=this.decodeRowStringBuffer,o=this.decodeMiddle(n,r,l),d=l.toString(),u=li.parseExtensionString(d),m=[new He((r[0]+r[1])/2,s),new He(o,s)],b=new Z(d,null,0,m,xe.UPC_EAN_EXTENSION,new Date().getTime());return u!=null&&b.putAllMetadata(u),b}decodeMiddle(s,n,r){let l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let o=s.getSize(),d=n[1],u=0;for(let m=0;m<2&&d<o;m++){let b=Kt.decodeDigit(s,l,d,Kt.L_AND_G_PATTERNS);r+=String.fromCharCode(48+b%10);for(let S of l)d+=S;b>=10&&(u|=1<<1-m),m!==1&&(d=s.getNextSet(d),d=s.getNextUnset(d))}if(r.length!==2)throw new F;if(parseInt(r.toString())%4!==u)throw new F;return d}static parseExtensionString(s){return s.length!==2?null:new Map([[Ve.ISSUE_NUMBER,parseInt(s)]])}}class Mr{static decodeRow(s,n,r){let l=Kt.findGuardPattern(n,r,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new pn().decodeRow(s,n,l)}catch{return new li().decodeRow(s,n,l)}}}Mr.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Mt extends Kt{constructor(){super(),this.decodeRowStringBuffer="",Mt.L_AND_G_PATTERNS=Mt.L_PATTERNS.map(s=>Int32Array.from(s));for(let s=10;s<20;s++){let n=Mt.L_PATTERNS[s-10],r=new Int32Array(n.length);for(let l=0;l<n.length;l++)r[l]=n[n.length-l-1];Mt.L_AND_G_PATTERNS[s]=r}}decodeRow(s,n,r){let l=Mt.findStartGuardPattern(n),o=r==null?null:r.get(ce.NEED_RESULT_POINT_CALLBACK);if(o!=null){const ke=new He((l[0]+l[1])/2,s);o.foundPossibleResultPoint(ke)}let d=this.decodeMiddle(n,l,this.decodeRowStringBuffer),u=d.rowOffset,m=d.resultString;if(o!=null){const ke=new He(u,s);o.foundPossibleResultPoint(ke)}let b=this.decodeEnd(n,u);if(o!=null){const ke=new He((b[0]+b[1])/2,s);o.foundPossibleResultPoint(ke)}let S=b[1],M=S+(S-b[0]);if(M>=n.getSize()||!n.isRange(S,M,!1))throw new F;let k=m.toString();if(k.length<8)throw new $;if(!Mt.checkChecksum(k))throw new L;let X=(l[1]+l[0])/2,re=(b[1]+b[0])/2,ie=this.getBarcodeFormat(),he=[new He(X,s),new He(re,s)],je=new Z(k,null,0,he,ie,new Date().getTime()),Pe=0;try{let ke=Mr.decodeRow(s,n,b[1]);je.putMetadata(Ve.UPC_EAN_EXTENSION,ke.getText()),je.putAllMetadata(ke.getResultMetadata()),je.addResultPoints(ke.getResultPoints()),Pe=ke.getText().length}catch{}let Le=r==null?null:r.get(ce.ALLOWED_EAN_EXTENSIONS);if(Le!=null){let ke=!1;for(let Rt in Le)if(Pe.toString()===Rt){ke=!0;break}if(!ke)throw new F}return je}decodeEnd(s,n){return Mt.findGuardPattern(s,n,!1,Mt.START_END_PATTERN,new Int32Array(Mt.START_END_PATTERN.length).fill(0))}static checkChecksum(s){return Mt.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let n=s.length;if(n===0)return!1;let r=parseInt(s.charAt(n-1),10);return Mt.getStandardUPCEANChecksum(s.substring(0,n-1))===r}static getStandardUPCEANChecksum(s){let n=s.length,r=0;for(let l=n-1;l>=0;l-=2){let o=s.charAt(l).charCodeAt(0)-48;if(o<0||o>9)throw new $;r+=o}r*=3;for(let l=n-2;l>=0;l-=2){let o=s.charAt(l).charCodeAt(0)-48;if(o<0||o>9)throw new $;r+=o}return(1e3-r)%10}}class Oa extends Mt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(s,n,r){let l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let o=s.getSize(),d=n[1],u=0;for(let b=0;b<6&&d<o;b++){let S=Mt.decodeDigit(s,l,d,Mt.L_AND_G_PATTERNS);r+=String.fromCharCode(48+S%10);for(let M of l)d+=M;S>=10&&(u|=1<<5-b)}r=Oa.determineFirstDigit(r,u),d=Mt.findGuardPattern(s,d,!0,Mt.MIDDLE_PATTERN,new Int32Array(Mt.MIDDLE_PATTERN.length).fill(0))[1];for(let b=0;b<6&&d<o;b++){let S=Mt.decodeDigit(s,l,d,Mt.L_PATTERNS);r+=String.fromCharCode(48+S);for(let M of l)d+=M}return{rowOffset:d,resultString:r}}getBarcodeFormat(){return xe.EAN_13}static determineFirstDigit(s,n){for(let r=0;r<10;r++)if(n===this.FIRST_DIGIT_ENCODINGS[r])return s=String.fromCharCode(48+r)+s,s;throw new F}}Oa.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class en extends Mt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(s,n,r){const l=this.decodeMiddleCounters;l[0]=0,l[1]=0,l[2]=0,l[3]=0;let o=s.getSize(),d=n[1];for(let m=0;m<4&&d<o;m++){let b=Mt.decodeDigit(s,l,d,Mt.L_PATTERNS);r+=String.fromCharCode(48+b);for(let S of l)d+=S}d=Mt.findGuardPattern(s,d,!0,Mt.MIDDLE_PATTERN,new Int32Array(Mt.MIDDLE_PATTERN.length).fill(0))[1];for(let m=0;m<4&&d<o;m++){let b=Mt.decodeDigit(s,l,d,Mt.L_PATTERNS);r+=String.fromCharCode(48+b);for(let S of l)d+=S}return{rowOffset:d,resultString:r}}getBarcodeFormat(){return xe.EAN_8}}class kr extends Mt{constructor(){super(...arguments),this.ean13Reader=new Oa}getBarcodeFormat(){return xe.UPC_A}decode(s,n){return this.maybeReturnResult(this.ean13Reader.decode(s))}decodeRow(s,n,r){return this.maybeReturnResult(this.ean13Reader.decodeRow(s,n,r))}decodeMiddle(s,n,r){return this.ean13Reader.decodeMiddle(s,n,r)}maybeReturnResult(s){let n=s.getText();if(n.charAt(0)==="0"){let r=new Z(n.substring(1),null,null,s.getResultPoints(),xe.UPC_A);return s.getResultMetadata()!=null&&r.putAllMetadata(s.getResultMetadata()),r}else throw new F}reset(){this.ean13Reader.reset()}}class Ks extends Mt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(s,n,r){const l=this.decodeMiddleCounters.map(b=>b);l[0]=0,l[1]=0,l[2]=0,l[3]=0;const o=s.getSize();let d=n[1],u=0;for(let b=0;b<6&&d<o;b++){const S=Ks.decodeDigit(s,l,d,Ks.L_AND_G_PATTERNS);r+=String.fromCharCode(48+S%10);for(let M of l)d+=M;S>=10&&(u|=1<<5-b)}let m=Ks.determineNumSysAndCheckDigit(r,u);return{rowOffset:d,resultString:m}}decodeEnd(s,n){return Ks.findGuardPatternWithoutCounters(s,n,!0,Ks.MIDDLE_END_PATTERN)}checkChecksum(s){return Mt.checkChecksum(Ks.convertUPCEtoUPCA(s))}static determineNumSysAndCheckDigit(s,n){for(let r=0;r<=1;r++)for(let l=0;l<10;l++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[r][l]){let o=String.fromCharCode(48+r),d=String.fromCharCode(48+l);return o+s+d}throw F.getNotFoundInstance()}getBarcodeFormat(){return xe.UPC_E}static convertUPCEtoUPCA(s){const n=s.slice(1,7).split("").map(o=>o.charCodeAt(0)),r=new J;r.append(s.charAt(0));let l=n[5];switch(l){case 0:case 1:case 2:r.appendChars(n,0,2),r.append(l),r.append("0000"),r.appendChars(n,2,3);break;case 3:r.appendChars(n,0,3),r.append("00000"),r.appendChars(n,3,2);break;case 4:r.appendChars(n,0,4),r.append("00000"),r.append(n[4]);break;default:r.appendChars(n,0,5),r.append("0000"),r.append(l);break}return s.length>=8&&r.append(s.charAt(7)),r.toString()}}Ks.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ks.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class nl extends Ue{constructor(s){super();let n=s==null?null:s.get(ce.POSSIBLE_FORMATS),r=[];y(n)?(r.push(new Oa),r.push(new kr),r.push(new en),r.push(new Ks)):(n.indexOf(xe.EAN_13)>-1&&r.push(new Oa),n.indexOf(xe.UPC_A)>-1&&r.push(new kr),n.indexOf(xe.EAN_8)>-1&&r.push(new en),n.indexOf(xe.UPC_E)>-1&&r.push(new Ks)),this.readers=r}decodeRow(s,n,r){for(let l of this.readers)try{const o=l.decodeRow(s,n,r),d=o.getBarcodeFormat()===xe.EAN_13&&o.getText().charAt(0)==="0",u=r==null?null:r.get(ce.POSSIBLE_FORMATS),m=u==null||u.includes(xe.UPC_A);if(d&&m){const b=o.getRawBytes(),S=new Z(o.getText().substring(1),b,b?b.length:null,o.getResultPoints(),xe.UPC_A);return S.putAllMetadata(o.getResultMetadata()),S}return o}catch{}throw new F}reset(){for(let s of this.readers)s.reset()}}class Us extends Ue{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(s,n){for(let r=0;r<n.length;r++)if(Ue.patternMatchVariance(s,n[r],Us.MAX_INDIVIDUAL_VARIANCE)<Us.MAX_AVG_VARIANCE)return r;throw new F}static count(s){return Xe.sum(new Int32Array(s))}static increment(s,n){let r=0,l=n[0];for(let o=1;o<s.length;o++)n[o]>l&&(l=n[o],r=o);s[r]++}static decrement(s,n){let r=0,l=n[0];for(let o=1;o<s.length;o++)n[o]<l&&(l=n[o],r=o);s[r]--}static isFinderPattern(s){let n=s[0]+s[1],r=n+s[2]+s[3],l=n/r;if(l>=Us.MIN_FINDER_PATTERN_RATIO&&l<=Us.MAX_FINDER_PATTERN_RATIO){let o=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER;for(let u of s)u>d&&(d=u),u<o&&(o=u);return d<10*o}return!1}}Us.MAX_AVG_VARIANCE=.2,Us.MAX_INDIVIDUAL_VARIANCE=.45,Us.MIN_FINDER_PATTERN_RATIO=9.5/12,Us.MAX_FINDER_PATTERN_RATIO=12.5/14;class tn{constructor(s,n){this.value=s,this.checksumPortion=n}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(s){if(!(s instanceof tn))return!1;const n=s;return this.value===n.value&&this.checksumPortion===n.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class sn{constructor(s,n,r,l,o){this.value=s,this.startEnd=n,this.value=s,this.startEnd=n,this.resultPoints=new Array,this.resultPoints.push(new He(r,o)),this.resultPoints.push(new He(l,o))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(s){if(!(s instanceof sn))return!1;const n=s;return this.value===n.value}hashCode(){return this.value}}class Da{constructor(){}static getRSSvalue(s,n,r){let l=0;for(let m of s)l+=m;let o=0,d=0,u=s.length;for(let m=0;m<u-1;m++){let b;for(b=1,d|=1<<m;b<s[m];b++,d&=~(1<<m)){let S=Da.combins(l-b-1,u-m-2);if(r&&d===0&&l-b-(u-m-1)>=u-m-1&&(S-=Da.combins(l-b-(u-m),u-m-2)),u-m-1>1){let M=0;for(let k=l-b-(u-m-2);k>n;k--)M+=Da.combins(l-b-k-1,u-m-3);S-=M*(u-1-m)}else l-b>n&&S--;o+=S}l-=b}return o}static combins(s,n){let r,l;s-n>n?(l=n,r=s-n):(l=s-n,r=n);let o=1,d=1;for(let u=s;u>r;u--)o*=u,d<=l&&(o/=d,d++);for(;d<=l;)o/=d,d++;return o}}class ao{static buildBitArray(s){let n=s.length*2-1;s[s.length-1].getRightChar()==null&&(n-=1);let r=12*n,l=new q(r),o=0,u=s[0].getRightChar().getValue();for(let m=11;m>=0;--m)(u&1<<m)!=0&&l.set(o),o++;for(let m=1;m<s.length;++m){let b=s[m],S=b.getLeftChar().getValue();for(let M=11;M>=0;--M)(S&1<<M)!=0&&l.set(o),o++;if(b.getRightChar()!=null){let M=b.getRightChar().getValue();for(let k=11;k>=0;--k)(M&1<<k)!=0&&l.set(o),o++}}return l}}class an{constructor(s,n){n?this.decodedInformation=null:(this.finished=s,this.decodedInformation=n)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class oi{constructor(s){this.newPosition=s}getNewPosition(){return this.newPosition}}class Ys extends oi{constructor(s,n){super(s),this.value=n}getValue(){return this.value}isFNC1(){return this.value===Ys.FNC1}}Ys.FNC1="$";class Xa extends oi{constructor(s,n,r){super(s),r?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=n}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class ta extends oi{constructor(s,n,r){if(super(s),n<0||n>10||r<0||r>10)throw new $;this.firstDigit=n,this.secondDigit=r}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===ta.FNC1}isSecondDigitFNC1(){return this.secondDigit===ta.FNC1}isAnyFNC1(){return this.firstDigit===ta.FNC1||this.secondDigit===ta.FNC1}}ta.FNC1=10;class qe{constructor(){}static parseFieldsInGeneralPurpose(s){if(!s)return null;if(s.length<2)throw new F;let n=s.substring(0,2);for(let o of qe.TWO_DIGIT_DATA_LENGTH)if(o[0]===n)return o[1]===qe.VARIABLE_LENGTH?qe.processVariableAI(2,o[2],s):qe.processFixedAI(2,o[1],s);if(s.length<3)throw new F;let r=s.substring(0,3);for(let o of qe.THREE_DIGIT_DATA_LENGTH)if(o[0]===r)return o[1]===qe.VARIABLE_LENGTH?qe.processVariableAI(3,o[2],s):qe.processFixedAI(3,o[1],s);for(let o of qe.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(o[0]===r)return o[1]===qe.VARIABLE_LENGTH?qe.processVariableAI(4,o[2],s):qe.processFixedAI(4,o[1],s);if(s.length<4)throw new F;let l=s.substring(0,4);for(let o of qe.FOUR_DIGIT_DATA_LENGTH)if(o[0]===l)return o[1]===qe.VARIABLE_LENGTH?qe.processVariableAI(4,o[2],s):qe.processFixedAI(4,o[1],s);throw new F}static processFixedAI(s,n,r){if(r.length<s)throw new F;let l=r.substring(0,s);if(r.length<s+n)throw new F;let o=r.substring(s,s+n),d=r.substring(s+n),u="("+l+")"+o,m=qe.parseFieldsInGeneralPurpose(d);return m==null?u:u+m}static processVariableAI(s,n,r){let l=r.substring(0,s),o;r.length<s+n?o=r.length:o=s+n;let d=r.substring(s,o),u=r.substring(o),m="("+l+")"+d,b=qe.parseFieldsInGeneralPurpose(u);return b==null?m:m+b}}qe.VARIABLE_LENGTH=[],qe.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",qe.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",qe.VARIABLE_LENGTH,20],["22",qe.VARIABLE_LENGTH,29],["30",qe.VARIABLE_LENGTH,8],["37",qe.VARIABLE_LENGTH,8],["90",qe.VARIABLE_LENGTH,30],["91",qe.VARIABLE_LENGTH,30],["92",qe.VARIABLE_LENGTH,30],["93",qe.VARIABLE_LENGTH,30],["94",qe.VARIABLE_LENGTH,30],["95",qe.VARIABLE_LENGTH,30],["96",qe.VARIABLE_LENGTH,30],["97",qe.VARIABLE_LENGTH,3],["98",qe.VARIABLE_LENGTH,30],["99",qe.VARIABLE_LENGTH,30]],qe.THREE_DIGIT_DATA_LENGTH=[["240",qe.VARIABLE_LENGTH,30],["241",qe.VARIABLE_LENGTH,30],["242",qe.VARIABLE_LENGTH,6],["250",qe.VARIABLE_LENGTH,30],["251",qe.VARIABLE_LENGTH,30],["253",qe.VARIABLE_LENGTH,17],["254",qe.VARIABLE_LENGTH,20],["400",qe.VARIABLE_LENGTH,30],["401",qe.VARIABLE_LENGTH,30],["402",17],["403",qe.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",qe.VARIABLE_LENGTH,20],["421",qe.VARIABLE_LENGTH,15],["422",3],["423",qe.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],qe.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",qe.VARIABLE_LENGTH,15],["391",qe.VARIABLE_LENGTH,18],["392",qe.VARIABLE_LENGTH,15],["393",qe.VARIABLE_LENGTH,18],["703",qe.VARIABLE_LENGTH,30]],qe.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",qe.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",qe.VARIABLE_LENGTH,20],["8003",qe.VARIABLE_LENGTH,30],["8004",qe.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",qe.VARIABLE_LENGTH,30],["8008",qe.VARIABLE_LENGTH,12],["8018",18],["8020",qe.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",qe.VARIABLE_LENGTH,70],["8200",qe.VARIABLE_LENGTH,70]];class sa{constructor(s){this.buffer=new J,this.information=s}decodeAllCodes(s,n){let r=n,l=null;do{let o=this.decodeGeneralPurposeField(r,l),d=qe.parseFieldsInGeneralPurpose(o.getNewString());if(d!=null&&s.append(d),o.isRemaining()?l=""+o.getRemainingValue():l=null,r===o.getNewPosition())break;r=o.getNewPosition()}while(!0);return s.toString()}isStillNumeric(s){if(s+7>this.information.getSize())return s+4<=this.information.getSize();for(let n=s;n<s+3;++n)if(this.information.get(n))return!0;return this.information.get(s+3)}decodeNumeric(s){if(s+7>this.information.getSize()){let o=this.extractNumericValueFromBitArray(s,4);return o===0?new ta(this.information.getSize(),ta.FNC1,ta.FNC1):new ta(this.information.getSize(),o-1,ta.FNC1)}let n=this.extractNumericValueFromBitArray(s,7),r=(n-8)/11,l=(n-8)%11;return new ta(s+7,r,l)}extractNumericValueFromBitArray(s,n){return sa.extractNumericValueFromBitArray(this.information,s,n)}static extractNumericValueFromBitArray(s,n,r){let l=0;for(let o=0;o<r;++o)s.get(n+o)&&(l|=1<<r-o-1);return l}decodeGeneralPurposeField(s,n){this.buffer.setLengthToZero(),n!=null&&this.buffer.append(n),this.current.setPosition(s);let r=this.parseBlocks();return r!=null&&r.isRemaining()?new Xa(this.current.getPosition(),this.buffer.toString(),r.getRemainingValue()):new Xa(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let s,n;do{let r=this.current.getPosition();if(this.current.isAlpha()?(n=this.parseAlphaBlock(),s=n.isFinished()):this.current.isIsoIec646()?(n=this.parseIsoIec646Block(),s=n.isFinished()):(n=this.parseNumericBlock(),s=n.isFinished()),!(r!==this.current.getPosition())&&!s)break}while(!s);return n.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let s=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFirstDigitFNC1()){let n;return s.isSecondDigitFNC1()?n=new Xa(this.current.getPosition(),this.buffer.toString()):n=new Xa(this.current.getPosition(),this.buffer.toString(),s.getSecondDigit()),new an(!0,n)}if(this.buffer.append(s.getFirstDigit()),s.isSecondDigitFNC1()){let n=new Xa(this.current.getPosition(),this.buffer.toString());return new an(!0,n)}this.buffer.append(s.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new an(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let s=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFNC1()){let n=new Xa(this.current.getPosition(),this.buffer.toString());return new an(!0,n)}this.buffer.append(s.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new an(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let s=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFNC1()){let n=new Xa(this.current.getPosition(),this.buffer.toString());return new an(!0,n)}this.buffer.append(s.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new an(!1)}isStillIsoIec646(s){if(s+5>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(s,5);if(n>=5&&n<16)return!0;if(s+7>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(s,7);if(r>=64&&r<116)return!0;if(s+8>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(s,8);return l>=232&&l<253}decodeIsoIec646(s){let n=this.extractNumericValueFromBitArray(s,5);if(n===15)return new Ys(s+5,Ys.FNC1);if(n>=5&&n<15)return new Ys(s+5,"0"+(n-5));let r=this.extractNumericValueFromBitArray(s,7);if(r>=64&&r<90)return new Ys(s+7,""+(r+1));if(r>=90&&r<116)return new Ys(s+7,""+(r+7));let l=this.extractNumericValueFromBitArray(s,8),o;switch(l){case 232:o="!";break;case 233:o='"';break;case 234:o="%";break;case 235:o="&";break;case 236:o="'";break;case 237:o="(";break;case 238:o=")";break;case 239:o="*";break;case 240:o="+";break;case 241:o=",";break;case 242:o="-";break;case 243:o=".";break;case 244:o="/";break;case 245:o=":";break;case 246:o=";";break;case 247:o="<";break;case 248:o="=";break;case 249:o=">";break;case 250:o="?";break;case 251:o="_";break;case 252:o=" ";break;default:throw new $}return new Ys(s+8,o)}isStillAlpha(s){if(s+5>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(s,5);if(n>=5&&n<16)return!0;if(s+6>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(s,6);return r>=16&&r<63}decodeAlphanumeric(s){let n=this.extractNumericValueFromBitArray(s,5);if(n===15)return new Ys(s+5,Ys.FNC1);if(n>=5&&n<15)return new Ys(s+5,"0"+(n-5));let r=this.extractNumericValueFromBitArray(s,6);if(r>=32&&r<58)return new Ys(s+6,""+(r+33));let l;switch(r){case 58:l="*";break;case 59:l=",";break;case 60:l="-";break;case 61:l=".";break;case 62:l="/";break;default:throw new Oe("Decoding invalid alphanumeric value: "+r)}return new Ys(s+6,l)}isAlphaTo646ToAlphaLatch(s){if(s+1>this.information.getSize())return!1;for(let n=0;n<5&&n+s<this.information.getSize();++n)if(n===2){if(!this.information.get(s+2))return!1}else if(this.information.get(s+n))return!1;return!0}isAlphaOr646ToNumericLatch(s){if(s+3>this.information.getSize())return!1;for(let n=s;n<s+3;++n)if(this.information.get(n))return!1;return!0}isNumericToAlphaNumericLatch(s){if(s+1>this.information.getSize())return!1;for(let n=0;n<4&&n+s<this.information.getSize();++n)if(this.information.get(s+n))return!1;return!0}}class Es{constructor(s){this.information=s,this.generalDecoder=new sa(s)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Jt extends Es{constructor(s){super(s)}encodeCompressedGtin(s,n){s.append("(01)");let r=s.length();s.append("9"),this.encodeCompressedGtinWithoutAI(s,n,r)}encodeCompressedGtinWithoutAI(s,n,r){for(let l=0;l<4;++l){let o=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*l,10);o/100===0&&s.append("0"),o/10===0&&s.append("0"),s.append(o)}Jt.appendCheckDigit(s,r)}static appendCheckDigit(s,n){let r=0;for(let l=0;l<13;l++){let o=s.charAt(l+n).charCodeAt(0)-48;r+=(l&1)===0?3*o:o}r=10-r%10,r===10&&(r=0),s.append(r)}}Jt.GTIN_SIZE=40;class pa extends Jt{constructor(s){super(s)}parseInformation(){let s=new J;s.append("(01)");let n=s.length(),r=this.getGeneralDecoder().extractNumericValueFromBitArray(pa.HEADER_SIZE,4);return s.append(r),this.encodeCompressedGtinWithoutAI(s,pa.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(s,pa.HEADER_SIZE+44)}}pa.HEADER_SIZE=4;class Kn extends Es{constructor(s){super(s)}parseInformation(){let s=new J;return this.getGeneralDecoder().decodeAllCodes(s,Kn.HEADER_SIZE)}}Kn.HEADER_SIZE=5;class ci extends Jt{constructor(s){super(s)}encodeCompressedWeight(s,n,r){let l=this.getGeneralDecoder().extractNumericValueFromBitArray(n,r);this.addWeightCode(s,l);let o=this.checkWeight(l),d=1e5;for(let u=0;u<5;++u)o/d===0&&s.append("0"),d/=10;s.append(o)}}class _a extends ci{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()!=_a.HEADER_SIZE+ci.GTIN_SIZE+_a.WEIGHT_SIZE)throw new F;let s=new J;return this.encodeCompressedGtin(s,_a.HEADER_SIZE),this.encodeCompressedWeight(s,_a.HEADER_SIZE+ci.GTIN_SIZE,_a.WEIGHT_SIZE),s.toString()}}_a.HEADER_SIZE=5,_a.WEIGHT_SIZE=15;class no extends _a{constructor(s){super(s)}addWeightCode(s,n){s.append("(3103)")}checkWeight(s){return s}}class Br extends _a{constructor(s){super(s)}addWeightCode(s,n){n<1e4?s.append("(3202)"):s.append("(3203)")}checkWeight(s){return s<1e4?s:s-1e4}}class oa extends Jt{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()<oa.HEADER_SIZE+Jt.GTIN_SIZE)throw new F;let s=new J;this.encodeCompressedGtin(s,oa.HEADER_SIZE);let n=this.getGeneralDecoder().extractNumericValueFromBitArray(oa.HEADER_SIZE+Jt.GTIN_SIZE,oa.LAST_DIGIT_SIZE);s.append("(392"),s.append(n),s.append(")");let r=this.getGeneralDecoder().decodeGeneralPurposeField(oa.HEADER_SIZE+Jt.GTIN_SIZE+oa.LAST_DIGIT_SIZE,null);return s.append(r.getNewString()),s.toString()}}oa.HEADER_SIZE=8,oa.LAST_DIGIT_SIZE=2;class bs extends Jt{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()<bs.HEADER_SIZE+Jt.GTIN_SIZE)throw new F;let s=new J;this.encodeCompressedGtin(s,bs.HEADER_SIZE);let n=this.getGeneralDecoder().extractNumericValueFromBitArray(bs.HEADER_SIZE+Jt.GTIN_SIZE,bs.LAST_DIGIT_SIZE);s.append("(393"),s.append(n),s.append(")");let r=this.getGeneralDecoder().extractNumericValueFromBitArray(bs.HEADER_SIZE+Jt.GTIN_SIZE+bs.LAST_DIGIT_SIZE,bs.FIRST_THREE_DIGITS_SIZE);r/100==0&&s.append("0"),r/10==0&&s.append("0"),s.append(r);let l=this.getGeneralDecoder().decodeGeneralPurposeField(bs.HEADER_SIZE+Jt.GTIN_SIZE+bs.LAST_DIGIT_SIZE+bs.FIRST_THREE_DIGITS_SIZE,null);return s.append(l.getNewString()),s.toString()}}bs.HEADER_SIZE=8,bs.LAST_DIGIT_SIZE=2,bs.FIRST_THREE_DIGITS_SIZE=10;class Xt extends ci{constructor(s,n,r){super(s),this.dateCode=r,this.firstAIdigits=n}parseInformation(){if(this.getInformation().getSize()!=Xt.HEADER_SIZE+Xt.GTIN_SIZE+Xt.WEIGHT_SIZE+Xt.DATE_SIZE)throw new F;let s=new J;return this.encodeCompressedGtin(s,Xt.HEADER_SIZE),this.encodeCompressedWeight(s,Xt.HEADER_SIZE+Xt.GTIN_SIZE,Xt.WEIGHT_SIZE),this.encodeCompressedDate(s,Xt.HEADER_SIZE+Xt.GTIN_SIZE+Xt.WEIGHT_SIZE),s.toString()}encodeCompressedDate(s,n){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(n,Xt.DATE_SIZE);if(r==38400)return;s.append("("),s.append(this.dateCode),s.append(")");let l=r%32;r/=32;let o=r%12+1;r/=12;let d=r;d/10==0&&s.append("0"),s.append(d),o/10==0&&s.append("0"),s.append(o),l/10==0&&s.append("0"),s.append(l)}addWeightCode(s,n){s.append("("),s.append(this.firstAIdigits),s.append(n/1e5),s.append(")")}checkWeight(s){return s%1e5}}Xt.HEADER_SIZE=8,Xt.WEIGHT_SIZE=20,Xt.DATE_SIZE=16;function Zn(I){try{if(I.get(1))return new pa(I);if(!I.get(2))return new Kn(I);switch(sa.extractNumericValueFromBitArray(I,1,4)){case 4:return new no(I);case 5:return new Br(I)}switch(sa.extractNumericValueFromBitArray(I,1,5)){case 12:return new oa(I);case 13:return new bs(I)}switch(sa.extractNumericValueFromBitArray(I,1,7)){case 56:return new Xt(I,"310","11");case 57:return new Xt(I,"320","11");case 58:return new Xt(I,"310","13");case 59:return new Xt(I,"320","13");case 60:return new Xt(I,"310","15");case 61:return new Xt(I,"320","15");case 62:return new Xt(I,"310","17");case 63:return new Xt(I,"320","17")}}catch(s){throw console.log(s),new Oe("unknown decoder: "+I)}}class aa{constructor(s,n,r,l){this.leftchar=s,this.rightchar=n,this.finderpattern=r,this.maybeLast=l}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(s,n){return s instanceof aa?aa.equalsOrNull(s.leftchar,n.leftchar)&&aa.equalsOrNull(s.rightchar,n.rightchar)&&aa.equalsOrNull(s.finderpattern,n.finderpattern):!1}static equalsOrNull(s,n){return s===null?n===null:aa.equals(s,n)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class ws{constructor(s,n,r){this.pairs=s,this.rowNumber=n,this.wasReversed=r}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(s){return this.checkEqualitity(this,s)}toString(){return"{ "+this.pairs+" }"}equals(s,n){return s instanceof ws?this.checkEqualitity(s,n)&&s.wasReversed===n.wasReversed:!1}checkEqualitity(s,n){if(!s||!n)return;let r;return s.forEach((l,o)=>{n.forEach(d=>{l.getLeftChar().getValue()===d.getLeftChar().getValue()&&l.getRightChar().getValue()===d.getRightChar().getValue()&&l.getFinderPatter().getValue()===d.getFinderPatter().getValue()&&(r=!0)})}),r}}class Me extends Us{constructor(s){super(...arguments),this.pairs=new Array(Me.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=s===!0}decodeRow(s,n,r){this.pairs.length=0,this.startFromEven=!1;try{return Me.constructResult(this.decodeRow2pairs(s,n))}catch(l){this.verbose&&console.log(l)}return this.pairs.length=0,this.startFromEven=!0,Me.constructResult(this.decodeRow2pairs(s,n))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(s,n){let r=!1;for(;!r;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,s))}catch(o){if(o instanceof F){if(!this.pairs.length)throw new F;r=!0}}if(this.checkChecksum())return this.pairs;let l;if(this.rows.length?l=!0:l=!1,this.storeRow(s,!1),l){let o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new F}checkRowsBoolean(s){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,s&&(this.rows=this.rows.reverse());let n=null;try{n=this.checkRows(new Array,0)}catch(r){this.verbose&&console.log(r)}return s&&(this.rows=this.rows.reverse()),n}checkRows(s,n){for(let r=n;r<this.rows.length;r++){let l=this.rows[r];this.pairs.length=0;for(let d of s)this.pairs.push(d.getPairs());if(this.pairs.push(l.getPairs()),!Me.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let o=new Array(s);o.push(l);try{return this.checkRows(o,r+1)}catch(d){this.verbose&&console.log(d)}}throw new F}static isValidSequence(s){for(let n of Me.FINDER_PATTERN_SEQUENCES){if(s.length>n.length)continue;let r=!0;for(let l=0;l<s.length;l++)if(s[l].getFinderPattern().getValue()!=n[l]){r=!1;break}if(r)return!0}return!1}storeRow(s,n){let r=0,l=!1,o=!1;for(;r<this.rows.length;){let d=this.rows[r];if(d.getRowNumber()>s){o=d.isEquivalent(this.pairs);break}l=d.isEquivalent(this.pairs),r++}o||l||Me.isPartialRow(this.pairs,this.rows)||(this.rows.push(r,new ws(this.pairs,s,n)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(s,n){for(let r of n)if(r.getPairs().length!==s.length){for(let l of r.getPairs())for(let o of s)if(aa.equals(l,o))break}}static isPartialRow(s,n){for(let r of n){let l=!0;for(let o of s){let d=!1;for(let u of r.getPairs())if(o.equals(u)){d=!0;break}if(!d){l=!1;break}}if(l)return!0}return!1}getRows(){return this.rows}static constructResult(s){let n=ao.buildBitArray(s),l=Zn(n).parseInformation(),o=s[0].getFinderPattern().getResultPoints(),d=s[s.length-1].getFinderPattern().getResultPoints(),u=[o[0],o[1],d[0],d[1]];return new Z(l,null,null,u,xe.RSS_EXPANDED,null)}checkChecksum(){let s=this.pairs.get(0),n=s.getLeftChar(),r=s.getRightChar();if(r==null)return!1;let l=r.getChecksumPortion(),o=2;for(let u=1;u<this.pairs.size();++u){let m=this.pairs.get(u);l+=m.getLeftChar().getChecksumPortion(),o++;let b=m.getRightChar();b!=null&&(l+=b.getChecksumPortion(),o++)}return l%=211,211*(o-4)+l==n.getValue()}static getNextSecondBar(s,n){let r;return s.get(n)?(r=s.getNextUnset(n),r=s.getNextSet(r)):(r=s.getNextSet(n),r=s.getNextUnset(r)),r}retrieveNextPair(s,n,r){let l=n.length%2==0;this.startFromEven&&(l=!l);let o,d=!0,u=-1;do this.findNextPair(s,n,u),o=this.parseFoundFinderPattern(s,r,l),o==null?u=Me.getNextSecondBar(s,this.startEnd[0]):d=!1;while(d);let m=this.decodeDataCharacter(s,o,l,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new F;let b;try{b=this.decodeDataCharacter(s,o,l,!1)}catch(S){b=null,this.verbose&&console.log(S)}return new aa(m,b,o,!0)}isEmptyPair(s){return s.length===0}findNextPair(s,n,r){let l=this.getDecodeFinderCounters();l[0]=0,l[1]=0,l[2]=0,l[3]=0;let o=s.getSize(),d;r>=0?d=r:this.isEmptyPair(n)?d=0:d=n[n.length-1].getFinderPattern().getStartEnd()[1];let u=n.length%2!=0;this.startFromEven&&(u=!u);let m=!1;for(;d<o&&(m=!s.get(d),!!m);)d++;let b=0,S=d;for(let M=d;M<o;M++)if(s.get(M)!=m)l[b]++;else{if(b==3){if(u&&Me.reverseCounters(l),Me.isFinderPattern(l)){this.startEnd[0]=S,this.startEnd[1]=M;return}u&&Me.reverseCounters(l),S+=l[0]+l[1],l[0]=l[2],l[1]=l[3],l[2]=0,l[3]=0,b--}else b++;l[b]=1,m=!m}throw new F}static reverseCounters(s){let n=s.length;for(let r=0;r<n/2;++r){let l=s[r];s[r]=s[n-r-1],s[n-r-1]=l}}parseFoundFinderPattern(s,n,r){let l,o,d;if(r){let b=this.startEnd[0]-1;for(;b>=0&&!s.get(b);)b--;b++,l=this.startEnd[0]-b,o=b,d=this.startEnd[1]}else o=this.startEnd[0],d=s.getNextUnset(this.startEnd[1]+1),l=d-this.startEnd[1];let u=this.getDecodeFinderCounters();V.arraycopy(u,0,u,1,u.length-1),u[0]=l;let m;try{m=this.parseFinderValue(u,Me.FINDER_PATTERNS)}catch{return null}return new sn(m,[o,d],o,d,n)}decodeDataCharacter(s,n,r,l){let o=this.getDataCharacterCounters();for(let Qt=0;Qt<o.length;Qt++)o[Qt]=0;if(l)Me.recordPatternInReverse(s,n.getStartEnd()[0],o);else{Me.recordPattern(s,n.getStartEnd()[1],o);for(let Qt=0,Vs=o.length-1;Qt<Vs;Qt++,Vs--){let ia=o[Qt];o[Qt]=o[Vs],o[Vs]=ia}}let d=17,u=Xe.sum(new Int32Array(o))/d,m=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(u-m)/m>.3)throw new F;let b=this.getOddCounts(),S=this.getEvenCounts(),M=this.getOddRoundingErrors(),k=this.getEvenRoundingErrors();for(let Qt=0;Qt<o.length;Qt++){let Vs=1*o[Qt]/u,ia=Vs+.5;if(ia<1){if(Vs<.3)throw new F;ia=1}else if(ia>8){if(Vs>8.7)throw new F;ia=8}let lr=Qt/2;(Qt&1)==0?(b[lr]=ia,M[lr]=Vs-ia):(S[lr]=ia,k[lr]=Vs-ia)}this.adjustOddEvenCounts(d);let X=4*n.getValue()+(r?0:2)+(l?0:1)-1,re=0,ie=0;for(let Qt=b.length-1;Qt>=0;Qt--){if(Me.isNotA1left(n,r,l)){let Vs=Me.WEIGHTS[X][2*Qt];ie+=b[Qt]*Vs}re+=b[Qt]}let he=0;for(let Qt=S.length-1;Qt>=0;Qt--)if(Me.isNotA1left(n,r,l)){let Vs=Me.WEIGHTS[X][2*Qt+1];he+=S[Qt]*Vs}let je=ie+he;if((re&1)!=0||re>13||re<4)throw new F;let Pe=(13-re)/2,Le=Me.SYMBOL_WIDEST[Pe],ke=9-Le,Rt=Da.getRSSvalue(b,Le,!0),wt=Da.getRSSvalue(S,ke,!1),Ns=Me.EVEN_TOTAL_SUBSET[Pe],ua=Me.GSUM[Pe],Zs=Rt*Ns+wt+ua;return new tn(Zs,je)}static isNotA1left(s,n,r){return!(s.getValue()==0&&n&&r)}adjustOddEvenCounts(s){let n=Xe.sum(new Int32Array(this.getOddCounts())),r=Xe.sum(new Int32Array(this.getEvenCounts())),l=!1,o=!1;n>13?o=!0:n<4&&(l=!0);let d=!1,u=!1;r>13?u=!0:r<4&&(d=!0);let m=n+r-s,b=(n&1)==1,S=(r&1)==0;if(m==1)if(b){if(S)throw new F;o=!0}else{if(!S)throw new F;u=!0}else if(m==-1)if(b){if(S)throw new F;l=!0}else{if(!S)throw new F;d=!0}else if(m==0){if(b){if(!S)throw new F;n<r?(l=!0,u=!0):(o=!0,d=!0)}else if(S)throw new F}else throw new F;if(l){if(o)throw new F;Me.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&Me.decrement(this.getOddCounts(),this.getOddRoundingErrors()),d){if(u)throw new F;Me.increment(this.getEvenCounts(),this.getOddRoundingErrors())}u&&Me.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Me.SYMBOL_WIDEST=[7,5,4,3,1],Me.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Me.GSUM=[0,348,1388,2948,3988],Me.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Me.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Me.FINDER_PAT_A=0,Me.FINDER_PAT_B=1,Me.FINDER_PAT_C=2,Me.FINDER_PAT_D=3,Me.FINDER_PAT_E=4,Me.FINDER_PAT_F=5,Me.FINDER_PATTERN_SEQUENCES=[[Me.FINDER_PAT_A,Me.FINDER_PAT_A],[Me.FINDER_PAT_A,Me.FINDER_PAT_B,Me.FINDER_PAT_B],[Me.FINDER_PAT_A,Me.FINDER_PAT_C,Me.FINDER_PAT_B,Me.FINDER_PAT_D],[Me.FINDER_PAT_A,Me.FINDER_PAT_E,Me.FINDER_PAT_B,Me.FINDER_PAT_D,Me.FINDER_PAT_C],[Me.FINDER_PAT_A,Me.FINDER_PAT_E,Me.FINDER_PAT_B,Me.FINDER_PAT_D,Me.FINDER_PAT_D,Me.FINDER_PAT_F],[Me.FINDER_PAT_A,Me.FINDER_PAT_E,Me.FINDER_PAT_B,Me.FINDER_PAT_D,Me.FINDER_PAT_E,Me.FINDER_PAT_F,Me.FINDER_PAT_F],[Me.FINDER_PAT_A,Me.FINDER_PAT_A,Me.FINDER_PAT_B,Me.FINDER_PAT_B,Me.FINDER_PAT_C,Me.FINDER_PAT_C,Me.FINDER_PAT_D,Me.FINDER_PAT_D],[Me.FINDER_PAT_A,Me.FINDER_PAT_A,Me.FINDER_PAT_B,Me.FINDER_PAT_B,Me.FINDER_PAT_C,Me.FINDER_PAT_C,Me.FINDER_PAT_D,Me.FINDER_PAT_E,Me.FINDER_PAT_E],[Me.FINDER_PAT_A,Me.FINDER_PAT_A,Me.FINDER_PAT_B,Me.FINDER_PAT_B,Me.FINDER_PAT_C,Me.FINDER_PAT_C,Me.FINDER_PAT_D,Me.FINDER_PAT_E,Me.FINDER_PAT_F,Me.FINDER_PAT_F],[Me.FINDER_PAT_A,Me.FINDER_PAT_A,Me.FINDER_PAT_B,Me.FINDER_PAT_B,Me.FINDER_PAT_C,Me.FINDER_PAT_D,Me.FINDER_PAT_D,Me.FINDER_PAT_E,Me.FINDER_PAT_E,Me.FINDER_PAT_F,Me.FINDER_PAT_F]],Me.MAX_PAIRS=11;class ro extends tn{constructor(s,n,r){super(s,n),this.count=0,this.finderPattern=r}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Zt extends Us{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(s,n,r){const l=this.decodePair(n,!1,s,r);Zt.addOrTally(this.possibleLeftPairs,l),n.reverse();let o=this.decodePair(n,!0,s,r);Zt.addOrTally(this.possibleRightPairs,o),n.reverse();for(let d of this.possibleLeftPairs)if(d.getCount()>1){for(let u of this.possibleRightPairs)if(u.getCount()>1&&Zt.checkChecksum(d,u))return Zt.constructResult(d,u)}throw new F}static addOrTally(s,n){if(n==null)return;let r=!1;for(let l of s)if(l.getValue()===n.getValue()){l.incrementCount(),r=!0;break}r||s.push(n)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(s,n){let r=4537077*s.getValue()+n.getValue(),l=new String(r).toString(),o=new J;for(let b=13-l.length;b>0;b--)o.append("0");o.append(l);let d=0;for(let b=0;b<13;b++){let S=o.charAt(b).charCodeAt(0)-48;d+=(b&1)===0?3*S:S}d=10-d%10,d===10&&(d=0),o.append(d.toString());let u=s.getFinderPattern().getResultPoints(),m=n.getFinderPattern().getResultPoints();return new Z(o.toString(),null,0,[u[0],u[1],m[0],m[1]],xe.RSS_14,new Date().getTime())}static checkChecksum(s,n){let r=(s.getChecksumPortion()+16*n.getChecksumPortion())%79,l=9*s.getFinderPattern().getValue()+n.getFinderPattern().getValue();return l>72&&l--,l>8&&l--,r===l}decodePair(s,n,r,l){try{let o=this.findFinderPattern(s,n),d=this.parseFoundFinderPattern(s,r,n,o),u=l==null?null:l.get(ce.NEED_RESULT_POINT_CALLBACK);if(u!=null){let S=(o[0]+o[1])/2;n&&(S=s.getSize()-1-S),u.foundPossibleResultPoint(new He(S,r))}let m=this.decodeDataCharacter(s,d,!0),b=this.decodeDataCharacter(s,d,!1);return new ro(1597*m.getValue()+b.getValue(),m.getChecksumPortion()+4*b.getChecksumPortion(),d)}catch{return null}}decodeDataCharacter(s,n,r){let l=this.getDataCharacterCounters();for(let he=0;he<l.length;he++)l[he]=0;if(r)Ue.recordPatternInReverse(s,n.getStartEnd()[0],l);else{Ue.recordPattern(s,n.getStartEnd()[1]+1,l);for(let he=0,je=l.length-1;he<je;he++,je--){let Pe=l[he];l[he]=l[je],l[je]=Pe}}let o=r?16:15,d=Xe.sum(new Int32Array(l))/o,u=this.getOddCounts(),m=this.getEvenCounts(),b=this.getOddRoundingErrors(),S=this.getEvenRoundingErrors();for(let he=0;he<l.length;he++){let je=l[he]/d,Pe=Math.floor(je+.5);Pe<1?Pe=1:Pe>8&&(Pe=8);let Le=Math.floor(he/2);(he&1)===0?(u[Le]=Pe,b[Le]=je-Pe):(m[Le]=Pe,S[Le]=je-Pe)}this.adjustOddEvenCounts(r,o);let M=0,k=0;for(let he=u.length-1;he>=0;he--)k*=9,k+=u[he],M+=u[he];let X=0,re=0;for(let he=m.length-1;he>=0;he--)X*=9,X+=m[he],re+=m[he];let ie=k+3*X;if(r){if((M&1)!==0||M>12||M<4)throw new F;let he=(12-M)/2,je=Zt.OUTSIDE_ODD_WIDEST[he],Pe=9-je,Le=Da.getRSSvalue(u,je,!1),ke=Da.getRSSvalue(m,Pe,!0),Rt=Zt.OUTSIDE_EVEN_TOTAL_SUBSET[he],wt=Zt.OUTSIDE_GSUM[he];return new tn(Le*Rt+ke+wt,ie)}else{if((re&1)!==0||re>10||re<4)throw new F;let he=(10-re)/2,je=Zt.INSIDE_ODD_WIDEST[he],Pe=9-je,Le=Da.getRSSvalue(u,je,!0),ke=Da.getRSSvalue(m,Pe,!1),Rt=Zt.INSIDE_ODD_TOTAL_SUBSET[he],wt=Zt.INSIDE_GSUM[he];return new tn(ke*Rt+Le+wt,ie)}}findFinderPattern(s,n){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let l=s.getSize(),o=!1,d=0;for(;d<l&&(o=!s.get(d),n!==o);)d++;let u=0,m=d;for(let b=d;b<l;b++)if(s.get(b)!==o)r[u]++;else{if(u===3){if(Us.isFinderPattern(r))return[m,b];m+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,u--}else u++;r[u]=1,o=!o}throw new F}parseFoundFinderPattern(s,n,r,l){let o=s.get(l[0]),d=l[0]-1;for(;d>=0&&o!==s.get(d);)d--;d++;const u=l[0]-d,m=this.getDecodeFinderCounters(),b=new Int32Array(m.length);V.arraycopy(m,0,b,1,m.length-1),b[0]=u;const S=this.parseFinderValue(b,Zt.FINDER_PATTERNS);let M=d,k=l[1];return r&&(M=s.getSize()-1-M,k=s.getSize()-1-k),new sn(S,[d,l[1]],M,k,n)}adjustOddEvenCounts(s,n){let r=Xe.sum(new Int32Array(this.getOddCounts())),l=Xe.sum(new Int32Array(this.getEvenCounts())),o=!1,d=!1,u=!1,m=!1;s?(r>12?d=!0:r<4&&(o=!0),l>12?m=!0:l<4&&(u=!0)):(r>11?d=!0:r<5&&(o=!0),l>10?m=!0:l<4&&(u=!0));let b=r+l-n,S=(r&1)===(s?1:0),M=(l&1)===1;if(b===1)if(S){if(M)throw new F;d=!0}else{if(!M)throw new F;m=!0}else if(b===-1)if(S){if(M)throw new F;o=!0}else{if(!M)throw new F;u=!0}else if(b===0){if(S){if(!M)throw new F;r<l?(o=!0,m=!0):(d=!0,u=!0)}else if(M)throw new F}else throw new F;if(o){if(d)throw new F;Us.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&Us.decrement(this.getOddCounts(),this.getOddRoundingErrors()),u){if(m)throw new F;Us.increment(this.getEvenCounts(),this.getOddRoundingErrors())}m&&Us.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Zt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Zt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Zt.OUTSIDE_GSUM=[0,161,961,2015,2715],Zt.INSIDE_GSUM=[0,336,1036,1516],Zt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Zt.INSIDE_ODD_WIDEST=[2,4,6,8],Zt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class ya extends Ue{constructor(s,n){super(),this.readers=[],this.verbose=n===!0;const r=s?s.get(ce.POSSIBLE_FORMATS):null,l=s&&s.get(ce.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;r?((r.includes(xe.EAN_13)||r.includes(xe.UPC_A)||r.includes(xe.EAN_8)||r.includes(xe.UPC_E))&&this.readers.push(new nl(s)),r.includes(xe.CODE_39)&&this.readers.push(new ot(l)),r.includes(xe.CODE_128)&&this.readers.push(new Te),r.includes(xe.ITF)&&this.readers.push(new Ye),r.includes(xe.RSS_14)&&this.readers.push(new Zt),r.includes(xe.RSS_EXPANDED)&&this.readers.push(new Me(this.verbose))):(this.readers.push(new nl(s)),this.readers.push(new ot),this.readers.push(new nl(s)),this.readers.push(new Te),this.readers.push(new Ye),this.readers.push(new Zt),this.readers.push(new Me(this.verbose)))}decodeRow(s,n,r){for(let l=0;l<this.readers.length;l++)try{return this.readers[l].decodeRow(s,n,r)}catch{}throw new F}reset(){this.readers.forEach(s=>s.reset())}}class Lc extends U{constructor(s=500,n){super(new ya(n),s,n)}}class Ut{constructor(s,n,r){this.ecCodewords=s,this.ecBlocks=[n],r&&this.ecBlocks.push(r)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Ft{constructor(s,n){this.count=s,this.dataCodewords=n}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Dt{constructor(s,n,r,l,o,d){this.versionNumber=s,this.symbolSizeRows=n,this.symbolSizeColumns=r,this.dataRegionSizeRows=l,this.dataRegionSizeColumns=o,this.ecBlocks=d;let u=0;const m=d.getECCodewords(),b=d.getECBlocks();for(let S of b)u+=S.getCount()*(S.getDataCodewords()+m);this.totalCodewords=u}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(s,n){if((s&1)!==0||(n&1)!==0)throw new $;for(let r of Dt.VERSIONS)if(r.symbolSizeRows===s&&r.symbolSizeColumns===n)return r;throw new $}toString(){return""+this.versionNumber}static buildVersions(){return[new Dt(1,10,10,8,8,new Ut(5,new Ft(1,3))),new Dt(2,12,12,10,10,new Ut(7,new Ft(1,5))),new Dt(3,14,14,12,12,new Ut(10,new Ft(1,8))),new Dt(4,16,16,14,14,new Ut(12,new Ft(1,12))),new Dt(5,18,18,16,16,new Ut(14,new Ft(1,18))),new Dt(6,20,20,18,18,new Ut(18,new Ft(1,22))),new Dt(7,22,22,20,20,new Ut(20,new Ft(1,30))),new Dt(8,24,24,22,22,new Ut(24,new Ft(1,36))),new Dt(9,26,26,24,24,new Ut(28,new Ft(1,44))),new Dt(10,32,32,14,14,new Ut(36,new Ft(1,62))),new Dt(11,36,36,16,16,new Ut(42,new Ft(1,86))),new Dt(12,40,40,18,18,new Ut(48,new Ft(1,114))),new Dt(13,44,44,20,20,new Ut(56,new Ft(1,144))),new Dt(14,48,48,22,22,new Ut(68,new Ft(1,174))),new Dt(15,52,52,24,24,new Ut(42,new Ft(2,102))),new Dt(16,64,64,14,14,new Ut(56,new Ft(2,140))),new Dt(17,72,72,16,16,new Ut(36,new Ft(4,92))),new Dt(18,80,80,18,18,new Ut(48,new Ft(4,114))),new Dt(19,88,88,20,20,new Ut(56,new Ft(4,144))),new Dt(20,96,96,22,22,new Ut(68,new Ft(4,174))),new Dt(21,104,104,24,24,new Ut(56,new Ft(6,136))),new Dt(22,120,120,18,18,new Ut(68,new Ft(6,175))),new Dt(23,132,132,20,20,new Ut(62,new Ft(8,163))),new Dt(24,144,144,22,22,new Ut(62,new Ft(8,156),new Ft(2,155))),new Dt(25,8,18,6,16,new Ut(7,new Ft(1,5))),new Dt(26,8,32,6,14,new Ut(11,new Ft(1,10))),new Dt(27,12,26,10,24,new Ut(14,new Ft(1,16))),new Dt(28,12,36,10,16,new Ut(18,new Ft(1,22))),new Dt(29,16,36,14,16,new Ut(24,new Ft(1,32))),new Dt(30,16,48,14,22,new Ut(28,new Ft(1,49)))]}}Dt.VERSIONS=Dt.buildVersions();class Wn{constructor(s){const n=s.getHeight();if(n<8||n>144||(n&1)!==0)throw new $;this.version=Wn.readVersion(s),this.mappingBitMatrix=this.extractDataRegion(s),this.readMappingMatrix=new ae(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(s){const n=s.getHeight(),r=s.getWidth();return Dt.getVersionForDimensions(n,r)}readCodewords(){const s=new Int8Array(this.version.getTotalCodewords());let n=0,r=4,l=0;const o=this.mappingBitMatrix.getHeight(),d=this.mappingBitMatrix.getWidth();let u=!1,m=!1,b=!1,S=!1;do if(r===o&&l===0&&!u)s[n++]=this.readCorner1(o,d)&255,r-=2,l+=2,u=!0;else if(r===o-2&&l===0&&(d&3)!==0&&!m)s[n++]=this.readCorner2(o,d)&255,r-=2,l+=2,m=!0;else if(r===o+4&&l===2&&(d&7)===0&&!b)s[n++]=this.readCorner3(o,d)&255,r-=2,l+=2,b=!0;else if(r===o-2&&l===0&&(d&7)===4&&!S)s[n++]=this.readCorner4(o,d)&255,r-=2,l+=2,S=!0;else{do r<o&&l>=0&&!this.readMappingMatrix.get(l,r)&&(s[n++]=this.readUtah(r,l,o,d)&255),r-=2,l+=2;while(r>=0&&l<d);r+=1,l+=3;do r>=0&&l<d&&!this.readMappingMatrix.get(l,r)&&(s[n++]=this.readUtah(r,l,o,d)&255),r+=2,l-=2;while(r<o&&l>=0);r+=3,l+=1}while(r<o||l<d);if(n!==this.version.getTotalCodewords())throw new $;return s}readModule(s,n,r,l){return s<0&&(s+=r,n+=4-(r+4&7)),n<0&&(n+=l,s+=4-(l+4&7)),this.readMappingMatrix.set(n,s),this.mappingBitMatrix.get(n,s)}readUtah(s,n,r,l){let o=0;return this.readModule(s-2,n-2,r,l)&&(o|=1),o<<=1,this.readModule(s-2,n-1,r,l)&&(o|=1),o<<=1,this.readModule(s-1,n-2,r,l)&&(o|=1),o<<=1,this.readModule(s-1,n-1,r,l)&&(o|=1),o<<=1,this.readModule(s-1,n,r,l)&&(o|=1),o<<=1,this.readModule(s,n-2,r,l)&&(o|=1),o<<=1,this.readModule(s,n-1,r,l)&&(o|=1),o<<=1,this.readModule(s,n,r,l)&&(o|=1),o}readCorner1(s,n){let r=0;return this.readModule(s-1,0,s,n)&&(r|=1),r<<=1,this.readModule(s-1,1,s,n)&&(r|=1),r<<=1,this.readModule(s-1,2,s,n)&&(r|=1),r<<=1,this.readModule(0,n-2,s,n)&&(r|=1),r<<=1,this.readModule(0,n-1,s,n)&&(r|=1),r<<=1,this.readModule(1,n-1,s,n)&&(r|=1),r<<=1,this.readModule(2,n-1,s,n)&&(r|=1),r<<=1,this.readModule(3,n-1,s,n)&&(r|=1),r}readCorner2(s,n){let r=0;return this.readModule(s-3,0,s,n)&&(r|=1),r<<=1,this.readModule(s-2,0,s,n)&&(r|=1),r<<=1,this.readModule(s-1,0,s,n)&&(r|=1),r<<=1,this.readModule(0,n-4,s,n)&&(r|=1),r<<=1,this.readModule(0,n-3,s,n)&&(r|=1),r<<=1,this.readModule(0,n-2,s,n)&&(r|=1),r<<=1,this.readModule(0,n-1,s,n)&&(r|=1),r<<=1,this.readModule(1,n-1,s,n)&&(r|=1),r}readCorner3(s,n){let r=0;return this.readModule(s-1,0,s,n)&&(r|=1),r<<=1,this.readModule(s-1,n-1,s,n)&&(r|=1),r<<=1,this.readModule(0,n-3,s,n)&&(r|=1),r<<=1,this.readModule(0,n-2,s,n)&&(r|=1),r<<=1,this.readModule(0,n-1,s,n)&&(r|=1),r<<=1,this.readModule(1,n-3,s,n)&&(r|=1),r<<=1,this.readModule(1,n-2,s,n)&&(r|=1),r<<=1,this.readModule(1,n-1,s,n)&&(r|=1),r}readCorner4(s,n){let r=0;return this.readModule(s-3,0,s,n)&&(r|=1),r<<=1,this.readModule(s-2,0,s,n)&&(r|=1),r<<=1,this.readModule(s-1,0,s,n)&&(r|=1),r<<=1,this.readModule(0,n-2,s,n)&&(r|=1),r<<=1,this.readModule(0,n-1,s,n)&&(r|=1),r<<=1,this.readModule(1,n-1,s,n)&&(r|=1),r<<=1,this.readModule(2,n-1,s,n)&&(r|=1),r<<=1,this.readModule(3,n-1,s,n)&&(r|=1),r}extractDataRegion(s){const n=this.version.getSymbolSizeRows(),r=this.version.getSymbolSizeColumns();if(s.getHeight()!==n)throw new O("Dimension of bitMatrix must match the version size");const l=this.version.getDataRegionSizeRows(),o=this.version.getDataRegionSizeColumns(),d=n/l|0,u=r/o|0,m=d*l,b=u*o,S=new ae(b,m);for(let M=0;M<d;++M){const k=M*l;for(let X=0;X<u;++X){const re=X*o;for(let ie=0;ie<l;++ie){const he=M*(l+2)+1+ie,je=k+ie;for(let Pe=0;Pe<o;++Pe){const Le=X*(o+2)+1+Pe;if(s.get(Le,he)){const ke=re+Pe;S.set(ke,je)}}}}}return S}}class Qn{constructor(s,n){this.numDataCodewords=s,this.codewords=n}static getDataBlocks(s,n){const r=n.getECBlocks();let l=0;const o=r.getECBlocks();for(let ie of o)l+=ie.getCount();const d=new Array(l);let u=0;for(let ie of o)for(let he=0;he<ie.getCount();he++){const je=ie.getDataCodewords(),Pe=r.getECCodewords()+je;d[u++]=new Qn(je,new Uint8Array(Pe))}const b=d[0].codewords.length-r.getECCodewords(),S=b-1;let M=0;for(let ie=0;ie<S;ie++)for(let he=0;he<u;he++)d[he].codewords[ie]=s[M++];const k=n.getVersionNumber()===24,X=k?8:u;for(let ie=0;ie<X;ie++)d[ie].codewords[b-1]=s[M++];const re=d[0].codewords.length;for(let ie=b;ie<re;ie++)for(let he=0;he<u;he++){const je=k?(he+8)%u:he,Pe=k&&je>7?ie-1:ie;d[je].codewords[Pe]=s[M++]}if(M!==s.length)throw new O;return d}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class ba{constructor(s){this.bytes=s,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(s){if(s<1||s>32||s>this.available())throw new O(""+s);let n=0,r=this.bitOffset,l=this.byteOffset;const o=this.bytes;if(r>0){const d=8-r,u=s<d?s:d,m=d-u,b=255>>8-u<<m;n=(o[l]&b)>>m,s-=u,r+=u,r===8&&(r=0,l++)}if(s>0){for(;s>=8;)n=n<<8|o[l]&255,l++,s-=8;if(s>0){const d=8-s,u=255>>d<<d;n=n<<s|(o[l]&u)>>d,r+=s}}return this.bitOffset=r,this.byteOffset=l,n}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Ht;(function(I){I[I.PAD_ENCODE=0]="PAD_ENCODE",I[I.ASCII_ENCODE=1]="ASCII_ENCODE",I[I.C40_ENCODE=2]="C40_ENCODE",I[I.TEXT_ENCODE=3]="TEXT_ENCODE",I[I.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",I[I.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",I[I.BASE256_ENCODE=6]="BASE256_ENCODE"})(Ht||(Ht={}));class Ya{static decode(s){const n=new ba(s),r=new J,l=new J,o=new Array;let d=Ht.ASCII_ENCODE;do if(d===Ht.ASCII_ENCODE)d=this.decodeAsciiSegment(n,r,l);else{switch(d){case Ht.C40_ENCODE:this.decodeC40Segment(n,r);break;case Ht.TEXT_ENCODE:this.decodeTextSegment(n,r);break;case Ht.ANSIX12_ENCODE:this.decodeAnsiX12Segment(n,r);break;case Ht.EDIFACT_ENCODE:this.decodeEdifactSegment(n,r);break;case Ht.BASE256_ENCODE:this.decodeBase256Segment(n,r,o);break;default:throw new $}d=Ht.ASCII_ENCODE}while(d!==Ht.PAD_ENCODE&&n.available()>0);return l.length()>0&&r.append(l.toString()),new Je(s,r.toString(),o.length===0?null:o,null)}static decodeAsciiSegment(s,n,r){let l=!1;do{let o=s.readBits(8);if(o===0)throw new $;if(o<=128)return l&&(o+=128),n.append(String.fromCharCode(o-1)),Ht.ASCII_ENCODE;if(o===129)return Ht.PAD_ENCODE;if(o<=229){const d=o-130;d<10&&n.append("0"),n.append(""+d)}else switch(o){case 230:return Ht.C40_ENCODE;case 231:return Ht.BASE256_ENCODE;case 232:n.append("");break;case 233:case 234:break;case 235:l=!0;break;case 236:n.append("[)>05"),r.insert(0,"");break;case 237:n.append("[)>06"),r.insert(0,"");break;case 238:return Ht.ANSIX12_ENCODE;case 239:return Ht.TEXT_ENCODE;case 240:return Ht.EDIFACT_ENCODE;case 241:break;default:if(o!==254||s.available()!==0)throw new $;break}}while(s.available()>0);return Ht.ASCII_ENCODE}static decodeC40Segment(s,n){let r=!1;const l=[];let o=0;do{if(s.available()===8)return;const d=s.readBits(8);if(d===254)return;this.parseTwoBytes(d,s.readBits(8),l);for(let u=0;u<3;u++){const m=l[u];switch(o){case 0:if(m<3)o=m+1;else if(m<this.C40_BASIC_SET_CHARS.length){const b=this.C40_BASIC_SET_CHARS[m];r?(n.append(String.fromCharCode(b.charCodeAt(0)+128)),r=!1):n.append(b)}else throw new $;break;case 1:r?(n.append(String.fromCharCode(m+128)),r=!1):n.append(String.fromCharCode(m)),o=0;break;case 2:if(m<this.C40_SHIFT2_SET_CHARS.length){const b=this.C40_SHIFT2_SET_CHARS[m];r?(n.append(String.fromCharCode(b.charCodeAt(0)+128)),r=!1):n.append(b)}else switch(m){case 27:n.append("");break;case 30:r=!0;break;default:throw new $}o=0;break;case 3:r?(n.append(String.fromCharCode(m+224)),r=!1):n.append(String.fromCharCode(m+96)),o=0;break;default:throw new $}}}while(s.available()>0)}static decodeTextSegment(s,n){let r=!1,l=[],o=0;do{if(s.available()===8)return;const d=s.readBits(8);if(d===254)return;this.parseTwoBytes(d,s.readBits(8),l);for(let u=0;u<3;u++){const m=l[u];switch(o){case 0:if(m<3)o=m+1;else if(m<this.TEXT_BASIC_SET_CHARS.length){const b=this.TEXT_BASIC_SET_CHARS[m];r?(n.append(String.fromCharCode(b.charCodeAt(0)+128)),r=!1):n.append(b)}else throw new $;break;case 1:r?(n.append(String.fromCharCode(m+128)),r=!1):n.append(String.fromCharCode(m)),o=0;break;case 2:if(m<this.TEXT_SHIFT2_SET_CHARS.length){const b=this.TEXT_SHIFT2_SET_CHARS[m];r?(n.append(String.fromCharCode(b.charCodeAt(0)+128)),r=!1):n.append(b)}else switch(m){case 27:n.append("");break;case 30:r=!0;break;default:throw new $}o=0;break;case 3:if(m<this.TEXT_SHIFT3_SET_CHARS.length){const b=this.TEXT_SHIFT3_SET_CHARS[m];r?(n.append(String.fromCharCode(b.charCodeAt(0)+128)),r=!1):n.append(b),o=0}else throw new $;break;default:throw new $}}}while(s.available()>0)}static decodeAnsiX12Segment(s,n){const r=[];do{if(s.available()===8)return;const l=s.readBits(8);if(l===254)return;this.parseTwoBytes(l,s.readBits(8),r);for(let o=0;o<3;o++){const d=r[o];switch(d){case 0:n.append("\r");break;case 1:n.append("*");break;case 2:n.append(">");break;case 3:n.append(" ");break;default:if(d<14)n.append(String.fromCharCode(d+44));else if(d<40)n.append(String.fromCharCode(d+51));else throw new $;break}}}while(s.available()>0)}static parseTwoBytes(s,n,r){let l=(s<<8)+n-1,o=Math.floor(l/1600);r[0]=o,l-=o*1600,o=Math.floor(l/40),r[1]=o,r[2]=l-o*40}static decodeEdifactSegment(s,n){do{if(s.available()<=16)return;for(let r=0;r<4;r++){let l=s.readBits(6);if(l===31){const o=8-s.getBitOffset();o!==8&&s.readBits(o);return}(l&32)===0&&(l|=64),n.append(String.fromCharCode(l))}}while(s.available()>0)}static decodeBase256Segment(s,n,r){let l=1+s.getByteOffset();const o=this.unrandomize255State(s.readBits(8),l++);let d;if(o===0?d=s.available()/8|0:o<250?d=o:d=250*(o-249)+this.unrandomize255State(s.readBits(8),l++),d<0)throw new $;const u=new Uint8Array(d);for(let m=0;m<d;m++){if(s.available()<8)throw new $;u[m]=this.unrandomize255State(s.readBits(8),l++)}r.push(u);try{n.append(me.decode(u,ne.ISO88591))}catch(m){throw new Oe("Platform does not support required encoding: "+m.message)}}static unrandomize255State(s,n){const r=149*n%255+1,l=s-r;return l>=0?l:l+256}}Ya.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Ya.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Ya.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Ya.TEXT_SHIFT2_SET_CHARS=Ya.C40_SHIFT2_SET_CHARS,Ya.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Pc{constructor(){this.rsDecoder=new mt(Ke.DATA_MATRIX_FIELD_256)}decode(s){const n=new Wn(s),r=n.getVersion(),l=n.readCodewords(),o=Qn.getDataBlocks(l,r);let d=0;for(let b of o)d+=b.getNumDataCodewords();const u=new Uint8Array(d),m=o.length;for(let b=0;b<m;b++){const S=o[b],M=S.getCodewords(),k=S.getNumDataCodewords();this.correctErrors(M,k);for(let X=0;X<k;X++)u[X*m+b]=M[X]}return Ya.decode(u)}correctErrors(s,n){const r=new Int32Array(s);try{this.rsDecoder.decode(r,s.length-n)}catch{throw new L}for(let l=0;l<n;l++)s[l]=r[l]}}class us{constructor(s){this.image=s,this.rectangleDetector=new We(this.image)}detect(){const s=this.rectangleDetector.detect();let n=this.detectSolid1(s);if(n=this.detectSolid2(n),n[3]=this.correctTopRight(n),!n[3])throw new F;n=this.shiftToModuleCenter(n);const r=n[0],l=n[1],o=n[2],d=n[3];let u=this.transitionsBetween(r,d)+1,m=this.transitionsBetween(o,d)+1;(u&1)===1&&(u+=1),(m&1)===1&&(m+=1),4*u<7*m&&4*m<7*u&&(u=m=Math.max(u,m));let b=us.sampleGrid(this.image,r,l,o,d,u,m);return new ye(b,[r,l,o,d])}static shiftPoint(s,n,r){let l=(n.getX()-s.getX())/(r+1),o=(n.getY()-s.getY())/(r+1);return new He(s.getX()+l,s.getY()+o)}static moveAway(s,n,r){let l=s.getX(),o=s.getY();return l<n?l-=1:l+=1,o<r?o-=1:o+=1,new He(l,o)}detectSolid1(s){let n=s[0],r=s[1],l=s[3],o=s[2],d=this.transitionsBetween(n,r),u=this.transitionsBetween(r,l),m=this.transitionsBetween(l,o),b=this.transitionsBetween(o,n),S=d,M=[o,n,r,l];return S>u&&(S=u,M[0]=n,M[1]=r,M[2]=l,M[3]=o),S>m&&(S=m,M[0]=r,M[1]=l,M[2]=o,M[3]=n),S>b&&(M[0]=l,M[1]=o,M[2]=n,M[3]=r),M}detectSolid2(s){let n=s[0],r=s[1],l=s[2],o=s[3],d=this.transitionsBetween(n,o),u=us.shiftPoint(r,l,(d+1)*4),m=us.shiftPoint(l,r,(d+1)*4),b=this.transitionsBetween(u,n),S=this.transitionsBetween(m,o);return b<S?(s[0]=n,s[1]=r,s[2]=l,s[3]=o):(s[0]=r,s[1]=l,s[2]=o,s[3]=n),s}correctTopRight(s){let n=s[0],r=s[1],l=s[2],o=s[3],d=this.transitionsBetween(n,o),u=this.transitionsBetween(r,o),m=us.shiftPoint(n,r,(u+1)*4),b=us.shiftPoint(l,r,(d+1)*4);d=this.transitionsBetween(m,o),u=this.transitionsBetween(b,o);let S=new He(o.getX()+(l.getX()-r.getX())/(d+1),o.getY()+(l.getY()-r.getY())/(d+1)),M=new He(o.getX()+(n.getX()-r.getX())/(u+1),o.getY()+(n.getY()-r.getY())/(u+1));if(!this.isValid(S))return this.isValid(M)?M:null;if(!this.isValid(M))return S;let k=this.transitionsBetween(m,S)+this.transitionsBetween(b,S),X=this.transitionsBetween(m,M)+this.transitionsBetween(b,M);return k>X?S:M}shiftToModuleCenter(s){let n=s[0],r=s[1],l=s[2],o=s[3],d=this.transitionsBetween(n,o)+1,u=this.transitionsBetween(l,o)+1,m=us.shiftPoint(n,r,u*4),b=us.shiftPoint(l,r,d*4);d=this.transitionsBetween(m,o)+1,u=this.transitionsBetween(b,o)+1,(d&1)===1&&(d+=1),(u&1)===1&&(u+=1);let S=(n.getX()+r.getX()+l.getX()+o.getX())/4,M=(n.getY()+r.getY()+l.getY()+o.getY())/4;n=us.moveAway(n,S,M),r=us.moveAway(r,S,M),l=us.moveAway(l,S,M),o=us.moveAway(o,S,M);let k,X;return m=us.shiftPoint(n,r,u*4),m=us.shiftPoint(m,o,d*4),k=us.shiftPoint(r,n,u*4),k=us.shiftPoint(k,l,d*4),b=us.shiftPoint(l,o,u*4),b=us.shiftPoint(b,r,d*4),X=us.shiftPoint(o,l,u*4),X=us.shiftPoint(X,n,d*4),[m,k,b,X]}isValid(s){return s.getX()>=0&&s.getX()<this.image.getWidth()&&s.getY()>0&&s.getY()<this.image.getHeight()}static sampleGrid(s,n,r,l,o,d,u){return pt.getInstance().sampleGrid(s,d,u,.5,.5,d-.5,.5,d-.5,u-.5,.5,u-.5,n.getX(),n.getY(),o.getX(),o.getY(),l.getX(),l.getY(),r.getX(),r.getY())}transitionsBetween(s,n){let r=Math.trunc(s.getX()),l=Math.trunc(s.getY()),o=Math.trunc(n.getX()),d=Math.trunc(n.getY()),u=Math.abs(d-l)>Math.abs(o-r);if(u){let ie=r;r=l,l=ie,ie=o,o=d,d=ie}let m=Math.abs(o-r),b=Math.abs(d-l),S=-m/2,M=l<d?1:-1,k=r<o?1:-1,X=0,re=this.image.get(u?l:r,u?r:l);for(let ie=r,he=l;ie!==o;ie+=k){let je=this.image.get(u?he:ie,u?ie:he);if(je!==re&&(X++,re=je),S+=b,S>0){if(he===d)break;he+=M,S-=m}}return X}}class qa{constructor(){this.decoder=new Pc}decode(s,n=null){let r,l;if(n!=null&&n.has(ce.PURE_BARCODE)){const b=qa.extractPureBits(s.getBlackMatrix());r=this.decoder.decode(b),l=qa.NO_POINTS}else{const b=new us(s.getBlackMatrix()).detect();r=this.decoder.decode(b.getBits()),l=b.getPoints()}const o=r.getRawBytes(),d=new Z(r.getText(),o,8*o.length,l,xe.DATA_MATRIX,V.currentTimeMillis()),u=r.getByteSegments();u!=null&&d.putMetadata(Ve.BYTE_SEGMENTS,u);const m=r.getECLevel();return m!=null&&d.putMetadata(Ve.ERROR_CORRECTION_LEVEL,m),d}reset(){}static extractPureBits(s){const n=s.getTopLeftOnBit(),r=s.getBottomRightOnBit();if(n==null||r==null)throw new F;const l=this.moduleSize(n,s);let o=n[1];const d=r[1];let u=n[0];const b=(r[0]-u+1)/l,S=(d-o+1)/l;if(b<=0||S<=0)throw new F;const M=l/2;o+=M,u+=M;const k=new ae(b,S);for(let X=0;X<S;X++){const re=o+X*l;for(let ie=0;ie<b;ie++)s.get(u+ie*l,re)&&k.set(ie,X)}return k}static moduleSize(s,n){const r=n.getWidth();let l=s[0];const o=s[1];for(;l<r&&n.get(l,o);)l++;if(l===r)throw new F;const d=l-s[0];if(d===0)throw new F;return d}}qa.NO_POINTS=[];class di extends U{constructor(s=500){super(new qa,s)}}var Jn;(function(I){I[I.L=0]="L",I[I.M=1]="M",I[I.Q=2]="Q",I[I.H=3]="H"})(Jn||(Jn={}));class Ot{constructor(s,n,r){this.value=s,this.stringValue=n,this.bits=r,Ot.FOR_BITS.set(r,this),Ot.FOR_VALUE.set(s,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(s){switch(s){case"L":return Ot.L;case"M":return Ot.M;case"Q":return Ot.Q;case"H":return Ot.H;default:throw new C(s+"not available")}}toString(){return this.stringValue}equals(s){if(!(s instanceof Ot))return!1;const n=s;return this.value===n.value}static forBits(s){if(s<0||s>=Ot.FOR_BITS.size)throw new O;return Ot.FOR_BITS.get(s)}}Ot.FOR_BITS=new Map,Ot.FOR_VALUE=new Map,Ot.L=new Ot(Jn.L,"L",1),Ot.M=new Ot(Jn.M,"M",0),Ot.Q=new Ot(Jn.Q,"Q",3),Ot.H=new Ot(Jn.H,"H",2);class Is{constructor(s){this.errorCorrectionLevel=Ot.forBits(s>>3&3),this.dataMask=s&7}static numBitsDiffering(s,n){return H.bitCount(s^n)}static decodeFormatInformation(s,n){const r=Is.doDecodeFormatInformation(s,n);return r!==null?r:Is.doDecodeFormatInformation(s^Is.FORMAT_INFO_MASK_QR,n^Is.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(s,n){let r=Number.MAX_SAFE_INTEGER,l=0;for(const o of Is.FORMAT_INFO_DECODE_LOOKUP){const d=o[0];if(d===s||d===n)return new Is(o[1]);let u=Is.numBitsDiffering(s,d);u<r&&(l=o[1],r=u),s!==n&&(u=Is.numBitsDiffering(n,d),u<r&&(l=o[1],r=u))}return r<=3?new Is(l):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(s){if(!(s instanceof Is))return!1;const n=s;return this.errorCorrectionLevel===n.errorCorrectionLevel&&this.dataMask===n.dataMask}}Is.FORMAT_INFO_MASK_QR=21522,Is.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class ge{constructor(s,...n){this.ecCodewordsPerBlock=s,this.ecBlocks=n}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let s=0;const n=this.ecBlocks;for(const r of n)s+=r.getCount();return s}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class z{constructor(s,n){this.count=s,this.dataCodewords=n}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class et{constructor(s,n,...r){this.versionNumber=s,this.alignmentPatternCenters=n,this.ecBlocks=r;let l=0;const o=r[0].getECCodewordsPerBlock(),d=r[0].getECBlocks();for(const u of d)l+=u.getCount()*(u.getDataCodewords()+o);this.totalCodewords=l}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(s){return this.ecBlocks[s.getValue()]}static getProvisionalVersionForDimension(s){if(s%4!==1)throw new $;try{return this.getVersionForNumber((s-17)/4)}catch{throw new $}}static getVersionForNumber(s){if(s<1||s>40)throw new O;return et.VERSIONS[s-1]}static decodeVersionInformation(s){let n=Number.MAX_SAFE_INTEGER,r=0;for(let l=0;l<et.VERSION_DECODE_INFO.length;l++){const o=et.VERSION_DECODE_INFO[l];if(o===s)return et.getVersionForNumber(l+7);const d=Is.numBitsDiffering(s,o);d<n&&(r=l+7,n=d)}return n<=3?et.getVersionForNumber(r):null}buildFunctionPattern(){const s=this.getDimensionForVersion(),n=new ae(s);n.setRegion(0,0,9,9),n.setRegion(s-8,0,8,9),n.setRegion(0,s-8,9,8);const r=this.alignmentPatternCenters.length;for(let l=0;l<r;l++){const o=this.alignmentPatternCenters[l]-2;for(let d=0;d<r;d++)l===0&&(d===0||d===r-1)||l===r-1&&d===0||n.setRegion(this.alignmentPatternCenters[d]-2,o,5,5)}return n.setRegion(6,9,1,s-17),n.setRegion(9,6,s-17,1),this.versionNumber>6&&(n.setRegion(s-11,0,3,6),n.setRegion(0,s-11,6,3)),n}toString(){return""+this.versionNumber}}et.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),et.VERSIONS=[new et(1,new Int32Array(0),new ge(7,new z(1,19)),new ge(10,new z(1,16)),new ge(13,new z(1,13)),new ge(17,new z(1,9))),new et(2,Int32Array.from([6,18]),new ge(10,new z(1,34)),new ge(16,new z(1,28)),new ge(22,new z(1,22)),new ge(28,new z(1,16))),new et(3,Int32Array.from([6,22]),new ge(15,new z(1,55)),new ge(26,new z(1,44)),new ge(18,new z(2,17)),new ge(22,new z(2,13))),new et(4,Int32Array.from([6,26]),new ge(20,new z(1,80)),new ge(18,new z(2,32)),new ge(26,new z(2,24)),new ge(16,new z(4,9))),new et(5,Int32Array.from([6,30]),new ge(26,new z(1,108)),new ge(24,new z(2,43)),new ge(18,new z(2,15),new z(2,16)),new ge(22,new z(2,11),new z(2,12))),new et(6,Int32Array.from([6,34]),new ge(18,new z(2,68)),new ge(16,new z(4,27)),new ge(24,new z(4,19)),new ge(28,new z(4,15))),new et(7,Int32Array.from([6,22,38]),new ge(20,new z(2,78)),new ge(18,new z(4,31)),new ge(18,new z(2,14),new z(4,15)),new ge(26,new z(4,13),new z(1,14))),new et(8,Int32Array.from([6,24,42]),new ge(24,new z(2,97)),new ge(22,new z(2,38),new z(2,39)),new ge(22,new z(4,18),new z(2,19)),new ge(26,new z(4,14),new z(2,15))),new et(9,Int32Array.from([6,26,46]),new ge(30,new z(2,116)),new ge(22,new z(3,36),new z(2,37)),new ge(20,new z(4,16),new z(4,17)),new ge(24,new z(4,12),new z(4,13))),new et(10,Int32Array.from([6,28,50]),new ge(18,new z(2,68),new z(2,69)),new ge(26,new z(4,43),new z(1,44)),new ge(24,new z(6,19),new z(2,20)),new ge(28,new z(6,15),new z(2,16))),new et(11,Int32Array.from([6,30,54]),new ge(20,new z(4,81)),new ge(30,new z(1,50),new z(4,51)),new ge(28,new z(4,22),new z(4,23)),new ge(24,new z(3,12),new z(8,13))),new et(12,Int32Array.from([6,32,58]),new ge(24,new z(2,92),new z(2,93)),new ge(22,new z(6,36),new z(2,37)),new ge(26,new z(4,20),new z(6,21)),new ge(28,new z(7,14),new z(4,15))),new et(13,Int32Array.from([6,34,62]),new ge(26,new z(4,107)),new ge(22,new z(8,37),new z(1,38)),new ge(24,new z(8,20),new z(4,21)),new ge(22,new z(12,11),new z(4,12))),new et(14,Int32Array.from([6,26,46,66]),new ge(30,new z(3,115),new z(1,116)),new ge(24,new z(4,40),new z(5,41)),new ge(20,new z(11,16),new z(5,17)),new ge(24,new z(11,12),new z(5,13))),new et(15,Int32Array.from([6,26,48,70]),new ge(22,new z(5,87),new z(1,88)),new ge(24,new z(5,41),new z(5,42)),new ge(30,new z(5,24),new z(7,25)),new ge(24,new z(11,12),new z(7,13))),new et(16,Int32Array.from([6,26,50,74]),new ge(24,new z(5,98),new z(1,99)),new ge(28,new z(7,45),new z(3,46)),new ge(24,new z(15,19),new z(2,20)),new ge(30,new z(3,15),new z(13,16))),new et(17,Int32Array.from([6,30,54,78]),new ge(28,new z(1,107),new z(5,108)),new ge(28,new z(10,46),new z(1,47)),new ge(28,new z(1,22),new z(15,23)),new ge(28,new z(2,14),new z(17,15))),new et(18,Int32Array.from([6,30,56,82]),new ge(30,new z(5,120),new z(1,121)),new ge(26,new z(9,43),new z(4,44)),new ge(28,new z(17,22),new z(1,23)),new ge(28,new z(2,14),new z(19,15))),new et(19,Int32Array.from([6,30,58,86]),new ge(28,new z(3,113),new z(4,114)),new ge(26,new z(3,44),new z(11,45)),new ge(26,new z(17,21),new z(4,22)),new ge(26,new z(9,13),new z(16,14))),new et(20,Int32Array.from([6,34,62,90]),new ge(28,new z(3,107),new z(5,108)),new ge(26,new z(3,41),new z(13,42)),new ge(30,new z(15,24),new z(5,25)),new ge(28,new z(15,15),new z(10,16))),new et(21,Int32Array.from([6,28,50,72,94]),new ge(28,new z(4,116),new z(4,117)),new ge(26,new z(17,42)),new ge(28,new z(17,22),new z(6,23)),new ge(30,new z(19,16),new z(6,17))),new et(22,Int32Array.from([6,26,50,74,98]),new ge(28,new z(2,111),new z(7,112)),new ge(28,new z(17,46)),new ge(30,new z(7,24),new z(16,25)),new ge(24,new z(34,13))),new et(23,Int32Array.from([6,30,54,78,102]),new ge(30,new z(4,121),new z(5,122)),new ge(28,new z(4,47),new z(14,48)),new ge(30,new z(11,24),new z(14,25)),new ge(30,new z(16,15),new z(14,16))),new et(24,Int32Array.from([6,28,54,80,106]),new ge(30,new z(6,117),new z(4,118)),new ge(28,new z(6,45),new z(14,46)),new ge(30,new z(11,24),new z(16,25)),new ge(30,new z(30,16),new z(2,17))),new et(25,Int32Array.from([6,32,58,84,110]),new ge(26,new z(8,106),new z(4,107)),new ge(28,new z(8,47),new z(13,48)),new ge(30,new z(7,24),new z(22,25)),new ge(30,new z(22,15),new z(13,16))),new et(26,Int32Array.from([6,30,58,86,114]),new ge(28,new z(10,114),new z(2,115)),new ge(28,new z(19,46),new z(4,47)),new ge(28,new z(28,22),new z(6,23)),new ge(30,new z(33,16),new z(4,17))),new et(27,Int32Array.from([6,34,62,90,118]),new ge(30,new z(8,122),new z(4,123)),new ge(28,new z(22,45),new z(3,46)),new ge(30,new z(8,23),new z(26,24)),new ge(30,new z(12,15),new z(28,16))),new et(28,Int32Array.from([6,26,50,74,98,122]),new ge(30,new z(3,117),new z(10,118)),new ge(28,new z(3,45),new z(23,46)),new ge(30,new z(4,24),new z(31,25)),new ge(30,new z(11,15),new z(31,16))),new et(29,Int32Array.from([6,30,54,78,102,126]),new ge(30,new z(7,116),new z(7,117)),new ge(28,new z(21,45),new z(7,46)),new ge(30,new z(1,23),new z(37,24)),new ge(30,new z(19,15),new z(26,16))),new et(30,Int32Array.from([6,26,52,78,104,130]),new ge(30,new z(5,115),new z(10,116)),new ge(28,new z(19,47),new z(10,48)),new ge(30,new z(15,24),new z(25,25)),new ge(30,new z(23,15),new z(25,16))),new et(31,Int32Array.from([6,30,56,82,108,134]),new ge(30,new z(13,115),new z(3,116)),new ge(28,new z(2,46),new z(29,47)),new ge(30,new z(42,24),new z(1,25)),new ge(30,new z(23,15),new z(28,16))),new et(32,Int32Array.from([6,34,60,86,112,138]),new ge(30,new z(17,115)),new ge(28,new z(10,46),new z(23,47)),new ge(30,new z(10,24),new z(35,25)),new ge(30,new z(19,15),new z(35,16))),new et(33,Int32Array.from([6,30,58,86,114,142]),new ge(30,new z(17,115),new z(1,116)),new ge(28,new z(14,46),new z(21,47)),new ge(30,new z(29,24),new z(19,25)),new ge(30,new z(11,15),new z(46,16))),new et(34,Int32Array.from([6,34,62,90,118,146]),new ge(30,new z(13,115),new z(6,116)),new ge(28,new z(14,46),new z(23,47)),new ge(30,new z(44,24),new z(7,25)),new ge(30,new z(59,16),new z(1,17))),new et(35,Int32Array.from([6,30,54,78,102,126,150]),new ge(30,new z(12,121),new z(7,122)),new ge(28,new z(12,47),new z(26,48)),new ge(30,new z(39,24),new z(14,25)),new ge(30,new z(22,15),new z(41,16))),new et(36,Int32Array.from([6,24,50,76,102,128,154]),new ge(30,new z(6,121),new z(14,122)),new ge(28,new z(6,47),new z(34,48)),new ge(30,new z(46,24),new z(10,25)),new ge(30,new z(2,15),new z(64,16))),new et(37,Int32Array.from([6,28,54,80,106,132,158]),new ge(30,new z(17,122),new z(4,123)),new ge(28,new z(29,46),new z(14,47)),new ge(30,new z(49,24),new z(10,25)),new ge(30,new z(24,15),new z(46,16))),new et(38,Int32Array.from([6,32,58,84,110,136,162]),new ge(30,new z(4,122),new z(18,123)),new ge(28,new z(13,46),new z(32,47)),new ge(30,new z(48,24),new z(14,25)),new ge(30,new z(42,15),new z(32,16))),new et(39,Int32Array.from([6,26,54,82,110,138,166]),new ge(30,new z(20,117),new z(4,118)),new ge(28,new z(40,47),new z(7,48)),new ge(30,new z(43,24),new z(22,25)),new ge(30,new z(10,15),new z(67,16))),new et(40,Int32Array.from([6,30,58,86,114,142,170]),new ge(30,new z(19,118),new z(6,119)),new ge(28,new z(18,47),new z(31,48)),new ge(30,new z(34,24),new z(34,25)),new ge(30,new z(20,15),new z(61,16)))];var Ss;(function(I){I[I.DATA_MASK_000=0]="DATA_MASK_000",I[I.DATA_MASK_001=1]="DATA_MASK_001",I[I.DATA_MASK_010=2]="DATA_MASK_010",I[I.DATA_MASK_011=3]="DATA_MASK_011",I[I.DATA_MASK_100=4]="DATA_MASK_100",I[I.DATA_MASK_101=5]="DATA_MASK_101",I[I.DATA_MASK_110=6]="DATA_MASK_110",I[I.DATA_MASK_111=7]="DATA_MASK_111"})(Ss||(Ss={}));class na{constructor(s,n){this.value=s,this.isMasked=n}unmaskBitMatrix(s,n){for(let r=0;r<n;r++)for(let l=0;l<n;l++)this.isMasked(r,l)&&s.flip(l,r)}}na.values=new Map([[Ss.DATA_MASK_000,new na(Ss.DATA_MASK_000,(I,s)=>(I+s&1)===0)],[Ss.DATA_MASK_001,new na(Ss.DATA_MASK_001,(I,s)=>(I&1)===0)],[Ss.DATA_MASK_010,new na(Ss.DATA_MASK_010,(I,s)=>s%3===0)],[Ss.DATA_MASK_011,new na(Ss.DATA_MASK_011,(I,s)=>(I+s)%3===0)],[Ss.DATA_MASK_100,new na(Ss.DATA_MASK_100,(I,s)=>(Math.floor(I/2)+Math.floor(s/3)&1)===0)],[Ss.DATA_MASK_101,new na(Ss.DATA_MASK_101,(I,s)=>I*s%6===0)],[Ss.DATA_MASK_110,new na(Ss.DATA_MASK_110,(I,s)=>I*s%6<3)],[Ss.DATA_MASK_111,new na(Ss.DATA_MASK_111,(I,s)=>(I+s+I*s%3&1)===0)]]);class $n{constructor(s){const n=s.getHeight();if(n<21||(n&3)!==1)throw new $;this.bitMatrix=s}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let s=0;for(let o=0;o<6;o++)s=this.copyBit(o,8,s);s=this.copyBit(7,8,s),s=this.copyBit(8,8,s),s=this.copyBit(8,7,s);for(let o=5;o>=0;o--)s=this.copyBit(8,o,s);const n=this.bitMatrix.getHeight();let r=0;const l=n-7;for(let o=n-1;o>=l;o--)r=this.copyBit(8,o,r);for(let o=n-8;o<n;o++)r=this.copyBit(o,8,r);if(this.parsedFormatInfo=Is.decodeFormatInformation(s,r),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new $}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const s=this.bitMatrix.getHeight(),n=Math.floor((s-17)/4);if(n<=6)return et.getVersionForNumber(n);let r=0;const l=s-11;for(let d=5;d>=0;d--)for(let u=s-9;u>=l;u--)r=this.copyBit(u,d,r);let o=et.decodeVersionInformation(r);if(o!==null&&o.getDimensionForVersion()===s)return this.parsedVersion=o,o;r=0;for(let d=5;d>=0;d--)for(let u=s-9;u>=l;u--)r=this.copyBit(d,u,r);if(o=et.decodeVersionInformation(r),o!==null&&o.getDimensionForVersion()===s)return this.parsedVersion=o,o;throw new $}copyBit(s,n,r){return(this.isMirror?this.bitMatrix.get(n,s):this.bitMatrix.get(s,n))?r<<1|1:r<<1}readCodewords(){const s=this.readFormatInformation(),n=this.readVersion(),r=na.values.get(s.getDataMask()),l=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,l);const o=n.buildFunctionPattern();let d=!0;const u=new Uint8Array(n.getTotalCodewords());let m=0,b=0,S=0;for(let M=l-1;M>0;M-=2){M===6&&M--;for(let k=0;k<l;k++){const X=d?l-1-k:k;for(let re=0;re<2;re++)o.get(M-re,X)||(S++,b<<=1,this.bitMatrix.get(M-re,X)&&(b|=1),S===8&&(u[m++]=b,S=0,b=0))}d=!d}if(m!==n.getTotalCodewords())throw new $;return u}remask(){if(this.parsedFormatInfo===null)return;const s=na.values[this.parsedFormatInfo.getDataMask()],n=this.bitMatrix.getHeight();s.unmaskBitMatrix(this.bitMatrix,n)}setMirror(s){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=s}mirror(){const s=this.bitMatrix;for(let n=0,r=s.getWidth();n<r;n++)for(let l=n+1,o=s.getHeight();l<o;l++)s.get(n,l)!==s.get(l,n)&&(s.flip(l,n),s.flip(n,l))}}class rl{constructor(s,n){this.numDataCodewords=s,this.codewords=n}static getDataBlocks(s,n,r){if(s.length!==n.getTotalCodewords())throw new O;const l=n.getECBlocksForLevel(r);let o=0;const d=l.getECBlocks();for(const re of d)o+=re.getCount();const u=new Array(o);let m=0;for(const re of d)for(let ie=0;ie<re.getCount();ie++){const he=re.getDataCodewords(),je=l.getECCodewordsPerBlock()+he;u[m++]=new rl(he,new Uint8Array(je))}const b=u[0].codewords.length;let S=u.length-1;for(;S>=0&&u[S].codewords.length!==b;)S--;S++;const M=b-l.getECCodewordsPerBlock();let k=0;for(let re=0;re<M;re++)for(let ie=0;ie<m;ie++)u[ie].codewords[re]=s[k++];for(let re=S;re<m;re++)u[re].codewords[M]=s[k++];const X=u[0].codewords.length;for(let re=M;re<X;re++)for(let ie=0;ie<m;ie++){const he=ie<S?re:re+1;u[ie].codewords[he]=s[k++]}return u}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var ra;(function(I){I[I.TERMINATOR=0]="TERMINATOR",I[I.NUMERIC=1]="NUMERIC",I[I.ALPHANUMERIC=2]="ALPHANUMERIC",I[I.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",I[I.BYTE=4]="BYTE",I[I.ECI=5]="ECI",I[I.KANJI=6]="KANJI",I[I.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",I[I.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",I[I.HANZI=9]="HANZI"})(ra||(ra={}));class nt{constructor(s,n,r,l){this.value=s,this.stringValue=n,this.characterCountBitsForVersions=r,this.bits=l,nt.FOR_BITS.set(l,this),nt.FOR_VALUE.set(s,this)}static forBits(s){const n=nt.FOR_BITS.get(s);if(n===void 0)throw new O;return n}getCharacterCountBits(s){const n=s.getVersionNumber();let r;return n<=9?r=0:n<=26?r=1:r=2,this.characterCountBitsForVersions[r]}getValue(){return this.value}getBits(){return this.bits}equals(s){if(!(s instanceof nt))return!1;const n=s;return this.value===n.value}toString(){return this.stringValue}}nt.FOR_BITS=new Map,nt.FOR_VALUE=new Map,nt.TERMINATOR=new nt(ra.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),nt.NUMERIC=new nt(ra.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),nt.ALPHANUMERIC=new nt(ra.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),nt.STRUCTURED_APPEND=new nt(ra.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),nt.BYTE=new nt(ra.BYTE,"BYTE",Int32Array.from([8,16,16]),4),nt.ECI=new nt(ra.ECI,"ECI",Int32Array.from([0,0,0]),7),nt.KANJI=new nt(ra.KANJI,"KANJI",Int32Array.from([8,10,12]),8),nt.FNC1_FIRST_POSITION=new nt(ra.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),nt.FNC1_SECOND_POSITION=new nt(ra.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),nt.HANZI=new nt(ra.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class is{static decode(s,n,r,l){const o=new ba(s);let d=new J;const u=new Array;let m=-1,b=-1;try{let S=null,M=!1,k;do{if(o.available()<4)k=nt.TERMINATOR;else{const X=o.readBits(4);k=nt.forBits(X)}switch(k){case nt.TERMINATOR:break;case nt.FNC1_FIRST_POSITION:case nt.FNC1_SECOND_POSITION:M=!0;break;case nt.STRUCTURED_APPEND:if(o.available()<16)throw new $;m=o.readBits(8),b=o.readBits(8);break;case nt.ECI:const X=is.parseECIValue(o);if(S=oe.getCharacterSetECIByValue(X),S===null)throw new $;break;case nt.HANZI:const re=o.readBits(4),ie=o.readBits(k.getCharacterCountBits(n));re===is.GB2312_SUBSET&&is.decodeHanziSegment(o,d,ie);break;default:const he=o.readBits(k.getCharacterCountBits(n));switch(k){case nt.NUMERIC:is.decodeNumericSegment(o,d,he);break;case nt.ALPHANUMERIC:is.decodeAlphanumericSegment(o,d,he,M);break;case nt.BYTE:is.decodeByteSegment(o,d,he,S,u,l);break;case nt.KANJI:is.decodeKanjiSegment(o,d,he);break;default:throw new $}break}}while(k!==nt.TERMINATOR)}catch{throw new $}return new Je(s,d.toString(),u.length===0?null:u,r===null?null:r.toString(),m,b)}static decodeHanziSegment(s,n,r){if(r*13>s.available())throw new $;const l=new Uint8Array(2*r);let o=0;for(;r>0;){const d=s.readBits(13);let u=d/96<<8&4294967295|d%96;u<959?u+=41377:u+=42657,l[o]=u>>8&255,l[o+1]=u&255,o+=2,r--}try{n.append(me.decode(l,ne.GB2312))}catch(d){throw new $(d)}}static decodeKanjiSegment(s,n,r){if(r*13>s.available())throw new $;const l=new Uint8Array(2*r);let o=0;for(;r>0;){const d=s.readBits(13);let u=d/192<<8&4294967295|d%192;u<7936?u+=33088:u+=49472,l[o]=u>>8,l[o+1]=u,o+=2,r--}try{n.append(me.decode(l,ne.SHIFT_JIS))}catch(d){throw new $(d)}}static decodeByteSegment(s,n,r,l,o,d){if(8*r>s.available())throw new $;const u=new Uint8Array(r);for(let b=0;b<r;b++)u[b]=s.readBits(8);let m;l===null?m=ne.guessEncoding(u,d):m=l.getName();try{n.append(me.decode(u,m))}catch(b){throw new $(b)}o.push(u)}static toAlphaNumericChar(s){if(s>=is.ALPHANUMERIC_CHARS.length)throw new $;return is.ALPHANUMERIC_CHARS[s]}static decodeAlphanumericSegment(s,n,r,l){const o=n.length();for(;r>1;){if(s.available()<11)throw new $;const d=s.readBits(11);n.append(is.toAlphaNumericChar(Math.floor(d/45))),n.append(is.toAlphaNumericChar(d%45)),r-=2}if(r===1){if(s.available()<6)throw new $;n.append(is.toAlphaNumericChar(s.readBits(6)))}if(l)for(let d=o;d<n.length();d++)n.charAt(d)==="%"&&(d<n.length()-1&&n.charAt(d+1)==="%"?n.deleteCharAt(d+1):n.setCharAt(d,""))}static decodeNumericSegment(s,n,r){for(;r>=3;){if(s.available()<10)throw new $;const l=s.readBits(10);if(l>=1e3)throw new $;n.append(is.toAlphaNumericChar(Math.floor(l/100))),n.append(is.toAlphaNumericChar(Math.floor(l/10)%10)),n.append(is.toAlphaNumericChar(l%10)),r-=3}if(r===2){if(s.available()<7)throw new $;const l=s.readBits(7);if(l>=100)throw new $;n.append(is.toAlphaNumericChar(Math.floor(l/10))),n.append(is.toAlphaNumericChar(l%10))}else if(r===1){if(s.available()<4)throw new $;const l=s.readBits(4);if(l>=10)throw new $;n.append(is.toAlphaNumericChar(l))}}static parseECIValue(s){const n=s.readBits(8);if((n&128)===0)return n&127;if((n&192)===128){const r=s.readBits(8);return(n&63)<<8&4294967295|r}if((n&224)===192){const r=s.readBits(16);return(n&31)<<16&4294967295|r}throw new $}}is.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",is.GB2312_SUBSET=1;class io{constructor(s){this.mirrored=s}isMirrored(){return this.mirrored}applyMirroredCorrection(s){if(!this.mirrored||s===null||s.length<3)return;const n=s[0];s[0]=s[2],s[2]=n}}class Fc{constructor(){this.rsDecoder=new mt(Ke.QR_CODE_FIELD_256)}decodeBooleanArray(s,n){return this.decodeBitMatrix(ae.parseFromBooleanArray(s),n)}decodeBitMatrix(s,n){const r=new $n(s);let l=null;try{return this.decodeBitMatrixParser(r,n)}catch(o){l=o}try{r.remask(),r.setMirror(!0),r.readVersion(),r.readFormatInformation(),r.mirror();const o=this.decodeBitMatrixParser(r,n);return o.setOther(new io(!0)),o}catch(o){throw l!==null?l:o}}decodeBitMatrixParser(s,n){const r=s.readVersion(),l=s.readFormatInformation().getErrorCorrectionLevel(),o=s.readCodewords(),d=rl.getDataBlocks(o,r,l);let u=0;for(const S of d)u+=S.getNumDataCodewords();const m=new Uint8Array(u);let b=0;for(const S of d){const M=S.getCodewords(),k=S.getNumDataCodewords();this.correctErrors(M,k);for(let X=0;X<k;X++)m[b++]=M[X]}return is.decode(m,r,l,n)}correctErrors(s,n){const r=new Int32Array(s);try{this.rsDecoder.decode(r,s.length-n)}catch{throw new L}for(let l=0;l<n;l++)s[l]=r[l]}}class er extends He{constructor(s,n,r){super(s,n),this.estimatedModuleSize=r}aboutEquals(s,n,r){if(Math.abs(n-this.getY())<=s&&Math.abs(r-this.getX())<=s){const l=Math.abs(s-this.estimatedModuleSize);return l<=1||l<=this.estimatedModuleSize}return!1}combineEstimate(s,n,r){const l=(this.getX()+n)/2,o=(this.getY()+s)/2,d=(this.estimatedModuleSize+r)/2;return new er(l,o,d)}}class ca{constructor(s,n,r,l,o,d,u){this.image=s,this.startX=n,this.startY=r,this.width=l,this.height=o,this.moduleSize=d,this.resultPointCallback=u,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const s=this.startX,n=this.height,r=this.width,l=s+r,o=this.startY+n/2,d=new Int32Array(3),u=this.image;for(let m=0;m<n;m++){const b=o+((m&1)===0?Math.floor((m+1)/2):-Math.floor((m+1)/2));d[0]=0,d[1]=0,d[2]=0;let S=s;for(;S<l&&!u.get(S,b);)S++;let M=0;for(;S<l;){if(u.get(S,b))if(M===1)d[1]++;else if(M===2){if(this.foundPatternCross(d)){const k=this.handlePossibleCenter(d,b,S);if(k!==null)return k}d[0]=d[2],d[1]=1,d[2]=0,M=1}else d[++M]++;else M===1&&M++,d[M]++;S++}if(this.foundPatternCross(d)){const k=this.handlePossibleCenter(d,b,l);if(k!==null)return k}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new F}static centerFromEnd(s,n){return n-s[2]-s[1]/2}foundPatternCross(s){const n=this.moduleSize,r=n/2;for(let l=0;l<3;l++)if(Math.abs(n-s[l])>=r)return!1;return!0}crossCheckVertical(s,n,r,l){const o=this.image,d=o.getHeight(),u=this.crossCheckStateCount;u[0]=0,u[1]=0,u[2]=0;let m=s;for(;m>=0&&o.get(n,m)&&u[1]<=r;)u[1]++,m--;if(m<0||u[1]>r)return NaN;for(;m>=0&&!o.get(n,m)&&u[0]<=r;)u[0]++,m--;if(u[0]>r)return NaN;for(m=s+1;m<d&&o.get(n,m)&&u[1]<=r;)u[1]++,m++;if(m===d||u[1]>r)return NaN;for(;m<d&&!o.get(n,m)&&u[2]<=r;)u[2]++,m++;if(u[2]>r)return NaN;const b=u[0]+u[1]+u[2];return 5*Math.abs(b-l)>=2*l?NaN:this.foundPatternCross(u)?ca.centerFromEnd(u,m):NaN}handlePossibleCenter(s,n,r){const l=s[0]+s[1]+s[2],o=ca.centerFromEnd(s,r),d=this.crossCheckVertical(n,o,2*s[1],l);if(!isNaN(d)){const u=(s[0]+s[1]+s[2])/3;for(const b of this.possibleCenters)if(b.aboutEquals(u,d,o))return b.combineEstimate(d,o,u);const m=new er(o,d,u);this.possibleCenters.push(m),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(m)}return null}}class Lr extends He{constructor(s,n,r,l){super(s,n),this.estimatedModuleSize=r,this.count=l,l===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(s,n,r){if(Math.abs(n-this.getY())<=s&&Math.abs(r-this.getX())<=s){const l=Math.abs(s-this.estimatedModuleSize);return l<=1||l<=this.estimatedModuleSize}return!1}combineEstimate(s,n,r){const l=this.count+1,o=(this.count*this.getX()+n)/l,d=(this.count*this.getY()+s)/l,u=(this.count*this.estimatedModuleSize+r)/l;return new Lr(o,d,u,l)}}class il{constructor(s){this.bottomLeft=s[0],this.topLeft=s[1],this.topRight=s[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class hs{constructor(s,n){this.image=s,this.resultPointCallback=n,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=n}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(s){const n=s!=null&&s.get(ce.TRY_HARDER)!==void 0,r=s!=null&&s.get(ce.PURE_BARCODE)!==void 0,l=this.image,o=l.getHeight(),d=l.getWidth();let u=Math.floor(3*o/(4*hs.MAX_MODULES));(u<hs.MIN_SKIP||n)&&(u=hs.MIN_SKIP);let m=!1;const b=new Int32Array(5);for(let M=u-1;M<o&&!m;M+=u){b[0]=0,b[1]=0,b[2]=0,b[3]=0,b[4]=0;let k=0;for(let X=0;X<d;X++)if(l.get(X,M))(k&1)===1&&k++,b[k]++;else if((k&1)===0)if(k===4)if(hs.foundPatternCross(b)){if(this.handlePossibleCenter(b,M,X,r)===!0)if(u=2,this.hasSkipped===!0)m=this.haveMultiplyConfirmedCenters();else{const ie=this.findRowSkip();ie>b[2]&&(M+=ie-b[2]-u,X=d-1)}else{b[0]=b[2],b[1]=b[3],b[2]=b[4],b[3]=1,b[4]=0,k=3;continue}k=0,b[0]=0,b[1]=0,b[2]=0,b[3]=0,b[4]=0}else b[0]=b[2],b[1]=b[3],b[2]=b[4],b[3]=1,b[4]=0,k=3;else b[++k]++;else b[k]++;hs.foundPatternCross(b)&&this.handlePossibleCenter(b,M,d,r)===!0&&(u=b[0],this.hasSkipped&&(m=this.haveMultiplyConfirmedCenters()))}const S=this.selectBestPatterns();return He.orderBestPatterns(S),new il(S)}static centerFromEnd(s,n){return n-s[4]-s[3]-s[2]/2}static foundPatternCross(s){let n=0;for(let o=0;o<5;o++){const d=s[o];if(d===0)return!1;n+=d}if(n<7)return!1;const r=n/7,l=r/2;return Math.abs(r-s[0])<l&&Math.abs(r-s[1])<l&&Math.abs(3*r-s[2])<3*l&&Math.abs(r-s[3])<l&&Math.abs(r-s[4])<l}getCrossCheckStateCount(){const s=this.crossCheckStateCount;return s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s}crossCheckDiagonal(s,n,r,l){const o=this.getCrossCheckStateCount();let d=0;const u=this.image;for(;s>=d&&n>=d&&u.get(n-d,s-d);)o[2]++,d++;if(s<d||n<d)return!1;for(;s>=d&&n>=d&&!u.get(n-d,s-d)&&o[1]<=r;)o[1]++,d++;if(s<d||n<d||o[1]>r)return!1;for(;s>=d&&n>=d&&u.get(n-d,s-d)&&o[0]<=r;)o[0]++,d++;if(o[0]>r)return!1;const m=u.getHeight(),b=u.getWidth();for(d=1;s+d<m&&n+d<b&&u.get(n+d,s+d);)o[2]++,d++;if(s+d>=m||n+d>=b)return!1;for(;s+d<m&&n+d<b&&!u.get(n+d,s+d)&&o[3]<r;)o[3]++,d++;if(s+d>=m||n+d>=b||o[3]>=r)return!1;for(;s+d<m&&n+d<b&&u.get(n+d,s+d)&&o[4]<r;)o[4]++,d++;if(o[4]>=r)return!1;const S=o[0]+o[1]+o[2]+o[3]+o[4];return Math.abs(S-l)<2*l&&hs.foundPatternCross(o)}crossCheckVertical(s,n,r,l){const o=this.image,d=o.getHeight(),u=this.getCrossCheckStateCount();let m=s;for(;m>=0&&o.get(n,m);)u[2]++,m--;if(m<0)return NaN;for(;m>=0&&!o.get(n,m)&&u[1]<=r;)u[1]++,m--;if(m<0||u[1]>r)return NaN;for(;m>=0&&o.get(n,m)&&u[0]<=r;)u[0]++,m--;if(u[0]>r)return NaN;for(m=s+1;m<d&&o.get(n,m);)u[2]++,m++;if(m===d)return NaN;for(;m<d&&!o.get(n,m)&&u[3]<r;)u[3]++,m++;if(m===d||u[3]>=r)return NaN;for(;m<d&&o.get(n,m)&&u[4]<r;)u[4]++,m++;if(u[4]>=r)return NaN;const b=u[0]+u[1]+u[2]+u[3]+u[4];return 5*Math.abs(b-l)>=2*l?NaN:hs.foundPatternCross(u)?hs.centerFromEnd(u,m):NaN}crossCheckHorizontal(s,n,r,l){const o=this.image,d=o.getWidth(),u=this.getCrossCheckStateCount();let m=s;for(;m>=0&&o.get(m,n);)u[2]++,m--;if(m<0)return NaN;for(;m>=0&&!o.get(m,n)&&u[1]<=r;)u[1]++,m--;if(m<0||u[1]>r)return NaN;for(;m>=0&&o.get(m,n)&&u[0]<=r;)u[0]++,m--;if(u[0]>r)return NaN;for(m=s+1;m<d&&o.get(m,n);)u[2]++,m++;if(m===d)return NaN;for(;m<d&&!o.get(m,n)&&u[3]<r;)u[3]++,m++;if(m===d||u[3]>=r)return NaN;for(;m<d&&o.get(m,n)&&u[4]<r;)u[4]++,m++;if(u[4]>=r)return NaN;const b=u[0]+u[1]+u[2]+u[3]+u[4];return 5*Math.abs(b-l)>=l?NaN:hs.foundPatternCross(u)?hs.centerFromEnd(u,m):NaN}handlePossibleCenter(s,n,r,l){const o=s[0]+s[1]+s[2]+s[3]+s[4];let d=hs.centerFromEnd(s,r),u=this.crossCheckVertical(n,Math.floor(d),s[2],o);if(!isNaN(u)&&(d=this.crossCheckHorizontal(Math.floor(d),Math.floor(u),s[2],o),!isNaN(d)&&(!l||this.crossCheckDiagonal(Math.floor(u),Math.floor(d),s[2],o)))){const m=o/7;let b=!1;const S=this.possibleCenters;for(let M=0,k=S.length;M<k;M++){const X=S[M];if(X.aboutEquals(m,u,d)){S[M]=X.combineEstimate(u,d,m),b=!0;break}}if(!b){const M=new Lr(d,u,m);S.push(M),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(M)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let n=null;for(const r of this.possibleCenters)if(r.getCount()>=hs.CENTER_QUORUM)if(n==null)n=r;else return this.hasSkipped=!0,Math.floor((Math.abs(n.getX()-r.getX())-Math.abs(n.getY()-r.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let s=0,n=0;const r=this.possibleCenters.length;for(const d of this.possibleCenters)d.getCount()>=hs.CENTER_QUORUM&&(s++,n+=d.getEstimatedModuleSize());if(s<3)return!1;const l=n/r;let o=0;for(const d of this.possibleCenters)o+=Math.abs(d.getEstimatedModuleSize()-l);return o<=.05*n}selectBestPatterns(){const s=this.possibleCenters.length;if(s<3)throw new F;const n=this.possibleCenters;let r;if(s>3){let l=0,o=0;for(const m of this.possibleCenters){const b=m.getEstimatedModuleSize();l+=b,o+=b*b}r=l/s;let d=Math.sqrt(o/s-r*r);n.sort((m,b)=>{const S=Math.abs(b.getEstimatedModuleSize()-r),M=Math.abs(m.getEstimatedModuleSize()-r);return S<M?-1:S>M?1:0});const u=Math.max(.2*r,d);for(let m=0;m<n.length&&n.length>3;m++){const b=n[m];Math.abs(b.getEstimatedModuleSize()-r)>u&&(n.splice(m,1),m--)}}if(n.length>3){let l=0;for(const o of n)l+=o.getEstimatedModuleSize();r=l/n.length,n.sort((o,d)=>{if(d.getCount()===o.getCount()){const u=Math.abs(d.getEstimatedModuleSize()-r),m=Math.abs(o.getEstimatedModuleSize()-r);return u<m?1:u>m?-1:0}else return d.getCount()-o.getCount()}),n.splice(3)}return[n[0],n[1],n[2]]}}hs.CENTER_QUORUM=2,hs.MIN_SKIP=3,hs.MAX_MODULES=57;class Ia{constructor(s){this.image=s}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(s){this.resultPointCallback=s==null?null:s.get(ce.NEED_RESULT_POINT_CALLBACK);const r=new hs(this.image,this.resultPointCallback).find(s);return this.processFinderPatternInfo(r)}processFinderPatternInfo(s){const n=s.getTopLeft(),r=s.getTopRight(),l=s.getBottomLeft(),o=this.calculateModuleSize(n,r,l);if(o<1)throw new F("No pattern found in proccess finder.");const d=Ia.computeDimension(n,r,l,o),u=et.getProvisionalVersionForDimension(d),m=u.getDimensionForVersion()-7;let b=null;if(u.getAlignmentPatternCenters().length>0){const X=r.getX()-n.getX()+l.getX(),re=r.getY()-n.getY()+l.getY(),ie=1-3/m,he=Math.floor(n.getX()+ie*(X-n.getX())),je=Math.floor(n.getY()+ie*(re-n.getY()));for(let Pe=4;Pe<=16;Pe<<=1)try{b=this.findAlignmentInRegion(o,he,je,Pe);break}catch(Le){if(!(Le instanceof F))throw Le}}const S=Ia.createTransform(n,r,l,b,d),M=Ia.sampleGrid(this.image,S,d);let k;return b===null?k=[l,n,r]:k=[l,n,r,b],new ye(M,k)}static createTransform(s,n,r,l,o){const d=o-3.5;let u,m,b,S;return l!==null?(u=l.getX(),m=l.getY(),b=d-3,S=b):(u=n.getX()-s.getX()+r.getX(),m=n.getY()-s.getY()+r.getY(),b=d,S=d),st.quadrilateralToQuadrilateral(3.5,3.5,d,3.5,b,S,3.5,d,s.getX(),s.getY(),n.getX(),n.getY(),u,m,r.getX(),r.getY())}static sampleGrid(s,n,r){return pt.getInstance().sampleGridWithTransform(s,r,r,n)}static computeDimension(s,n,r,l){const o=Xe.round(He.distance(s,n)/l),d=Xe.round(He.distance(s,r)/l);let u=Math.floor((o+d)/2)+7;switch(u&3){case 0:u++;break;case 2:u--;break;case 3:throw new F("Dimensions could be not found.")}return u}calculateModuleSize(s,n,r){return(this.calculateModuleSizeOneWay(s,n)+this.calculateModuleSizeOneWay(s,r))/2}calculateModuleSizeOneWay(s,n){const r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(s.getX()),Math.floor(s.getY()),Math.floor(n.getX()),Math.floor(n.getY())),l=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(n.getX()),Math.floor(n.getY()),Math.floor(s.getX()),Math.floor(s.getY()));return isNaN(r)?l/7:isNaN(l)?r/7:(r+l)/14}sizeOfBlackWhiteBlackRunBothWays(s,n,r,l){let o=this.sizeOfBlackWhiteBlackRun(s,n,r,l),d=1,u=s-(r-s);u<0?(d=s/(s-u),u=0):u>=this.image.getWidth()&&(d=(this.image.getWidth()-1-s)/(u-s),u=this.image.getWidth()-1);let m=Math.floor(n-(l-n)*d);return d=1,m<0?(d=n/(n-m),m=0):m>=this.image.getHeight()&&(d=(this.image.getHeight()-1-n)/(m-n),m=this.image.getHeight()-1),u=Math.floor(s+(u-s)*d),o+=this.sizeOfBlackWhiteBlackRun(s,n,u,m),o-1}sizeOfBlackWhiteBlackRun(s,n,r,l){const o=Math.abs(l-n)>Math.abs(r-s);if(o){let X=s;s=n,n=X,X=r,r=l,l=X}const d=Math.abs(r-s),u=Math.abs(l-n);let m=-d/2;const b=s<r?1:-1,S=n<l?1:-1;let M=0;const k=r+b;for(let X=s,re=n;X!==k;X+=b){const ie=o?re:X,he=o?X:re;if(M===1===this.image.get(ie,he)){if(M===2)return Xe.distance(X,re,s,n);M++}if(m+=u,m>0){if(re===l)break;re+=S,m-=d}}return M===2?Xe.distance(r+b,l,s,n):NaN}findAlignmentInRegion(s,n,r,l){const o=Math.floor(l*s),d=Math.max(0,n-o),u=Math.min(this.image.getWidth()-1,n+o);if(u-d<s*3)throw new F("Alignment top exceeds estimated module size.");const m=Math.max(0,r-o),b=Math.min(this.image.getHeight()-1,r+o);if(b-m<s*3)throw new F("Alignment bottom exceeds estimated module size.");return new ca(this.image,d,m,u-d,b-m,s,this.resultPointCallback).find()}}class Ka{constructor(){this.decoder=new Fc}getDecoder(){return this.decoder}decode(s,n){let r,l;if(n!=null&&n.get(ce.PURE_BARCODE)!==void 0){const m=Ka.extractPureBits(s.getBlackMatrix());r=this.decoder.decodeBitMatrix(m,n),l=Ka.NO_POINTS}else{const m=new Ia(s.getBlackMatrix()).detect(n);r=this.decoder.decodeBitMatrix(m.getBits(),n),l=m.getPoints()}r.getOther()instanceof io&&r.getOther().applyMirroredCorrection(l);const o=new Z(r.getText(),r.getRawBytes(),void 0,l,xe.QR_CODE,void 0),d=r.getByteSegments();d!==null&&o.putMetadata(Ve.BYTE_SEGMENTS,d);const u=r.getECLevel();return u!==null&&o.putMetadata(Ve.ERROR_CORRECTION_LEVEL,u),r.hasStructuredAppend()&&(o.putMetadata(Ve.STRUCTURED_APPEND_SEQUENCE,r.getStructuredAppendSequenceNumber()),o.putMetadata(Ve.STRUCTURED_APPEND_PARITY,r.getStructuredAppendParity())),o}reset(){}static extractPureBits(s){const n=s.getTopLeftOnBit(),r=s.getBottomRightOnBit();if(n===null||r===null)throw new F;const l=this.moduleSize(n,s);let o=n[1],d=r[1],u=n[0],m=r[0];if(u>=m||o>=d)throw new F;if(d-o!==m-u&&(m=u+(d-o),m>=s.getWidth()))throw new F;const b=Math.round((m-u+1)/l),S=Math.round((d-o+1)/l);if(b<=0||S<=0)throw new F;if(S!==b)throw new F;const M=Math.floor(l/2);o+=M,u+=M;const k=u+Math.floor((b-1)*l)-m;if(k>0){if(k>M)throw new F;u-=k}const X=o+Math.floor((S-1)*l)-d;if(X>0){if(X>M)throw new F;o-=X}const re=new ae(b,S);for(let ie=0;ie<S;ie++){const he=o+Math.floor(ie*l);for(let je=0;je<b;je++)s.get(u+Math.floor(je*l),he)&&re.set(je,ie)}return re}static moduleSize(s,n){const r=n.getHeight(),l=n.getWidth();let o=s[0],d=s[1],u=!0,m=0;for(;o<l&&d<r;){if(u!==n.get(o,d)){if(++m===5)break;u=!u}o++,d++}if(o===l||d===r)throw new F;return(o-s[0])/7}}Ka.NO_POINTS=new Array;class dt{PDF417Common(){}static getBitCountSum(s){return Xe.sum(s)}static toIntArray(s){if(s==null||!s.length)return dt.EMPTY_INT_ARRAY;const n=new Int32Array(s.length);let r=0;for(const l of s)n[r++]=l;return n}static getCodeword(s){const n=K.binarySearch(dt.SYMBOL_TABLE,s&262143);return n<0?-1:(dt.CODEWORD_TABLE[n]-1)%dt.NUMBER_OF_CODEWORDS}}dt.NUMBER_OF_CODEWORDS=929,dt.MAX_CODEWORDS_IN_BARCODE=dt.NUMBER_OF_CODEWORDS-1,dt.MIN_ROWS_IN_BARCODE=3,dt.MAX_ROWS_IN_BARCODE=90,dt.MODULES_IN_CODEWORD=17,dt.MODULES_IN_STOP_PATTERN=18,dt.BARS_IN_MODULE=8,dt.EMPTY_INT_ARRAY=new Int32Array([]),dt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),dt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class lo{constructor(s,n){this.bits=s,this.points=n}getBits(){return this.bits}getPoints(){return this.points}}class bt{static detectMultiple(s,n,r){let l=s.getBlackMatrix(),o=bt.detect(r,l);return o.length||(l=l.clone(),l.rotate180(),o=bt.detect(r,l)),new lo(l,o)}static detect(s,n){const r=new Array;let l=0,o=0,d=!1;for(;l<n.getHeight();){const u=bt.findVertices(n,l,o);if(u[0]==null&&u[3]==null){if(!d)break;d=!1,o=0;for(const m of r)m[1]!=null&&(l=Math.trunc(Math.max(l,m[1].getY()))),m[3]!=null&&(l=Math.max(l,Math.trunc(m[3].getY())));l+=bt.ROW_STEP;continue}if(d=!0,r.push(u),!s)break;u[2]!=null?(o=Math.trunc(u[2].getX()),l=Math.trunc(u[2].getY())):(o=Math.trunc(u[4].getX()),l=Math.trunc(u[4].getY()))}return r}static findVertices(s,n,r){const l=s.getHeight(),o=s.getWidth(),d=new Array(8);return bt.copyToResult(d,bt.findRowsWithPattern(s,l,o,n,r,bt.START_PATTERN),bt.INDEXES_START_PATTERN),d[4]!=null&&(r=Math.trunc(d[4].getX()),n=Math.trunc(d[4].getY())),bt.copyToResult(d,bt.findRowsWithPattern(s,l,o,n,r,bt.STOP_PATTERN),bt.INDEXES_STOP_PATTERN),d}static copyToResult(s,n,r){for(let l=0;l<r.length;l++)s[r[l]]=n[l]}static findRowsWithPattern(s,n,r,l,o,d){const u=new Array(4);let m=!1;const b=new Int32Array(d.length);for(;l<n;l+=bt.ROW_STEP){let M=bt.findGuardPattern(s,o,l,r,!1,d,b);if(M!=null){for(;l>0;){const k=bt.findGuardPattern(s,o,--l,r,!1,d,b);if(k!=null)M=k;else{l++;break}}u[0]=new He(M[0],l),u[1]=new He(M[1],l),m=!0;break}}let S=l+1;if(m){let M=0,k=Int32Array.from([Math.trunc(u[0].getX()),Math.trunc(u[1].getX())]);for(;S<n;S++){const X=bt.findGuardPattern(s,k[0],S,r,!1,d,b);if(X!=null&&Math.abs(k[0]-X[0])<bt.MAX_PATTERN_DRIFT&&Math.abs(k[1]-X[1])<bt.MAX_PATTERN_DRIFT)k=X,M=0;else{if(M>bt.SKIPPED_ROW_COUNT_MAX)break;M++}}S-=M+1,u[2]=new He(k[0],S),u[3]=new He(k[1],S)}return S-l<bt.BARCODE_MIN_HEIGHT&&K.fill(u,null),u}static findGuardPattern(s,n,r,l,o,d,u){K.fillWithin(u,0,u.length,0);let m=n,b=0;for(;s.get(m,r)&&m>0&&b++<bt.MAX_PIXEL_DRIFT;)m--;let S=m,M=0,k=d.length;for(let X=o;S<l;S++)if(s.get(S,r)!==X)u[M]++;else{if(M===k-1){if(bt.patternMatchVariance(u,d,bt.MAX_INDIVIDUAL_VARIANCE)<bt.MAX_AVG_VARIANCE)return new Int32Array([m,S]);m+=u[0]+u[1],V.arraycopy(u,2,u,0,M-1),u[M-1]=0,u[M]=0,M--}else M++;u[M]=1,X=!X}return M===k-1&&bt.patternMatchVariance(u,d,bt.MAX_INDIVIDUAL_VARIANCE)<bt.MAX_AVG_VARIANCE?new Int32Array([m,S-1]):null}static patternMatchVariance(s,n,r){let l=s.length,o=0,d=0;for(let b=0;b<l;b++)o+=s[b],d+=n[b];if(o<d)return 1/0;let u=o/d;r*=u;let m=0;for(let b=0;b<l;b++){let S=s[b],M=n[b]*u,k=S>M?S-M:M-S;if(k>r)return 1/0;m+=k}return m/o}}bt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),bt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),bt.MAX_AVG_VARIANCE=.42,bt.MAX_INDIVIDUAL_VARIANCE=.8,bt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),bt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),bt.MAX_PIXEL_DRIFT=3,bt.MAX_PATTERN_DRIFT=5,bt.SKIPPED_ROW_COUNT_MAX=25,bt.ROW_STEP=5,bt.BARCODE_MIN_HEIGHT=10;class ls{constructor(s,n){if(n.length===0)throw new O;this.field=s;let r=n.length;if(r>1&&n[0]===0){let l=1;for(;l<r&&n[l]===0;)l++;l===r?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(r-l),V.arraycopy(n,l,this.coefficients,0,this.coefficients.length))}else this.coefficients=n}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(s){return this.coefficients[this.coefficients.length-1-s]}evaluateAt(s){if(s===0)return this.getCoefficient(0);if(s===1){let l=0;for(let o of this.coefficients)l=this.field.add(l,o);return l}let n=this.coefficients[0],r=this.coefficients.length;for(let l=1;l<r;l++)n=this.field.add(this.field.multiply(s,n),this.coefficients[l]);return n}add(s){if(!this.field.equals(s.field))throw new O("ModulusPolys do not have same ModulusGF field");if(this.isZero())return s;if(s.isZero())return this;let n=this.coefficients,r=s.coefficients;if(n.length>r.length){let d=n;n=r,r=d}let l=new Int32Array(r.length),o=r.length-n.length;V.arraycopy(r,0,l,0,o);for(let d=o;d<r.length;d++)l[d]=this.field.add(n[d-o],r[d]);return new ls(this.field,l)}subtract(s){if(!this.field.equals(s.field))throw new O("ModulusPolys do not have same ModulusGF field");return s.isZero()?this:this.add(s.negative())}multiply(s){return s instanceof ls?this.multiplyOther(s):this.multiplyScalar(s)}multiplyOther(s){if(!this.field.equals(s.field))throw new O("ModulusPolys do not have same ModulusGF field");if(this.isZero()||s.isZero())return new ls(this.field,new Int32Array([0]));let n=this.coefficients,r=n.length,l=s.coefficients,o=l.length,d=new Int32Array(r+o-1);for(let u=0;u<r;u++){let m=n[u];for(let b=0;b<o;b++)d[u+b]=this.field.add(d[u+b],this.field.multiply(m,l[b]))}return new ls(this.field,d)}negative(){let s=this.coefficients.length,n=new Int32Array(s);for(let r=0;r<s;r++)n[r]=this.field.subtract(0,this.coefficients[r]);return new ls(this.field,n)}multiplyScalar(s){if(s===0)return new ls(this.field,new Int32Array([0]));if(s===1)return this;let n=this.coefficients.length,r=new Int32Array(n);for(let l=0;l<n;l++)r[l]=this.field.multiply(this.coefficients[l],s);return new ls(this.field,r)}multiplyByMonomial(s,n){if(s<0)throw new O;if(n===0)return new ls(this.field,new Int32Array([0]));let r=this.coefficients.length,l=new Int32Array(r+s);for(let o=0;o<r;o++)l[o]=this.field.multiply(this.coefficients[o],n);return new ls(this.field,l)}toString(){let s=new J;for(let n=this.getDegree();n>=0;n--){let r=this.getCoefficient(n);r!==0&&(r<0?(s.append(" - "),r=-r):s.length()>0&&s.append(" + "),(n===0||r!==1)&&s.append(r),n!==0&&(n===1?s.append("x"):(s.append("x^"),s.append(n))))}return s.toString()}}class ll{add(s,n){return(s+n)%this.modulus}subtract(s,n){return(this.modulus+s-n)%this.modulus}exp(s){return this.expTable[s]}log(s){if(s===0)throw new O;return this.logTable[s]}inverse(s){if(s===0)throw new lt;return this.expTable[this.modulus-this.logTable[s]-1]}multiply(s,n){return s===0||n===0?0:this.expTable[(this.logTable[s]+this.logTable[n])%(this.modulus-1)]}getSize(){return this.modulus}equals(s){return s===this}}class yn extends ll{constructor(s,n){super(),this.modulus=s,this.expTable=new Int32Array(s),this.logTable=new Int32Array(s);let r=1;for(let l=0;l<s;l++)this.expTable[l]=r,r=r*n%s;for(let l=0;l<s-1;l++)this.logTable[this.expTable[l]]=l;this.zero=new ls(this,new Int32Array([0])),this.one=new ls(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(s,n){if(s<0)throw new O;if(n===0)return this.zero;let r=new Int32Array(s+1);return r[0]=n,new ls(this,r)}}yn.PDF417_GF=new yn(dt.NUMBER_OF_CODEWORDS,3);class Za{constructor(){this.field=yn.PDF417_GF}decode(s,n,r){let l=new ls(this.field,s),o=new Int32Array(n),d=!1;for(let re=n;re>0;re--){let ie=l.evaluateAt(this.field.exp(re));o[n-re]=ie,ie!==0&&(d=!0)}if(!d)return 0;let u=this.field.getOne();if(r!=null)for(const re of r){let ie=this.field.exp(s.length-1-re),he=new ls(this.field,new Int32Array([this.field.subtract(0,ie),1]));u=u.multiply(he)}let m=new ls(this.field,o),b=this.runEuclideanAlgorithm(this.field.buildMonomial(n,1),m,n),S=b[0],M=b[1],k=this.findErrorLocations(S),X=this.findErrorMagnitudes(M,S,k);for(let re=0;re<k.length;re++){let ie=s.length-1-this.field.log(k[re]);if(ie<0)throw L.getChecksumInstance();s[ie]=this.field.subtract(s[ie],X[re])}return k.length}runEuclideanAlgorithm(s,n,r){if(s.getDegree()<n.getDegree()){let k=s;s=n,n=k}let l=s,o=n,d=this.field.getZero(),u=this.field.getOne();for(;o.getDegree()>=Math.round(r/2);){let k=l,X=d;if(l=o,d=u,l.isZero())throw L.getChecksumInstance();o=k;let re=this.field.getZero(),ie=l.getCoefficient(l.getDegree()),he=this.field.inverse(ie);for(;o.getDegree()>=l.getDegree()&&!o.isZero();){let je=o.getDegree()-l.getDegree(),Pe=this.field.multiply(o.getCoefficient(o.getDegree()),he);re=re.add(this.field.buildMonomial(je,Pe)),o=o.subtract(l.multiplyByMonomial(je,Pe))}u=re.multiply(d).subtract(X).negative()}let m=u.getCoefficient(0);if(m===0)throw L.getChecksumInstance();let b=this.field.inverse(m),S=u.multiply(b),M=o.multiply(b);return[S,M]}findErrorLocations(s){let n=s.getDegree(),r=new Int32Array(n),l=0;for(let o=1;o<this.field.getSize()&&l<n;o++)s.evaluateAt(o)===0&&(r[l]=this.field.inverse(o),l++);if(l!==n)throw L.getChecksumInstance();return r}findErrorMagnitudes(s,n,r){let l=n.getDegree(),o=new Int32Array(l);for(let b=1;b<=l;b++)o[l-b]=this.field.multiply(b,n.getCoefficient(b));let d=new ls(this.field,o),u=r.length,m=new Int32Array(u);for(let b=0;b<u;b++){let S=this.field.inverse(r[b]),M=this.field.subtract(0,s.evaluateAt(S)),k=this.field.inverse(d.evaluateAt(S));m[b]=this.field.multiply(M,k)}return m}}class Wa{constructor(s,n,r,l,o){s instanceof Wa?this.constructor_2(s):this.constructor_1(s,n,r,l,o)}constructor_1(s,n,r,l,o){const d=n==null||r==null,u=l==null||o==null;if(d&&u)throw new F;d?(n=new He(0,l.getY()),r=new He(0,o.getY())):u&&(l=new He(s.getWidth()-1,n.getY()),o=new He(s.getWidth()-1,r.getY())),this.image=s,this.topLeft=n,this.bottomLeft=r,this.topRight=l,this.bottomRight=o,this.minX=Math.trunc(Math.min(n.getX(),r.getX())),this.maxX=Math.trunc(Math.max(l.getX(),o.getX())),this.minY=Math.trunc(Math.min(n.getY(),l.getY())),this.maxY=Math.trunc(Math.max(r.getY(),o.getY()))}constructor_2(s){this.image=s.image,this.topLeft=s.getTopLeft(),this.bottomLeft=s.getBottomLeft(),this.topRight=s.getTopRight(),this.bottomRight=s.getBottomRight(),this.minX=s.getMinX(),this.maxX=s.getMaxX(),this.minY=s.getMinY(),this.maxY=s.getMaxY()}static merge(s,n){return s==null?n:n==null?s:new Wa(s.image,s.topLeft,s.bottomLeft,n.topRight,n.bottomRight)}addMissingRows(s,n,r){let l=this.topLeft,o=this.bottomLeft,d=this.topRight,u=this.bottomRight;if(s>0){let m=r?this.topLeft:this.topRight,b=Math.trunc(m.getY()-s);b<0&&(b=0);let S=new He(m.getX(),b);r?l=S:d=S}if(n>0){let m=r?this.bottomLeft:this.bottomRight,b=Math.trunc(m.getY()+n);b>=this.image.getHeight()&&(b=this.image.getHeight()-1);let S=new He(m.getX(),b);r?o=S:u=S}return new Wa(this.image,l,o,d,u)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class ui{constructor(s,n,r,l){this.columnCount=s,this.errorCorrectionLevel=l,this.rowCountUpperPart=n,this.rowCountLowerPart=r,this.rowCount=n+r}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class tr{constructor(){this.buffer=""}static form(s,n){let r=-1;function l(d,u,m,b,S,M){if(d==="%%")return"%";if(n[++r]===void 0)return;d=b?parseInt(b.substr(1)):void 0;let k=S?parseInt(S.substr(1)):void 0,X;switch(M){case"s":X=n[r];break;case"c":X=n[r][0];break;case"f":X=parseFloat(n[r]).toFixed(d);break;case"p":X=parseFloat(n[r]).toPrecision(d);break;case"e":X=parseFloat(n[r]).toExponential(d);break;case"x":X=parseInt(n[r]).toString(k||16);break;case"d":X=parseFloat(parseInt(n[r],k||10).toPrecision(d)).toFixed(0);break}X=typeof X=="object"?JSON.stringify(X):(+X).toString(k);let re=parseInt(m),ie=m&&m[0]+""=="0"?"0":" ";for(;X.length<re;)X=u!==void 0?X+ie:ie+X;return X}let o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return s.replace(o,l)}format(s,...n){this.buffer+=tr.form(s,n)}toString(){return this.buffer}}class nn{constructor(s){this.boundingBox=new Wa(s),this.codewords=new Array(s.getMaxY()-s.getMinY()+1)}getCodewordNearby(s){let n=this.getCodeword(s);if(n!=null)return n;for(let r=1;r<nn.MAX_NEARBY_DISTANCE;r++){let l=this.imageRowToCodewordIndex(s)-r;if(l>=0&&(n=this.codewords[l],n!=null)||(l=this.imageRowToCodewordIndex(s)+r,l<this.codewords.length&&(n=this.codewords[l],n!=null)))return n}return null}imageRowToCodewordIndex(s){return s-this.boundingBox.getMinY()}setCodeword(s,n){this.codewords[this.imageRowToCodewordIndex(s)]=n}getCodeword(s){return this.codewords[this.imageRowToCodewordIndex(s)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const s=new tr;let n=0;for(const r of this.codewords){if(r==null){s.format("%3d:    |   %n",n++);continue}s.format("%3d: %3d|%3d%n",n++,r.getRowNumber(),r.getValue())}return s.toString()}}nn.MAX_NEARBY_DISTANCE=5;class rn{constructor(){this.values=new Map}setValue(s){s=Math.trunc(s);let n=this.values.get(s);n==null&&(n=0),n++,this.values.set(s,n)}getValue(){let s=-1,n=new Array;for(const[r,l]of this.values.entries()){const o={getKey:()=>r,getValue:()=>l};o.getValue()>s?(s=o.getValue(),n=[],n.push(o.getKey())):o.getValue()===s&&n.push(o.getKey())}return dt.toIntArray(n)}getConfidence(s){return this.values.get(s)}}class ol extends nn{constructor(s,n){super(s),this._isLeft=n}setRowNumbers(){for(let s of this.getCodewords())s!=null&&s.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(s){let n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,s);let r=this.getBoundingBox(),l=this._isLeft?r.getTopLeft():r.getTopRight(),o=this._isLeft?r.getBottomLeft():r.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(l.getY())),u=this.imageRowToCodewordIndex(Math.trunc(o.getY())),m=-1,b=1,S=0;for(let M=d;M<u;M++){if(n[M]==null)continue;let k=n[M],X=k.getRowNumber()-m;if(X===0)S++;else if(X===1)b=Math.max(b,S),S=1,m=k.getRowNumber();else if(X<0||k.getRowNumber()>=s.getRowCount()||X>M)n[M]=null;else{let re;b>2?re=(b-2)*X:re=X;let ie=re>=M;for(let he=1;he<=re&&!ie;he++)ie=n[M-he]!=null;ie?n[M]=null:(m=k.getRowNumber(),S=1)}}}getRowHeights(){let s=this.getBarcodeMetadata();if(s==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(s);let n=new Int32Array(s.getRowCount());for(let r of this.getCodewords())if(r!=null){let l=r.getRowNumber();if(l>=n.length)continue;n[l]++}return n}adjustIncompleteIndicatorColumnRowNumbers(s){let n=this.getBoundingBox(),r=this._isLeft?n.getTopLeft():n.getTopRight(),l=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(r.getY())),d=this.imageRowToCodewordIndex(Math.trunc(l.getY())),u=this.getCodewords(),m=-1;for(let b=o;b<d;b++){if(u[b]==null)continue;let S=u[b];S.setRowNumberAsRowIndicatorColumn();let M=S.getRowNumber()-m;M===0||(M===1?m=S.getRowNumber():S.getRowNumber()>=s.getRowCount()?u[b]=null:m=S.getRowNumber())}}getBarcodeMetadata(){let s=this.getCodewords(),n=new rn,r=new rn,l=new rn,o=new rn;for(let u of s){if(u==null)continue;u.setRowNumberAsRowIndicatorColumn();let m=u.getValue()%30,b=u.getRowNumber();switch(this._isLeft||(b+=2),b%3){case 0:r.setValue(m*3+1);break;case 1:o.setValue(m/3),l.setValue(m%3);break;case 2:n.setValue(m+1);break}}if(n.getValue().length===0||r.getValue().length===0||l.getValue().length===0||o.getValue().length===0||n.getValue()[0]<1||r.getValue()[0]+l.getValue()[0]<dt.MIN_ROWS_IN_BARCODE||r.getValue()[0]+l.getValue()[0]>dt.MAX_ROWS_IN_BARCODE)return null;let d=new ui(n.getValue()[0],r.getValue()[0],l.getValue()[0],o.getValue()[0]);return this.removeIncorrectCodewords(s,d),d}removeIncorrectCodewords(s,n){for(let r=0;r<s.length;r++){let l=s[r];if(s[r]==null)continue;let o=l.getValue()%30,d=l.getRowNumber();if(d>n.getRowCount()){s[r]=null;continue}switch(this._isLeft||(d+=2),d%3){case 0:o*3+1!==n.getRowCountUpperPart()&&(s[r]=null);break;case 1:(Math.trunc(o/3)!==n.getErrorCorrectionLevel()||o%3!==n.getRowCountLowerPart())&&(s[r]=null);break;case 2:o+1!==n.getColumnCount()&&(s[r]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Ms{constructor(s,n){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=s,this.barcodeColumnCount=s.getColumnCount(),this.boundingBox=n,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let s=dt.MAX_CODEWORDS_IN_BARCODE,n;do n=s,s=this.adjustRowNumbersAndGetCount();while(s>0&&s<n);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(s){s!=null&&s.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let s=this.adjustRowNumbersByRow();if(s===0)return 0;for(let n=1;n<this.barcodeColumnCount+1;n++){let r=this.detectionResultColumns[n].getCodewords();for(let l=0;l<r.length;l++)r[l]!=null&&(r[l].hasValidRowNumber()||this.adjustRowNumbers(n,l,r))}return s}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let s=this.detectionResultColumns[0].getCodewords(),n=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<s.length;r++)if(s[r]!=null&&n[r]!=null&&s[r].getRowNumber()===n[r].getRowNumber())for(let l=1;l<=this.barcodeColumnCount;l++){let o=this.detectionResultColumns[l].getCodewords()[r];o!=null&&(o.setRowNumber(s[r].getRowNumber()),o.hasValidRowNumber()||(this.detectionResultColumns[l].getCodewords()[r]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let s=0,n=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<n.length;r++){if(n[r]==null)continue;let l=n[r].getRowNumber(),o=0;for(let d=this.barcodeColumnCount+1;d>0&&o<this.ADJUST_ROW_NUMBER_SKIP;d--){let u=this.detectionResultColumns[d].getCodewords()[r];u!=null&&(o=Ms.adjustRowNumberIfValid(l,o,u),u.hasValidRowNumber()||s++)}}return s}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let s=0,n=this.detectionResultColumns[0].getCodewords();for(let r=0;r<n.length;r++){if(n[r]==null)continue;let l=n[r].getRowNumber(),o=0;for(let d=1;d<this.barcodeColumnCount+1&&o<this.ADJUST_ROW_NUMBER_SKIP;d++){let u=this.detectionResultColumns[d].getCodewords()[r];u!=null&&(o=Ms.adjustRowNumberIfValid(l,o,u),u.hasValidRowNumber()||s++)}}return s}static adjustRowNumberIfValid(s,n,r){return r==null||r.hasValidRowNumber()||(r.isValidRowNumber(s)?(r.setRowNumber(s),n=0):++n),n}adjustRowNumbers(s,n,r){if(!this.detectionResultColumns[s-1])return;let l=r[n],o=this.detectionResultColumns[s-1].getCodewords(),d=o;this.detectionResultColumns[s+1]!=null&&(d=this.detectionResultColumns[s+1].getCodewords());let u=new Array(14);u[2]=o[n],u[3]=d[n],n>0&&(u[0]=r[n-1],u[4]=o[n-1],u[5]=d[n-1]),n>1&&(u[8]=r[n-2],u[10]=o[n-2],u[11]=d[n-2]),n<r.length-1&&(u[1]=r[n+1],u[6]=o[n+1],u[7]=d[n+1]),n<r.length-2&&(u[9]=r[n+2],u[12]=o[n+2],u[13]=d[n+2]);for(let m of u)if(Ms.adjustRowNumber(l,m))return}static adjustRowNumber(s,n){return n==null?!1:n.hasValidRowNumber()&&n.getBucket()===s.getBucket()?(s.setRowNumber(n.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(s){this.boundingBox=s}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(s,n){this.detectionResultColumns[s]=n}getDetectionResultColumn(s){return this.detectionResultColumns[s]}toString(){let s=this.detectionResultColumns[0];s==null&&(s=this.detectionResultColumns[this.barcodeColumnCount+1]);let n=new tr;for(let r=0;r<s.getCodewords().length;r++){n.format("CW %3d:",r);for(let l=0;l<this.barcodeColumnCount+2;l++){if(this.detectionResultColumns[l]==null){n.format("    |   ");continue}let o=this.detectionResultColumns[l].getCodewords()[r];if(o==null){n.format("    |   ");continue}n.format(" %3d|%3d",o.getRowNumber(),o.getValue())}n.format("%n")}return n.toString()}}class wa{constructor(s,n,r,l){this.rowNumber=wa.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(s),this.endX=Math.trunc(n),this.bucket=Math.trunc(r),this.value=Math.trunc(l)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(s){return s!==wa.BARCODE_ROW_UNKNOWN&&this.bucket===s%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(s){this.rowNumber=s}toString(){return this.rowNumber+"|"+this.value}}wa.BARCODE_ROW_UNKNOWN=-1;class zs{static initialize(){for(let s=0;s<dt.SYMBOL_TABLE.length;s++){let n=dt.SYMBOL_TABLE[s],r=n&1;for(let l=0;l<dt.BARS_IN_MODULE;l++){let o=0;for(;(n&1)===r;)o+=1,n>>=1;r=n&1,zs.RATIOS_TABLE[s]||(zs.RATIOS_TABLE[s]=new Array(dt.BARS_IN_MODULE)),zs.RATIOS_TABLE[s][dt.BARS_IN_MODULE-l-1]=Math.fround(o/dt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(s){let n=zs.getDecodedCodewordValue(zs.sampleBitCounts(s));return n!==-1?n:zs.getClosestDecodedValue(s)}static sampleBitCounts(s){let n=Xe.sum(s),r=new Int32Array(dt.BARS_IN_MODULE),l=0,o=0;for(let d=0;d<dt.MODULES_IN_CODEWORD;d++){let u=n/(2*dt.MODULES_IN_CODEWORD)+d*n/dt.MODULES_IN_CODEWORD;o+s[l]<=u&&(o+=s[l],l++),r[l]++}return r}static getDecodedCodewordValue(s){let n=zs.getBitValue(s);return dt.getCodeword(n)===-1?-1:n}static getBitValue(s){let n=0;for(let r=0;r<s.length;r++)for(let l=0;l<s[r];l++)n=n<<1|(r%2===0?1:0);return Math.trunc(n)}static getClosestDecodedValue(s){let n=Xe.sum(s),r=new Array(dt.BARS_IN_MODULE);if(n>1)for(let d=0;d<r.length;d++)r[d]=Math.fround(s[d]/n);let l=Tt.MAX_VALUE,o=-1;this.bSymbolTableReady||zs.initialize();for(let d=0;d<zs.RATIOS_TABLE.length;d++){let u=0,m=zs.RATIOS_TABLE[d];for(let b=0;b<dt.BARS_IN_MODULE;b++){let S=Math.fround(m[b]-r[b]);if(u+=Math.fround(S*S),u>=l)break}u<l&&(l=u,o=dt.SYMBOL_TABLE[d])}return o}}zs.bSymbolTableReady=!1,zs.RATIOS_TABLE=new Array(dt.SYMBOL_TABLE.length).map(I=>new Array(dt.BARS_IN_MODULE));class sr{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(s){this.segmentIndex=s}getFileId(){return this.fileId}setFileId(s){this.fileId=s}getOptionalData(){return this.optionalData}setOptionalData(s){this.optionalData=s}isLastSegment(){return this.lastSegment}setLastSegment(s){this.lastSegment=s}getSegmentCount(){return this.segmentCount}setSegmentCount(s){this.segmentCount=s}getSender(){return this.sender||null}setSender(s){this.sender=s}getAddressee(){return this.addressee||null}setAddressee(s){this.addressee=s}getFileName(){return this.fileName}setFileName(s){this.fileName=s}getFileSize(){return this.fileSize}setFileSize(s){this.fileSize=s}getChecksum(){return this.checksum}setChecksum(s){this.checksum=s}getTimestamp(){return this.timestamp}setTimestamp(s){this.timestamp=s}}class oo{static parseLong(s,n=void 0){return parseInt(s,n)}}class hi extends w{}hi.kind="NullPointerException";class cl{writeBytes(s){this.writeBytesOffset(s,0,s.length)}writeBytesOffset(s,n,r){if(s==null)throw new hi;if(n<0||n>s.length||r<0||n+r>s.length||n+r<0)throw new Y;if(r===0)return;for(let l=0;l<r;l++)this.write(s[n+l])}flush(){}close(){}}class Pr extends w{}class fi extends cl{constructor(s=32){if(super(),this.count=0,s<0)throw new O("Negative initial size: "+s);this.buf=new Uint8Array(s)}ensureCapacity(s){s-this.buf.length>0&&this.grow(s)}grow(s){let r=this.buf.length<<1;if(r-s<0&&(r=s),r<0){if(s<0)throw new Pr;r=H.MAX_VALUE}this.buf=K.copyOfUint8Array(this.buf,r)}write(s){this.ensureCapacity(this.count+1),this.buf[this.count]=s,this.count+=1}writeBytesOffset(s,n,r){if(n<0||n>s.length||r<0||n+r-s.length>0)throw new Y;this.ensureCapacity(this.count+r),V.arraycopy(s,n,this.buf,this.count,r),this.count+=r}writeTo(s){s.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return K.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(s){return s?typeof s=="string"?this.toString_string(s):this.toString_number(s):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(s){return new String(this.buf).toString()}toString_number(s){return new String(this.buf).toString()}close(){}}var Yt;(function(I){I[I.ALPHA=0]="ALPHA",I[I.LOWER=1]="LOWER",I[I.MIXED=2]="MIXED",I[I.PUNCT=3]="PUNCT",I[I.ALPHA_SHIFT=4]="ALPHA_SHIFT",I[I.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Yt||(Yt={}));function co(){if(typeof window<"u")return window.BigInt||null;if(typeof Nc<"u")return Nc.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let xi;function ln(I){if(typeof xi>"u"&&(xi=co()),xi===null)throw new Error("BigInt is not supported!");return xi(I)}function dl(){let I=[];I[0]=ln(1);let s=ln(900);I[1]=s;for(let n=2;n<16;n++)I[n]=I[n-1]*s;return I}class Ce{static decode(s,n){let r=new J(""),l=oe.ISO8859_1;r.enableDecoding(l);let o=1,d=s[o++],u=new sr;for(;o<s[0];){switch(d){case Ce.TEXT_COMPACTION_MODE_LATCH:o=Ce.textCompaction(s,o,r);break;case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:o=Ce.byteCompaction(d,s,l,o,r);break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(s[o++]);break;case Ce.NUMERIC_COMPACTION_MODE_LATCH:o=Ce.numericCompaction(s,o,r);break;case Ce.ECI_CHARSET:oe.getCharacterSetECIByValue(s[o++]);break;case Ce.ECI_GENERAL_PURPOSE:o+=2;break;case Ce.ECI_USER_DEFINED:o++;break;case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:o=Ce.decodeMacroBlock(s,o,u);break;case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:throw new $;default:o--,o=Ce.textCompaction(s,o,r);break}if(o<s.length)d=s[o++];else throw $.getFormatInstance()}if(r.length()===0)throw $.getFormatInstance();let m=new Je(null,r.toString(),null,n);return m.setOther(u),m}static decodeMacroBlock(s,n,r){if(n+Ce.NUMBER_OF_SEQUENCE_CODEWORDS>s[0])throw $.getFormatInstance();let l=new Int32Array(Ce.NUMBER_OF_SEQUENCE_CODEWORDS);for(let u=0;u<Ce.NUMBER_OF_SEQUENCE_CODEWORDS;u++,n++)l[u]=s[n];r.setSegmentIndex(H.parseInt(Ce.decodeBase900toBase10(l,Ce.NUMBER_OF_SEQUENCE_CODEWORDS)));let o=new J;n=Ce.textCompaction(s,n,o),r.setFileId(o.toString());let d=-1;for(s[n]===Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(d=n+1);n<s[0];)switch(s[n]){case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(n++,s[n]){case Ce.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let u=new J;n=Ce.textCompaction(s,n+1,u),r.setFileName(u.toString());break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let m=new J;n=Ce.textCompaction(s,n+1,m),r.setSender(m.toString());break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let b=new J;n=Ce.textCompaction(s,n+1,b),r.setAddressee(b.toString());break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let S=new J;n=Ce.numericCompaction(s,n+1,S),r.setSegmentCount(H.parseInt(S.toString()));break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let M=new J;n=Ce.numericCompaction(s,n+1,M),r.setTimestamp(oo.parseLong(M.toString()));break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let k=new J;n=Ce.numericCompaction(s,n+1,k),r.setChecksum(H.parseInt(k.toString()));break;case Ce.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let X=new J;n=Ce.numericCompaction(s,n+1,X),r.setFileSize(oo.parseLong(X.toString()));break;default:throw $.getFormatInstance()}break;case Ce.MACRO_PDF417_TERMINATOR:n++,r.setLastSegment(!0);break;default:throw $.getFormatInstance()}if(d!==-1){let u=n-d;r.isLastSegment()&&u--,r.setOptionalData(K.copyOfRange(s,d,d+u))}return n}static textCompaction(s,n,r){let l=new Int32Array((s[0]-n)*2),o=new Int32Array((s[0]-n)*2),d=0,u=!1;for(;n<s[0]&&!u;){let m=s[n++];if(m<Ce.TEXT_COMPACTION_MODE_LATCH)l[d]=m/30,l[d+1]=m%30,d+=2;else switch(m){case Ce.TEXT_COMPACTION_MODE_LATCH:l[d++]=Ce.TEXT_COMPACTION_MODE_LATCH;break;case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:case Ce.NUMERIC_COMPACTION_MODE_LATCH:case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:n--,u=!0;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l[d]=Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,m=s[n++],o[d]=m,d++;break}}return Ce.decodeTextCompaction(l,o,d,r),n}static decodeTextCompaction(s,n,r,l){let o=Yt.ALPHA,d=Yt.ALPHA,u=0;for(;u<r;){let m=s[u],b="";switch(o){case Yt.ALPHA:if(m<26)b=String.fromCharCode(65+m);else switch(m){case 26:b=" ";break;case Ce.LL:o=Yt.LOWER;break;case Ce.ML:o=Yt.MIXED;break;case Ce.PS:d=o,o=Yt.PUNCT_SHIFT;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(n[u]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:o=Yt.ALPHA;break}break;case Yt.LOWER:if(m<26)b=String.fromCharCode(97+m);else switch(m){case 26:b=" ";break;case Ce.AS:d=o,o=Yt.ALPHA_SHIFT;break;case Ce.ML:o=Yt.MIXED;break;case Ce.PS:d=o,o=Yt.PUNCT_SHIFT;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(n[u]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:o=Yt.ALPHA;break}break;case Yt.MIXED:if(m<Ce.PL)b=Ce.MIXED_CHARS[m];else switch(m){case Ce.PL:o=Yt.PUNCT;break;case 26:b=" ";break;case Ce.LL:o=Yt.LOWER;break;case Ce.AL:o=Yt.ALPHA;break;case Ce.PS:d=o,o=Yt.PUNCT_SHIFT;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(n[u]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:o=Yt.ALPHA;break}break;case Yt.PUNCT:if(m<Ce.PAL)b=Ce.PUNCT_CHARS[m];else switch(m){case Ce.PAL:o=Yt.ALPHA;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(n[u]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:o=Yt.ALPHA;break}break;case Yt.ALPHA_SHIFT:if(o=d,m<26)b=String.fromCharCode(65+m);else switch(m){case 26:b=" ";break;case Ce.TEXT_COMPACTION_MODE_LATCH:o=Yt.ALPHA;break}break;case Yt.PUNCT_SHIFT:if(o=d,m<Ce.PAL)b=Ce.PUNCT_CHARS[m];else switch(m){case Ce.PAL:o=Yt.ALPHA;break;case Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(n[u]);break;case Ce.TEXT_COMPACTION_MODE_LATCH:o=Yt.ALPHA;break}break}b!==""&&l.append(b),u++}}static byteCompaction(s,n,r,l,o){let d=new fi,u=0,m=0,b=!1;switch(s){case Ce.BYTE_COMPACTION_MODE_LATCH:let S=new Int32Array(6),M=n[l++];for(;l<n[0]&&!b;)switch(S[u++]=M,m=900*m+M,M=n[l++],M){case Ce.TEXT_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.NUMERIC_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:l--,b=!0;break;default:if(u%5===0&&u>0){for(let k=0;k<6;++k)d.write(Number(ln(m)>>ln(8*(5-k))));m=0,u=0}break}l===n[0]&&M<Ce.TEXT_COMPACTION_MODE_LATCH&&(S[u++]=M);for(let k=0;k<u;k++)d.write(S[k]);break;case Ce.BYTE_COMPACTION_MODE_LATCH_6:for(;l<n[0]&&!b;){let k=n[l++];if(k<Ce.TEXT_COMPACTION_MODE_LATCH)u++,m=900*m+k;else switch(k){case Ce.TEXT_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.NUMERIC_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:l--,b=!0;break}if(u%5===0&&u>0){for(let X=0;X<6;++X)d.write(Number(ln(m)>>ln(8*(5-X))));m=0,u=0}}break}return o.append(me.decode(d.toByteArray(),r)),l}static numericCompaction(s,n,r){let l=0,o=!1,d=new Int32Array(Ce.MAX_NUMERIC_CODEWORDS);for(;n<s[0]&&!o;){let u=s[n++];if(n===s[0]&&(o=!0),u<Ce.TEXT_COMPACTION_MODE_LATCH)d[l]=u,l++;else switch(u){case Ce.TEXT_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH:case Ce.BYTE_COMPACTION_MODE_LATCH_6:case Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ce.MACRO_PDF417_TERMINATOR:n--,o=!0;break}(l%Ce.MAX_NUMERIC_CODEWORDS===0||u===Ce.NUMERIC_COMPACTION_MODE_LATCH||o)&&l>0&&(r.append(Ce.decodeBase900toBase10(d,l)),l=0)}return n}static decodeBase900toBase10(s,n){let r=ln(0);for(let o=0;o<n;o++)r+=Ce.EXP900[n-o-1]*ln(s[o]);let l=r.toString();if(l.charAt(0)!=="1")throw new $;return l.substring(1)}}Ce.TEXT_COMPACTION_MODE_LATCH=900,Ce.BYTE_COMPACTION_MODE_LATCH=901,Ce.NUMERIC_COMPACTION_MODE_LATCH=902,Ce.BYTE_COMPACTION_MODE_LATCH_6=924,Ce.ECI_USER_DEFINED=925,Ce.ECI_GENERAL_PURPOSE=926,Ce.ECI_CHARSET=927,Ce.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Ce.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Ce.MACRO_PDF417_TERMINATOR=922,Ce.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Ce.MAX_NUMERIC_CODEWORDS=15,Ce.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Ce.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Ce.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Ce.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Ce.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Ce.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Ce.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Ce.PL=25,Ce.LL=27,Ce.AS=27,Ce.ML=28,Ce.AL=28,Ce.PS=29,Ce.PAL=29,Ce.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Ce.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Ce.EXP900=co()?dl():[],Ce.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Ct{constructor(){}static decode(s,n,r,l,o,d,u){let m=new Wa(s,n,r,l,o),b=null,S=null,M;for(let re=!0;;re=!1){if(n!=null&&(b=Ct.getRowIndicatorColumn(s,m,n,!0,d,u)),l!=null&&(S=Ct.getRowIndicatorColumn(s,m,l,!1,d,u)),M=Ct.merge(b,S),M==null)throw F.getNotFoundInstance();let ie=M.getBoundingBox();if(re&&ie!=null&&(ie.getMinY()<m.getMinY()||ie.getMaxY()>m.getMaxY()))m=ie;else break}M.setBoundingBox(m);let k=M.getBarcodeColumnCount()+1;M.setDetectionResultColumn(0,b),M.setDetectionResultColumn(k,S);let X=b!=null;for(let re=1;re<=k;re++){let ie=X?re:k-re;if(M.getDetectionResultColumn(ie)!==void 0)continue;let he;ie===0||ie===k?he=new ol(m,ie===0):he=new nn(m),M.setDetectionResultColumn(ie,he);let je=-1,Pe=je;for(let Le=m.getMinY();Le<=m.getMaxY();Le++){if(je=Ct.getStartColumn(M,ie,Le,X),je<0||je>m.getMaxX()){if(Pe===-1)continue;je=Pe}let ke=Ct.detectCodeword(s,m.getMinX(),m.getMaxX(),X,je,Le,d,u);ke!=null&&(he.setCodeword(Le,ke),Pe=je,d=Math.min(d,ke.getWidth()),u=Math.max(u,ke.getWidth()))}}return Ct.createDecoderResult(M)}static merge(s,n){if(s==null&&n==null)return null;let r=Ct.getBarcodeMetadata(s,n);if(r==null)return null;let l=Wa.merge(Ct.adjustBoundingBox(s),Ct.adjustBoundingBox(n));return new Ms(r,l)}static adjustBoundingBox(s){if(s==null)return null;let n=s.getRowHeights();if(n==null)return null;let r=Ct.getMax(n),l=0;for(let u of n)if(l+=r-u,u>0)break;let o=s.getCodewords();for(let u=0;l>0&&o[u]==null;u++)l--;let d=0;for(let u=n.length-1;u>=0&&(d+=r-n[u],!(n[u]>0));u--);for(let u=o.length-1;d>0&&o[u]==null;u--)d--;return s.getBoundingBox().addMissingRows(l,d,s.isLeft())}static getMax(s){let n=-1;for(let r of s)n=Math.max(n,r);return n}static getBarcodeMetadata(s,n){let r;if(s==null||(r=s.getBarcodeMetadata())==null)return n==null?null:n.getBarcodeMetadata();let l;return n==null||(l=n.getBarcodeMetadata())==null?r:r.getColumnCount()!==l.getColumnCount()&&r.getErrorCorrectionLevel()!==l.getErrorCorrectionLevel()&&r.getRowCount()!==l.getRowCount()?null:r}static getRowIndicatorColumn(s,n,r,l,o,d){let u=new ol(n,l);for(let m=0;m<2;m++){let b=m===0?1:-1,S=Math.trunc(Math.trunc(r.getX()));for(let M=Math.trunc(Math.trunc(r.getY()));M<=n.getMaxY()&&M>=n.getMinY();M+=b){let k=Ct.detectCodeword(s,0,s.getWidth(),l,S,M,o,d);k!=null&&(u.setCodeword(M,k),l?S=k.getStartX():S=k.getEndX())}}return u}static adjustCodewordCount(s,n){let r=n[0][1],l=r.getValue(),o=s.getBarcodeColumnCount()*s.getBarcodeRowCount()-Ct.getNumberOfECCodeWords(s.getBarcodeECLevel());if(l.length===0){if(o<1||o>dt.MAX_CODEWORDS_IN_BARCODE)throw F.getNotFoundInstance();r.setValue(o)}else l[0]!==o&&r.setValue(o)}static createDecoderResult(s){let n=Ct.createBarcodeMatrix(s);Ct.adjustCodewordCount(s,n);let r=new Array,l=new Int32Array(s.getBarcodeRowCount()*s.getBarcodeColumnCount()),o=[],d=new Array;for(let m=0;m<s.getBarcodeRowCount();m++)for(let b=0;b<s.getBarcodeColumnCount();b++){let S=n[m][b+1].getValue(),M=m*s.getBarcodeColumnCount()+b;S.length===0?r.push(M):S.length===1?l[M]=S[0]:(d.push(M),o.push(S))}let u=new Array(o.length);for(let m=0;m<u.length;m++)u[m]=o[m];return Ct.createDecoderResultFromAmbiguousValues(s.getBarcodeECLevel(),l,dt.toIntArray(r),dt.toIntArray(d),u)}static createDecoderResultFromAmbiguousValues(s,n,r,l,o){let d=new Int32Array(l.length),u=100;for(;u-- >0;){for(let m=0;m<d.length;m++)n[l[m]]=o[m][d[m]];try{return Ct.decodeCodewords(n,s,r)}catch(m){if(!(m instanceof L))throw m}if(d.length===0)throw L.getChecksumInstance();for(let m=0;m<d.length;m++)if(d[m]<o[m].length-1){d[m]++;break}else if(d[m]=0,m===d.length-1)throw L.getChecksumInstance()}throw L.getChecksumInstance()}static createBarcodeMatrix(s){let n=Array.from({length:s.getBarcodeRowCount()},()=>new Array(s.getBarcodeColumnCount()+2));for(let l=0;l<n.length;l++)for(let o=0;o<n[l].length;o++)n[l][o]=new rn;let r=0;for(let l of s.getDetectionResultColumns()){if(l!=null){for(let o of l.getCodewords())if(o!=null){let d=o.getRowNumber();if(d>=0){if(d>=n.length)continue;n[d][r].setValue(o.getValue())}}}r++}return n}static isValidBarcodeColumn(s,n){return n>=0&&n<=s.getBarcodeColumnCount()+1}static getStartColumn(s,n,r,l){let o=l?1:-1,d=null;if(Ct.isValidBarcodeColumn(s,n-o)&&(d=s.getDetectionResultColumn(n-o).getCodeword(r)),d!=null)return l?d.getEndX():d.getStartX();if(d=s.getDetectionResultColumn(n).getCodewordNearby(r),d!=null)return l?d.getStartX():d.getEndX();if(Ct.isValidBarcodeColumn(s,n-o)&&(d=s.getDetectionResultColumn(n-o).getCodewordNearby(r)),d!=null)return l?d.getEndX():d.getStartX();let u=0;for(;Ct.isValidBarcodeColumn(s,n-o);){n-=o;for(let m of s.getDetectionResultColumn(n).getCodewords())if(m!=null)return(l?m.getEndX():m.getStartX())+o*u*(m.getEndX()-m.getStartX());u++}return l?s.getBoundingBox().getMinX():s.getBoundingBox().getMaxX()}static detectCodeword(s,n,r,l,o,d,u,m){o=Ct.adjustCodewordStartColumn(s,n,r,l,o,d);let b=Ct.getModuleBitCount(s,n,r,l,o,d);if(b==null)return null;let S,M=Xe.sum(b);if(l)S=o+M;else{for(let re=0;re<b.length/2;re++){let ie=b[re];b[re]=b[b.length-1-re],b[b.length-1-re]=ie}S=o,o=S-M}if(!Ct.checkCodewordSkew(M,u,m))return null;let k=zs.getDecodedValue(b),X=dt.getCodeword(k);return X===-1?null:new wa(o,S,Ct.getCodewordBucketNumber(k),X)}static getModuleBitCount(s,n,r,l,o,d){let u=o,m=new Int32Array(8),b=0,S=l?1:-1,M=l;for(;(l?u<r:u>=n)&&b<m.length;)s.get(u,d)===M?(m[b]++,u+=S):(b++,M=!M);return b===m.length||u===(l?r:n)&&b===m.length-1?m:null}static getNumberOfECCodeWords(s){return 2<<s}static adjustCodewordStartColumn(s,n,r,l,o,d){let u=o,m=l?-1:1;for(let b=0;b<2;b++){for(;(l?u>=n:u<r)&&l===s.get(u,d);){if(Math.abs(o-u)>Ct.CODEWORD_SKEW_SIZE)return o;u+=m}m=-m,l=!l}return u}static checkCodewordSkew(s,n,r){return n-Ct.CODEWORD_SKEW_SIZE<=s&&s<=r+Ct.CODEWORD_SKEW_SIZE}static decodeCodewords(s,n,r){if(s.length===0)throw $.getFormatInstance();let l=1<<n+1,o=Ct.correctErrors(s,r,l);Ct.verifyCodewordCount(s,l);let d=Ce.decode(s,""+n);return d.setErrorsCorrected(o),d.setErasures(r.length),d}static correctErrors(s,n,r){if(n!=null&&n.length>r/2+Ct.MAX_ERRORS||r<0||r>Ct.MAX_EC_CODEWORDS)throw L.getChecksumInstance();return Ct.errorCorrection.decode(s,r,n)}static verifyCodewordCount(s,n){if(s.length<4)throw $.getFormatInstance();let r=s[0];if(r>s.length)throw $.getFormatInstance();if(r===0)if(n<s.length)s[0]=s.length-n;else throw $.getFormatInstance()}static getBitCountForCodeword(s){let n=new Int32Array(8),r=0,l=n.length-1;for(;!((s&1)!==r&&(r=s&1,l--,l<0));)n[l]++,s>>=1;return n}static getCodewordBucketNumber(s){return s instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(s):this.getCodewordBucketNumber_number(s)}static getCodewordBucketNumber_number(s){return Ct.getCodewordBucketNumber(Ct.getBitCountForCodeword(s))}static getCodewordBucketNumber_Int32Array(s){return(s[0]-s[2]+s[4]-s[6]+9)%9}static toString(s){let n=new tr;for(let r=0;r<s.length;r++){n.format("Row %2d: ",r);for(let l=0;l<s[r].length;l++){let o=s[r][l];o.getValue().length===0?n.format("        ",null):n.format("%4d(%2d)",o.getValue()[0],o.getConfidence(o.getValue()[0]))}n.format("%n")}return n.toString()}}Ct.CODEWORD_SKEW_SIZE=2,Ct.MAX_ERRORS=3,Ct.MAX_EC_CODEWORDS=512,Ct.errorCorrection=new Za;class Hs{decode(s,n=null){let r=Hs.decode(s,n,!1);if(r==null||r.length===0||r[0]==null)throw F.getNotFoundInstance();return r[0]}decodeMultiple(s,n=null){try{return Hs.decode(s,n,!0)}catch(r){throw r instanceof $||r instanceof L?F.getNotFoundInstance():r}}static decode(s,n,r){const l=new Array,o=bt.detectMultiple(s,n,r);for(const d of o.getPoints()){const u=Ct.decode(o.getBits(),d[4],d[5],d[6],d[7],Hs.getMinCodewordWidth(d),Hs.getMaxCodewordWidth(d)),m=new Z(u.getText(),u.getRawBytes(),void 0,d,xe.PDF_417);m.putMetadata(Ve.ERROR_CORRECTION_LEVEL,u.getECLevel());const b=u.getOther();b!=null&&m.putMetadata(Ve.PDF417_EXTRA_METADATA,b),l.push(m)}return l.map(d=>d)}static getMaxWidth(s,n){return s==null||n==null?0:Math.trunc(Math.abs(s.getX()-n.getX()))}static getMinWidth(s,n){return s==null||n==null?H.MAX_VALUE:Math.trunc(Math.abs(s.getX()-n.getX()))}static getMaxCodewordWidth(s){return Math.floor(Math.max(Math.max(Hs.getMaxWidth(s[0],s[4]),Hs.getMaxWidth(s[6],s[2])*dt.MODULES_IN_CODEWORD/dt.MODULES_IN_STOP_PATTERN),Math.max(Hs.getMaxWidth(s[1],s[5]),Hs.getMaxWidth(s[7],s[3])*dt.MODULES_IN_CODEWORD/dt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(s){return Math.floor(Math.min(Math.min(Hs.getMinWidth(s[0],s[4]),Hs.getMinWidth(s[6],s[2])*dt.MODULES_IN_CODEWORD/dt.MODULES_IN_STOP_PATTERN),Math.min(Hs.getMinWidth(s[1],s[5]),Hs.getMinWidth(s[7],s[3])*dt.MODULES_IN_CODEWORD/dt.MODULES_IN_STOP_PATTERN)))}reset(){}}class mi extends w{}mi.kind="ReaderException";class uo{constructor(s,n){this.verbose=s===!0,n&&this.setHints(n)}decode(s,n){return n&&this.setHints(n),this.decodeInternal(s)}decodeWithState(s){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(s)}setHints(s){this.hints=s;const n=!y(s)&&s.get(ce.TRY_HARDER)===!0,r=y(s)?null:s.get(ce.POSSIBLE_FORMATS),l=new Array;if(!y(r)){const o=r.some(d=>d===xe.UPC_A||d===xe.UPC_E||d===xe.EAN_13||d===xe.EAN_8||d===xe.CODABAR||d===xe.CODE_39||d===xe.CODE_93||d===xe.CODE_128||d===xe.ITF||d===xe.RSS_14||d===xe.RSS_EXPANDED);o&&!n&&l.push(new ya(s,this.verbose)),r.includes(xe.QR_CODE)&&l.push(new Ka),r.includes(xe.DATA_MATRIX)&&l.push(new qa),r.includes(xe.AZTEC)&&l.push(new ue),r.includes(xe.PDF_417)&&l.push(new Hs),o&&n&&l.push(new ya(s,this.verbose))}l.length===0&&(n||l.push(new ya(s,this.verbose)),l.push(new Ka),l.push(new qa),l.push(new ue),l.push(new Hs),n&&l.push(new ya(s,this.verbose))),this.readers=l}reset(){if(this.readers!==null)for(const s of this.readers)s.reset()}decodeInternal(s){if(this.readers===null)throw new mi("No readers where selected, nothing can be read.");for(const n of this.readers)try{return n.decode(s,this.hints)}catch(r){if(r instanceof mi)continue}throw new F("No MultiFormat Readers were able to detect the code.")}}class ho extends U{constructor(s=null,n=500){const r=new uo;r.setHints(s),super(r,n)}decodeBitmap(s){return this.reader.decodeWithState(s)}}class Uc extends U{constructor(s=500){super(new Hs,s)}}class zc extends U{constructor(s=500){super(new Ka,s)}}var ul;(function(I){I[I.ERROR_CORRECTION=0]="ERROR_CORRECTION",I[I.CHARACTER_SET=1]="CHARACTER_SET",I[I.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",I[I.MIN_SIZE=3]="MIN_SIZE",I[I.MAX_SIZE=4]="MAX_SIZE",I[I.MARGIN=5]="MARGIN",I[I.PDF417_COMPACT=6]="PDF417_COMPACT",I[I.PDF417_COMPACTION=7]="PDF417_COMPACTION",I[I.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",I[I.AZTEC_LAYERS=9]="AZTEC_LAYERS",I[I.QR_VERSION=10]="QR_VERSION"})(ul||(ul={}));var Ts=ul;class Fr{constructor(s){this.field=s,this.cachedGenerators=[],this.cachedGenerators.push(new Be(s,Int32Array.from([1])))}buildGenerator(s){const n=this.cachedGenerators;if(s>=n.length){let r=n[n.length-1];const l=this.field;for(let o=n.length;o<=s;o++){const d=r.multiply(new Be(l,Int32Array.from([1,l.exp(o-1+l.getGeneratorBase())])));n.push(d),r=d}}return n[s]}encode(s,n){if(n===0)throw new O("No error correction bytes");const r=s.length-n;if(r<=0)throw new O("No data bytes provided");const l=this.buildGenerator(n),o=new Int32Array(r);V.arraycopy(s,0,o,0,r);let d=new Be(this.field,o);d=d.multiplyByMonomial(n,1);const m=d.divide(l)[1].getCoefficients(),b=n-m.length;for(let S=0;S<b;S++)s[r+S]=0;V.arraycopy(m,0,s,r+b,m.length)}}class ps{constructor(){}static applyMaskPenaltyRule1(s){return ps.applyMaskPenaltyRule1Internal(s,!0)+ps.applyMaskPenaltyRule1Internal(s,!1)}static applyMaskPenaltyRule2(s){let n=0;const r=s.getArray(),l=s.getWidth(),o=s.getHeight();for(let d=0;d<o-1;d++){const u=r[d];for(let m=0;m<l-1;m++){const b=u[m];b===u[m+1]&&b===r[d+1][m]&&b===r[d+1][m+1]&&n++}}return ps.N2*n}static applyMaskPenaltyRule3(s){let n=0;const r=s.getArray(),l=s.getWidth(),o=s.getHeight();for(let d=0;d<o;d++)for(let u=0;u<l;u++){const m=r[d];u+6<l&&m[u]===1&&m[u+1]===0&&m[u+2]===1&&m[u+3]===1&&m[u+4]===1&&m[u+5]===0&&m[u+6]===1&&(ps.isWhiteHorizontal(m,u-4,u)||ps.isWhiteHorizontal(m,u+7,u+11))&&n++,d+6<o&&r[d][u]===1&&r[d+1][u]===0&&r[d+2][u]===1&&r[d+3][u]===1&&r[d+4][u]===1&&r[d+5][u]===0&&r[d+6][u]===1&&(ps.isWhiteVertical(r,u,d-4,d)||ps.isWhiteVertical(r,u,d+7,d+11))&&n++}return n*ps.N3}static isWhiteHorizontal(s,n,r){n=Math.max(n,0),r=Math.min(r,s.length);for(let l=n;l<r;l++)if(s[l]===1)return!1;return!0}static isWhiteVertical(s,n,r,l){r=Math.max(r,0),l=Math.min(l,s.length);for(let o=r;o<l;o++)if(s[o][n]===1)return!1;return!0}static applyMaskPenaltyRule4(s){let n=0;const r=s.getArray(),l=s.getWidth(),o=s.getHeight();for(let m=0;m<o;m++){const b=r[m];for(let S=0;S<l;S++)b[S]===1&&n++}const d=s.getHeight()*s.getWidth();return Math.floor(Math.abs(n*2-d)*10/d)*ps.N4}static getDataMaskBit(s,n,r){let l,o;switch(s){case 0:l=r+n&1;break;case 1:l=r&1;break;case 2:l=n%3;break;case 3:l=(r+n)%3;break;case 4:l=Math.floor(r/2)+Math.floor(n/3)&1;break;case 5:o=r*n,l=(o&1)+o%3;break;case 6:o=r*n,l=(o&1)+o%3&1;break;case 7:o=r*n,l=o%3+(r+n&1)&1;break;default:throw new O("Invalid mask pattern: "+s)}return l===0}static applyMaskPenaltyRule1Internal(s,n){let r=0;const l=n?s.getHeight():s.getWidth(),o=n?s.getWidth():s.getHeight(),d=s.getArray();for(let u=0;u<l;u++){let m=0,b=-1;for(let S=0;S<o;S++){const M=n?d[u][S]:d[S][u];M===b?m++:(m>=5&&(r+=ps.N1+(m-5)),m=1,b=M)}m>=5&&(r+=ps.N1+(m-5))}return r}}ps.N1=3,ps.N2=3,ps.N3=40,ps.N4=10;class gi{constructor(s,n){this.width=s,this.height=n;const r=new Array(n);for(let l=0;l!==n;l++)r[l]=new Uint8Array(s);this.bytes=r}getHeight(){return this.height}getWidth(){return this.width}get(s,n){return this.bytes[n][s]}getArray(){return this.bytes}setNumber(s,n,r){this.bytes[n][s]=r}setBoolean(s,n,r){this.bytes[n][s]=r?1:0}clear(s){for(const n of this.bytes)K.fill(n,s)}equals(s){if(!(s instanceof gi))return!1;const n=s;if(this.width!==n.width||this.height!==n.height)return!1;for(let r=0,l=this.height;r<l;++r){const o=this.bytes[r],d=n.bytes[r];for(let u=0,m=this.width;u<m;++u)if(o[u]!==d[u])return!1}return!0}toString(){const s=new J;for(let n=0,r=this.height;n<r;++n){const l=this.bytes[n];for(let o=0,d=this.width;o<d;++o)switch(l[o]){case 0:s.append(" 0");break;case 1:s.append(" 1");break;default:s.append("  ");break}s.append(`
`)}return s.toString()}}class bn{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const s=new J;return s.append(`<<
`),s.append(" mode: "),s.append(this.mode?this.mode.toString():"null"),s.append(`
 ecLevel: `),s.append(this.ecLevel?this.ecLevel.toString():"null"),s.append(`
 version: `),s.append(this.version?this.version.toString():"null"),s.append(`
 maskPattern: `),s.append(this.maskPattern.toString()),this.matrix?(s.append(`
 matrix:
`),s.append(this.matrix.toString())):s.append(`
 matrix: null
`),s.append(`>>
`),s.toString()}setMode(s){this.mode=s}setECLevel(s){this.ecLevel=s}setVersion(s){this.version=s}setMaskPattern(s){this.maskPattern=s}setMatrix(s){this.matrix=s}static isValidMaskPattern(s){return s>=0&&s<bn.NUM_MASK_PATTERNS}}bn.NUM_MASK_PATTERNS=8;class Wt extends w{}Wt.kind="WriterException";class ut{constructor(){}static clearMatrix(s){s.clear(255)}static buildMatrix(s,n,r,l,o){ut.clearMatrix(o),ut.embedBasicPatterns(r,o),ut.embedTypeInfo(n,l,o),ut.maybeEmbedVersionInfo(r,o),ut.embedDataBits(s,l,o)}static embedBasicPatterns(s,n){ut.embedPositionDetectionPatternsAndSeparators(n),ut.embedDarkDotAtLeftBottomCorner(n),ut.maybeEmbedPositionAdjustmentPatterns(s,n),ut.embedTimingPatterns(n)}static embedTypeInfo(s,n,r){const l=new q;ut.makeTypeInfoBits(s,n,l);for(let o=0,d=l.getSize();o<d;++o){const u=l.get(l.getSize()-1-o),m=ut.TYPE_INFO_COORDINATES[o],b=m[0],S=m[1];if(r.setBoolean(b,S,u),o<8){const M=r.getWidth()-o-1;r.setBoolean(M,8,u)}else{const k=r.getHeight()-7+(o-8);r.setBoolean(8,k,u)}}}static maybeEmbedVersionInfo(s,n){if(s.getVersionNumber()<7)return;const r=new q;ut.makeVersionInfoBits(s,r);let l=17;for(let o=0;o<6;++o)for(let d=0;d<3;++d){const u=r.get(l);l--,n.setBoolean(o,n.getHeight()-11+d,u),n.setBoolean(n.getHeight()-11+d,o,u)}}static embedDataBits(s,n,r){let l=0,o=-1,d=r.getWidth()-1,u=r.getHeight()-1;for(;d>0;){for(d===6&&(d-=1);u>=0&&u<r.getHeight();){for(let m=0;m<2;++m){const b=d-m;if(!ut.isEmpty(r.get(b,u)))continue;let S;l<s.getSize()?(S=s.get(l),++l):S=!1,n!==255&&ps.getDataMaskBit(n,b,u)&&(S=!S),r.setBoolean(b,u,S)}u+=o}o=-o,u+=o,d-=2}if(l!==s.getSize())throw new Wt("Not all bits consumed: "+l+"/"+s.getSize())}static findMSBSet(s){return 32-H.numberOfLeadingZeros(s)}static calculateBCHCode(s,n){if(n===0)throw new O("0 polynomial");const r=ut.findMSBSet(n);for(s<<=r-1;ut.findMSBSet(s)>=r;)s^=n<<ut.findMSBSet(s)-r;return s}static makeTypeInfoBits(s,n,r){if(!bn.isValidMaskPattern(n))throw new Wt("Invalid mask pattern");const l=s.getBits()<<3|n;r.appendBits(l,5);const o=ut.calculateBCHCode(l,ut.TYPE_INFO_POLY);r.appendBits(o,10);const d=new q;if(d.appendBits(ut.TYPE_INFO_MASK_PATTERN,15),r.xor(d),r.getSize()!==15)throw new Wt("should not happen but we got: "+r.getSize())}static makeVersionInfoBits(s,n){n.appendBits(s.getVersionNumber(),6);const r=ut.calculateBCHCode(s.getVersionNumber(),ut.VERSION_INFO_POLY);if(n.appendBits(r,12),n.getSize()!==18)throw new Wt("should not happen but we got: "+n.getSize())}static isEmpty(s){return s===255}static embedTimingPatterns(s){for(let n=8;n<s.getWidth()-8;++n){const r=(n+1)%2;ut.isEmpty(s.get(n,6))&&s.setNumber(n,6,r),ut.isEmpty(s.get(6,n))&&s.setNumber(6,n,r)}}static embedDarkDotAtLeftBottomCorner(s){if(s.get(8,s.getHeight()-8)===0)throw new Wt;s.setNumber(8,s.getHeight()-8,1)}static embedHorizontalSeparationPattern(s,n,r){for(let l=0;l<8;++l){if(!ut.isEmpty(r.get(s+l,n)))throw new Wt;r.setNumber(s+l,n,0)}}static embedVerticalSeparationPattern(s,n,r){for(let l=0;l<7;++l){if(!ut.isEmpty(r.get(s,n+l)))throw new Wt;r.setNumber(s,n+l,0)}}static embedPositionAdjustmentPattern(s,n,r){for(let l=0;l<5;++l){const o=ut.POSITION_ADJUSTMENT_PATTERN[l];for(let d=0;d<5;++d)r.setNumber(s+d,n+l,o[d])}}static embedPositionDetectionPattern(s,n,r){for(let l=0;l<7;++l){const o=ut.POSITION_DETECTION_PATTERN[l];for(let d=0;d<7;++d)r.setNumber(s+d,n+l,o[d])}}static embedPositionDetectionPatternsAndSeparators(s){const n=ut.POSITION_DETECTION_PATTERN[0].length;ut.embedPositionDetectionPattern(0,0,s),ut.embedPositionDetectionPattern(s.getWidth()-n,0,s),ut.embedPositionDetectionPattern(0,s.getWidth()-n,s);const r=8;ut.embedHorizontalSeparationPattern(0,r-1,s),ut.embedHorizontalSeparationPattern(s.getWidth()-r,r-1,s),ut.embedHorizontalSeparationPattern(0,s.getWidth()-r,s);const l=7;ut.embedVerticalSeparationPattern(l,0,s),ut.embedVerticalSeparationPattern(s.getHeight()-l-1,0,s),ut.embedVerticalSeparationPattern(l,s.getHeight()-l,s)}static maybeEmbedPositionAdjustmentPatterns(s,n){if(s.getVersionNumber()<2)return;const r=s.getVersionNumber()-1,l=ut.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[r];for(let o=0,d=l.length;o!==d;o++){const u=l[o];if(u>=0)for(let m=0;m!==d;m++){const b=l[m];b>=0&&ut.isEmpty(n.get(b,u))&&ut.embedPositionAdjustmentPattern(b-2,u-2,n)}}}}ut.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),ut.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),ut.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),ut.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),ut.VERSION_INFO_POLY=7973,ut.TYPE_INFO_POLY=1335,ut.TYPE_INFO_MASK_PATTERN=21522;class Hc{constructor(s,n){this.dataBytes=s,this.errorCorrectionBytes=n}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class os{constructor(){}static calculateMaskPenalty(s){return ps.applyMaskPenaltyRule1(s)+ps.applyMaskPenaltyRule2(s)+ps.applyMaskPenaltyRule3(s)+ps.applyMaskPenaltyRule4(s)}static encode(s,n,r=null){let l=os.DEFAULT_BYTE_MODE_ENCODING;const o=r!==null&&r.get(Ts.CHARACTER_SET)!==void 0;o&&(l=r.get(Ts.CHARACTER_SET).toString());const d=this.chooseMode(s,l),u=new q;if(d===nt.BYTE&&(o||os.DEFAULT_BYTE_MODE_ENCODING!==l)){const Le=oe.getCharacterSetECIByName(l);Le!==void 0&&this.appendECI(Le,u)}this.appendModeInfo(d,u);const m=new q;this.appendBytes(s,d,m,l);let b;if(r!==null&&r.get(Ts.QR_VERSION)!==void 0){const Le=Number.parseInt(r.get(Ts.QR_VERSION).toString(),10);b=et.getVersionForNumber(Le);const ke=this.calculateBitsNeeded(d,u,m,b);if(!this.willFit(ke,b,n))throw new Wt("Data too big for requested version")}else b=this.recommendVersion(n,d,u,m);const S=new q;S.appendBitArray(u);const M=d===nt.BYTE?m.getSizeInBytes():s.length;this.appendLengthInfo(M,b,d,S),S.appendBitArray(m);const k=b.getECBlocksForLevel(n),X=b.getTotalCodewords()-k.getTotalECCodewords();this.terminateBits(X,S);const re=this.interleaveWithECBytes(S,b.getTotalCodewords(),X,k.getNumBlocks()),ie=new bn;ie.setECLevel(n),ie.setMode(d),ie.setVersion(b);const he=b.getDimensionForVersion(),je=new gi(he,he),Pe=this.chooseMaskPattern(re,n,b,je);return ie.setMaskPattern(Pe),ut.buildMatrix(re,n,b,Pe,je),ie.setMatrix(je),ie}static recommendVersion(s,n,r,l){const o=this.calculateBitsNeeded(n,r,l,et.getVersionForNumber(1)),d=this.chooseVersion(o,s),u=this.calculateBitsNeeded(n,r,l,d);return this.chooseVersion(u,s)}static calculateBitsNeeded(s,n,r,l){return n.getSize()+s.getCharacterCountBits(l)+r.getSize()}static getAlphanumericCode(s){return s<os.ALPHANUMERIC_TABLE.length?os.ALPHANUMERIC_TABLE[s]:-1}static chooseMode(s,n=null){if(oe.SJIS.getName()===n&&this.isOnlyDoubleByteKanji(s))return nt.KANJI;let r=!1,l=!1;for(let o=0,d=s.length;o<d;++o){const u=s.charAt(o);if(os.isDigit(u))r=!0;else if(this.getAlphanumericCode(u.charCodeAt(0))!==-1)l=!0;else return nt.BYTE}return l?nt.ALPHANUMERIC:r?nt.NUMERIC:nt.BYTE}static isOnlyDoubleByteKanji(s){let n;try{n=me.encode(s,oe.SJIS)}catch{return!1}const r=n.length;if(r%2!==0)return!1;for(let l=0;l<r;l+=2){const o=n[l]&255;if((o<129||o>159)&&(o<224||o>235))return!1}return!0}static chooseMaskPattern(s,n,r,l){let o=Number.MAX_SAFE_INTEGER,d=-1;for(let u=0;u<bn.NUM_MASK_PATTERNS;u++){ut.buildMatrix(s,n,r,u,l);let m=this.calculateMaskPenalty(l);m<o&&(o=m,d=u)}return d}static chooseVersion(s,n){for(let r=1;r<=40;r++){const l=et.getVersionForNumber(r);if(os.willFit(s,l,n))return l}throw new Wt("Data too big")}static willFit(s,n,r){const l=n.getTotalCodewords(),d=n.getECBlocksForLevel(r).getTotalECCodewords(),u=l-d,m=(s+7)/8;return u>=m}static terminateBits(s,n){const r=s*8;if(n.getSize()>r)throw new Wt("data bits cannot fit in the QR Code"+n.getSize()+" > "+r);for(let d=0;d<4&&n.getSize()<r;++d)n.appendBit(!1);const l=n.getSize()&7;if(l>0)for(let d=l;d<8;d++)n.appendBit(!1);const o=s-n.getSizeInBytes();for(let d=0;d<o;++d)n.appendBits((d&1)===0?236:17,8);if(n.getSize()!==r)throw new Wt("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(s,n,r,l,o,d){if(l>=r)throw new Wt("Block ID too large");const u=s%r,m=r-u,b=Math.floor(s/r),S=b+1,M=Math.floor(n/r),k=M+1,X=b-M,re=S-k;if(X!==re)throw new Wt("EC bytes mismatch");if(r!==m+u)throw new Wt("RS blocks mismatch");if(s!==(M+X)*m+(k+re)*u)throw new Wt("Total bytes mismatch");l<m?(o[0]=M,d[0]=X):(o[0]=k,d[0]=re)}static interleaveWithECBytes(s,n,r,l){if(s.getSizeInBytes()!==r)throw new Wt("Number of bits and data bytes does not match");let o=0,d=0,u=0;const m=new Array;for(let S=0;S<l;++S){const M=new Int32Array(1),k=new Int32Array(1);os.getNumDataBytesAndNumECBytesForBlockID(n,r,l,S,M,k);const X=M[0],re=new Uint8Array(X);s.toBytes(8*o,re,0,X);const ie=os.generateECBytes(re,k[0]);m.push(new Hc(re,ie)),d=Math.max(d,X),u=Math.max(u,ie.length),o+=M[0]}if(r!==o)throw new Wt("Data bytes does not match offset");const b=new q;for(let S=0;S<d;++S)for(const M of m){const k=M.getDataBytes();S<k.length&&b.appendBits(k[S],8)}for(let S=0;S<u;++S)for(const M of m){const k=M.getErrorCorrectionBytes();S<k.length&&b.appendBits(k[S],8)}if(n!==b.getSizeInBytes())throw new Wt("Interleaving error: "+n+" and "+b.getSizeInBytes()+" differ.");return b}static generateECBytes(s,n){const r=s.length,l=new Int32Array(r+n);for(let d=0;d<r;d++)l[d]=s[d]&255;new Fr(Ke.QR_CODE_FIELD_256).encode(l,n);const o=new Uint8Array(n);for(let d=0;d<n;d++)o[d]=l[r+d];return o}static appendModeInfo(s,n){n.appendBits(s.getBits(),4)}static appendLengthInfo(s,n,r,l){const o=r.getCharacterCountBits(n);if(s>=1<<o)throw new Wt(s+" is bigger than "+((1<<o)-1));l.appendBits(s,o)}static appendBytes(s,n,r,l){switch(n){case nt.NUMERIC:os.appendNumericBytes(s,r);break;case nt.ALPHANUMERIC:os.appendAlphanumericBytes(s,r);break;case nt.BYTE:os.append8BitBytes(s,r,l);break;case nt.KANJI:os.appendKanjiBytes(s,r);break;default:throw new Wt("Invalid mode: "+n)}}static getDigit(s){return s.charCodeAt(0)-48}static isDigit(s){const n=os.getDigit(s);return n>=0&&n<=9}static appendNumericBytes(s,n){const r=s.length;let l=0;for(;l<r;){const o=os.getDigit(s.charAt(l));if(l+2<r){const d=os.getDigit(s.charAt(l+1)),u=os.getDigit(s.charAt(l+2));n.appendBits(o*100+d*10+u,10),l+=3}else if(l+1<r){const d=os.getDigit(s.charAt(l+1));n.appendBits(o*10+d,7),l+=2}else n.appendBits(o,4),l++}}static appendAlphanumericBytes(s,n){const r=s.length;let l=0;for(;l<r;){const o=os.getAlphanumericCode(s.charCodeAt(l));if(o===-1)throw new Wt;if(l+1<r){const d=os.getAlphanumericCode(s.charCodeAt(l+1));if(d===-1)throw new Wt;n.appendBits(o*45+d,11),l+=2}else n.appendBits(o,6),l++}}static append8BitBytes(s,n,r){let l;try{l=me.encode(s,r)}catch(o){throw new Wt(o)}for(let o=0,d=l.length;o!==d;o++){const u=l[o];n.appendBits(u,8)}}static appendKanjiBytes(s,n){let r;try{r=me.encode(s,oe.SJIS)}catch(o){throw new Wt(o)}const l=r.length;for(let o=0;o<l;o+=2){const d=r[o]&255,u=r[o+1]&255,m=d<<8&4294967295|u;let b=-1;if(m>=33088&&m<=40956?b=m-33088:m>=57408&&m<=60351&&(b=m-49472),b===-1)throw new Wt("Invalid byte sequence");const S=(b>>8)*192+(b&255);n.appendBits(S,13)}}static appendECI(s,n){n.appendBits(nt.ECI.getBits(),4),n.appendBits(s.getValue(),8)}}os.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),os.DEFAULT_BYTE_MODE_ENCODING=oe.UTF8.getName();class wn{write(s,n,r,l=null){if(s.length===0)throw new O("Found empty contents");if(n<0||r<0)throw new O("Requested dimensions are too small: "+n+"x"+r);let o=Ot.L,d=wn.QUIET_ZONE_SIZE;l!==null&&(l.get(Ts.ERROR_CORRECTION)!==void 0&&(o=Ot.fromString(l.get(Ts.ERROR_CORRECTION).toString())),l.get(Ts.MARGIN)!==void 0&&(d=Number.parseInt(l.get(Ts.MARGIN).toString(),10)));const u=os.encode(s,o,l);return this.renderResult(u,n,r,d)}writeToDom(s,n,r,l,o=null){typeof s=="string"&&(s=document.querySelector(s));const d=this.write(n,r,l,o);s&&s.appendChild(d)}renderResult(s,n,r,l){const o=s.getMatrix();if(o===null)throw new Oe;const d=o.getWidth(),u=o.getHeight(),m=d+l*2,b=u+l*2,S=Math.max(n,m),M=Math.max(r,b),k=Math.min(Math.floor(S/m),Math.floor(M/b)),X=Math.floor((S-d*k)/2),re=Math.floor((M-u*k)/2),ie=this.createSVGElement(S,M);for(let he=0,je=re;he<u;he++,je+=k)for(let Pe=0,Le=X;Pe<d;Pe++,Le+=k)if(o.get(Pe,he)===1){const ke=this.createSvgRectElement(Le,je,k,k);ie.appendChild(ke)}return ie}createSVGElement(s,n){const r=document.createElementNS(wn.SVG_NS,"svg");return r.setAttributeNS(null,"height",s.toString()),r.setAttributeNS(null,"width",n.toString()),r}createSvgRectElement(s,n,r,l){const o=document.createElementNS(wn.SVG_NS,"rect");return o.setAttributeNS(null,"x",s.toString()),o.setAttributeNS(null,"y",n.toString()),o.setAttributeNS(null,"height",r.toString()),o.setAttributeNS(null,"width",l.toString()),o.setAttributeNS(null,"fill","#000000"),o}}wn.QUIET_ZONE_SIZE=4,wn.SVG_NS="http://www.w3.org/2000/svg";class ar{encode(s,n,r,l,o){if(s.length===0)throw new O("Found empty contents");if(n!==xe.QR_CODE)throw new O("Can only encode QR_CODE, but got "+n);if(r<0||l<0)throw new O(`Requested dimensions are too small: ${r}x${l}`);let d=Ot.L,u=ar.QUIET_ZONE_SIZE;o!==null&&(o.get(Ts.ERROR_CORRECTION)!==void 0&&(d=Ot.fromString(o.get(Ts.ERROR_CORRECTION).toString())),o.get(Ts.MARGIN)!==void 0&&(u=Number.parseInt(o.get(Ts.MARGIN).toString(),10)));const m=os.encode(s,d,o);return ar.renderResult(m,r,l,u)}static renderResult(s,n,r,l){const o=s.getMatrix();if(o===null)throw new Oe;const d=o.getWidth(),u=o.getHeight(),m=d+l*2,b=u+l*2,S=Math.max(n,m),M=Math.max(r,b),k=Math.min(Math.floor(S/m),Math.floor(M/b)),X=Math.floor((S-d*k)/2),re=Math.floor((M-u*k)/2),ie=new ae(S,M);for(let he=0,je=re;he<u;he++,je+=k)for(let Pe=0,Le=X;Pe<d;Pe++,Le+=k)o.get(Pe,he)===1&&ie.setRegion(Le,je,k,k);return ie}}ar.QUIET_ZONE_SIZE=4;class Vc{encode(s,n,r,l,o){let d;switch(n){case xe.QR_CODE:d=new ar;break;default:throw new O("No encoder available for format "+n)}return d.encode(s,n,r,l,o)}}class Ma extends Ne{constructor(s,n,r,l,o,d,u,m){if(super(d,u),this.yuvData=s,this.dataWidth=n,this.dataHeight=r,this.left=l,this.top=o,l+d>n||o+u>r)throw new O("Crop rectangle does not fit within image data.");m&&this.reverseHorizontal(d,u)}getRow(s,n){if(s<0||s>=this.getHeight())throw new O("Requested row is outside the image: "+s);const r=this.getWidth();(n==null||n.length<r)&&(n=new Uint8ClampedArray(r));const l=(s+this.top)*this.dataWidth+this.left;return V.arraycopy(this.yuvData,l,n,0,r),n}getMatrix(){const s=this.getWidth(),n=this.getHeight();if(s===this.dataWidth&&n===this.dataHeight)return this.yuvData;const r=s*n,l=new Uint8ClampedArray(r);let o=this.top*this.dataWidth+this.left;if(s===this.dataWidth)return V.arraycopy(this.yuvData,o,l,0,r),l;for(let d=0;d<n;d++){const u=d*s;V.arraycopy(this.yuvData,o,l,u,s),o+=this.dataWidth}return l}isCropSupported(){return!0}crop(s,n,r,l){return new Ma(this.yuvData,this.dataWidth,this.dataHeight,this.left+s,this.top+n,r,l,!1)}renderThumbnail(){const s=this.getWidth()/Ma.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/Ma.THUMBNAIL_SCALE_FACTOR,r=new Int32Array(s*n),l=this.yuvData;let o=this.top*this.dataWidth+this.left;for(let d=0;d<n;d++){const u=d*s;for(let m=0;m<s;m++){const b=l[o+m*Ma.THUMBNAIL_SCALE_FACTOR]&255;r[u+m]=4278190080|b*65793}o+=this.dataWidth*Ma.THUMBNAIL_SCALE_FACTOR}return r}getThumbnailWidth(){return this.getWidth()/Ma.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Ma.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(s,n){const r=this.yuvData;for(let l=0,o=this.top*this.dataWidth+this.left;l<n;l++,o+=this.dataWidth){const d=o+s/2;for(let u=o,m=o+s-1;u<d;u++,m--){const b=r[u];r[u]=r[m],r[m]=b}}}invert(){return new Se(this)}}Ma.THUMBNAIL_SCALE_FACTOR=2;class hl extends Ne{constructor(s,n,r,l,o,d,u){if(super(n,r),this.dataWidth=l,this.dataHeight=o,this.left=d,this.top=u,s.BYTES_PER_ELEMENT===4){const m=n*r,b=new Uint8ClampedArray(m);for(let S=0;S<m;S++){const M=s[S],k=M>>16&255,X=M>>7&510,re=M&255;b[S]=(k+X+re)/4&255}this.luminances=b}else this.luminances=s;if(l===void 0&&(this.dataWidth=n),o===void 0&&(this.dataHeight=r),d===void 0&&(this.left=0),u===void 0&&(this.top=0),this.left+n>this.dataWidth||this.top+r>this.dataHeight)throw new O("Crop rectangle does not fit within image data.")}getRow(s,n){if(s<0||s>=this.getHeight())throw new O("Requested row is outside the image: "+s);const r=this.getWidth();(n==null||n.length<r)&&(n=new Uint8ClampedArray(r));const l=(s+this.top)*this.dataWidth+this.left;return V.arraycopy(this.luminances,l,n,0,r),n}getMatrix(){const s=this.getWidth(),n=this.getHeight();if(s===this.dataWidth&&n===this.dataHeight)return this.luminances;const r=s*n,l=new Uint8ClampedArray(r);let o=this.top*this.dataWidth+this.left;if(s===this.dataWidth)return V.arraycopy(this.luminances,o,l,0,r),l;for(let d=0;d<n;d++){const u=d*s;V.arraycopy(this.luminances,o,l,u,s),o+=this.dataWidth}return l}isCropSupported(){return!0}crop(s,n,r,l){return new hl(this.luminances,r,l,this.dataWidth,this.dataHeight,this.left+s,this.top+n)}invert(){return new Se(this)}}class fo extends oe{static forName(s){return this.getCharacterSetECIByName(s)}}class Ur{}Ur.ISO_8859_1=oe.ISO8859_1;class nr{isCompact(){return this.compact}setCompact(s){this.compact=s}getSize(){return this.size}setSize(s){this.size=s}getLayers(){return this.layers}setLayers(s){this.layers=s}getCodeWords(){return this.codeWords}setCodeWords(s){this.codeWords=s}getMatrix(){return this.matrix}setMatrix(s){this.matrix=s}}class xo{static singletonList(s){return[s]}static min(s,n){return s.sort(n)[0]}}class mo{constructor(s){this.previous=s}getPrevious(){return this.previous}}class Nn extends mo{constructor(s,n,r){super(s),this.value=n,this.bitCount=r}appendTo(s,n){s.appendBits(this.value,this.bitCount)}add(s,n){return new Nn(this,s,n)}addBinaryShift(s,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Nn(this,s,n)}toString(){let s=this.value&(1<<this.bitCount)-1;return s|=1<<this.bitCount,"<"+H.toBinaryString(s|1<<this.bitCount).substring(1)+">"}}class pi extends Nn{constructor(s,n,r){super(s,0,0),this.binaryShiftStart=n,this.binaryShiftByteCount=r}appendTo(s,n){for(let r=0;r<this.binaryShiftByteCount;r++)(r===0||r===31&&this.binaryShiftByteCount<=62)&&(s.appendBits(31,5),this.binaryShiftByteCount>62?s.appendBits(this.binaryShiftByteCount-31,16):r===0?s.appendBits(Math.min(this.binaryShiftByteCount,31),5):s.appendBits(this.binaryShiftByteCount-31,5)),s.appendBits(n[this.binaryShiftStart+r],8)}addBinaryShift(s,n){return new pi(this,s,n)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function go(I,s,n){return new pi(I,s,n)}function rr(I,s,n){return new Nn(I,s,n)}const ir=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],on=0,yi=1,da=2,fl=3,Na=4,zr=new Nn(null,0,0),vn=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Gc(I){for(let s of I)K.fill(s,-1);return I[on][Na]=0,I[yi][Na]=0,I[yi][on]=28,I[fl][Na]=0,I[da][Na]=0,I[da][on]=15,I}const Hr=Gc(K.createInt32Array(6,6));class va{constructor(s,n,r,l){this.token=s,this.mode=n,this.binaryShiftByteCount=r,this.bitCount=l}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(s,n){let r=this.bitCount,l=this.token;if(s!==this.mode){let d=vn[this.mode][s];l=rr(l,d&65535,d>>16),r+=d>>16}let o=s===da?4:5;return l=rr(l,n,o),new va(l,s,0,r+o)}shiftAndAppend(s,n){let r=this.token,l=this.mode===da?4:5;return r=rr(r,Hr[this.mode][s],l),r=rr(r,n,5),new va(r,this.mode,0,this.bitCount+l+5)}addBinaryShiftChar(s){let n=this.token,r=this.mode,l=this.bitCount;if(this.mode===Na||this.mode===da){let u=vn[r][on];n=rr(n,u&65535,u>>16),l+=u>>16,r=on}let o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,d=new va(n,r,this.binaryShiftByteCount+1,l+o);return d.binaryShiftByteCount===2078&&(d=d.endBinaryShift(s+1)),d}endBinaryShift(s){if(this.binaryShiftByteCount===0)return this;let n=this.token;return n=go(n,s-this.binaryShiftByteCount,this.binaryShiftByteCount),new va(n,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(s){let n=this.bitCount+(vn[this.mode][s.mode]>>16);return this.binaryShiftByteCount<s.binaryShiftByteCount?n+=va.calculateBinaryShiftCost(s)-va.calculateBinaryShiftCost(this):this.binaryShiftByteCount>s.binaryShiftByteCount&&s.binaryShiftByteCount>0&&(n+=10),n<=s.bitCount}toBitArray(s){let n=[];for(let l=this.endBinaryShift(s.length).token;l!==null;l=l.getPrevious())n.unshift(l);let r=new q;for(const l of n)l.appendTo(r,s);return r}toString(){return ne.format("%s bits=%d bytes=%d",ir[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(s){return s.binaryShiftByteCount>62?21:s.binaryShiftByteCount>31?20:s.binaryShiftByteCount>0?10:0}}va.INITIAL_STATE=new va(zr,on,0,0);function po(I){const s=ne.getCharCode(" "),n=ne.getCharCode("."),r=ne.getCharCode(",");I[on][s]=1;const l=ne.getCharCode("Z"),o=ne.getCharCode("A");for(let k=o;k<=l;k++)I[on][k]=k-o+2;I[yi][s]=1;const d=ne.getCharCode("z"),u=ne.getCharCode("a");for(let k=u;k<=d;k++)I[yi][k]=k-u+2;I[da][s]=1;const m=ne.getCharCode("9"),b=ne.getCharCode("0");for(let k=b;k<=m;k++)I[da][k]=k-b+2;I[da][r]=12,I[da][n]=13;const S=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let k=0;k<S.length;k++)I[fl][ne.getCharCode(S[k])]=k;const M=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let k=0;k<M.length;k++)ne.getCharCode(M[k])>0&&(I[Na][ne.getCharCode(M[k])]=k);return I}const Vr=po(K.createInt32Array(5,256));class jn{constructor(s){this.text=s}encode(){const s=ne.getCharCode(" "),n=ne.getCharCode(`
`);let r=xo.singletonList(va.INITIAL_STATE);for(let o=0;o<this.text.length;o++){let d,u=o+1<this.text.length?this.text[o+1]:0;switch(this.text[o]){case ne.getCharCode("\r"):d=u===n?2:0;break;case ne.getCharCode("."):d=u===s?3:0;break;case ne.getCharCode(","):d=u===s?4:0;break;case ne.getCharCode(":"):d=u===s?5:0;break;default:d=0}d>0?(r=jn.updateStateListForPair(r,o,d),o++):r=this.updateStateListForChar(r,o)}return xo.min(r,(o,d)=>o.getBitCount()-d.getBitCount()).toBitArray(this.text)}updateStateListForChar(s,n){const r=[];for(let l of s)this.updateStateForChar(l,n,r);return jn.simplifyStates(r)}updateStateForChar(s,n,r){let l=this.text[n]&255,o=Vr[s.getMode()][l]>0,d=null;for(let u=0;u<=Na;u++){let m=Vr[u][l];if(m>0){if(d==null&&(d=s.endBinaryShift(n)),!o||u===s.getMode()||u===da){const b=d.latchAndAppend(u,m);r.push(b)}if(!o&&Hr[s.getMode()][u]>=0){const b=d.shiftAndAppend(u,m);r.push(b)}}}if(s.getBinaryShiftByteCount()>0||Vr[s.getMode()][l]===0){let u=s.addBinaryShiftChar(n);r.push(u)}}static updateStateListForPair(s,n,r){const l=[];for(let o of s)this.updateStateForPair(o,n,r,l);return this.simplifyStates(l)}static updateStateForPair(s,n,r,l){let o=s.endBinaryShift(n);if(l.push(o.latchAndAppend(Na,r)),s.getMode()!==Na&&l.push(o.shiftAndAppend(Na,r)),r===3||r===4){let d=o.latchAndAppend(da,16-r).latchAndAppend(da,1);l.push(d)}if(s.getBinaryShiftByteCount()>0){let d=s.addBinaryShiftChar(n).addBinaryShiftChar(n+1);l.push(d)}}static simplifyStates(s){let n=[];for(const r of s){let l=!0;for(const o of n){if(o.isBetterThanOrEqualTo(r)){l=!1;break}r.isBetterThanOrEqualTo(o)&&(n=n.filter(d=>d!==o))}l&&n.push(r)}return n}}class kt{constructor(){}static encodeBytes(s){return kt.encode(s,kt.DEFAULT_EC_PERCENT,kt.DEFAULT_AZTEC_LAYERS)}static encode(s,n,r){let l=new jn(s).encode(),o=H.truncDivision(l.getSize()*n,100)+11,d=l.getSize()+o,u,m,b,S,M;if(r!==kt.DEFAULT_AZTEC_LAYERS){if(u=r<0,m=Math.abs(r),m>(u?kt.MAX_NB_BITS_COMPACT:kt.MAX_NB_BITS))throw new O(ne.format("Illegal value %s for layers",r));b=kt.totalBitsInLayer(m,u),S=kt.WORD_SIZE[m];let ke=b-b%S;if(M=kt.stuffBits(l,S),M.getSize()+o>ke)throw new O("Data to large for user specified layer");if(u&&M.getSize()>S*64)throw new O("Data to large for user specified layer")}else{S=0,M=null;for(let ke=0;;ke++){if(ke>kt.MAX_NB_BITS)throw new O("Data too large for an Aztec code");if(u=ke<=3,m=u?ke+1:ke,b=kt.totalBitsInLayer(m,u),d>b)continue;(M==null||S!==kt.WORD_SIZE[m])&&(S=kt.WORD_SIZE[m],M=kt.stuffBits(l,S));let Rt=b-b%S;if(!(u&&M.getSize()>S*64)&&M.getSize()+o<=Rt)break}}let k=kt.generateCheckWords(M,b,S),X=M.getSize()/S,re=kt.generateModeMessage(u,m,X),ie=(u?11:14)+m*4,he=new Int32Array(ie),je;if(u){je=ie;for(let ke=0;ke<he.length;ke++)he[ke]=ke}else{je=ie+1+2*H.truncDivision(H.truncDivision(ie,2)-1,15);let ke=H.truncDivision(ie,2),Rt=H.truncDivision(je,2);for(let wt=0;wt<ke;wt++){let Ns=wt+H.truncDivision(wt,15);he[ke-wt-1]=Rt-Ns-1,he[ke+wt]=Rt+Ns+1}}let Pe=new ae(je);for(let ke=0,Rt=0;ke<m;ke++){let wt=(m-ke)*4+(u?9:12);for(let Ns=0;Ns<wt;Ns++){let ua=Ns*2;for(let Zs=0;Zs<2;Zs++)k.get(Rt+ua+Zs)&&Pe.set(he[ke*2+Zs],he[ke*2+Ns]),k.get(Rt+wt*2+ua+Zs)&&Pe.set(he[ke*2+Ns],he[ie-1-ke*2-Zs]),k.get(Rt+wt*4+ua+Zs)&&Pe.set(he[ie-1-ke*2-Zs],he[ie-1-ke*2-Ns]),k.get(Rt+wt*6+ua+Zs)&&Pe.set(he[ie-1-ke*2-Ns],he[ke*2+Zs])}Rt+=wt*8}if(kt.drawModeMessage(Pe,u,je,re),u)kt.drawBullsEye(Pe,H.truncDivision(je,2),5);else{kt.drawBullsEye(Pe,H.truncDivision(je,2),7);for(let ke=0,Rt=0;ke<H.truncDivision(ie,2)-1;ke+=15,Rt+=16)for(let wt=H.truncDivision(je,2)&1;wt<je;wt+=2)Pe.set(H.truncDivision(je,2)-Rt,wt),Pe.set(H.truncDivision(je,2)+Rt,wt),Pe.set(wt,H.truncDivision(je,2)-Rt),Pe.set(wt,H.truncDivision(je,2)+Rt)}let Le=new nr;return Le.setCompact(u),Le.setSize(je),Le.setLayers(m),Le.setCodeWords(X),Le.setMatrix(Pe),Le}static drawBullsEye(s,n,r){for(let l=0;l<r;l+=2)for(let o=n-l;o<=n+l;o++)s.set(o,n-l),s.set(o,n+l),s.set(n-l,o),s.set(n+l,o);s.set(n-r,n-r),s.set(n-r+1,n-r),s.set(n-r,n-r+1),s.set(n+r,n-r),s.set(n+r,n-r+1),s.set(n+r,n+r-1)}static generateModeMessage(s,n,r){let l=new q;return s?(l.appendBits(n-1,2),l.appendBits(r-1,6),l=kt.generateCheckWords(l,28,4)):(l.appendBits(n-1,5),l.appendBits(r-1,11),l=kt.generateCheckWords(l,40,4)),l}static drawModeMessage(s,n,r,l){let o=H.truncDivision(r,2);if(n)for(let d=0;d<7;d++){let u=o-3+d;l.get(d)&&s.set(u,o-5),l.get(d+7)&&s.set(o+5,u),l.get(20-d)&&s.set(u,o+5),l.get(27-d)&&s.set(o-5,u)}else for(let d=0;d<10;d++){let u=o-5+d+H.truncDivision(d,5);l.get(d)&&s.set(u,o-7),l.get(d+10)&&s.set(o+7,u),l.get(29-d)&&s.set(u,o+7),l.get(39-d)&&s.set(o-7,u)}}static generateCheckWords(s,n,r){let l=s.getSize()/r,o=new Fr(kt.getGF(r)),d=H.truncDivision(n,r),u=kt.bitsToWords(s,r,d);o.encode(u,d-l);let m=n%r,b=new q;b.appendBits(0,m);for(const S of Array.from(u))b.appendBits(S,r);return b}static bitsToWords(s,n,r){let l=new Int32Array(r),o,d;for(o=0,d=s.getSize()/n;o<d;o++){let u=0;for(let m=0;m<n;m++)u|=s.get(o*n+m)?1<<n-m-1:0;l[o]=u}return l}static getGF(s){switch(s){case 4:return Ke.AZTEC_PARAM;case 6:return Ke.AZTEC_DATA_6;case 8:return Ke.AZTEC_DATA_8;case 10:return Ke.AZTEC_DATA_10;case 12:return Ke.AZTEC_DATA_12;default:throw new O("Unsupported word size "+s)}}static stuffBits(s,n){let r=new q,l=s.getSize(),o=(1<<n)-2;for(let d=0;d<l;d+=n){let u=0;for(let m=0;m<n;m++)(d+m>=l||s.get(d+m))&&(u|=1<<n-1-m);(u&o)===o?(r.appendBits(u&o,n),d--):(u&o)===0?(r.appendBits(u|1,n),d--):r.appendBits(u,n)}return r}static totalBitsInLayer(s,n){return((n?88:112)+16*s)*s}}kt.DEFAULT_EC_PERCENT=33,kt.DEFAULT_AZTEC_LAYERS=0,kt.MAX_NB_BITS=32,kt.MAX_NB_BITS_COMPACT=4,kt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Gr{encode(s,n,r,l){return this.encodeWithHints(s,n,r,l,null)}encodeWithHints(s,n,r,l,o){let d=Ur.ISO_8859_1,u=kt.DEFAULT_EC_PERCENT,m=kt.DEFAULT_AZTEC_LAYERS;return o!=null&&(o.has(Ts.CHARACTER_SET)&&(d=fo.forName(o.get(Ts.CHARACTER_SET).toString())),o.has(Ts.ERROR_CORRECTION)&&(u=H.parseInt(o.get(Ts.ERROR_CORRECTION).toString())),o.has(Ts.AZTEC_LAYERS)&&(m=H.parseInt(o.get(Ts.AZTEC_LAYERS).toString()))),Gr.encodeLayers(s,n,r,l,d,u,m)}static encodeLayers(s,n,r,l,o,d,u){if(n!==xe.AZTEC)throw new O("Can only encode AZTEC, but got "+n);let m=kt.encode(ne.getBytes(s,o),d,u);return Gr.renderResult(m,r,l)}static renderResult(s,n,r){let l=s.getMatrix();if(l==null)throw new Oe;let o=l.getWidth(),d=l.getHeight(),u=Math.max(n,o),m=Math.max(r,d),b=Math.min(u/o,m/d),S=(u-o*b)/2,M=(m-d*b)/2,k=new ae(u,m);for(let X=0,re=M;X<d;X++,re+=b)for(let ie=0,he=S;ie<o;ie++,he+=b)l.get(ie,X)&&k.setRegion(he,re,b,b);return k}}f.AbstractExpandedDecoder=Es,f.ArgumentException=C,f.ArithmeticException=lt,f.AztecCode=nr,f.AztecCodeReader=ue,f.AztecCodeWriter=Gr,f.AztecDecoder=Ze,f.AztecDetector=ds,f.AztecDetectorResult=Fe,f.AztecEncoder=kt,f.AztecHighLevelEncoder=jn,f.AztecPoint=ct,f.BarcodeFormat=xe,f.Binarizer=P,f.BinaryBitmap=_,f.BitArray=q,f.BitMatrix=ae,f.BitSource=ba,f.BrowserAztecCodeReader=ze,f.BrowserBarcodeReader=Lc,f.BrowserCodeReader=U,f.BrowserDatamatrixCodeReader=di,f.BrowserMultiFormatReader=ho,f.BrowserPDF417Reader=Uc,f.BrowserQRCodeReader=zc,f.BrowserQRCodeSvgWriter=wn,f.CharacterSetECI=oe,f.ChecksumException=L,f.Code128Reader=Te,f.Code39Reader=ot,f.DataMatrixDecodedBitStreamParser=Ya,f.DataMatrixReader=qa,f.DecodeHintType=ce,f.DecoderResult=Je,f.DefaultGridSampler=_s,f.DetectorResult=ye,f.EAN13Reader=Oa,f.EncodeHintType=Ts,f.Exception=w,f.FormatException=$,f.GenericGF=Ke,f.GenericGFPoly=Be,f.GlobalHistogramBinarizer=W,f.GridSampler=rt,f.GridSamplerInstance=pt,f.HTMLCanvasElementLuminanceSource=fe,f.HybridBinarizer=Q,f.ITFReader=Ye,f.IllegalArgumentException=O,f.IllegalStateException=Oe,f.InvertedLuminanceSource=Se,f.LuminanceSource=Ne,f.MathUtils=Xe,f.MultiFormatOneDReader=ya,f.MultiFormatReader=uo,f.MultiFormatWriter=Vc,f.NotFoundException=F,f.OneDReader=Ue,f.PDF417DecodedBitStreamParser=Ce,f.PDF417DecoderErrorCorrection=Za,f.PDF417Reader=Hs,f.PDF417ResultMetadata=sr,f.PerspectiveTransform=st,f.PlanarYUVLuminanceSource=Ma,f.QRCodeByteMatrix=gi,f.QRCodeDataMask=na,f.QRCodeDecodedBitStreamParser=is,f.QRCodeDecoderErrorCorrectionLevel=Ot,f.QRCodeDecoderFormatInformation=Is,f.QRCodeEncoder=os,f.QRCodeEncoderQRCode=bn,f.QRCodeMaskUtil=ps,f.QRCodeMatrixUtil=ut,f.QRCodeMode=nt,f.QRCodeReader=Ka,f.QRCodeVersion=et,f.QRCodeWriter=ar,f.RGBLuminanceSource=hl,f.RSS14Reader=Zt,f.RSSExpandedReader=Me,f.ReaderException=mi,f.ReedSolomonDecoder=mt,f.ReedSolomonEncoder=Fr,f.ReedSolomonException=ft,f.Result=Z,f.ResultMetadataType=Ve,f.ResultPoint=He,f.StringUtils=ne,f.UnsupportedOperationException=Ee,f.VideoInputDevice=E,f.WhiteRectangleDetector=We,f.WriterException=Wt,f.ZXingArrays=K,f.ZXingCharset=fo,f.ZXingInteger=H,f.ZXingStandardCharsets=Ur,f.ZXingStringBuilder=J,f.ZXingStringEncoding=me,f.ZXingSystem=V,f.createAbstractExpandedDecoder=Zn,Object.defineProperty(f,"__esModule",{value:!0})}))})(Jl,Jl.exports)),Jl.exports}var ms=Ty();const Ry=Mc(ms),Oy=Dx({__proto__:null,default:Ry},[ms]);var $1=(function(){function h(p,f,y){if(this.formatMap=new Map([[Qe.QR_CODE,ms.BarcodeFormat.QR_CODE],[Qe.AZTEC,ms.BarcodeFormat.AZTEC],[Qe.CODABAR,ms.BarcodeFormat.CODABAR],[Qe.CODE_39,ms.BarcodeFormat.CODE_39],[Qe.CODE_93,ms.BarcodeFormat.CODE_93],[Qe.CODE_128,ms.BarcodeFormat.CODE_128],[Qe.DATA_MATRIX,ms.BarcodeFormat.DATA_MATRIX],[Qe.MAXICODE,ms.BarcodeFormat.MAXICODE],[Qe.ITF,ms.BarcodeFormat.ITF],[Qe.EAN_13,ms.BarcodeFormat.EAN_13],[Qe.EAN_8,ms.BarcodeFormat.EAN_8],[Qe.PDF_417,ms.BarcodeFormat.PDF_417],[Qe.RSS_14,ms.BarcodeFormat.RSS_14],[Qe.RSS_EXPANDED,ms.BarcodeFormat.RSS_EXPANDED],[Qe.UPC_A,ms.BarcodeFormat.UPC_A],[Qe.UPC_E,ms.BarcodeFormat.UPC_E],[Qe.UPC_EAN_EXTENSION,ms.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!Oy)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=f,this.logger=y;var v=this.createZXingFormats(p),N=new Map;N.set(ms.DecodeHintType.POSSIBLE_FORMATS,v),N.set(ms.DecodeHintType.TRY_HARDER,!1),this.hints=N}return h.prototype.decodeAsync=function(p){var f=this;return new Promise(function(y,v){try{y(f.decode(p))}catch(N){v(N)}})},h.prototype.decode=function(p){var f=new ms.MultiFormatReader(this.verbose,this.hints),y=new ms.HTMLCanvasElementLuminanceSource(p),v=new ms.BinaryBitmap(new ms.HybridBinarizer(y)),N=f.decode(v);return{text:N.text,format:Zx.create(this.toHtml5QrcodeSupportedFormats(N.format)),debugData:this.createDebugData()}},h.prototype.createReverseFormatMap=function(){var p=new Map;return this.formatMap.forEach(function(f,y,v){p.set(f,y)}),p},h.prototype.toHtml5QrcodeSupportedFormats=function(p){if(!this.reverseFormatMap.has(p))throw"reverseFormatMap doesn't have ".concat(p);return this.reverseFormatMap.get(p)},h.prototype.createZXingFormats=function(p){for(var f=[],y=0,v=p;y<v.length;y++){var N=v[y];this.formatMap.has(N)?f.push(this.formatMap.get(N)):this.logger.logError("".concat(N," is not supported by")+"ZXingHtml5QrcodeShim")}return f},h.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},h})(),Dy=function(h,p,f,y){function v(N){return N instanceof f?N:new f(function(A){A(N)})}return new(f||(f=Promise))(function(N,A){function R(C){try{w(y.next(C))}catch(O){A(O)}}function j(C){try{w(y.throw(C))}catch(O){A(O)}}function w(C){C.done?N(C.value):v(C.value).then(R,j)}w((y=y.apply(h,p||[])).next())})},_y=function(h,p){var f={label:0,sent:function(){if(N[0]&1)throw N[1];return N[1]},trys:[],ops:[]},y,v,N,A;return A={next:R(0),throw:R(1),return:R(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function R(w){return function(C){return j([w,C])}}function j(w){if(y)throw new TypeError("Generator is already executing.");for(;A&&(A=0,w[0]&&(f=0)),f;)try{if(y=1,v&&(N=w[0]&2?v.return:w[0]?v.throw||((N=v.return)&&N.call(v),0):v.next)&&!(N=N.call(v,w[1])).done)return N;switch(v=0,N&&(w=[w[0]&2,N.value]),w[0]){case 0:case 1:N=w;break;case 4:return f.label++,{value:w[1],done:!1};case 5:f.label++,v=w[1],w=[0];continue;case 7:w=f.ops.pop(),f.trys.pop();continue;default:if(N=f.trys,!(N=N.length>0&&N[N.length-1])&&(w[0]===6||w[0]===2)){f=0;continue}if(w[0]===3&&(!N||w[1]>N[0]&&w[1]<N[3])){f.label=w[1];break}if(w[0]===6&&f.label<N[1]){f.label=N[1],N=w;break}if(N&&f.label<N[2]){f.label=N[2],f.ops.push(w);break}N[2]&&f.ops.pop(),f.trys.pop();continue}w=p.call(h,f)}catch(C){w=[6,C],v=0}finally{y=N=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},ex=(function(){function h(p,f,y){if(this.formatMap=new Map([[Qe.QR_CODE,"qr_code"],[Qe.AZTEC,"aztec"],[Qe.CODABAR,"codabar"],[Qe.CODE_39,"code_39"],[Qe.CODE_93,"code_93"],[Qe.CODE_128,"code_128"],[Qe.DATA_MATRIX,"data_matrix"],[Qe.ITF,"itf"],[Qe.EAN_13,"ean_13"],[Qe.EAN_8,"ean_8"],[Qe.PDF_417,"pdf417"],[Qe.UPC_A,"upc_a"],[Qe.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!h.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=f,this.logger=y;var v=this.createBarcodeDetectorFormats(p);if(this.detector=new BarcodeDetector(v),!this.detector)throw"BarcodeDetector detector not supported"}return h.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var p=new BarcodeDetector({formats:["qr_code"]});return typeof p<"u"},h.prototype.decodeAsync=function(p){return Dy(this,void 0,void 0,function(){var f,y;return _y(this,function(v){switch(v.label){case 0:return[4,this.detector.detect(p)];case 1:if(f=v.sent(),!f||f.length===0)throw"No barcode or QR code detected.";return y=this.selectLargestBarcode(f),[2,{text:y.rawValue,format:Zx.create(this.toHtml5QrcodeSupportedFormats(y.format)),debugData:this.createDebugData()}]}})})},h.prototype.selectLargestBarcode=function(p){for(var f=null,y=0,v=0,N=p;v<N.length;v++){var A=N[v],R=A.boundingBox.width*A.boundingBox.height;R>y&&(y=R,f=A)}if(!f)throw"No largest barcode found";return f},h.prototype.createBarcodeDetectorFormats=function(p){for(var f=[],y=0,v=p;y<v.length;y++){var N=v[y];this.formatMap.has(N)?f.push(this.formatMap.get(N)):this.logger.warn("".concat(N," is not supported by")+"BarcodeDetectorDelegate")}return{formats:f}},h.prototype.toHtml5QrcodeSupportedFormats=function(p){if(!this.reverseFormatMap.has(p))throw"reverseFormatMap doesn't have ".concat(p);return this.reverseFormatMap.get(p)},h.prototype.createReverseFormatMap=function(){var p=new Map;return this.formatMap.forEach(function(f,y,v){p.set(f,y)}),p},h.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},h})(),tx=function(h,p,f,y){function v(N){return N instanceof f?N:new f(function(A){A(N)})}return new(f||(f=Promise))(function(N,A){function R(C){try{w(y.next(C))}catch(O){A(O)}}function j(C){try{w(y.throw(C))}catch(O){A(O)}}function w(C){C.done?N(C.value):v(C.value).then(R,j)}w((y=y.apply(h,p||[])).next())})},sx=function(h,p){var f={label:0,sent:function(){if(N[0]&1)throw N[1];return N[1]},trys:[],ops:[]},y,v,N,A;return A={next:R(0),throw:R(1),return:R(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function R(w){return function(C){return j([w,C])}}function j(w){if(y)throw new TypeError("Generator is already executing.");for(;A&&(A=0,w[0]&&(f=0)),f;)try{if(y=1,v&&(N=w[0]&2?v.return:w[0]?v.throw||((N=v.return)&&N.call(v),0):v.next)&&!(N=N.call(v,w[1])).done)return N;switch(v=0,N&&(w=[w[0]&2,N.value]),w[0]){case 0:case 1:N=w;break;case 4:return f.label++,{value:w[1],done:!1};case 5:f.label++,v=w[1],w=[0];continue;case 7:w=f.ops.pop(),f.trys.pop();continue;default:if(N=f.trys,!(N=N.length>0&&N[N.length-1])&&(w[0]===6||w[0]===2)){f=0;continue}if(w[0]===3&&(!N||w[1]>N[0]&&w[1]<N[3])){f.label=w[1];break}if(w[0]===6&&f.label<N[1]){f.label=N[1],N=w;break}if(N&&f.label<N[2]){f.label=N[2],f.ops.push(w);break}N[2]&&f.ops.pop(),f.trys.pop();continue}w=p.call(h,f)}catch(C){w=[6,C],v=0}finally{y=N=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},Iy=(function(){function h(p,f,y,v){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=y,f&&ex.isSupported()?(this.primaryDecoder=new ex(p,y,v),this.secondaryDecoder=new $1(p,y,v)):this.primaryDecoder=new $1(p,y,v)}return h.prototype.decodeAsync=function(p){return tx(this,void 0,void 0,function(){var f;return sx(this,function(y){switch(y.label){case 0:f=performance.now(),y.label=1;case 1:return y.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(p)];case 2:return[2,y.sent()];case 3:return this.possiblyLogPerformance(f),[7];case 4:return[2]}})})},h.prototype.decodeRobustlyAsync=function(p){return tx(this,void 0,void 0,function(){var f,y;return sx(this,function(v){switch(v.label){case 0:f=performance.now(),v.label=1;case 1:return v.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(p)];case 2:return[2,v.sent()];case 3:if(y=v.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(p)];throw y;case 4:return this.possiblyLogPerformance(f),[7];case 5:return[2]}})})},h.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},h.prototype.possiblyLogPerformance=function(p){if(this.verbose){var f=performance.now()-p;this.executionResults.push(f),this.executions++,this.possiblyFlushPerformanceReport()}},h.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var p=0,f=0,y=this.executionResults;f<y.length;f++){var v=y[f];p+=v}var N=p/this.executionResults.length;console.log("".concat(N," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},h})(),w0=(function(){var h=function(p,f){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,v){y.__proto__=v}||function(y,v){for(var N in v)Object.prototype.hasOwnProperty.call(v,N)&&(y[N]=v[N])},h(p,f)};return function(p,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");h(p,f);function y(){this.constructor=p}p.prototype=f===null?Object.create(f):(y.prototype=f.prototype,new y)}})(),_c=function(h,p,f,y){function v(N){return N instanceof f?N:new f(function(A){A(N)})}return new(f||(f=Promise))(function(N,A){function R(C){try{w(y.next(C))}catch(O){A(O)}}function j(C){try{w(y.throw(C))}catch(O){A(O)}}function w(C){C.done?N(C.value):v(C.value).then(R,j)}w((y=y.apply(h,p||[])).next())})},Ic=function(h,p){var f={label:0,sent:function(){if(N[0]&1)throw N[1];return N[1]},trys:[],ops:[]},y,v,N,A;return A={next:R(0),throw:R(1),return:R(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function R(w){return function(C){return j([w,C])}}function j(w){if(y)throw new TypeError("Generator is already executing.");for(;A&&(A=0,w[0]&&(f=0)),f;)try{if(y=1,v&&(N=w[0]&2?v.return:w[0]?v.throw||((N=v.return)&&N.call(v),0):v.next)&&!(N=N.call(v,w[1])).done)return N;switch(v=0,N&&(w=[w[0]&2,N.value]),w[0]){case 0:case 1:N=w;break;case 4:return f.label++,{value:w[1],done:!1};case 5:f.label++,v=w[1],w=[0];continue;case 7:w=f.ops.pop(),f.trys.pop();continue;default:if(N=f.trys,!(N=N.length>0&&N[N.length-1])&&(w[0]===6||w[0]===2)){f=0;continue}if(w[0]===3&&(!N||w[1]>N[0]&&w[1]<N[3])){f.label=w[1];break}if(w[0]===6&&f.label<N[1]){f.label=N[1],N=w;break}if(N&&f.label<N[2]){f.label=N[2],f.ops.push(w);break}N[2]&&f.ops.pop(),f.trys.pop();continue}w=p.call(h,f)}catch(C){w=[6,C],v=0}finally{y=N=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},Qx=(function(){function h(p,f){this.name=p,this.track=f}return h.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},h.prototype.apply=function(p){var f={};f[this.name]=p;var y={advanced:[f]};return this.track.applyConstraints(y)},h.prototype.value=function(){var p=this.track.getSettings();if(this.name in p){var f=p[this.name];return f}return null},h})(),My=(function(h){w0(p,h);function p(f,y){return h.call(this,f,y)||this}return p.prototype.min=function(){return this.getCapabilities().min},p.prototype.max=function(){return this.getCapabilities().max},p.prototype.step=function(){return this.getCapabilities().step},p.prototype.apply=function(f){var y={};y[this.name]=f;var v={advanced:[y]};return this.track.applyConstraints(v)},p.prototype.getCapabilities=function(){this.failIfNotSupported();var f=this.track.getCapabilities(),y=f[this.name];return{min:y.min,max:y.max,step:y.step}},p.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},p})(Qx),ky=(function(h){w0(p,h);function p(f){return h.call(this,"zoom",f)||this}return p})(My),By=(function(h){w0(p,h);function p(f){return h.call(this,"torch",f)||this}return p})(Qx),Ly=(function(){function h(p){this.track=p}return h.prototype.zoomFeature=function(){return new ky(this.track)},h.prototype.torchFeature=function(){return new By(this.track)},h})(),Py=(function(){function h(p,f,y){this.isClosed=!1,this.parentElement=p,this.mediaStream=f,this.callbacks=y,this.surface=this.createVideoElement(this.parentElement.clientWidth),p.append(this.surface)}return h.prototype.createVideoElement=function(p){var f=document.createElement("video");return f.style.width="".concat(p,"px"),f.style.display="block",f.muted=!0,f.setAttribute("muted","true"),f.playsInline=!0,f},h.prototype.setupSurface=function(){var p=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var f=function(){var y=p.surface.clientWidth,v=p.surface.clientHeight;p.callbacks.onRenderSurfaceReady(y,v),p.surface.removeEventListener("playing",f)};this.surface.addEventListener("playing",f),this.surface.srcObject=this.mediaStream,this.surface.play()},h.create=function(p,f,y,v){return _c(this,void 0,void 0,function(){var N,A;return Ic(this,function(R){switch(R.label){case 0:return N=new h(p,f,v),y.aspectRatio?(A={aspectRatio:y.aspectRatio},[4,N.getFirstTrackOrFail().applyConstraints(A)]):[3,2];case 1:R.sent(),R.label=2;case 2:return N.setupSurface(),[2,N]}})})},h.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},h.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},h.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},h.prototype.resume=function(p){this.failIfClosed();var f=this,y=function(){setTimeout(p,200),f.surface.removeEventListener("playing",y)};this.surface.addEventListener("playing",y),this.surface.play()},h.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},h.prototype.getSurface=function(){return this.failIfClosed(),this.surface},h.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},h.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},h.prototype.applyVideoConstraints=function(p){return _c(this,void 0,void 0,function(){return Ic(this,function(f){if("aspectRatio"in p)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(p)]})})},h.prototype.close=function(){if(this.isClosed)return Promise.resolve();var p=this;return new Promise(function(f,y){var v=p.mediaStream.getVideoTracks(),N=v.length,A=0;p.mediaStream.getVideoTracks().forEach(function(R){p.mediaStream.removeTrack(R),R.stop(),++A,A>=N&&(p.isClosed=!0,p.parentElement.removeChild(p.surface),f())})})},h.prototype.getCapabilities=function(){return new Ly(this.getFirstTrackOrFail())},h})(),Fy=(function(){function h(p){this.mediaStream=p}return h.prototype.render=function(p,f,y){return _c(this,void 0,void 0,function(){return Ic(this,function(v){return[2,Py.create(p,this.mediaStream,f,y)]})})},h.create=function(p){return _c(this,void 0,void 0,function(){var f,y;return Ic(this,function(v){switch(v.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return f={audio:!1,video:p},[4,navigator.mediaDevices.getUserMedia(f)];case 1:return y=v.sent(),[2,new h(y)]}})})},h})(),ax=function(h,p,f,y){function v(N){return N instanceof f?N:new f(function(A){A(N)})}return new(f||(f=Promise))(function(N,A){function R(C){try{w(y.next(C))}catch(O){A(O)}}function j(C){try{w(y.throw(C))}catch(O){A(O)}}function w(C){C.done?N(C.value):v(C.value).then(R,j)}w((y=y.apply(h,p||[])).next())})},nx=function(h,p){var f={label:0,sent:function(){if(N[0]&1)throw N[1];return N[1]},trys:[],ops:[]},y,v,N,A;return A={next:R(0),throw:R(1),return:R(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function R(w){return function(C){return j([w,C])}}function j(w){if(y)throw new TypeError("Generator is already executing.");for(;A&&(A=0,w[0]&&(f=0)),f;)try{if(y=1,v&&(N=w[0]&2?v.return:w[0]?v.throw||((N=v.return)&&N.call(v),0):v.next)&&!(N=N.call(v,w[1])).done)return N;switch(v=0,N&&(w=[w[0]&2,N.value]),w[0]){case 0:case 1:N=w;break;case 4:return f.label++,{value:w[1],done:!1};case 5:f.label++,v=w[1],w=[0];continue;case 7:w=f.ops.pop(),f.trys.pop();continue;default:if(N=f.trys,!(N=N.length>0&&N[N.length-1])&&(w[0]===6||w[0]===2)){f=0;continue}if(w[0]===3&&(!N||w[1]>N[0]&&w[1]<N[3])){f.label=w[1];break}if(w[0]===6&&f.label<N[1]){f.label=N[1],N=w;break}if(N&&f.label<N[2]){f.label=N[2],f.ops.push(w);break}N[2]&&f.ops.pop(),f.trys.pop();continue}w=p.call(h,f)}catch(C){w=[6,C],v=0}finally{y=N=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},Uy=(function(){function h(){}return h.failIfNotSupported=function(){return ax(this,void 0,void 0,function(){return nx(this,function(p){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new h]})})},h.prototype.create=function(p){return ax(this,void 0,void 0,function(){return nx(this,function(f){return[2,Fy.create(p)]})})},h})(),zy=function(h,p,f,y){function v(N){return N instanceof f?N:new f(function(A){A(N)})}return new(f||(f=Promise))(function(N,A){function R(C){try{w(y.next(C))}catch(O){A(O)}}function j(C){try{w(y.throw(C))}catch(O){A(O)}}function w(C){C.done?N(C.value):v(C.value).then(R,j)}w((y=y.apply(h,p||[])).next())})},Hy=function(h,p){var f={label:0,sent:function(){if(N[0]&1)throw N[1];return N[1]},trys:[],ops:[]},y,v,N,A;return A={next:R(0),throw:R(1),return:R(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function R(w){return function(C){return j([w,C])}}function j(w){if(y)throw new TypeError("Generator is already executing.");for(;A&&(A=0,w[0]&&(f=0)),f;)try{if(y=1,v&&(N=w[0]&2?v.return:w[0]?v.throw||((N=v.return)&&N.call(v),0):v.next)&&!(N=N.call(v,w[1])).done)return N;switch(v=0,N&&(w=[w[0]&2,N.value]),w[0]){case 0:case 1:N=w;break;case 4:return f.label++,{value:w[1],done:!1};case 5:f.label++,v=w[1],w=[0];continue;case 7:w=f.ops.pop(),f.trys.pop();continue;default:if(N=f.trys,!(N=N.length>0&&N[N.length-1])&&(w[0]===6||w[0]===2)){f=0;continue}if(w[0]===3&&(!N||w[1]>N[0]&&w[1]<N[3])){f.label=w[1];break}if(w[0]===6&&f.label<N[1]){f.label=N[1],N=w;break}if(N&&f.label<N[2]){f.label=N[2],f.ops.push(w);break}N[2]&&f.ops.pop(),f.trys.pop();continue}w=p.call(h,f)}catch(C){w=[6,C],v=0}finally{y=N=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},Vy=(function(){function h(){}return h.retrieve=function(){if(navigator.mediaDevices)return h.getCamerasFromMediaDevices();var p=MediaStreamTrack;return MediaStreamTrack&&p.getSources?h.getCamerasFromMediaStreamTrack():h.rejectWithError()},h.rejectWithError=function(){var p=qi.unableToQuerySupportedDevices();return h.isHttpsOrLocalhost()||(p=qi.insecureContextCameraQueryError()),Promise.reject(p)},h.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var p=location.host.split(":")[0];return p==="127.0.0.1"||p==="localhost"},h.getCamerasFromMediaDevices=function(){return zy(this,void 0,void 0,function(){var p,f,y,v,N,A,R;return Hy(this,function(j){switch(j.label){case 0:return p=function(w){for(var C=w.getVideoTracks(),O=0,_=C;O<_.length;O++){var L=_[O];L.enabled=!1,L.stop(),w.removeTrack(L)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return f=j.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(y=j.sent(),v=[],N=0,A=y;N<A.length;N++)R=A[N],R.kind==="videoinput"&&v.push({id:R.deviceId,label:R.label});return p(f),[2,v]}})})},h.getCamerasFromMediaStreamTrack=function(){return new Promise(function(p,f){var y=function(N){for(var A=[],R=0,j=N;R<j.length;R++){var w=j[R];w.kind==="video"&&A.push({id:w.id,label:w.label})}p(A)},v=MediaStreamTrack;v.getSources(y)})},h})(),Cs;(function(h){h[h.UNKNOWN=0]="UNKNOWN",h[h.NOT_STARTED=1]="NOT_STARTED",h[h.SCANNING=2]="SCANNING",h[h.PAUSED=3]="PAUSED"})(Cs||(Cs={}));var Gy=(function(){function h(){this.state=Cs.NOT_STARTED,this.onGoingTransactionNewState=Cs.UNKNOWN}return h.prototype.directTransition=function(p){this.failIfTransitionOngoing(),this.validateTransition(p),this.state=p},h.prototype.startTransition=function(p){return this.failIfTransitionOngoing(),this.validateTransition(p),this.onGoingTransactionNewState=p,this},h.prototype.execute=function(){if(this.onGoingTransactionNewState===Cs.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var p=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Cs.UNKNOWN,this.directTransition(p)},h.prototype.cancel=function(){if(this.onGoingTransactionNewState===Cs.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Cs.UNKNOWN},h.prototype.getState=function(){return this.state},h.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Cs.UNKNOWN)throw"Cannot transition to a new state, already under transition"},h.prototype.validateTransition=function(p){switch(this.state){case Cs.UNKNOWN:throw"Transition from unknown is not allowed";case Cs.NOT_STARTED:this.failIfNewStateIs(p,[Cs.PAUSED]);break;case Cs.SCANNING:break;case Cs.PAUSED:break}},h.prototype.failIfNewStateIs=function(p,f){for(var y=0,v=f;y<v.length;y++){var N=v[y];if(p===N)throw"Cannot transition from ".concat(this.state," to ").concat(p)}},h})(),Xy=(function(){function h(p){this.stateManager=p}return h.prototype.startTransition=function(p){return this.stateManager.startTransition(p)},h.prototype.directTransition=function(p){this.stateManager.directTransition(p)},h.prototype.getState=function(){return this.stateManager.getState()},h.prototype.canScanFile=function(){return this.stateManager.getState()===Cs.NOT_STARTED},h.prototype.isScanning=function(){return this.stateManager.getState()!==Cs.NOT_STARTED},h.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Cs.SCANNING},h.prototype.isPaused=function(){return this.stateManager.getState()===Cs.PAUSED},h})(),Yy=(function(){function h(){}return h.create=function(){return new Xy(new Gy)},h})(),qy=(function(){var h=function(p,f){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,v){y.__proto__=v}||function(y,v){for(var N in v)Object.prototype.hasOwnProperty.call(v,N)&&(y[N]=v[N])},h(p,f)};return function(p,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");h(p,f);function y(){this.constructor=p}p.prototype=f===null?Object.create(f):(y.prototype=f.prototype,new y)}})(),Ra=(function(h){qy(p,h);function p(){return h!==null&&h.apply(this,arguments)||this}return p.DEFAULT_WIDTH=300,p.DEFAULT_WIDTH_OFFSET=2,p.FILE_SCAN_MIN_HEIGHT=300,p.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,p.MIN_QR_BOX_SIZE=50,p.SHADED_LEFT=1,p.SHADED_RIGHT=2,p.SHADED_TOP=3,p.SHADED_BOTTOM=4,p.SHADED_REGION_ELEMENT_ID="qr-shaded-region",p.VERBOSE=!1,p.BORDER_SHADER_DEFAULT_COLOR="#ffffff",p.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",p})(Cy),Ky=(function(){function h(p,f){this.logger=f,this.fps=Ra.SCAN_DEFAULT_FPS,p?(p.fps&&(this.fps=p.fps),this.disableFlip=p.disableFlip===!0,this.qrbox=p.qrbox,this.aspectRatio=p.aspectRatio,this.videoConstraints=p.videoConstraints):this.disableFlip=Ra.DEFAULT_DISABLE_FLIP}return h.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Wx.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},h.prototype.isShadedBoxEnabled=function(){return!Hn(this.qrbox)},h.create=function(p,f){return new h(p,f)},h})(),Zy=(function(){function h(p,f){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(p))throw"HTML Element with id=".concat(p," not found");this.elementId=p,this.verbose=!1;var y;typeof f=="boolean"?this.verbose=f===!0:f&&(y=f,this.verbose=y.verbose===!0,y.experimentalFeatures),this.logger=new Ey(this.verbose),this.qrcode=new Iy(this.getSupportedFormats(f),this.getUseBarCodeDetectorIfSupported(y),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=Yy.create()}return h.prototype.start=function(p,f,y,v){var N=this;if(!p)throw"cameraIdOrConfig is required";if(!y||typeof y!="function")throw"qrCodeSuccessCallback is required and should be a function.";var A;v?A=v:A=this.verbose?this.logger.log:function(){};var R=Ky.create(f,this.logger);this.clearElement();var j=!1;R.videoConstraints&&(R.isMediaStreamConstraintsValid()?j=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var w=j,C=document.getElementById(this.elementId);C.clientWidth?C.clientWidth:Ra.DEFAULT_WIDTH,C.style.position="relative",this.shouldScan=!0,this.element=C;var O=this,_=this.stateManagerProxy.startTransition(Cs.SCANNING);return new Promise(function(L,P){var V=w?R.videoConstraints:O.createVideoConstraints(p);if(!V){_.cancel(),P("videoConstraints should be defined");return}var Y={};(!w||R.aspectRatio)&&(Y.aspectRatio=R.aspectRatio);var ee={onRenderSurfaceReady:function(K,H){O.setupUi(K,H,R),O.isScanning=!0,O.foreverScan(R,y,A)}};Uy.failIfNotSupported().then(function(K){K.create(V).then(function(H){return H.render(N.element,Y,ee).then(function(q){O.renderedCamera=q,_.execute(),L(null)}).catch(function(q){_.cancel(),P(q)})}).catch(function(H){_.cancel(),P(qi.errorGettingUserMedia(H))})}).catch(function(K){_.cancel(),P(qi.cameraStreamingNotSupported())})})},h.prototype.pause=function(p){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Cs.PAUSED),this.showPausedState(),(Hn(p)||p!==!0)&&(p=!1),p&&this.renderedCamera&&this.renderedCamera.pause()},h.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var p=this,f=function(){p.stateManagerProxy.directTransition(Cs.SCANNING),p.hidePausedState()};if(!this.renderedCamera.isPaused()){f();return}this.renderedCamera.resume(function(){f()})},h.prototype.getState=function(){return this.stateManagerProxy.getState()},h.prototype.stop=function(){var p=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var f=this.stateManagerProxy.startTransition(Cs.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var y=function(){if(p.element){var N=document.getElementById(Ra.SHADED_REGION_ELEMENT_ID);N&&p.element.removeChild(N)}},v=this;return this.renderedCamera.close().then(function(){return v.renderedCamera=null,v.element&&(v.element.removeChild(v.canvasElement),v.canvasElement=null),y(),v.qrRegion&&(v.qrRegion=null),v.context&&(v.context=null),f.execute(),v.hidePausedState(),v.isScanning=!1,Promise.resolve()})},h.prototype.scanFile=function(p,f){return this.scanFileV2(p,f).then(function(y){return y.decodedText})},h.prototype.scanFileV2=function(p,f){var y=this;if(!p||!(p instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Hn(f)&&(f=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(v,N){y.possiblyCloseLastScanImageFile(),y.clearElement(),y.lastScanImageFile=URL.createObjectURL(p);var A=new Image;A.onload=function(){var R=A.width,j=A.height,w=document.getElementById(y.elementId),C=w.clientWidth?w.clientWidth:Ra.DEFAULT_WIDTH,O=Math.max(w.clientHeight?w.clientHeight:j,Ra.FILE_SCAN_MIN_HEIGHT),_=y.computeCanvasDrawConfig(R,j,C,O);if(f){var L=y.createCanvasElement(C,O,"qr-canvas-visible");L.style.display="inline-block",w.appendChild(L);var P=L.getContext("2d");if(!P)throw"Unable to get 2d context from canvas";P.canvas.width=C,P.canvas.height=O,P.drawImage(A,0,0,R,j,_.x,_.y,_.width,_.height)}var V=Ra.FILE_SCAN_HIDDEN_CANVAS_PADDING,Y=Math.max(A.width,_.width),ee=Math.max(A.height,_.height),K=Y+2*V,H=ee+2*V,q=y.createCanvasElement(K,H);w.appendChild(q);var te=q.getContext("2d");if(!te)throw"Unable to get 2d context from canvas";te.canvas.width=K,te.canvas.height=H,te.drawImage(A,0,0,R,j,V,V,Y,ee);try{y.qrcode.decodeRobustlyAsync(q).then(function(ce){v(Q1.createFromQrcodeResult(ce))}).catch(N)}catch(ce){N("QR code parse error, error = ".concat(ce))}},A.onerror=N,A.onabort=N,A.onstalled=N,A.onsuspend=N,A.src=URL.createObjectURL(p)})},h.prototype.clear=function(){this.clearElement()},h.getCameras=function(){return Vy.retrieve()},h.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},h.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},h.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},h.prototype.applyVideoConstraints=function(p){if(p){if(!Wx.isMediaStreamConstraintsValid(p,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(p)},h.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},h.prototype.getSupportedFormats=function(p){var f=[Qe.QR_CODE,Qe.AZTEC,Qe.CODABAR,Qe.CODE_39,Qe.CODE_93,Qe.CODE_128,Qe.DATA_MATRIX,Qe.MAXICODE,Qe.ITF,Qe.EAN_13,Qe.EAN_8,Qe.PDF_417,Qe.RSS_14,Qe.RSS_EXPANDED,Qe.UPC_A,Qe.UPC_E,Qe.UPC_EAN_EXTENSION];if(!p||typeof p=="boolean"||!p.formatsToSupport)return f;if(!Array.isArray(p.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(p.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var y=[],v=0,N=p.formatsToSupport;v<N.length;v++){var A=N[v];jy(A)?y.push(A):this.logger.warn("Invalid format: ".concat(A," passed in config, ignoring."))}if(y.length===0)throw"None of formatsToSupport match supported values.";return y},h.prototype.getUseBarCodeDetectorIfSupported=function(p){if(Hn(p))return!0;if(!Hn(p.useBarCodeDetectorIfSupported))return p.useBarCodeDetectorIfSupported!==!1;if(Hn(p.experimentalFeatures))return!0;var f=p.experimentalFeatures;return Hn(f.useBarCodeDetectorIfSupported)?!0:f.useBarCodeDetectorIfSupported!==!1},h.prototype.validateQrboxSize=function(p,f,y){var v=this,N=y.qrbox;this.validateQrboxConfig(N);var A=this.toQrdimensions(p,f,N),R=function(w){if(w<Ra.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Ra.MIN_QR_BOX_SIZE,"px.")},j=function(w){return w>p&&(v.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),w=p),w};R(A.width),R(A.height),A.width=j(A.width)},h.prototype.validateQrboxConfig=function(p){if(typeof p!="number"&&typeof p!="function"&&(p.width===void 0||p.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},h.prototype.toQrdimensions=function(p,f,y){if(typeof y=="number")return{width:y,height:y};if(typeof y=="function")try{return y(p,f)}catch(v){throw new Error("qrbox config was passed as a function but it failed with unknown error"+v)}return y},h.prototype.setupUi=function(p,f,y){y.isShadedBoxEnabled()&&this.validateQrboxSize(p,f,y);var v=Hn(y.qrbox)?{width:p,height:f}:y.qrbox;this.validateQrboxConfig(v);var N=this.toQrdimensions(p,f,v);N.height>f&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var A=y.isShadedBoxEnabled()&&N.height<=f,R={x:0,y:0,width:p,height:f},j=A?this.getShadedRegionBounds(p,f,N):R,w=this.createCanvasElement(j.width,j.height),C={willReadFrequently:!0},O=w.getContext("2d",C);O.canvas.width=j.width,O.canvas.height=j.height,this.element.append(w),A&&this.possiblyInsertShadingElement(this.element,p,f,N),this.createScannerPausedUiElement(this.element),this.qrRegion=j,this.context=O,this.canvasElement=w},h.prototype.createScannerPausedUiElement=function(p){var f=document.createElement("div");f.innerText=qi.scannerPaused(),f.style.display="none",f.style.position="absolute",f.style.top="0px",f.style.zIndex="1",f.style.background="rgba(9, 9, 9, 0.46)",f.style.color="#FFECEC",f.style.textAlign="center",f.style.width="100%",p.appendChild(f),this.scannerPausedUiElement=f},h.prototype.scanContext=function(p,f){var y=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(v){return p(v.text,Q1.createFromQrcodeResult(v)),y.possiblyUpdateShaders(!0),!0}).catch(function(v){y.possiblyUpdateShaders(!1);var N=qi.codeParseError(v);return f(N,Ay.createFrom(N)),!1})},h.prototype.foreverScan=function(p,f,y){var v=this;if(this.shouldScan&&this.renderedCamera){var N=this.renderedCamera.getSurface(),A=N.videoWidth/N.clientWidth,R=N.videoHeight/N.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var j=this.qrRegion.width*A,w=this.qrRegion.height*R,C=this.qrRegion.x*A,O=this.qrRegion.y*R;this.context.drawImage(N,C,O,j,w,0,0,this.qrRegion.width,this.qrRegion.height);var _=function(){v.foreverScanTimeout=setTimeout(function(){v.foreverScan(p,f,y)},v.getTimeoutFps(p.fps))};this.scanContext(f,y).then(function(L){!L&&p.disableFlip!==!0?(v.context.translate(v.context.canvas.width,0),v.context.scale(-1,1),v.scanContext(f,y).finally(function(){_()})):_()}).catch(function(L){v.logger.logError("Error happend while scanning context",L),_()})}},h.prototype.createVideoConstraints=function(p){if(typeof p=="string")return{deviceId:{exact:p}};if(typeof p=="object"){var f="facingMode",y="deviceId",v={user:!0,environment:!0},N="exact",A=function(P){if(P in v)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(P,"'")},R=Object.keys(p);if(R.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(R.length," keys");var j=Object.keys(p)[0];if(j!==f&&j!==y)throw"Only '".concat(f,"' and '").concat(y,"' ")+" are supported for 'cameraIdOrConfig'";if(j===f){var w=p.facingMode;if(typeof w=="string"){if(A(w))return{facingMode:w}}else if(typeof w=="object")if(N in w){if(A(w["".concat(N)]))return{facingMode:{exact:w["".concat(N)]}}}else throw"'facingMode' should be string or object with"+" ".concat(N," as key.");else{var C=typeof w;throw"Invalid type of 'facingMode' = ".concat(C)}}else{var O=p.deviceId;if(typeof O=="string")return{deviceId:O};if(typeof O=="object"){if(N in O)return{deviceId:{exact:O["".concat(N)]}};throw"'deviceId' should be string or object with"+" ".concat(N," as key.")}else{var _=typeof O;throw"Invalid type of 'deviceId' = ".concat(_)}}}var L=typeof p;throw"Invalid type of 'cameraIdOrConfig' = ".concat(L)},h.prototype.computeCanvasDrawConfig=function(p,f,y,v){if(p<=y&&f<=v){var N=(y-p)/2,A=(v-f)/2;return{x:N,y:A,width:p,height:f}}else{var R=p,j=f;return p>y&&(f=y/p*f,p=y),f>v&&(p=v/f*p,f=v),this.logger.log("Image downsampled from "+"".concat(R,"X").concat(j)+" to ".concat(p,"X").concat(f,".")),this.computeCanvasDrawConfig(p,f,y,v)}},h.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var p=document.getElementById(this.elementId);p&&(p.innerHTML="")},h.prototype.possiblyUpdateShaders=function(p){this.qrMatch!==p&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(f){f.style.backgroundColor=p?Ra.BORDER_SHADER_MATCH_COLOR:Ra.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=p)},h.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},h.prototype.createCanvasElement=function(p,f,y){var v=p,N=f,A=document.createElement("canvas");return A.style.width="".concat(v,"px"),A.style.height="".concat(N,"px"),A.style.display="none",A.id=Hn(y)?"qr-canvas":y,A},h.prototype.getShadedRegionBounds=function(p,f,y){if(y.width>p||y.height>f)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(p-y.width)/2,y:(f-y.height)/2,width:y.width,height:y.height}},h.prototype.possiblyInsertShadingElement=function(p,f,y,v){if(!(f-v.width<1||y-v.height<1)){var N=document.createElement("div");N.style.position="absolute";var A=(f-v.width)/2,R=(y-v.height)/2;if(N.style.borderLeft="".concat(A,"px solid rgba(0, 0, 0, 0.48)"),N.style.borderRight="".concat(A,"px solid rgba(0, 0, 0, 0.48)"),N.style.borderTop="".concat(R,"px solid rgba(0, 0, 0, 0.48)"),N.style.borderBottom="".concat(R,"px solid rgba(0, 0, 0, 0.48)"),N.style.boxSizing="border-box",N.style.top="0px",N.style.bottom="0px",N.style.left="0px",N.style.right="0px",N.id="".concat(Ra.SHADED_REGION_ELEMENT_ID),f-v.width<11||y-v.height<11)this.hasBorderShaders=!1;else{var j=5,w=40;this.insertShaderBorders(N,w,j,-j,null,0,!0),this.insertShaderBorders(N,w,j,-j,null,0,!1),this.insertShaderBorders(N,w,j,null,-j,0,!0),this.insertShaderBorders(N,w,j,null,-j,0,!1),this.insertShaderBorders(N,j,w+j,-j,null,-j,!0),this.insertShaderBorders(N,j,w+j,null,-j,-j,!0),this.insertShaderBorders(N,j,w+j,-j,null,-j,!1),this.insertShaderBorders(N,j,w+j,null,-j,-j,!1),this.hasBorderShaders=!0}p.append(N)}},h.prototype.insertShaderBorders=function(p,f,y,v,N,A,R){var j=document.createElement("div");j.style.position="absolute",j.style.backgroundColor=Ra.BORDER_SHADER_DEFAULT_COLOR,j.style.width="".concat(f,"px"),j.style.height="".concat(y,"px"),v!==null&&(j.style.top="".concat(v,"px")),N!==null&&(j.style.bottom="".concat(N,"px")),R?j.style.left="".concat(A,"px"):j.style.right="".concat(A,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(j),p.appendChild(j)},h.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},h.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},h.prototype.getTimeoutFps=function(p){return 1e3/p},h})(),rx;(function(h){h[h.STATUS_DEFAULT=0]="STATUS_DEFAULT",h[h.STATUS_SUCCESS=1]="STATUS_SUCCESS",h[h.STATUS_WARNING=2]="STATUS_WARNING",h[h.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(rx||(rx={}));const Wy=`
  #qr-scanner-container #html5-qrcode-button-camera-permission,
  #qr-scanner-container #html5-qrcode-button-file-selection,
  #qr-scanner-container select,
  #qr-scanner-container button:not(.custom-scanner-button),
  #qr-scanner-container .html5-qrcode-element button,
  #qr-scanner-container div[style*="text-align: center"] button,
  #qr-scanner-container div[style*="text-align:center"] button {
    display: none !important;
  }

  #qr-scanner-container > div > div:last-child {
    display: none !important;
  }
`,Bc=({onScan:h,onError:p,isActive:f=!0,className:y="",showManualInput:v=!0,pauseAfterScan:N=!0})=>{const[A,R]=D.useState("camera"),[j,w]=D.useState(""),[C,O]=D.useState(!1),[_,L]=D.useState(""),[P,V]=D.useState(!1),[Y,ee]=D.useState(!1),[K,H]=D.useState({active:!1,width:0,height:0,constraints:null}),q=D.useRef(null),te=D.useRef(null),ce=D.useRef(null),$=D.useRef(null);D.useEffect(()=>{const ae=document.createElement("style");return ae.textContent=Wy,document.head.appendChild(ae),()=>{document.head.contains(ae)&&document.head.removeChild(ae)}},[]),D.useEffect(()=>()=>{oe()},[]),D.useEffect(()=>{f||((Y||P)&&console.log("[QrScanner] isActive=false -> stopping scanner"),oe())},[f]);const Re=async()=>{try{if(O(!0),L(""),V(!1),ee(!0),H({active:!1,width:0,height:0,constraints:null}),console.log(" Starting camera initialization..."),q.current&&(await q.current.stop(),q.current=null),$.current&&($.current.getTracks().forEach(Se=>Se.stop()),$.current=null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Camera is not supported in this browser. Please use manual input.");if(console.log(" getUserMedia available"),!(window.isSecureContext||window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.protocol==="https:"))throw new Error("Camera requires HTTPS connection or localhost. Please use HTTPS or manual input.");console.log(" Secure context verified");let F=null,W=null;try{console.log(" Trying back camera (environment)..."),W={video:{facingMode:{ideal:"environment"},width:{ideal:1280,min:640},height:{ideal:720,min:480}},audio:!1},F=await navigator.mediaDevices.getUserMedia(W),console.log(" Back camera successful")}catch(Se){console.log(" Back camera failed:",Se.message);try{console.log(" Trying front camera (user)..."),W={video:{facingMode:"user",width:{ideal:1280,min:640},height:{ideal:720,min:480}},audio:!1},F=await navigator.mediaDevices.getUserMedia(W),console.log(" Front camera successful")}catch(fe){console.log(" Front camera failed:",fe.message),console.log(" Trying any camera..."),W={video:{width:{ideal:1280,min:640},height:{ideal:720,min:480}},audio:!1},F=await navigator.mediaDevices.getUserMedia(W),console.log(" Any camera successful")}}if(!F)throw new Error("No camera stream available");console.log(" Stream obtained:",{active:F.active,tracks:F.getTracks().length,videoTracks:F.getVideoTracks().length}),$.current=F;const Q=F.getVideoTracks()[0];if(Q){const Se=Q.getSettings();console.log(" Video track settings:",Se),H({active:!0,width:Se.width||0,height:Se.height||0,constraints:W})}if(console.log(" Waiting for DOM container..."),await new Promise(Se=>{const fe=()=>{document.getElementById("qr-scanner-container")?(console.log(" DOM container found"),Se()):setTimeout(fe,50)};fe()}),ce.current){ce.current.srcObject=F,await new Promise(Se=>{ce.current.onloadedmetadata=()=>{console.log(" Video metadata loaded"),Se()}});try{await ce.current.play(),console.log(" Video playback started")}catch(Se){throw console.error(" Video playback error:",Se),new Error("Failed to start video playback")}}console.log(" Initializing QR scanner...");const Ne={fps:10,qrbox:{width:250,height:250},aspectRatio:1,disableFlip:!1};q.current=new Zy("qr-scanner-container"),await q.current.start({deviceId:{exact:Q.getSettings().deviceId}},Ne,Se=>{console.log(" QR Code detected:",Se),Ee(Se)},Se=>{!Se.includes("No MultiFormat Readers")&&!Se.includes("NotFoundException")&&!Se.includes("No QR code found")&&console.warn("QR scan error:",Se)}),console.log(" Scanner initialization complete"),V(!0),O(!1)}catch(ae){console.error(" Scanner initialization error:",ae);let F=ae.message||"Failed to initialize camera scanner.";ae.name==="NotAllowedError"?F="Camera access denied. Please allow camera permissions and refresh the page.":ae.name==="NotFoundError"?F="No camera found. Please connect a camera and try again.":ae.name==="NotReadableError"?F="Camera is already in use by another application.":ae.name==="OverconstrainedError"&&(F="Camera constraints not supported. Please try manual input."),L(F),O(!1),ee(!1),H({active:!1,width:0,height:0,constraints:null}),$.current&&($.current.getTracks().forEach(W=>W.stop()),$.current=null),q.current&&(await q.current.stop(),q.current=null),p&&p(F)}},oe=async()=>{try{console.log(" Stopping scanner..."),q.current&&(await q.current.stop(),q.current=null),$.current&&($.current.getTracks().forEach(ae=>{ae.stop(),console.log(" Stopped track:",ae.kind)}),$.current=null),V(!1),O(!1),L(""),ee(!1),H({active:!1,width:0,height:0,constraints:null}),console.log(" Scanner stopped")}catch(ae){console.error("Error stopping scanner:",ae),V(!1),O(!1),ee(!1),H({active:!1,width:0,height:0,constraints:null})}},Ee=ae=>{const F=(ae||"").trim();console.log("[QrScanner] Scan detected",{raw:ae,trimmed:F}),F&&(h&&h(F),N&&oe())},me=ae=>{ae.preventDefault();const F=j.trim();F&&h&&(h(F),w(""))},ne=()=>{R("camera"),w("")},J=()=>{R("manual"),oe()};return e.jsxs("div",{className:`w-full ${y}`,children:[e.jsxs("div",{className:"flex space-x-2 mb-4",children:[e.jsxs("button",{onClick:ne,className:`flex items-center px-4 py-2 rounded-lg border transition-colors ${A==="camera"?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,disabled:C,children:[e.jsx(Ql,{className:"w-4 h-4 mr-2"}),"Camera Scan"]}),v&&e.jsxs("button",{onClick:J,className:`flex items-center px-4 py-2 rounded-lg border transition-colors ${A==="manual"?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:[e.jsx(Fu,{className:"w-4 h-4 mr-2"}),"Manual Input"]})]}),A==="camera"?e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"relative",children:[!Y&&e.jsxs("div",{className:"min-h-[320px] bg-gray-50 rounded-lg flex flex-col items-center justify-center border-2 border-dashed border-gray-300",children:[e.jsx(Ql,{className:"w-16 h-16 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Ready to scan QR codes"}),e.jsxs("button",{onClick:Re,disabled:C,className:"inline-flex items-center px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium disabled:opacity-50",children:[e.jsx(f0,{className:"w-5 h-5 mr-2"}),"Start Scanning"]})]}),C&&e.jsxs("div",{className:"min-h-[320px] bg-gray-50 rounded-lg flex flex-col items-center justify-center",children:[e.jsx(Zi,{className:"w-8 h-8 mb-4 animate-spin text-green-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Initializing camera..."})]}),_&&Y&&e.jsxs("div",{className:"min-h-[320px] bg-gray-50 rounded-lg flex flex-col items-center justify-center border-2 border-dashed border-red-300",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Wp,{className:"w-8 h-8 text-red-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Camera Unavailable"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6 text-center max-w-md",children:_}),e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("div",{className:"flex space-x-3 justify-center",children:[e.jsxs("button",{onClick:Re,className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Ql,{className:"w-4 h-4 mr-2"}),"Try Again"]}),v&&e.jsxs("button",{onClick:J,className:"inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(Fu,{className:"w-4 h-4 mr-2"}),"Manual Input"]})]}),e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[e.jsx("p",{className:"mb-1",children:"Troubleshooting:"}),e.jsx("p",{children:" Refresh the page and allow camera permissions"}),e.jsx("p",{children:" Make sure no other app is using the camera"}),e.jsx("p",{children:" Try using HTTPS instead of HTTP"})]})]})]}),Y&&!_&&e.jsxs("div",{className:"relative",children:[e.jsxs("div",{id:"qr-scanner-container",ref:te,className:"rounded-lg overflow-hidden bg-gray-900 relative",style:{height:"320px"},children:[e.jsx("video",{ref:ce,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 z-10",children:e.jsxs("button",{onClick:oe,className:"inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium shadow-lg",children:[e.jsx(q2,{className:"w-4 h-4 mr-2"}),"Stop Scanning"]})})]}),K.active&&e.jsx("div",{className:"mt-2 p-2 bg-gray-100 rounded text-xs text-gray-600",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{children:["Stream: Active (",K.width,"",K.height,")"]}),e.jsx("span",{className:"text-green-600",children:""})]})}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ql,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsx("p",{className:"text-sm text-blue-800",children:"Position the QR code within the scan area above"})]})})]})]})}):e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Fu,{className:"w-8 h-8 text-green-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Manual Input"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Enter the Booking ID manually if camera scanning is not available"})]}),e.jsxs("form",{onSubmit:me,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manual-booking-id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Booking ID"}),e.jsx("input",{id:"manual-booking-id",type:"text",value:j,onChange:ae=>w(ae.target.value),placeholder:"Enter booking ID (e.g., LLL12345)",className:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500 text-lg font-mono",autoComplete:"off"})]}),e.jsxs("button",{type:"submit",disabled:!j.trim(),className:"w-full flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(Yn,{className:"w-5 h-5 mr-2"}),"Scan Order"]})]})]})]})},Qy=()=>{const[h,p]=D.useState(""),[f,y]=D.useState([]),[v,N]=D.useState(null),[A,R]=D.useState(""),[j,w]=D.useState(!1),[C,O]=D.useState(!1),[_,L]=D.useState([]),{user:P}=Fs(),V=(P==null?void 0:P.token)||Xs();D.useEffect(()=>{(async()=>{try{const ce=await fetch("/api/users/riders",{headers:{Authorization:`Bearer ${V}`}}),$=await ce.json();ce.ok&&y($.filter(Re=>Re.status==="ACTIVE"))}catch(ce){console.error("Failed to fetch riders:",ce)}})()},[V]);const Y=async te=>{if(!te||!te.trim()){R("Please enter or scan a booking ID");return}if(!h){R("Please select a rider first");return}w(!0),R(""),N(null);try{const ce=await fetch(`/api/orders/details/${encodeURIComponent(te.trim())}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${V}`}}),$=ce.headers.get("content-type");if(!$||!$.includes("application/json")){const oe=await ce.text();throw new Error(`Server returned non-JSON response: ${oe.substring(0,100)}`)}const Re=await ce.json();if(!ce.ok)throw new Error(Re.message||"Failed to fetch order details");N(Re)}catch(ce){R(ce.message),N(null)}finally{w(!1)}},ee=async()=>{if(!v||!h){R("Please select a rider and scan an order");return}O(!0),R("");try{const te=await fetch("/api/orders/assign-by-scan",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${V}`},body:JSON.stringify({bookingId:v.bookingId,assignedRiderId:h})}),ce=te.headers.get("content-type");if(!ce||!ce.includes("application/json")){const oe=await te.text();throw new Error(`Server returned non-JSON response: ${oe.substring(0,100)}`)}const $=await te.json();if(!te.ok)throw new Error($.message||"Failed to assign order");const Re=f.find(oe=>oe._id===h);L(oe=>[{bookingId:v.bookingId,riderName:(Re==null?void 0:Re.name)||"Unknown",timestamp:new Date().toLocaleString()},...oe.slice(0,9)]),N(null),R("")}catch(te){R(te.message)}finally{O(!1)}},K=te=>{Y(te)},H=te=>{R(te)},q=f.find(te=>te._id===h);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ii,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Assign Orders by QR Scan"})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Select a rider and scan QR codes to assign orders. Orders will be automatically marked as Out for Delivery."})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(to,{className:"w-4 h-4 inline mr-2"}),"Select Rider (Required)"]}),e.jsxs("select",{value:h,onChange:te=>{p(te.target.value),N(null),R("")},className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white focus:ring-2 focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"",children:"-- Select a Rider --"}),f.map(te=>e.jsxs("option",{value:te._id,children:[te.name," ",te.email?`(${te.email})`:""]},te._id))]}),q&&e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",e.jsx("span",{className:"font-semibold",children:q.name}),q.phone&&e.jsxs("span",{className:"ml-2",children:["- ",q.phone]})]})]}),h&&e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsx(Bc,{onScan:K,onError:H})}),j&&e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-600",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Fetching order details..."})]})}),A&&e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"p-4 bg-red-50 border border-red-100 text-red-600 rounded-lg flex items-center gap-2",children:[e.jsx(xn,{className:"w-5 h-5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Error"}),e.jsx("p",{className:"text-sm",children:A})]})]})}),v&&h&&e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-100 text-blue-700 rounded-lg mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(St,{className:"w-5 h-5"}),e.jsx("p",{className:"font-semibold",children:"Order Preview"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Booking ID:"}),e.jsx("span",{className:"font-mono",children:v.bookingId})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Tracking ID:"}),e.jsx("span",{className:"font-mono",children:v.trackingId})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Consignee:"}),e.jsx("span",{children:v.consigneeName})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gn,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Address:"}),e.jsxs("span",{children:[v.consigneeAddress,", ",v.destinationCity]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Phone:"}),e.jsx("span",{children:v.consigneePhone})]}),v.codAmount>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ts,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"COD Amount:"}),e.jsxs("span",{children:["PKR ",Number(v.codAmount).toLocaleString()]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200",children:[e.jsx("span",{className:"font-medium",children:"Current Status:"}),e.jsx("span",{className:"ml-2 px-2 py-1 bg-blue-200 text-blue-800 rounded text-xs font-semibold",children:v.status})]}),v.assignedRider&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-200",children:[e.jsx("span",{className:"font-medium",children:"Currently Assigned:"}),e.jsx("span",{className:"ml-2",children:v.assignedRider.name})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(zt,{onClick:ee,disabled:C,className:"flex-1",children:C?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Assigning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(gs,{className:"w-4 h-4 mr-2"}),"Assign to ",q==null?void 0:q.name]})}),e.jsx("button",{onClick:()=>{N(null),R("")},className:"px-4 py-2 text-sm bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Cancel"})]})]}),_.length>0&&e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("h4",{className:"text-md font-bold text-secondary mb-4",children:"Recent Assignments"}),e.jsx("div",{className:"space-y-2",children:_.map((te,ce)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-100 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Yn,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium",children:te.bookingId}),e.jsxs("span",{className:"text-sm text-gray-600",children:[" ",te.riderName]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:te.timestamp})]},ce))})]})]})},Jy=()=>{const h=As(),[p,f]=D.useState([]),[y,v]=D.useState([]),[N,A]=D.useState(!0),[R,j]=D.useState(""),[w,C]=D.useState(""),[O,_]=D.useState("ALL"),L=typeof window<"u"?localStorage.getItem("token"):null,[P,V]=D.useState(null),[Y,ee]=D.useState({newPassword:"",confirmPassword:""}),[K,H]=D.useState({}),[q,te]=D.useState(null),[ce,$]=D.useState(""),[Re,oe]=D.useState(null);D.useEffect(()=>{Ee()},[]),D.useEffect(()=>{me()},[p,w,O]);const Ee=async()=>{A(!0),j("");try{const Q=await fetch("/api/users/riders",{headers:{Authorization:L?`Bearer ${L}`:""}}),Ne=await Q.json();if(!Q.ok)throw new Error(Ne.message||"Failed to fetch riders");f(Ne)}catch(Q){j(Q.message)}finally{A(!1)}},me=()=>{let Q=[...p];if(O!=="ALL"&&(Q=Q.filter(Ne=>Ne.status===O)),w.trim()){const Ne=w.toLowerCase();Q=Q.filter(Se=>{var fe,E,G;return((fe=Se.name)==null?void 0:fe.toLowerCase().includes(Ne))||((E=Se.email)==null?void 0:E.toLowerCase().includes(Ne))||((G=Se.phone)==null?void 0:G.toLowerCase().includes(Ne))})}v(Q)},ne=()=>{const Q={};return(!Y.newPassword||Y.newPassword.length<8)&&(Q.newPassword="Password must be at least 8 characters"),Y.confirmPassword?Y.newPassword!==Y.confirmPassword&&(Q.confirmPassword="Passwords do not match"):Q.confirmPassword="Please confirm your password",H(Q),Object.keys(Q).length===0},J=async Q=>{if(Q.preventDefault(),H({}),te(null),$(""),!!ne())try{const Ne=await fetch(`/api/users/${P._id}/reset-password`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:L?`Bearer ${L}`:""},body:JSON.stringify({newPassword:Y.newPassword})}),Se=await Ne.json();if(!Ne.ok)throw new Error(Se.message||"Failed to reset password");te({message:"Password updated successfully!",password:Se.password,isTemporary:Se.isTemporary}),$(Se.password),ee({newPassword:"",confirmPassword:""})}catch(Ne){H({submit:Ne.message})}},ae=async Q=>{try{const Ne=await fetch(`/api/users/${Q._id}/reset-password`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:L?`Bearer ${L}`:""},body:JSON.stringify({})}),Se=await Ne.json();if(!Ne.ok)throw new Error(Se.message||"Failed to generate password");V(Q),te({message:"Temporary password generated successfully!",password:Se.password,isTemporary:!0}),$(Se.password),ee({newPassword:"",confirmPassword:""})}catch(Ne){H({submit:Ne.message})}},F=Q=>{navigator.clipboard.writeText(Q),alert("Password copied to clipboard!")},W=async(Q,Ne)=>{try{const Se=await fetch(`/api/users/${Q}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:L?`Bearer ${L}`:""},body:JSON.stringify({status:Ne})}),fe=await Se.json();if(!Se.ok)throw new Error(fe.message||"Failed to update status");await Ee()}catch(Se){j(Se.message)}};return e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(gs,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Riders Management"})]})})}),R&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:R}),e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(al,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name, email, or phone...",value:w,onChange:Q=>C(Q.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),e.jsxs("select",{value:O,onChange:Q=>_(Q.target.value),className:"px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:N?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):y.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No riders found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[e.jsx("th",{className:"py-3 px-4",children:"Rider Name"}),e.jsx("th",{className:"py-3 px-4",children:"Email"}),e.jsx("th",{className:"py-3 px-4",children:"Phone"}),e.jsx("th",{className:"py-3 px-4",children:"Assigned Orders"}),e.jsx("th",{className:"py-3 px-4",children:"COD Collected"}),e.jsx("th",{className:"py-3 px-4",children:"Status"}),e.jsx("th",{className:"py-3 px-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:y.map(Q=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 font-medium",children:Q.name}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Oc,{className:"w-3 h-3 text-gray-400"}),Q.email||"N/A"]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Vn,{className:"w-3 h-3 text-gray-400"}),Q.phone||"N/A"]})}),e.jsx("td",{className:"py-3 px-4",children:Q.assignedOrders||0}),e.jsxs("td",{className:"py-3 px-4",children:["PKR ",Number(Q.codCollected||0).toLocaleString()]}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Q.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Q.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:()=>W(Q._id,Q.status==="ACTIVE"?"INACTIVE":"ACTIVE"),children:Q.status==="ACTIVE"?"Deactivate":"Activate"}),e.jsxs("button",{className:"px-2 py-1 text-xs border border-blue-200 text-blue-600 rounded hover:bg-blue-50 flex items-center gap-1",onClick:()=>{V(Q),ee({newPassword:"",confirmPassword:""}),H({}),te(null),$("")},children:[e.jsx(N2,{className:"w-3 h-3"}),"Reset Password"]}),e.jsxs("button",{className:"px-2 py-1 text-xs border border-green-200 text-green-600 rounded hover:bg-green-50 flex items-center gap-1",onClick:()=>ae(Q),children:[e.jsx(F2,{className:"w-3 h-3"}),"Generate Temp"]}),e.jsxs("button",{className:"px-2 py-1 text-xs border border-purple-200 text-purple-600 rounded hover:bg-purple-50",onClick:()=>oe(Q),children:[e.jsx(to,{className:"w-3 h-3 inline"})," Details"]}),e.jsx("button",{className:"px-2 py-1 text-xs border border-purple-200 text-purple-600 rounded hover:bg-purple-50",onClick:()=>h(`/ceo/riders/${Q._id}/settlements`,{state:{rider:Q}}),children:"Settlements"})]})})]},Q._id))})]})})}),P&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>{V(null),ee({newPassword:"",confirmPassword:""}),H({}),te(null),$("")},children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",onClick:Q=>Q.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-bold text-secondary",children:["Reset Password for ",P.name]}),e.jsx("button",{onClick:()=>{V(null),ee({newPassword:"",confirmPassword:""}),H({}),te(null),$("")},className:"text-gray-400 hover:text-gray-600",children:e.jsx(xn,{className:"w-5 h-5"})})]}),e.jsx("form",{onSubmit:J,className:"p-6 space-y-4",children:q?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 text-green-700 rounded-lg",children:[e.jsx("p",{className:"font-semibold mb-2",children:q.message}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:q.isTemporary?"Temporary Password (copy this):":"New Password (copy this):"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:q.password,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg bg-gray-50 font-mono"}),e.jsxs("button",{type:"button",onClick:()=>F(q.password),className:"px-3 py-2 text-sm bg-primary text-white rounded-lg hover:bg-primary-hover flex items-center gap-1",children:[e.jsx(o2,{className:"w-4 h-4"}),"Copy"]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>{V(null),ee({newPassword:"",confirmPassword:""}),H({}),te(null),$("")},className:"px-4 py-2 text-sm bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Close"})})]}):e.jsxs(e.Fragment,{children:[K.submit&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 text-red-600 text-sm rounded",children:K.submit}),e.jsxs("div",{children:[e.jsx(ht,{label:"New Password",type:"password",value:Y.newPassword,onChange:Q=>ee({...Y,newPassword:Q.target.value}),required:!0}),K.newPassword&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:K.newPassword})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Confirm Password",type:"password",value:Y.confirmPassword,onChange:Q=>ee({...Y,confirmPassword:Q.target.value}),required:!0}),K.confirmPassword&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:K.confirmPassword})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>{V(null),ee({newPassword:"",confirmPassword:""}),H({}),te(null),$("")},children:"Cancel"}),e.jsx(zt,{type:"submit",children:"Reset Password"})]})]})})]})}),Re&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>oe(null),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden",onClick:Q=>Q.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Rider Details"}),e.jsx("button",{onClick:()=>oe(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(xn,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Name"}),e.jsx("p",{className:"text-sm font-semibold",children:Re.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Email"}),e.jsx("p",{className:"text-sm",children:Re.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Phone"}),e.jsx("p",{className:"text-sm",children:Re.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Status"}),e.jsx("p",{className:"text-sm",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Re.status==="ACTIVE"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Re.status})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Vehicle Info"}),e.jsx("p",{className:"text-sm",children:Re.vehicleInfo||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Assigned Orders"}),e.jsx("p",{className:"text-sm font-semibold",children:Re.assignedOrders||0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"COD Collected"}),e.jsxs("p",{className:"text-sm font-semibold",children:["PKR ",Number(Re.codCollected||0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Service Charges"}),e.jsxs("p",{className:"text-sm font-semibold",children:["PKR ",Number(Re.serviceCharges||0).toLocaleString()]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>oe(null),className:"px-4 py-2 text-sm bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Close"})})]})]})})]})},Zl=h=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0}).format(Number(h||0)),$y=h=>{if(!h)return"";const p=new Date(h);return Number.isNaN(p.getTime())?"":p.toLocaleString()},eb=()=>{var jt;const{id:h}=tl(),p=Ga(),f=As(),{user:y}=Fs(),v=(y==null?void 0:y.token)||Xs(),[N,A]=D.useState(((jt=p.state)==null?void 0:jt.rider)||null),[R,j]=D.useState(!1),[w,C]=D.useState({summary:null,items:[],page:1,totalPages:1,total:0}),[O,_]=D.useState(!1),[L,P]=D.useState(""),[V,Y]=D.useState(""),[ee,K]=D.useState(""),[H,q]=D.useState(""),[te,ce]=D.useState("all"),[$,Re]=D.useState("all"),[oe,Ee]=D.useState("desc"),[me,ne]=D.useState(""),[J,ae]=D.useState(1),[F,W]=D.useState(""),[Q,Ne]=D.useState([]),[Se,fe]=D.useState(!1);D.useEffect(()=>{if(!v||N||!h)return;(async()=>{j(!0);try{const lt=await fetch("/api/users/riders",{headers:{Authorization:`Bearer ${v}`}}),Ke=await lt.json();if(lt.ok&&Array.isArray(Ke)){const ft=Ke.find(Oe=>Oe._id===h);ft&&A(ft)}}catch{}finally{j(!1)}})()},[v,N,h]),D.useEffect(()=>{if(!v)return;(async()=>{try{const lt=await fetch("/api/users/shippers?active=true",{headers:{Authorization:`Bearer ${v}`}}),Ke=await lt.json();lt.ok&&Array.isArray(Ke)&&Ne(Ke)}catch{}})()},[v]);const E=async(Be={})=>{if(!v||!h)return;const lt=Be.from??ee,Ke=Be.to??H,ft=Be.status??te,Oe=Be.settlement??$,mt=Be.sortOrder??oe,yt=Be.page??J,Ze=Be.shipperId??F,Xe=Be.search??me;_(!0),P(""),Y("");try{const Tt=new URLSearchParams;lt&&Tt.set("from",lt),Ke&&Tt.set("to",Ke),ft&&ft!=="all"&&Tt.set("status",ft),Oe&&Oe!=="all"&&Tt.set("settlement",Oe),mt&&(mt==="asc"||mt==="desc")&&Tt.set("sortOrder",mt),Ze&&Tt.set("shipperId",Ze),Xe&&Xe.trim()&&Tt.set("search",Xe.trim()),Tt.set("page",String(yt)),Tt.set("limit","20");const He=await fetch(`/api/riders/${h}/settlements?${Tt.toString()}`,{headers:{Authorization:`Bearer ${v}`}}),ye=await He.json();if(!He.ok)throw new Error(ye.message||"Failed to load rider settlements");C(ye),ae(ye.page||yt)}catch(Tt){P(Tt.message||"Failed to load rider settlements")}finally{_(!1)}};D.useEffect(()=>{v&&h&&E({page:1})},[v,h]);const G=async()=>{ae(1),await E({page:1})},U=async()=>{K(""),q(""),ce("all"),Re("all"),Ee("desc"),ne(""),W(""),ae(1),await E({from:"",to:"",status:"all",settlement:"all",sortOrder:"desc",page:1,shipperId:"",search:""})},Z=async Be=>{const lt=new Date;lt.setHours(0,0,0,0);const Ke=new Date(lt),ft=new Date(lt);Be>0&&ft.setDate(ft.getDate()-(Be-1));const Oe=Ze=>{const Xe=Ze.getFullYear(),Tt=String(Ze.getMonth()+1).padStart(2,"0"),He=String(Ze.getDate()).padStart(2,"0");return`${Xe}-${Tt}-${He}`},mt=Oe(ft),yt=Oe(Ke);K(mt),q(yt),ae(1),await E({from:mt,to:yt,page:1})},we=async(Be,lt)=>{if(!v||!Be)return;const Ke=lt==="PAID"?"UNPAID":"PAID";fe(!0),P(""),Y("");try{const ft=await fetch(`/api/orders/${Be}/rider-settlement`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},body:JSON.stringify({status:Ke})}),Oe=await ft.json();if(!ft.ok)throw new Error(Oe.message||"Failed to update rider settlement");Y(Ke==="PAID"?"Rider settlement marked as Paid":"Rider settlement marked as Unpaid"),await E({page:J})}catch(ft){P(ft.message||"Failed to update rider settlement")}finally{fe(!1)}},xe=w.summary||{},Ge=w.items||[],Ve=N&&N.name||(R?"Loading rider":`Rider ${h}`),Je=(N==null?void 0:N.email)||"";return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between gap-4",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:()=>f(-1),className:"inline-flex items-center gap-1 text-xs text-gray-600 hover:text-secondary",children:[e.jsx(h0,{className:"w-4 h-4"}),e.jsx("span",{children:"Back to Riders"})]})})}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-secondary",children:"Rider Settlements"}),e.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:Ve}),Je&&e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",Je,")"]})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Order-level earnings and settlement status for this rider."})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap text-xs",children:[e.jsx("span",{className:"text-gray-500 mr-1",children:"Quick range:"}),e.jsx("button",{onClick:()=>Z(0),className:"px-3 py-1 rounded-full border border-gray-200 hover:bg-gray-50",children:"Today"}),e.jsx("button",{onClick:()=>Z(7),className:"px-3 py-1 rounded-full border border-gray-200 hover:bg-gray-50",children:"7 days"}),e.jsx("button",{onClick:()=>Z(15),className:"px-3 py-1 rounded-full border border-gray-200 hover:bg-gray-50",children:"15 days"}),e.jsx("button",{onClick:()=>Z(30),className:"px-3 py-1 rounded-full border border-gray-200 hover:bg-gray-50",children:"30 days"})]})]}),L&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-xs rounded",children:L}),V&&!L&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-100 text-green-700 text-xs rounded",children:V}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500",children:"Delivered (range)"}),e.jsx("div",{className:"mt-1 text-xl font-bold text-secondary",children:xe.deliveredCount||0})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500",children:"Returned (range)"}),e.jsx("div",{className:"mt-1 text-xl font-bold text-secondary",children:xe.returnedCount||0})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500",children:"Failed (range)"}),e.jsx("div",{className:"mt-1 text-xl font-bold text-secondary",children:xe.failedCount||0})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500",children:"Rider Earnings (range)"}),e.jsx("div",{className:"mt-1 text-sm font-bold text-secondary",children:Zl(xe.riderEarnings||0)})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500",children:"Unpaid Balance (range)"}),e.jsx("div",{className:"mt-1 text-sm font-bold text-red-600",children:Zl(xe.unpaidBalance||0)})]})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-secondary",children:[e.jsx(sl,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:"Filters"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(al,{className:"w-4 h-4"}),e.jsx("input",{type:"text",value:me,onChange:Be=>ne(Be.target.value),placeholder:"Search by Order ID / Tracking ID",className:"px-3 py-1.5 border border-gray-200 rounded-lg text-xs"})]})]}),e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[11px] text-gray-500 mb-1",children:"From"}),e.jsx("input",{type:"date",value:ee,onChange:Be=>K(Be.target.value),className:"px-3 py-2 text-xs border border-gray-200 rounded-lg"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[11px] text-gray-500 mb-1",children:"To"}),e.jsx("input",{type:"date",value:H,onChange:Be=>q(Be.target.value),className:"px-3 py-2 text-xs border border-gray-200 rounded-lg"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[11px] text-gray-500 mb-1",children:"Order Status"}),e.jsxs("select",{value:te,onChange:Be=>ce(Be.target.value),className:"px-3 py-2 text-xs border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"returned",children:"Returned"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[11px] text-gray-500 mb-1",children:"Settlement"}),e.jsxs("select",{value:$,onChange:Be=>Re(Be.target.value),className:"px-3 py-2 text-xs border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"unpaid",children:"Unpaid"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[11px] text-gray-500 mb-1",children:"Shipper"}),e.jsxs("select",{value:F,onChange:Be=>W(Be.target.value),className:"px-3 py-2 text-xs border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"",children:"All"}),Q.map(Be=>e.jsx("option",{value:Be._id,children:(Be.companyName||Be.name||"Unnamed")+(Be.email?` - ${Be.email}`:"")},Be._id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[11px] text-gray-500 mb-1",children:"Sort by Date"}),e.jsxs("select",{value:oe,onChange:Be=>{Ee(Be.target.value),ae(1),E({sortOrder:Be.target.value,page:1})},className:"px-3 py-2 text-xs border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"desc",children:"Newest First"}),e.jsx("option",{value:"asc",children:"Oldest First"})]})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx(zt,{onClick:G,className:"text-xs",children:"Apply"}),e.jsx(zt,{variant:"outline",onClick:U,className:"text-xs",children:"Reset"})]})]}),e.jsx("div",{className:"overflow-x-auto border-t border-gray-100",children:e.jsxs("table",{className:"min-w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-gray-500 border-b",children:[e.jsx("th",{className:"py-2 px-3 text-left",children:"Date/Time"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Order / CN"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Shipper"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Consignee"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Destination"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"Weight (kg)"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Weight Bracket"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"COD"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"Service Charges"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"Rider Earning"}),e.jsx("th",{className:"py-2 px-3 text-center",children:"Order Status"}),e.jsx("th",{className:"py-2 px-3 text-center",children:"Settlement"}),e.jsx("th",{className:"py-2 px-3 text-center",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:O?e.jsx("tr",{children:e.jsx("td",{colSpan:13,className:"py-8 px-3 text-center text-gray-500 text-xs",children:"Loading settlements..."})}):Ge.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:13,className:"py-8 px-3 text-center text-gray-500 text-xs",children:"No orders found for selected filters."})}):Ge.map(Be=>{const lt=Be.settlementStatus==="PAID";return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-2 px-3 whitespace-nowrap",children:$y(Be.date)}),e.jsx("td",{className:"py-2 px-3",children:e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{className:"font-mono text-[11px]",children:Be.orderId||""})})}),e.jsx("td",{className:"py-2 px-3 text-xs",children:Be.shipperName||""}),e.jsx("td",{className:"py-2 px-3 text-xs",children:Be.consigneeName||""}),e.jsx("td",{className:"py-2 px-3 text-xs",children:Be.destination||""}),e.jsx("td",{className:"py-2 px-3 text-right",children:Number(Be.weightKg||0).toFixed(2)}),e.jsx("td",{className:"py-2 px-3 text-xs",children:Be.weightBracketLabel||""}),e.jsx("td",{className:"py-2 px-3 text-right",children:Zl(Be.codAmount||0)}),e.jsx("td",{className:"py-2 px-3 text-right",children:Zl(Be.serviceCharges||0)}),e.jsx("td",{className:"py-2 px-3 text-right font-semibold text-secondary",children:Zl(Be.riderEarning||0)}),e.jsx("td",{className:"py-2 px-3 text-center",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-gray-100 text-gray-700 text-[11px]",children:Be.status||""})}),e.jsx("td",{className:"py-2 px-3 text-center",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${lt?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:lt?"Paid":"Unpaid"})}),e.jsx("td",{className:"py-2 px-3 text-center",children:e.jsx("button",{disabled:Se,onClick:()=>we(Be.id,Be.settlementStatus),className:`px-3 py-1 text-[11px] rounded border ${lt?"bg-gray-100 text-gray-700 hover:bg-gray-200 border-gray-200":"bg-primary text-white hover:bg-primary-hover border-primary"} disabled:opacity-50 disabled:cursor-not-allowed`,children:lt?"Mark Unpaid":"Mark Paid"})})]},Be.id)})})]})}),e.jsxs("div",{className:"p-3 border-t border-gray-100 flex items-center justify-between text-[11px] text-gray-500",children:[e.jsxs("div",{children:["Showing page ",w.page||1," of ",w.totalPages||1," (Total ",w.total||0,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{const Be=Math.max(1,(w.page||1)-1);ae(Be),E({page:Be})},disabled:(w.page||1)<=1||O,className:"px-3 py-1.5 rounded border border-gray-200 bg-gray-50 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Prev"}),e.jsx("button",{onClick:()=>{const Be=Math.min(w.totalPages||1,(w.page||1)+1);ae(Be),E({page:Be})},disabled:(w.page||1)>=(w.totalPages||1)||O,className:"px-3 py-1.5 rounded border border-gray-200 bg-gray-50 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})},ix=()=>{var Ee,me;const[h,p]=D.useState(!1),[f,y]=D.useState(""),[v,N]=D.useState(""),[A,R]=D.useState(null),[j,w]=D.useState(!1),[C,O]=D.useState(""),[_,L]=D.useState(!1),[P,V]=D.useState(!1),[Y,ee]=D.useState([]),{user:K}=Fs(),H=(K==null?void 0:K.token)||Xs();D.useEffect(()=>{const ne=localStorage.getItem("warehouseScanHistory");if(ne)try{ee(JSON.parse(ne))}catch(J){console.error("Failed to load scan history:",J)}},[]);const q=ne=>{const ae=[{bookingId:ne.bookingId,consigneeName:ne.consigneeName,scannedAt:new Date().toISOString(),scannedBy:(K==null?void 0:K.name)||"Unknown",weightKg:ne.weightKg,status:ne.status},...Y.slice(0,9)];ee(ae),localStorage.setItem("warehouseScanHistory",JSON.stringify(ae))},te=async ne=>{y(""),N("");let J=ne;if(ne.includes("|")){const ae=ne.split("|");ae.length===2&&ae[0]==="LLL"&&(J=ae[1])}try{p(!0);const ae=await fetch(`/api/orders/${J}/scan-preview`,{method:"GET",headers:{Authorization:`Bearer ${H}`,"Content-Type":"application/json"}}),F=await ae.json();if(!ae.ok){F.code==="ORDER_NOT_FOUND"?y(`Order "${J}" not found. Please check the booking ID.`):F.code==="INVALID_STATUS"?y(`Cannot scan order: ${F.message}`):y(F.message||"Failed to fetch order details");return}if(F.success){const W=F.data.order;R(W),O(W.weightKg.toString()),L(!1),w(!0)}}catch(ae){console.error("Error scanning order:",ae),y("Network error. Please check your connection and try again.")}finally{p(!1)}},ce=async()=>{if(A)try{V(!0),y("");const ne={};if(_&&C!==A.weightKg.toString()){const F=parseFloat(C);if(isNaN(F)||F<=0){y("Please enter a valid weight greater than 0");return}if(F>50){y("Weight cannot exceed 50kg");return}ne.scannedWeightKg=F}const J=await fetch(`/api/orders/${A.bookingId}/warehouse-scan`,{method:"POST",headers:{Authorization:`Bearer ${H}`,"Content-Type":"application/json"},body:JSON.stringify(ne)}),ae=await J.json();if(!J.ok){ae.code==="ORDER_INVOICED"?y("This order has already been invoiced and cannot be modified."):ae.code==="INVALID_WEIGHT"?y(ae.message):y(ae.message||"Failed to process warehouse scan");return}if(ae.success){const F=ae.data.order,W=ae.data.changes;q(F);let Q="Order successfully scanned into warehouse!";W.weightChanged&&(Q+=` Weight updated from ${W.oldWeight}kg to ${W.newWeight}kg.`),W.serviceChargesRecalculated&&(Q+=" Service charges recalculated."),N(Q),w(!1),R(null)}}catch(ne){console.error("Error processing scan:",ne),y("Network error. Please try again.")}finally{V(!1)}},$=ne=>ne?new Date(ne).toLocaleString():"Not set",Re=ne=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0}).format(ne||0),oe=ne=>{const J={CREATED:{bg:"bg-gray-100",text:"text-gray-800",label:"Created"},ASSIGNED:{bg:"bg-blue-100",text:"text-blue-800",label:"Assigned"},AT_LLL_WAREHOUSE:{bg:"bg-green-100",text:"text-green-800",label:"At Warehouse"},OUT_FOR_DELIVERY:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Out for Delivery"},DELIVERED:{bg:"bg-green-100",text:"text-green-800",label:"Delivered"},RETURNED:{bg:"bg-red-100",text:"text-red-800",label:"Returned"},FAILED:{bg:"bg-red-100",text:"text-red-800",label:"Failed"}},ae=J[ne]||J.CREATED;return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ae.bg} ${ae.text}`,children:ae.label})};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-4 lg:p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:e.jsx(St,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Warehouse Scanner"}),e.jsx("p",{className:"text-gray-600",children:"Scan parcels to mark arrival and verify weight"})]})]})}),f&&e.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-2",children:[e.jsx(J2,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-red-700",children:f})]}),v&&e.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4 flex items-start space-x-2",children:[e.jsx(Yn,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-green-700",children:v})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(St,{className:"w-6 h-6 mr-2 text-green-600"}),"Scan Parcel QR Code"]}),e.jsx(Bc,{onScan:te,onError:y,isActive:!j,showManualInput:!0}),h&&e.jsxs("div",{className:"mt-6 text-center py-4",children:[e.jsx(Zi,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-green-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Loading order details..."})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(mn,{className:"w-5 h-5 mr-2 text-gray-600"}),"Recent Scans"]}),Y.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(St,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No scans yet"})]}):e.jsx("div",{className:"space-y-3",children:Y.map((ne,J)=>{var ae;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-gray-900",children:ne.bookingId}),e.jsx("span",{className:"text-xs text-gray-500",children:(ae=$(ne.scannedAt).split(",")[1])==null?void 0:ae.trim()})]}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:ne.consigneeName}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[ne.weightKg,"kg"]}),oe(ne.status)]})]},J)})})]})})]}),j&&A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[e.jsx(St,{className:"w-6 h-6 mr-2 text-green-600"}),"Confirm Warehouse Scan"]}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600",disabled:P,children:e.jsx(p0,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Booking ID"}),e.jsx("p",{className:"text-lg font-mono font-semibold text-gray-900",children:A.bookingId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Consignee"}),e.jsx("p",{className:"text-gray-900",children:A.consigneeName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination"}),e.jsxs("div",{className:"flex items-center text-gray-900",children:[e.jsx(gn,{className:"w-4 h-4 mr-1 text-gray-500"}),A.destinationCity]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shipper"}),e.jsxs("div",{className:"flex items-center text-gray-900",children:[e.jsx(to,{className:"w-4 h-4 mr-1 text-gray-500"}),((Ee=A.shipper)==null?void 0:Ee.name)||((me=A.shipper)==null?void 0:me.companyName)||"Unknown"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Status"}),oe(A.status)]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"COD Amount"}),e.jsxs("div",{className:"flex items-center text-gray-900",children:[e.jsx(ts,{className:"w-4 h-4 mr-1 text-gray-500"}),Re(A.codAmount)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Service Charges"}),e.jsxs("div",{className:"flex items-center text-gray-900",children:[e.jsx(ts,{className:"w-4 h-4 mr-1 text-gray-500"}),Re(A.serviceCharges)]})]}),A.assignedRider&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned Rider"}),e.jsxs("div",{className:"flex items-center text-gray-900",children:[e.jsx(gs,{className:"w-4 h-4 mr-1 text-gray-500"}),A.assignedRider.name]})]})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 mb-6",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(q1,{className:"w-5 h-5 mr-2 text-green-600"}),"Weight Verification"]}),A.isInvoiced&&e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(b2,{className:"w-5 h-5 text-yellow-600 mr-2"}),e.jsx("span",{className:"text-sm text-yellow-800",children:"This order is already invoiced. Weight cannot be changed."})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Current Weight: ",e.jsxs("span",{className:"font-semibold",children:[A.weightKg," kg"]})]}),A.weightSource&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Source: ",A.weightSource.replace("_"," ").toLowerCase(),A.weightVerifiedAt&&`  Verified: ${$(A.weightVerifiedAt)}`]})]}),!A.isInvoiced&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"override-weight",checked:_,onChange:ne=>L(ne.target.checked),className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"}),e.jsx("label",{htmlFor:"override-weight",className:"text-sm font-medium text-gray-700",children:"Verify/Override weight at warehouse"})]}),_&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Actual Weight (kg)"}),e.jsxs("div",{className:"relative",children:[e.jsx(q1,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"number",value:C,onChange:ne=>O(ne.target.value),step:"0.1",min:"0.1",max:"50",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"Enter actual weight"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This will recalculate service charges based on the new weight"})]})]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>w(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:P,children:"Cancel"}),e.jsx("button",{onClick:ce,disabled:P,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:P?e.jsxs(e.Fragment,{children:[e.jsx(Zi,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(x0,{className:"w-4 h-4 mr-2"}),"Confirm Scan"]})})]})]})})})]})})},tb=()=>{const[h,p]=D.useState([]),[f,y]=D.useState(!0),[v,N]=D.useState(""),[A,R]=D.useState(null),[j,w]=D.useState("today"),[C,O]=D.useState(null),{user:_}=Fs(),L=As(),P=b0(),V=(_==null?void 0:_.token)||Xs();D.useEffect(()=>{V&&(Y(),ee(),K())},[V,j]);const Y=async()=>{y(!0),N("");try{const ne=await fetch("/api/orders",{headers:{Authorization:`Bearer ${V}`}}),J=await ne.json();if(!ne.ok)throw new Error(J.message||"Failed to fetch orders");p(J)}catch(ne){N(ne.message)}finally{y(!1)}},ee=async()=>{try{const ne=await fetch("/api/orders/summary/manager",{headers:{Authorization:`Bearer ${V}`}}),J=await ne.json();ne.ok&&R(J)}catch{}},K=async()=>{try{const ne=await fetch(`/api/dashboard/manager?period=${j}`,{headers:{Authorization:`Bearer ${V}`}}),J=await ne.json();ne.ok&&O(J.stats)}catch{}},H=ne=>typeof ne=="number"||typeof ne=="string"?ne:"",q=ne=>{const J=Number(ne);return Number.isNaN(J)?"":J.toLocaleString()},te=[{label:"7 DAYS",value:"7days"},{label:"15 DAYS",value:"15days"},{label:"30 DAYS",value:"30days"}],ce=j==="month"?"30days":j,$=j==="7days"?"7 Days Orders":j==="15days"?"15 Days Orders":j==="month"?"30 Days Orders":"Today's Orders",Re=[{key:"totalOrders",icon:St,title:"Total Orders",value:(C==null?void 0:C.totalOrders)||0,colorClass:"text-gray-600"},{key:"unassignedOrders",icon:St,title:"Unassigned",value:(C==null?void 0:C.unassignedOrders)||0,colorClass:"text-amber-600"},{key:"assignedOrders",icon:ri,title:"Assigned",value:(C==null?void 0:C.assignedOrders)||0,colorClass:"text-blue-600"},{key:"warehouseOrdersCount",icon:St,title:"At Warehouse",value:(C==null?void 0:C.warehouseOrdersCount)||0,colorClass:"text-cyan-600"},{key:"completedOrders",icon:gs,title:"Delivered",value:(C==null?void 0:C.completedOrders)||0,colorClass:"text-green-700"},{key:"pendingOrders",icon:mn,title:"Pending",value:(C==null?void 0:C.pendingOrders)||0,colorClass:"text-orange-600"},{key:"totalCod",icon:ts,title:"Total COD",value:`PKR ${q((C==null?void 0:C.totalCod)||0)}`,colorClass:"text-green-600"},{key:"totalServiceCharges",icon:ts,title:"Service Charges",value:`PKR ${q((C==null?void 0:C.totalServiceCharges)||0)}`,colorClass:"text-emerald-600"}],oe=()=>{Y(),ee(),K()},Ee=()=>e.jsxs("div",{className:"space-y-8",children:[v&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:v}),e.jsx(y0,{heroTitle:$,heroCount:H(C==null?void 0:C.totalOrders),onRefresh:oe,kpis:[{prefix:"PKR",value:q(C==null?void 0:C.totalServiceCharges),label:"Service Charges"},{value:H((C==null?void 0:C.pendingOrders)||0),label:"Pending Orders"},{value:H((C==null?void 0:C.totalOrders)||0),label:"Total Orders"}],periodOptions:te,activePeriod:ce,onPeriodChange:ne=>{ne==="7days"?w("7days"):ne==="15days"?w("15days"):ne==="30days"&&w("month")},statCards:Re})]}),me=()=>e.jsxs("div",{className:"space-y-8",children:[v&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:v}),e.jsx("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-secondary",children:"Warehouse Operations"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Scan parcels to mark as arrived at LLL warehouse"})]}),e.jsxs("button",{onClick:()=>L("/manager/scanner"),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-hover flex items-center gap-2",children:[e.jsx(ii,{className:"w-4 h-4"}),"Scan Parcel"]})]})}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(St,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Manager Dashboard"})]}),e.jsx("button",{onClick:()=>{Y(),ee(),K()},className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Overview of orders and riders."})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:j==="7days"?"Last 7 Days Stats":j==="15days"?"Last 15 Days Stats":j==="month"?"This Month Stats":"Today's Stats"}),e.jsx("button",{onClick:K,className:"text-gray-400 hover:text-primary",children:e.jsx(Gn,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx("button",{onClick:()=>w("today"),className:`px-3 py-1.5 text-xs rounded-full ${j==="today"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"Today"}),e.jsx("button",{onClick:()=>w("7days"),className:`px-3 py-1.5 text-xs rounded-full ${j==="7days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"7 Days"}),e.jsx("button",{onClick:()=>w("15days"),className:`px-3 py-1.5 text-xs rounded-full ${j==="15days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"15 Days"}),e.jsx("button",{onClick:()=>w("month"),className:`px-3 py-1.5 text-xs rounded-full ${j==="month"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"This Month"})]})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(rs,{icon:St,title:"Total Orders",count:(C==null?void 0:C.totalOrders)||0}),e.jsx(rs,{icon:gs,title:"Completed Orders",count:(C==null?void 0:C.completedOrders)||0}),e.jsx(rs,{icon:mn,title:"Pending Orders",count:(C==null?void 0:C.pendingOrders)||0}),e.jsx(rs,{icon:ri,title:"Assigned Orders",count:(C==null?void 0:C.assignedOrders)||0}),e.jsx(rs,{icon:St,title:"Unassigned Orders",count:(C==null?void 0:C.unassignedOrders)||0}),e.jsx(rs,{icon:ts,title:"Total COD",count:`PKR ${((C==null?void 0:C.totalCod)||0).toLocaleString()}`}),e.jsx(rs,{icon:ts,title:"Total Service Charges",count:`PKR ${((C==null?void 0:C.totalServiceCharges)||0).toLocaleString()}`}),e.jsx(rs,{icon:St,title:"At LLL Warehouse",count:(C==null?void 0:C.warehouseOrdersCount)||0})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Today orders"}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:A?A.todayReceived:"-"})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Booked"}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:A?A.todayBooked:"-"})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Unbooked"}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:A?A.todayUnbooked:"-"})]}),e.jsx("div",{className:"bg-white p-5 rounded-xl border border-gray-100 md:col-span-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"In LLL Warehouse"}),e.jsx("h3",{className:"text-xl font-bold text-secondary",children:A?A.warehouseCount:"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Out for delivery"}),e.jsx("h3",{className:"text-xl font-bold text-secondary",children:A?A.outForDeliveryCount:"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Returned"}),e.jsx("h3",{className:"text-xl font-bold text-secondary",children:A?A.returnedCount:"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Delivery under review"}),e.jsx("h3",{className:"text-xl font-bold text-secondary",children:A?A.deliveryUnderReviewCount:"-"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Recent Orders"}),e.jsx(Sc,{to:"/manager/orders",className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"View All Orders"})]}),e.jsx("div",{className:"p-6",children:f?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading recent orders..."}):h.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No recent orders found."}):e.jsx("ul",{className:"space-y-3",children:h.slice(0,5).map(ne=>{var J,ae;return e.jsxs("li",{className:"border border-gray-100 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:((J=ne.shipper)==null?void 0:J.companyName)||((ae=ne.shipper)==null?void 0:ae.name)||"Unknown"}),e.jsx("span",{className:"font-mono text-xs",children:ne.bookingId})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.jsxs("span",{children:["Created: ",new Date(ne.createdAt).toLocaleString()]}),ne.assignedRider&&e.jsxs("span",{className:"ml-3",children:["Assigned to: ",ne.assignedRider.name]})]}),e.jsx("div",{className:"flex items-center justify-between mt-1",children:e.jsx("div",{className:"text-xs text-gray-500",children:ne.status})})]},ne._id)})})})]})]});return P?e.jsx(Ee,{}):e.jsx(me,{})},sb=()=>{var Q,Ne,Se;const[h,p]=D.useState([]),[f,y]=D.useState([]),[v,N]=D.useState(null),[A,R]=D.useState(!0),[j,w]=D.useState(""),[C,O]=D.useState(""),[_,L]=D.useState([]),[P,V]=D.useState(null),[Y,ee]=D.useState(null),[K,H]=D.useState(!1),[q,te]=D.useState("all"),[ce,$]=D.useState(""),[Re,oe]=D.useState("ALL"),Ee=typeof window<"u"?localStorage.getItem("token"):null,me=async()=>{R(!0),w("");try{const fe=await fetch("/api/orders",{headers:{Authorization:Ee?`Bearer ${Ee}`:""}}),E=await fe.json();if(!fe.ok)throw new Error(E.message||"Failed to fetch orders");p(E)}catch(fe){w(fe.message)}finally{R(!1)}},ne=async fe=>{if(fe&&fe.preventDefault(),V(null),!!C.trim())try{const E=await fetch(`/api/orders?q=${encodeURIComponent(C.trim())}`,{headers:{Authorization:Ee?`Bearer ${Ee}`:""}}),G=await E.json();E.ok&&Array.isArray(G)&&G.length>0?V(G[0]):V({notFound:!0})}catch{}};D.useEffect(()=>{(async()=>{if(!P||P.notFound){ee(null);return}try{const E=await fetch(`/api/finance/transactions/order/${P._id}`,{headers:{Authorization:Ee?`Bearer ${Ee}`:""}}),G=await E.json();E.ok?ee(G):ee(null)}catch{ee(null)}})()},[P]);const J=async(fe,E)=>{if(fe){H(!0),w("");try{const G=await fetch(`/api/finance/transactions/${fe}/settlement`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:Ee?`Bearer ${Ee}`:""},body:JSON.stringify({status:E})}),U=await G.json();if(!G.ok)throw new Error(U.message||"Failed to update settlement");if(ee(U),P&&P._id)try{const Z=await fetch(`/api/finance/transactions/order/${P._id}`,{headers:{Authorization:Ee?`Bearer ${Ee}`:""}}),we=await Z.json();Z.ok&&ee(we)}catch{}}catch(G){w(G.message)}finally{H(!1)}}},ae=async()=>{try{const fe=await fetch("/api/users/riders",{headers:{Authorization:Ee?`Bearer ${Ee}`:""}}),E=await fe.json();if(!fe.ok)throw new Error(E.message||"Failed to fetch riders");y(E)}catch{}};D.useEffect(()=>{me(),ae()},[]);const F=fn.useMemo(()=>{if(!Array.isArray(h))return[];let fe=h;if(q!=="all"){const E=new Date;let G=new Date(E),U=new Date(E);if(q==="today")G.setHours(0,0,0,0),U.setHours(23,59,59,999);else if(q==="week"){const Z=E.getDay(),we=Z===0?-6:1-Z;G=new Date(E),G.setDate(E.getDate()+we),G.setHours(0,0,0,0),U=new Date(G),U.setDate(G.getDate()+6),U.setHours(23,59,59,999)}else q==="month"&&(G=new Date(E.getFullYear(),E.getMonth(),1,0,0,0,0),U=new Date(E.getFullYear(),E.getMonth()+1,0,23,59,59,999));fe=fe.filter(Z=>{const we=new Date(Z==null?void 0:Z.createdAt);return Number.isNaN(we.getTime())?!1:we.getTime()>=G.getTime()&&we.getTime()<=U.getTime()})}return ce==="unassigned"?fe=fe.filter(E=>!E.assignedRider):ce&&(fe=fe.filter(E=>E.assignedRider&&E.assignedRider._id===ce)),Re==="PENDING"?fe=fe.filter(E=>!["DELIVERED","RETURNED","FAILED"].includes(E.status)):Re==="OUT_FOR_DELIVERY"?fe=fe.filter(E=>E.status==="OUT_FOR_DELIVERY"):Re==="DELIVERED"?fe=fe.filter(E=>E.status==="DELIVERED"):Re==="RETURNED"&&(fe=fe.filter(E=>E.status==="RETURNED")),fe},[h,q,ce,Re]);D.useEffect(()=>{const fe=C.trim().toLowerCase();if(fe.length<2){L([]);return}L(h.filter(E=>{var G,U,Z,we;return((G=E.bookingId)==null?void 0:G.toLowerCase().includes(fe))||((U=E.trackingId)==null?void 0:U.toLowerCase().includes(fe))||((Z=E.consigneeName)==null?void 0:Z.toLowerCase().includes(fe))||((we=E.destinationCity)==null?void 0:we.toLowerCase().includes(fe))}).slice(0,8))},[C,h]);const W=async(fe,E)=>{try{const G=await fetch(`/api/orders/${fe}/assign`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:Ee?`Bearer ${Ee}`:""},body:JSON.stringify({riderId:E||null})}),U=await G.json();if(!G.ok)throw new Error(U.message||"Failed to assign rider");N(null),await me()}catch(G){w(G.message)}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"All Orders"}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("form",{onSubmit:ne,className:"relative flex flex-wrap items-stretch gap-2 justify-end",children:[e.jsx(al,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:C,onChange:fe=>O(fe.target.value),type:"text",placeholder:"Enter Booking/Tracking ID",className:"pl-9 pr-4 py-1.5 text-sm border border-gray-200 rounded-lg"}),e.jsxs("select",{value:ce,onChange:fe=>$(fe.target.value),className:"pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white","aria-label":"Filter by Assigned Rider",children:[e.jsx("option",{value:"",children:"All Riders"}),e.jsx("option",{value:"unassigned",children:"Unassigned"}),f.map(fe=>e.jsx("option",{value:fe._id,children:fe.name||"Unnamed"},fe._id))]}),e.jsxs("select",{value:Re,onChange:fe=>oe(fe.target.value),className:"pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white","aria-label":"Filter by Order Status",children:[e.jsx("option",{value:"ALL",children:"All Statuses"}),e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"OUT_FOR_DELIVERY",children:"Out for Delivery"}),e.jsx("option",{value:"DELIVERED",children:"Delivered"}),e.jsx("option",{value:"RETURNED",children:"Returned"})]}),e.jsxs("select",{value:q,onChange:fe=>te(fe.target.value),className:"pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white","aria-label":"Filter by Date Range",children:[e.jsx("option",{value:"all",children:"All Orders"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"})]}),_.length>0&&e.jsx("ul",{className:"absolute left-0 top-full mt-1 w-80 bg-white border border-gray-200 rounded-lg shadow z-10",children:_.map(fe=>e.jsxs("li",{className:"px-3 py-2 text-sm hover:bg-gray-50 cursor-pointer",onMouseDown:()=>V(fe),children:[e.jsx("span",{className:"font-mono text-xs mr-2",children:fe.bookingId}),e.jsx("span",{children:fe.consigneeName}),e.jsxs("span",{className:"text-xs text-gray-500",children:[" "," ",fe.destinationCity]})]},fe._id))})]})})]}),e.jsxs("div",{className:"p-6",children:[j&&e.jsx("p",{className:"text-sm text-red-600",children:j}),A?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):F.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No orders found for selected filters."}):e.jsx("ul",{className:"space-y-3",children:F.map(fe=>{var E,G;return e.jsxs("li",{className:"border border-gray-100 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:((E=fe.shipper)==null?void 0:E.companyName)||((G=fe.shipper)==null?void 0:G.name)||"Unknown"}),e.jsx("span",{className:"font-mono text-xs",children:fe.bookingId})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.jsxs("span",{children:["Created: ",new Date(fe.createdAt).toLocaleString()]}),fe.assignedRider&&e.jsxs("span",{className:"ml-3",children:["Assigned to: ",fe.assignedRider.name]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("div",{className:"text-xs text-gray-500",children:fe.status}),e.jsxs("div",{className:"flex items-center gap-2",children:[(fe.status==="CREATED"||fe.assignedRider)&&e.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:()=>N(fe),children:fe.assignedRider?"Change Assignment":"Assign"}),e.jsx("button",{className:"px-2 py-1 text-xs border border-gray-200 rounded hover:bg-gray-50",onClick:()=>V(fe),children:"View Details"})]})]})]},fe._id)})})]})]}),P&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>V(null),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden",onClick:fe=>fe.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Order Detail"}),e.jsx("button",{onClick:()=>V(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(xn,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6 space-y-3 text-sm max-h-96 overflow-y-auto",children:P.notFound?e.jsx("p",{className:"text-red-600",children:"No order found"}):e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Order ID:"})," ",e.jsx("span",{className:"font-mono",children:P.bookingId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Tracking ID:"})," ",e.jsx("span",{className:"font-mono",children:P.trackingId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Shipper:"})," ",((Q=P.shipper)==null?void 0:Q.companyName)||((Ne=P.shipper)==null?void 0:Ne.name)||"Unknown"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Status:"})," ",e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded text-xs",children:P.status})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Consignee Name:"})," ",P.consigneeName]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Phone:"})," ",P.consigneePhone]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"City:"})," ",P.destinationCity]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Address:"})," ",P.consigneeAddress]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"COD Amount:"})," ","PKR ",Number(P.codAmount||0).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Pieces:"})," ",P.pieces||1]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Fragile:"})," ",P.fragile?"Yes":"No"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Weight:"})," ",P.weightKg||P.weight||"N/A"," kg"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Service Charges:"})," ","PKR ",Number(P.serviceCharges||0).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Total Charges:"})," ","PKR"," ",Number(P.totalAmount||(P.codAmount||0)+(P.serviceCharges||0)).toLocaleString()]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Remarks:"})," ",P.remarks||"N/A"]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Assigned Rider:"})," ",((Se=P.assignedRider)==null?void 0:Se.name)||"Unassigned"]}),Y&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Rider Commission:"})," ","PKR ",Number(Y.riderCommission||0).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Net Amount:"})," ","PKR"," ",Number((Y.totalCodCollected||0)-(Y.riderCommission||0)).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Settlement Status:"})," ",e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${String(Y.settlementStatus||"").toUpperCase()==="PAID"||String(Y.settlementStatus||"").toUpperCase()==="SETTLED"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:String(Y.settlementStatus||"").toUpperCase()==="PAID"||String(Y.settlementStatus||"").toUpperCase()==="SETTLED"?"Paid":"Unpaid"})]}),e.jsx("div",{className:"col-span-2",children:(()=>{const fe=String(Y.settlementStatus||"").toUpperCase()==="PAID"||String(Y.settlementStatus||"").toUpperCase()==="SETTLED";return e.jsx("button",{disabled:K,onClick:()=>J(Y._id,fe?"UNPAID":"PAID"),className:`mt-2 px-3 py-1 text-xs rounded border ${fe?"bg-gray-100 text-gray-700 hover:bg-gray-200 border-gray-200":"bg-primary text-white hover:bg-primary-hover border-primary"} disabled:opacity-50 disabled:cursor-not-allowed`,children:fe?"Mark Unpaid":"Mark Paid"})})()})]})]})}),e.jsx("div",{className:"p-4 flex justify-end gap-2 border-t border-gray-100",children:e.jsx("button",{className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>V(null),children:"Close"})})]})}),v&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Assign Rider"}),e.jsx("button",{onClick:()=>N(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(xn,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-2 max-h-80 overflow-y-auto",children:[e.jsxs("button",{onClick:()=>W(v._id,null),className:"w-full flex items-center gap-3 p-3 rounded-lg border border-red-200 hover:border-red-300 hover:bg-red-50 text-left mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-100 flex items-center justify-center text-red-600",children:e.jsx(xn,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-700",children:"Unassign"}),e.jsx("div",{className:"text-xs text-red-500",children:"Remove rider assignment"})]})]}),f.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No riders found."}),f.map(fe=>e.jsxs("button",{onClick:()=>W(v._id,fe._id),className:"w-full flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-primary hover:bg-primary/5 text-left",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600",children:e.jsx(gs,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-secondary",children:fe.name}),e.jsx("div",{className:"text-xs text-gray-500",children:fe.email})]})]},fe._id))]})]})})]})},Cc=h=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0}).format(Number(h||0)),ab=h=>{if(!h)return"";const p=new Date(h);return Number.isNaN(p.getTime())?"":p.toLocaleString()},lx=()=>{const[h,p]=D.useState([]),[f,y]=D.useState(!0),[v,N]=D.useState(""),[A,R]=D.useState(null),[j,w]=D.useState(new Date().toISOString().split("T")[0]),{user:C}=Fs(),O=(C==null?void 0:C.token)||Xs(),[_,L]=D.useState(null),[P,V]=D.useState({summary:null,items:[],page:1,totalPages:1,total:0}),[Y,ee]=D.useState(!1),[K,H]=D.useState(""),[q,te]=D.useState(""),[ce,$]=D.useState(""),[Re,oe]=D.useState(""),[Ee,me]=D.useState("all"),[ne,J]=D.useState("all"),[ae,F]=D.useState("desc"),[W,Q]=D.useState(""),[Ne,Se]=D.useState(1),[fe,E]=D.useState(""),[G,U]=D.useState([]),[Z,we]=D.useState(!1),xe=async()=>{y(!0),N("");try{const Oe=await fetch("/api/riders/finance",{headers:{Authorization:`Bearer ${O}`}}),mt=await Oe.json();if(!Oe.ok)throw new Error(mt.message||"Failed to fetch riders");p(mt)}catch(Oe){N(Oe.message)}finally{y(!1)}},Ge=async()=>{if(O)try{const Oe=await fetch("/api/users/shippers?active=true",{headers:{Authorization:`Bearer ${O}`}}),mt=await Oe.json();Oe.ok&&Array.isArray(mt)&&U(mt)}catch{}},Ve=async(Oe,mt)=>{try{const yt=mt==="paid"?"unpaid":"paid",Ze=await fetch(`/api/riders/${Oe}/service-charges-status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${O}`},body:JSON.stringify({status:yt})});if(Ze.ok)await xe();else{const Xe=await Ze.json();N(Xe.message||"Failed to update status")}}catch(yt){N(yt.message)}},Je=async(Oe,mt={})=>{if(!Oe||!O)return;const yt=Oe._id;ee(!0),H(""),te("");try{const Ze=new URLSearchParams,Xe=mt.from??ce,Tt=mt.to??Re,He=mt.status??Ee,ye=mt.settlement??ne,Fe=mt.sortOrder??ae,We=mt.page??Ne,rt=mt.shipperId??fe,st=mt.search??W;Xe&&Ze.set("from",Xe),Tt&&Ze.set("to",Tt),He&&He!=="all"&&Ze.set("status",He),ye&&ye!=="all"&&Ze.set("settlement",ye),Fe&&(Fe==="asc"||Fe==="desc")&&Ze.set("sortOrder",Fe),rt&&Ze.set("shipperId",rt),st&&st.trim()&&Ze.set("search",st.trim()),Ze.set("page",String(We)),Ze.set("limit","20");const _s=await fetch(`/api/riders/${yt}/settlements?${Ze.toString()}`,{headers:{Authorization:`Bearer ${O}`}}),pt=await _s.json();if(!_s.ok)throw new Error(pt.message||"Failed to load rider settlements");V(pt),Se(pt.page||We)}catch(Ze){H(Ze.message||"Failed to load rider settlements")}finally{ee(!1)}},jt=Oe=>{L(Oe),$(""),oe(""),me("all"),J("all"),F("desc"),Q(""),E(""),Se(1),H(""),te(""),Je(Oe,{page:1})},Be=async()=>{_&&(Se(1),await Je(_,{page:1}))},lt=async()=>{_&&($(""),oe(""),me("all"),J("all"),F("desc"),Q(""),E(""),Se(1),await Je(_,{from:"",to:"",status:"all",settlement:"all",sortOrder:"desc",page:1,shipperId:"",search:""}))},Ke=async(Oe,mt)=>{if(!Oe||!_||!O)return;const yt=mt==="PAID"?"UNPAID":"PAID";we(!0),H(""),te("");try{const Ze=await fetch(`/api/orders/${Oe}/rider-settlement`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${O}`},body:JSON.stringify({status:yt})}),Xe=await Ze.json();if(!Ze.ok)throw new Error(Xe.message||"Failed to update rider settlement");te(yt==="PAID"?"Rider settlement marked as Paid":"Rider settlement marked as Unpaid"),await Je(_,{page:Ne})}catch(Ze){H(Ze.message||"Failed to update rider settlement")}finally{we(!1)}},ft=async(Oe,mt)=>{try{const yt=await fetch(`/api/riders/${Oe}/daily-report?date=${j}`,{headers:{Authorization:`Bearer ${O}`}});if(!yt.ok)throw new Error("Failed to download report");const Ze=await yt.blob(),Xe=window.URL.createObjectURL(Ze),Tt=document.createElement("a");Tt.href=Xe,Tt.download=`rider-${mt}-${j}.xlsx`,document.body.appendChild(Tt),Tt.click(),window.URL.revokeObjectURL(Xe),document.body.removeChild(Tt)}catch(yt){N(yt.message)}};return D.useEffect(()=>{O&&(xe(),Ge())},[O]),e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(gs,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Riders Finance"})]})}),v&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:v}),e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:f?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[e.jsx("th",{className:"py-3 px-4",children:"Rider Name"}),e.jsx("th",{className:"py-3 px-4",children:"Assigned Orders"}),e.jsx("th",{className:"py-3 px-4",children:"COD Collected"}),e.jsx("th",{className:"py-3 px-4",children:"Service Charges"}),e.jsx("th",{className:"py-3 px-4",children:"Status"}),e.jsx("th",{className:"py-3 px-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:h.map(Oe=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:Oe.name}),e.jsx("div",{className:"text-xs text-gray-500",children:Oe.email})]})}),e.jsx("td",{className:"py-3 px-4",children:Oe.assignedOrders||0}),e.jsxs("td",{className:"py-3 px-4",children:["PKR ",Number(Oe.codCollected||0).toLocaleString()]}),e.jsxs("td",{className:"py-3 px-4",children:["PKR ",Number(Oe.serviceCharges||0).toLocaleString()]}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Oe.serviceChargeStatus==="paid"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Oe.serviceChargeStatus==="paid"?"Paid":"Unpaid"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Ve(Oe._id,Oe.serviceChargeStatus),className:`px-3 py-1 text-xs rounded ${Oe.serviceChargeStatus==="paid"?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-primary text-white hover:bg-primary-hover"}`,children:Oe.serviceChargeStatus==="paid"?"Mark Unpaid":"Mark Paid"}),e.jsxs("button",{onClick:()=>ft(Oe._id,Oe.name),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 flex items-center gap-1",children:[e.jsx(Rc,{className:"w-3 h-3"}),"Report"]}),e.jsx("button",{onClick:()=>jt(Oe),className:"px-3 py-1 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200",children:"Settlements"})]})})]},Oe._id))})]})})}),_&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>{L(null),H(""),te("")},children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",onClick:Oe=>Oe.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-secondary",children:["Rider Settlements - ",_.name]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Order-level rider earnings and settlement status for this rider."})]}),e.jsx("button",{onClick:()=>{L(null),H(""),te("")},className:"text-gray-400 hover:text-gray-600",children:e.jsx(p0,{className:"w-5 h-5"})})]}),K&&e.jsx("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-100 text-red-600 text-xs rounded",children:K}),q&&!K&&e.jsx("div",{className:"mx-6 mt-4 p-3 bg-green-50 border border-green-100 text-green-700 text-xs rounded",children:q}),e.jsxs("div",{className:"p-6 pt-4 space-y-5 overflow-y-auto",children:[(()=>{const Oe=P.summary||{};return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500",children:"Delivered (range)"}),e.jsx("div",{className:"mt-1 text-xl font-bold text-secondary",children:Oe.deliveredCount||0})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500",children:"Returned (range)"}),e.jsx("div",{className:"mt-1 text-xl font-bold text-secondary",children:Oe.returnedCount||0})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500",children:"Failed (range)"}),e.jsx("div",{className:"mt-1 text-xl font-bold text-secondary",children:Oe.failedCount||0})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500",children:"Rider Earnings (range)"}),e.jsx("div",{className:"mt-1 text-sm font-bold text-secondary",children:Cc(Oe.riderEarnings||0)})]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500",children:"Unpaid Balance (range)"}),e.jsx("div",{className:"mt-1 text-sm font-bold text-red-600",children:Cc(Oe.unpaidBalance||0)})]})]})})(),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-secondary",children:[e.jsx(sl,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:"Filters"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(al,{className:"w-4 h-4"}),e.jsx("input",{type:"text",value:W,onChange:Oe=>Q(Oe.target.value),placeholder:"Search by Order ID / Tracking ID",className:"px-3 py-1.5 border border-gray-200 rounded-lg text-xs"})]})]}),e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[11px] text-gray-500 mb-1",children:"From"}),e.jsx("input",{type:"date",value:ce,onChange:Oe=>$(Oe.target.value),className:"px-3 py-2 text-xs border border-gray-200 rounded-lg"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[11px] text-gray-500 mb-1",children:"To"}),e.jsx("input",{type:"date",value:Re,onChange:Oe=>oe(Oe.target.value),className:"px-3 py-2 text-xs border border-gray-200 rounded-lg"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[11px] text-gray-500 mb-1",children:"Status"}),e.jsxs("select",{value:Ee,onChange:Oe=>me(Oe.target.value),className:"px-3 py-2 text-xs border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"returned",children:"Returned"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[11px] text-gray-500 mb-1",children:"Settlement"}),e.jsxs("select",{value:ne,onChange:Oe=>J(Oe.target.value),className:"px-3 py-2 text-xs border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"unpaid",children:"Unpaid"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[11px] text-gray-500 mb-1",children:"Shipper"}),e.jsxs("select",{value:fe,onChange:Oe=>E(Oe.target.value),className:"px-3 py-2 text-xs border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"",children:"All"}),G.map(Oe=>e.jsx("option",{value:Oe._id,children:(Oe.companyName||Oe.name||"Unnamed")+(Oe.email?` - ${Oe.email}`:"")},Oe._id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[11px] text-gray-500 mb-1",children:"Sort by Date"}),e.jsxs("select",{value:ae,onChange:Oe=>{F(Oe.target.value),Se(1),_&&Je(_,{sortOrder:Oe.target.value,page:1})},className:"px-3 py-2 text-xs border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"desc",children:"Newest First"}),e.jsx("option",{value:"asc",children:"Oldest First"})]})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx(zt,{onClick:Be,className:"text-xs",children:"Apply"}),e.jsx(zt,{variant:"outline",onClick:lt,className:"text-xs",children:"Reset"})]})]}),e.jsx("div",{className:"overflow-x-auto border-t border-gray-100",children:e.jsxs("table",{className:"min-w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-gray-500 border-b",children:[e.jsx("th",{className:"py-2 px-3 text-left",children:"Date/Time"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Order / CN"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Shipper"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Consignee"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Destination"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"Weight (kg)"}),e.jsx("th",{className:"py-2 px-3 text-left",children:"Weight Bracket"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"COD"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"Rider Earning"}),e.jsx("th",{className:"py-2 px-3 text-center",children:"Status"}),e.jsx("th",{className:"py-2 px-3 text-center",children:"Settlement"}),e.jsx("th",{className:"py-2 px-3 text-center",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:Y?e.jsx("tr",{children:e.jsx("td",{colSpan:12,className:"py-8 px-3 text-center text-gray-500 text-xs",children:"Loading settlements..."})}):(P.items||[]).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:12,className:"py-8 px-3 text-center text-gray-500 text-xs",children:"No orders found for selected filters."})}):(P.items||[]).map(Oe=>{const mt=Oe.settlementStatus==="PAID";return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-2 px-3 whitespace-nowrap",children:ab(Oe.date)}),e.jsx("td",{className:"py-2 px-3",children:e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{className:"font-mono text-[11px]",children:Oe.orderId||""})})}),e.jsx("td",{className:"py-2 px-3 text-xs",children:Oe.shipperName||""}),e.jsx("td",{className:"py-2 px-3 text-xs",children:Oe.consigneeName||""}),e.jsx("td",{className:"py-2 px-3 text-xs",children:Oe.destination||""}),e.jsx("td",{className:"py-2 px-3 text-right",children:Number(Oe.weightKg||0).toFixed(2)}),e.jsx("td",{className:"py-2 px-3 text-xs",children:Oe.weightBracketLabel||""}),e.jsx("td",{className:"py-2 px-3 text-right",children:Cc(Oe.codAmount||0)}),e.jsx("td",{className:"py-2 px-3 text-right font-semibold text-secondary",children:Cc(Oe.riderEarning||0)}),e.jsx("td",{className:"py-2 px-3 text-center",children:e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-gray-100 text-gray-700 text-[11px]",children:Oe.status||""})}),e.jsx("td",{className:"py-2 px-3 text-center",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] ${mt?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:mt?"Paid":"Unpaid"})}),e.jsx("td",{className:"py-2 px-3 text-center",children:e.jsx("button",{disabled:Z,onClick:()=>Ke(Oe.id,Oe.settlementStatus),className:`px-3 py-1 text-[11px] rounded border ${mt?"bg-gray-100 text-gray-700 hover:bg-gray-200 border-gray-200":"bg-primary text-white hover:bg-primary-hover border-primary"} disabled:opacity-50 disabled:cursor-not-allowed`,children:mt?"Mark Unpaid":"Mark Paid"})})]},Oe.id)})})]})}),e.jsxs("div",{className:"p-3 border-t border-gray-100 flex items-center justify-between text-[11px] text-gray-500",children:[e.jsxs("div",{children:["Showing page ",P.page||1," of"," ",P.totalPages||1," (Total ",P.total||0,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{const Oe=Math.max(1,(P.page||1)-1);Se(Oe),_&&Je(_,{page:Oe})},disabled:(P.page||1)<=1||Y,className:"px-3 py-1.5 rounded border border-gray-200 bg-gray-50 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Prev"}),e.jsx("button",{onClick:()=>{const Oe=Math.min(P.totalPages||1,(P.page||1)+1);Se(Oe),_&&Je(_,{page:Oe})},disabled:(P.page||1)>=(P.totalPages||1)||Y,className:"px-3 py-1.5 rounded border border-gray-200 bg-gray-50 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})]})}),A&&e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("h4",{className:"font-bold mb-4",children:"Download Daily Report"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"date",value:j,onChange:Oe=>w(Oe.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg"}),e.jsxs(zt,{onClick:()=>ft(A._id,A.name),children:[e.jsx(Rc,{className:"w-4 h-4"})," Download"]})]})]})]})},ox=()=>{const[h,p]=D.useState([]),[f,y]=D.useState([]),[v,N]=D.useState([]),[A,R]=D.useState([]),[j,w]=D.useState(!0),[C,O]=D.useState(""),[_,L]=D.useState(""),[P,V]=D.useState({type:"FLAT",value:0,weightBrackets:[{minKg:0,maxKg:1,charge:100}]}),[Y,ee]=D.useState({riderId:"",rules:[{status:"DELIVERED",type:"FLAT",value:""},{status:"RETURNED",type:"FLAT",value:""},{status:"FAILED",type:"FLAT",value:""}]}),K=typeof window<"u"?localStorage.getItem("token"):null,{showToast:H}=Kx(),q=async()=>{w(!0),O("");try{const[J,ae,F,W]=await Promise.all([fetch("/api/users/shippers",{headers:{Authorization:K?`Bearer ${K}`:""}}),fetch("/api/users/riders",{headers:{Authorization:K?`Bearer ${K}`:""}}),fetch("/api/commission",{headers:{Authorization:K?`Bearer ${K}`:""}}),fetch("/api/commission/rider",{headers:{Authorization:K?`Bearer ${K}`:""}})]),Q=await J.json(),Ne=await ae.json(),Se=await F.json(),fe=await W.json();if(!J.ok)throw new Error(Q.message||"Failed to fetch shippers");if(!ae.ok)throw new Error(Ne.message||"Failed to fetch riders");if(!F.ok)throw new Error(Se.message||"Failed to fetch commissions");if(!W.ok)throw new Error(fe.message||"Failed to fetch rider commissions");const E=(Q||[]).filter(U=>U.role==="SHIPPER"),G=(Ne||[]).filter(U=>U.role==="RIDER");p(E),N(G),y(Se),R(fe),E.length&&!_&&L(E[0]._id),G.length&&!Y.riderId&&ee(U=>({...U,riderId:G[0]._id}))}catch(J){O(J.message)}finally{w(!1)}},te=async J=>{if(J)try{O("");const ae=await fetch(`/api/commission/${J}`,{headers:{Authorization:K?`Bearer ${K}`:""}});if(ae.ok){const F=await ae.json();V({type:F.type||"FLAT",value:typeof F.value=="number"&&!Number.isNaN(F.value)?F.value:0,weightBrackets:F.weightBrackets&&F.weightBrackets.length>0?F.weightBrackets:[{minKg:0,maxKg:1,charge:100}]})}else if(ae.status===404)V({type:"FLAT",value:0,weightBrackets:[{minKg:0,maxKg:1,charge:100}]});else{const F=await ae.json();throw new Error(F.message||"Failed to load config")}}catch(ae){O(ae.message)}};D.useEffect(()=>{q()},[]),D.useEffect(()=>{_&&te(_)},[_]);const ce=J=>{if(!Array.isArray(J)||J.length===0)return{valid:!1,message:"At least one weight bracket is required"};const ae=J.map((F,W)=>{const Q=F.minKg,Ne=F.maxKg,Se=F.charge,fe=Q===""||Q===null||Q===void 0?NaN:Number(Q),E=Ne===""||Ne===null||Ne===void 0?null:Number(Ne),G=Se===""||Se===null||Se===void 0?NaN:Number(Se);return{index:W,minKg:fe,maxKg:E,charge:G}}).sort((F,W)=>F.minKg-W.minKg);for(let F=0;F<ae.length;F++){const W=ae[F];if(!Number.isFinite(W.minKg)||W.minKg<0)return{valid:!1,message:`Invalid minimum weight for bracket ${F+1}`};if(!Number.isFinite(W.charge)||W.charge<0)return{valid:!1,message:`Invalid charge for bracket ${F+1}`};if(W.maxKg!==null&&(!Number.isFinite(W.maxKg)||W.maxKg<=W.minKg))return{valid:!1,message:`Maximum weight must be greater than minimum weight for bracket ${F+1}`};if(F>0){const Q=ae[F-1];if(Q.maxKg!==null&&W.minKg<Q.maxKg)return{valid:!1,message:`Overlap between ${Q.minKg}-${Q.maxKg}kg and ${W.minKg}-${W.maxKg||""}kg`}}if(W.maxKg===null&&F!==ae.length-1)return{valid:!1,message:"Only the last bracket can have unlimited maximum weight"}}return{valid:!0}},$=async()=>{try{O("");const J=ce(P.weightBrackets);if(!J.valid){O(J.message);return}const ae={type:P.type||"FLAT",value:typeof P.value=="number"?P.value:Number(P.value)||0,weightBrackets:P.weightBrackets.map(Ne=>({minKg:Number(Ne.minKg),maxKg:Ne.maxKg===""||Ne.maxKg===null||Ne.maxKg===void 0?null:Number(Ne.maxKg),charge:Number(Ne.charge)}))},F=await fetch(`/api/commission/${_}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:K?`Bearer ${K}`:""},body:JSON.stringify(ae)}),W=await F.json();if(!F.ok)throw new Error(W.message||"Failed to save commission");await q();const Q=h.find(Ne=>Ne._id===_);H({type:"success",title:"Commission saved",description:Q?`Commission configuration updated for ${Q.name}.`:"Commission configuration saved."})}catch(J){O(J.message),H({type:"error",title:"Commission error",description:J.message||"Failed to save commission."})}},Re=async()=>{try{O("");const J={riderId:Y.riderId,rules:Y.rules.map(Q=>({...Q,value:Number(Q.value)}))},ae=await fetch("/api/commission/rider",{method:"POST",headers:{"Content-Type":"application/json",Authorization:K?`Bearer ${K}`:""},body:JSON.stringify(J)}),F=await ae.json();if(!ae.ok)throw new Error(F.message||"Failed to save rider commission");await q();const W=v.find(Q=>Q._id===Y.riderId);H({type:"success",title:"Rider commission saved",description:W?`Commission rules updated for ${W.name}.`:"Rider commission rules saved."})}catch(J){O(J.message),H({type:"error",title:"Rider commission error",description:J.message||"Failed to save rider commission."})}},oe=()=>{const J=P.weightBrackets[P.weightBrackets.length-1],ae=J&&J.maxKg!=null?J.maxKg:0;V(F=>({...F,weightBrackets:[...F.weightBrackets,{minKg:ae,maxKg:ae+1,charge:0}]}))},Ee=J=>{if(P.weightBrackets.length<=1){O("At least one weight bracket is required");return}V(ae=>({...ae,weightBrackets:ae.weightBrackets.filter((F,W)=>W!==J)}))},me=(J,ae,F)=>{V(W=>({...W,weightBrackets:W.weightBrackets.map((Q,Ne)=>Ne===J?{...Q,[ae]:F}:Q)}))},ne=ce(P.weightBrackets);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(iy,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Commission Settings"})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Set per-shipper company commission and dynamic weight-based service charges."})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm max-w-4xl",children:[C&&e.jsx("p",{className:"text-sm text-red-600 mb-4",children:C}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Shipper"}),e.jsx("select",{value:_,onChange:J=>L(J.target.value),className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white",children:h.map(J=>e.jsxs("option",{value:J._id,children:[J.name," (",J.email,")"]},J._id))})]})}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-md font-semibold text-secondary",children:"Weight-Based Service Charges"}),e.jsxs("button",{onClick:oe,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-primary hover:bg-primary-hover text-white rounded-lg",children:[e.jsx(n0,{className:"w-4 h-4"}),"Add Bracket"]})]}),e.jsx("div",{className:"space-y-3",children:P.weightBrackets.map((J,ae)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 items-end p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Weight (kg)"}),e.jsx("input",{type:"number",step:"0.1",min:"0",value:J.minKg||"",onChange:F=>me(ae,"minKg",F.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-200 bg-white text-sm",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Weight (kg)"}),e.jsx("input",{type:"number",step:"0.1",min:"0",value:J.maxKg||"",onChange:F=>me(ae,"maxKg",F.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-200 bg-white text-sm",placeholder:"Leave empty for "})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Charge (PKR)"}),e.jsx("input",{type:"number",min:"0",value:J.charge||"",onChange:F=>me(ae,"charge",F.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-200 bg-white text-sm",placeholder:"0"})]}),e.jsxs("div",{className:"text-sm text-gray-600 self-center",children:[J.minKg||0,"kg - ",J.maxKg||"","kg"]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>Ee(ae),disabled:P.weightBrackets.length<=1,className:`p-2 rounded-lg ${P.weightBrackets.length<=1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-red-100 hover:bg-red-200 text-red-600"}`,children:e.jsx(g0,{className:"w-4 h-4"})})})]},ae))}),!ne.valid&&e.jsx("p",{className:"text-sm text-red-600 mt-2",children:ne.message})]}),e.jsx("div",{className:"flex justify-end gap-3 mt-6",children:e.jsx("button",{onClick:$,disabled:!ne.valid||!_,className:`px-6 py-2 rounded-lg text-sm ${!ne.valid||!_?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-primary hover:bg-primary-hover text-white"}`,children:"Save Configuration"})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm max-w-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(gs,{className:"w-5 h-5 text-primary"}),e.jsx("h4",{className:"text-md font-semibold text-secondary",children:"Rider Commission by Status"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Rider"}),e.jsx("select",{value:Y.riderId,onChange:J=>ee({...Y,riderId:J.target.value}),className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white",children:v.map(J=>e.jsxs("option",{value:J._id,children:[J.name," (",J.email,")"]},J._id))})]}),Y.rules.map((J,ae)=>e.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Status"}),e.jsx("input",{value:J.status,readOnly:!0,className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Type"}),e.jsxs("select",{value:J.type,onChange:F=>{const W=F.target.value;ee(Q=>({...Q,rules:Q.rules.map((Ne,Se)=>Se===ae?{...Ne,type:W}:Ne)}))},className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white",children:[e.jsx("option",{value:"FLAT",children:"FLAT"}),e.jsx("option",{value:"PERCENTAGE",children:"PERCENTAGE"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Value"}),e.jsx("input",{type:"number",value:J.value,onChange:F=>{const W=F.target.value;ee(Q=>({...Q,rules:Q.rules.map((Ne,Se)=>Se===ae?{...Ne,value:W}:Ne)}))},className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white",placeholder:J.type==="PERCENTAGE"?"5 for 5%":"100 for PKR 100"})]})]},J.status))]}),e.jsx("div",{className:"flex justify-end gap-3 mt-4",children:e.jsx("button",{onClick:Re,className:"px-4 py-2 rounded-lg bg-primary hover:bg-primary-hover text-white text-sm",children:"Save Rider Rules"})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Current Configurations"}),e.jsx("button",{onClick:q,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2 px-3",children:"Shipper"}),e.jsx("th",{className:"py-2 px-3",children:"Weight Brackets"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:f.map(J=>{var ae;return e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3",children:((ae=J.shipper)==null?void 0:ae.name)||J.shipper}),e.jsx("td",{className:"py-2 px-3",children:J.weightBrackets&&J.weightBrackets.length>0?e.jsx("div",{className:"space-y-1",children:J.weightBrackets.map((F,W)=>e.jsxs("div",{className:"text-xs text-gray-600",children:[F.minKg,"kg - ",F.maxKg||"","kg: PKR"," ",F.charge]},W))}):e.jsx("span",{className:"text-gray-400",children:"No brackets"})})]},J._id)})})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Current Rider Commissions"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2 px-3",children:"Rider"}),e.jsx("th",{className:"py-2 px-3",children:"Type"}),e.jsx("th",{className:"py-2 px-3",children:"Value"}),e.jsx("th",{className:"py-2 px-3",children:"Rules"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:A.map(J=>{var ae;return e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3",children:((ae=J.rider)==null?void 0:ae.name)||J.rider}),e.jsx("td",{className:"py-2 px-3",children:J.type}),e.jsx("td",{className:"py-2 px-3",children:J.type==="PERCENTAGE"?`${J.value}%`:`PKR ${Number(J.value||0).toLocaleString()}`}),e.jsx("td",{className:"py-2 px-3",children:Array.isArray(J.rules)&&J.rules.length?e.jsx("div",{className:"space-y-1",children:J.rules.map(F=>e.jsxs("div",{className:"text-xs text-gray-600",children:[F.status,":"," ",F.type==="PERCENTAGE"?`${F.value}%`:`PKR ${Number(F.value||0).toLocaleString()}`]},F.status))}):""})]},J._id)})})]})})]})]})},Un=({children:h,className:p=""})=>e.jsx("div",{className:`bg-white border border-gray-200 rounded-xl shadow-sm ${p}`,children:h}),Xi=({children:h,className:p=""})=>e.jsx("h3",{className:`text-lg font-semibold text-gray-900 ${p}`,children:h}),ni=({label:h,value:p,icon:f})=>e.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[f&&e.jsx(f,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600",children:[h,":"]}),e.jsx("span",{className:"text-gray-900 font-medium ml-2",children:p})]})]}),Wl=({label:h,value:p,type:f="default",children:y})=>e.jsxs("div",{className:`flex justify-between items-center py-3 px-0 ${f==="total"?"border-t-2 border-gray-300 pt-4 mt-2":"border-b border-gray-100"}`,children:[e.jsxs("span",{className:`text-sm ${f==="total"?"font-bold text-gray-900":"text-gray-700"}`,children:[h,":"]}),y||e.jsx("span",{className:`text-sm ${f==="total"?"text-lg font-bold text-green-600":"font-semibold text-gray-900"}`,children:p})]}),cx=({status:h,invoiced:p})=>{if(p)return e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(Yn,{className:"w-3 h-3 mr-1"}),"Paid"]});const f={CREATED:{bg:"bg-blue-100",text:"text-blue-800",icon:mn},DELIVERED:{bg:"bg-green-100",text:"text-green-800",icon:Yn},IN_TRANSIT:{bg:"bg-yellow-100",text:"text-yellow-800",icon:mn},FAILED:{bg:"bg-red-100",text:"text-red-800",icon:Xn}},y=f[h]||f.CREATED,v=y.icon;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium ${y.bg} ${y.text}`,children:[e.jsx(v,{className:"w-3 h-3 mr-1"}),h||"Unpaid"]})},dx=()=>{const[h,p]=D.useState(!1),[f,y]=D.useState(""),[v,N]=D.useState(""),[A,R]=D.useState(null),[j,w]=D.useState(""),[C,O]=D.useState(""),[_,L]=D.useState(""),[P,V]=D.useState(""),[Y,ee]=D.useState(new Date().toISOString().split("T")[0]),[K,H]=D.useState(""),[q,te]=D.useState(""),[ce,$]=D.useState("uninvoiced"),[Re,oe]=D.useState("100"),[Ee,me]=D.useState(0),[ne,J]=D.useState(0),[ae,F]=D.useState(0),[W,Q]=D.useState(0),[Ne,Se]=D.useState(0),[fe,E]=D.useState(0),[G,U]=D.useState([]),[Z,we]=D.useState([]),[xe,Ge]=D.useState(new Set),[Ve,Je]=D.useState(null),[jt,Be]=D.useState(!0);console.log(" Current selectedParcelIds state:",Array.from(xe));const lt=localStorage.getItem("token"),{showToast:Ke}=Kx();D.useEffect(()=>{Oe(),yt(),mt()},[]),D.useEffect(()=>{j&&K&&q&&Ze()},[j,K,q,ce]);const ft=G.find(ue=>ue._id===j),Oe=async()=>{try{const ue=await fetch("/api/invoice/shippers",{headers:{Authorization:`Bearer ${lt}`}}),ze=await ue.json();ue.ok&&Array.isArray(ze)&&U(ze)}catch{y("Failed to load customers")}},mt=async()=>{try{Be(!0);const ue=await fetch("/api/company-profile/public"),ze=await ue.json();ue.ok&&ze.success?Je(ze.data):(console.warn("Failed to load company profile, using defaults"),Je({companyName:"LahoreLink Courier Services",logoUrl:"",address:{line1:"Office # 123, Main Boulevard, Gulberg III",city:"Lahore",country:"Pakistan"},phone:"+92-42-111-LINK (5465)",email:"finance@lahorelink.com",website:"www.lahorelink.com",footerNote:"For support contact: +92-42-111-LINK (5465) | Email: support@lahorelink.com"}))}catch(ue){console.error("Error loading company profile:",ue),Je({companyName:"LahoreLink Courier Services",logoUrl:"",address:{line1:"Office # 123, Main Boulevard, Gulberg III",city:"Lahore",country:"Pakistan"},phone:"+92-42-111-LINK (5465)",email:"finance@lahorelink.com",website:"www.lahorelink.com",footerNote:"For support contact: +92-42-111-LINK (5465) | Email: support@lahorelink.com"})}finally{Be(!1)}},yt=async()=>{try{const ue=await fetch("/api/invoice/next-number",{headers:{Authorization:`Bearer ${lt}`}}),ze=await ue.json();ue.ok&&O(ze.invoiceNumber)}catch{console.error("Failed to get next invoice number")}},Ze=async()=>{try{p(!0);const ue=new URLSearchParams({shipperId:j,from:K,to:q,list:ce}),ze=await fetch(`/api/invoice/orders?${ue}`,{headers:{Authorization:`Bearer ${lt}`}}),Ue=await ze.json();if(ze.ok&&Array.isArray(Ue)){console.log("Orders loaded from API:",Ue);const Te=Ue.map(Ye=>({...Ye,_id:Ye._id||Ye.id,invoice:Ye.invoice||null,bookingId:Ye.bookingId||Ye.trackingId||"N/A",serviceCharges:Number(Ye.serviceCharges||0),codAmount:Number(Ye.codAmount||0),weightKg:Number(Ye.weightKg||0)}));console.log("Validated orders:",Te),Te.forEach(Ye=>{console.log(` Order ${Ye.bookingId||Ye._id}: invoice=${Ye.invoice}, isInvoiced=${Ye.invoice!==null&&Ye.invoice!==void 0}`)});const ot=Te.filter(Ye=>Ye.invoice===null||Ye.invoice===void 0);console.log(` Total orders: ${Te.length}, Uninvoiced: ${ot.length}`),we(Te),Ge(new Set)}else console.error("Failed to load orders:",Ue),we([]),y(Ue.message||"Failed to load orders")}catch{y("Failed to load orders")}finally{p(!1)}},Xe=ue=>{console.log(" CHECKBOX CLICKED - Order ID:",ue),console.log(" Current selectedParcelIds:",Array.from(xe));const ze=Z.find(Ue=>Ue._id===ue);if(!ze){console.error(" Order not found:",ue);return}if(console.log(" Order details:",{id:ze._id,bookingId:ze.bookingId,invoice:ze.invoice,isInvoiced:ze.invoice!==null&&ze.invoice!==void 0}),ze.invoice!==null&&ze.invoice!==void 0){console.log(" Order already invoiced, cannot select:",ue);return}console.log(" Proceeding with selection toggle"),Ge(Ue=>{console.log(" State update - Previous selection:",Array.from(Ue));const Te=new Set(Ue);return Te.has(ue)?(Te.delete(ue),console.log(" Deselected order:",ue)):(Te.add(ue),console.log(" Selected order:",ue)),console.log(" New selection:",Array.from(Te)),console.log(" New selection size:",Te.size),Te})},Tt=()=>{console.log(" SELECT ALL BUTTON CLICKED");const ue=Z.filter(ot=>ot.invoice===null||ot.invoice===void 0);if(console.log(" Select all analysis:"),console.log("  - Total orders:",Z.length),console.log("  - Uninvoiced orders:",ue.length),console.log("  - Current selection size:",xe.size),ue.length===0){console.log(" No uninvoiced orders to select");return}const ze=ue.map(ot=>ot._id),Ue=ze.filter(ot=>xe.has(ot)),Te=Ue.length===ze.length;console.log(" Selection details:"),console.log("  - Uninvoiced IDs:",ze),console.log("  - Currently selected uninvoiced:",Ue),console.log("  - All currently selected:",Te),Ge(ot=>{console.log(" SELECT ALL - Previous state:",Array.from(ot));const Ye=new Set(ot);return Te?(console.log(" Deselecting all visible orders"),ze.forEach(Kt=>Ye.delete(Kt))):(console.log(" Selecting all visible orders"),ze.forEach(Kt=>Ye.add(Kt))),console.log(" SELECT ALL - New state:",Array.from(Ye)),console.log(" SELECT ALL - New selection size:",Ye.size),Ye})},He=Z.filter(ue=>xe.has(ue._id)&&!ue._id.startsWith("TEST-")),ye=He.reduce((ue,ze)=>ue+(ze.codAmount||0),0),Fe=He.reduce((ue,ze)=>ue+(ze.serviceCharges||0),0),rt=ye+Fe-Number(Ee||0)-Number(ne||0),st=ue=>`PKR ${Number(ue||0).toLocaleString()}`,_s=async()=>{var ze;const ue=Array.from(xe).filter(Ue=>!Ue.startsWith("TEST-"));if(!j||!_||ue.length===0){y("Please fill all required fields and select at least one order");return}console.log(" Saving invoice with IDs:",ue);try{p(!0),y("");const Ue={shipperId:j,accountName:_,accountNumber:P,invoiceDate:Y,parcelFrom:K,parcelTo:q,selectedOrderIds:ue,whtIt:Number(Ee||0),whtSt:Number(ne||0)},Te=await fetch("/api/invoice",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${lt}`},body:JSON.stringify(Ue)}),ot=await Te.json();Te.ok?(N("Invoice created successfully!"),R(ot.invoice._id),Ge(new Set),F(0),Q(0),Se(0),E(0),yt(),j&&K&&q&&Ze(),Ke({type:"success",title:"Invoice saved",description:(ze=ot.invoice)!=null&&ze.invoiceNumber?`Invoice ${ot.invoice.invoiceNumber} created successfully.`:"Invoice created successfully."})):(y(ot.message||"Failed to create invoice"),Ke({type:"error",title:"Invoice error",description:ot.message||"Failed to create invoice"}))}catch{y("Failed to create invoice"),Ke({type:"error",title:"Invoice error",description:"Failed to create invoice"})}finally{p(!1)}},pt=()=>{A?window.open(`/invoice-print/${A}`,"_blank"):(y("Please save the invoice first before printing"),Ke({type:"error",title:"Cannot print",description:"Please save the invoice first before printing."}))},ct=async()=>{if(!A){y("Please save the invoice first before exporting");return}try{p(!0),y("");const ue=await fetch(`/api/invoice/${A}/export.xlsx`,{method:"GET",headers:{Authorization:`Bearer ${lt}`}});if(!ue.ok)throw new Error("Failed to export Excel file");const ze=await ue.blob(),Ue=window.URL.createObjectURL(ze),Te=document.createElement("a");Te.href=Ue,Te.download=`Invoice_${C}.xlsx`,document.body.appendChild(Te),Te.click(),document.body.removeChild(Te),window.URL.revokeObjectURL(Ue),N("Excel file downloaded successfully!"),Ke({type:"success",title:"Export ready",description:"Excel file downloaded successfully."})}catch(ue){y("Failed to export Excel file"),console.error("Export error:",ue),Ke({type:"error",title:"Export failed",description:"Failed to export Excel file."})}finally{p(!1)}},ds=({order:ue})=>e.jsx(Un,{className:"mb-3 overflow-hidden",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:xe.has(ue._id),onChange:ze=>{console.log(" Mobile Checkbox onChange fired for:",ue._id),console.log(" Event target checked:",ze.target.checked),console.log(" Current state has ID:",xe.has(ue._id)),ze.stopPropagation(),Xe(ue._id)},onClick:ze=>{console.log(" Mobile Checkbox onClick fired for:",ue._id)},disabled:ue.invoice!==null&&ue.invoice!==void 0,className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono text-sm font-semibold text-gray-900",children:ue.bookingId||ue.trackingId}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(ue.createdAt).toLocaleDateString()})]})]}),e.jsx(cx,{status:ue.status,invoiced:ue.invoice!==null&&ue.invoice!==void 0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Consignee:"}),e.jsx("div",{className:"font-medium text-gray-900",children:ue.consigneeName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Destination:"}),e.jsx("div",{className:"font-medium text-gray-900",children:ue.destinationCity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Weight:"}),e.jsxs("div",{className:"font-medium text-gray-900",children:[ue.weightKg," kg"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"COD Amount:"}),e.jsx("div",{className:"font-medium text-gray-900",children:st(ue.codAmount)})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-600",children:"Service Charges:"}),e.jsx("div",{className:"font-medium text-gray-900",children:st(ue.serviceCharges)})]})]})]})});return e.jsxs("div",{className:"min-h-screen bg-gray-50 print:bg-white",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 md:sticky md:top-0 md:z-50 print:relative print:border-b-2",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between py-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2 sm:mb-0",children:[e.jsx("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:e.jsx(Wi,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"LahoreLink Logistics"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Payment Invoice"})]})]}),e.jsxs("div",{className:"text-right sm:text-left",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["Invoice No: ",e.jsx("span",{className:"font-mono",children:C})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["Date: ",new Date(Y).toLocaleDateString()]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs(Un,{className:"mb-6 p-6",children:[e.jsx(Xi,{className:"mb-6",children:"Invoice Setup"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"xl:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Customer ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:j,onChange:ue=>{const ze=ue.target.value;w(ze);const Ue=G.find(Te=>Te._id===ze);L((Ue==null?void 0:Ue.accountHolderName)||(Ue==null?void 0:Ue.companyName)||(Ue==null?void 0:Ue.name)||""),V((Ue==null?void 0:Ue.accountNumber)||(Ue==null?void 0:Ue.iban)||"")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:"Select Customer"}),G.map(ue=>e.jsx("option",{value:ue._id,children:ue.companyName||ue.name},ue._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Invoice Number"}),e.jsx("input",{type:"text",value:C,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm bg-gray-50 text-gray-600"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Account Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:_,onChange:ue=>L(ue.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Number"}),e.jsx("input",{type:"text",value:P,onChange:ue=>V(ue.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{className:"md:col-span-2 xl:col-span-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Invoice Date"}),e.jsx("input",{type:"date",value:Y,onChange:ue=>ee(ue.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500"})]})]})]}),Z.length>0&&e.jsxs(Un,{className:"p-4 mb-6 bg-blue-50 border-blue-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:" Order Status Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white p-3 rounded border",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Total Orders"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Z.length})]}),e.jsxs("div",{className:"bg-white p-3 rounded border",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Unpaid"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:Z.filter(ue=>ue.invoice===null||ue.invoice===void 0).length})]}),e.jsxs("div",{className:"bg-white p-3 rounded border",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Already Paid"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:Z.filter(ue=>ue.invoice!==null&&ue.invoice!==void 0).length})]})]}),Z.filter(ue=>ue.invoice===null||ue.invoice===void 0).length===0&&e.jsx("div",{className:"mt-4 p-3 bg-orange-100 border border-orange-300 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xn,{className:"w-5 h-5 text-orange-600"}),e.jsxs("div",{className:"text-orange-800",children:[e.jsx("strong",{children:"No unpaid orders found."})," All orders in this date range have already been paid. Try selecting a different date range or customer to find unpaid orders."]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs(Un,{className:"p-6",children:[e.jsxs(Xi,{className:"mb-4 flex items-center",children:[e.jsx(Wi,{className:"w-5 h-5 mr-2 text-green-600"}),"Company Information"]}),jt?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-green-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading company info..."})]}):Ve?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[Ve.logoUrl&&e.jsx("img",{src:Ve.logoUrl,alt:"Company Logo",className:"w-12 h-12 object-contain"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:Ve.companyName}),e.jsx("div",{className:"text-sm text-gray-600",children:"Professional Logistics Solutions"})]})]}),e.jsx(ni,{icon:gn,label:"Address",value:`${Ve.address.line1}, ${Ve.address.city}, ${Ve.address.country}`}),e.jsx(ni,{icon:Oc,label:"Email",value:Ve.email}),e.jsx(ni,{icon:Vn,label:"Phone",value:Ve.phone}),Ve.website&&e.jsx(ni,{icon:Gx,label:"Website",value:Ve.website})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Company profile not set"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Set company profile from CEO dashboard"})]})]}),e.jsxs(Un,{className:"p-6",children:[e.jsxs(Xi,{className:"mb-4 flex items-center",children:[e.jsx(to,{className:"w-5 h-5 mr-2 text-blue-600"}),"Customer Information"]}),ft?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsx("div",{className:"font-semibold text-gray-900",children:ft.companyName||ft.name})}),ft.address&&e.jsx(ni,{icon:gn,label:"Address",value:ft.address}),e.jsx(ni,{icon:Oc,label:"Email",value:ft.email}),ft.phone&&e.jsx(ni,{icon:Vn,label:"Phone",value:ft.phone})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(to,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"Please select a customer to view details"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"xl:col-span-3 space-y-6",children:[e.jsxs(Un,{className:"p-6",children:[e.jsx(Xi,{className:"mb-4",children:"Parcel Filters"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Parcel From"}),e.jsx("input",{type:"date",value:K,onChange:ue=>H(ue.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Parcel To"}),e.jsx("input",{type:"date",value:q,onChange:ue=>te(ue.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status Filter"}),e.jsxs("select",{value:ce,onChange:ue=>$(ue.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"all",children:"All Parcels"}),e.jsx("option",{value:"uninvoiced",children:"Unpaid"}),e.jsx("option",{value:"invoiced",children:"Paid"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Limit"}),e.jsx("input",{type:"number",value:Re,onChange:ue=>oe(ue.target.value),min:"1",max:"1000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-green-500 focus:border-green-500"})]}),e.jsx("div",{className:"sm:col-span-2 lg:col-span-4 xl:col-span-1 flex items-end",children:e.jsxs("button",{onClick:Ze,disabled:!j||h,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-lg shadow-sm transition-colors flex items-center justify-center space-x-2",children:[e.jsx(sl,{className:"w-4 h-4"}),e.jsx("span",{children:h?"Loading...":"Filter"})]})})]})]}),e.jsxs(Un,{className:"overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsx(Xi,{children:"Parcel List"}),Z.length>0&&e.jsxs("div",{className:"flex items-center space-x-4 mt-4 sm:mt-0",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[Z.filter(ue=>xe.has(ue._id)&&!ue._id.startsWith("TEST-")&&(ue.invoice===null||ue.invoice===void 0)).length," ","of"," ",Z.filter(ue=>ue.invoice===null||ue.invoice===void 0).length," ","selected"]}),e.jsx("button",{onClick:ue=>{console.log(" Select All BUTTON clicked"),Tt()},className:"text-sm font-medium text-green-600 hover:text-green-700 px-3 py-1 border border-green-300 rounded-md hover:bg-green-50 transition-colors",children:(()=>{const ue=Z.filter(Ue=>Ue.invoice===null||Ue.invoice===void 0);return ue.filter(Ue=>xe.has(Ue._id)&&!Ue._id.startsWith("TEST-")).length===ue.length&&ue.length>0?"Deselect All":"Select All"})()})]})]})}),h?e.jsx("div",{className:"p-12 text-center",children:e.jsx("div",{className:"text-gray-500",children:"Loading parcels..."})}):Z.length===0?e.jsxs("div",{className:"p-12 text-center text-gray-500",children:[e.jsx("div",{className:"mb-2",children:"No parcels found for selected filters"}),e.jsx("div",{className:"text-sm",children:"Try adjusting your customer selection and date range"})]}):Z.filter(ue=>ue.invoice===null||ue.invoice===void 0).length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(St,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("div",{className:"text-lg font-medium mb-2",children:"No selectable parcels found"}),e.jsxs("div",{className:"text-sm",children:["All parcels in this date range have already been paid.",e.jsx("br",{}),"Try selecting a different date range to find unpaid parcels."]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:(()=>{const ue=Z.filter(Te=>Te.invoice===null||Te.invoice===void 0),ze=ue.filter(Te=>xe.has(Te._id)&&!Te._id.startsWith("TEST-")),Ue=ue.length>0&&ze.length===ue.length;return console.log(" Header checkbox state:",{uninvoicedCount:ue.length,selectedUninvoicedCount:ze.length,isChecked:Ue}),Ue})(),onChange:ue=>{console.log(" Header checkbox onChange:",ue.target.checked),Tt()},className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"})}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-900",children:"CN/Booking ID"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-900",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-900",children:"Consignee"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-900",children:"Destination"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-gray-900",children:"Weight"}),e.jsx("th",{className:"px-6 py-3 text-right font-semibold text-gray-900",children:"COD Amount"}),e.jsx("th",{className:"px-6 py-3 text-right font-semibold text-gray-900",children:"Service Charges"}),e.jsx("th",{className:"px-6 py-3 text-center font-semibold text-gray-900",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Z.map(ue=>e.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${xe.has(ue._id)?"bg-green-50":""}`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:xe.has(ue._id),onChange:ze=>{console.log(" Checkbox onChange fired for:",ue._id),console.log(" Event target checked:",ze.target.checked),console.log(" Current state has ID:",xe.has(ue._id)),ze.stopPropagation(),Xe(ue._id)},onClick:ze=>{console.log(" Checkbox onClick fired for:",ue._id)},disabled:ue.invoice!==null&&ue.invoice!==void 0,className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed"})}),e.jsx("td",{className:"px-6 py-4 font-mono text-sm font-medium text-gray-900",children:ue.bookingId||ue.trackingId}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:new Date(ue.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ue.consigneeName}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ue.destinationCity}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[ue.weightKg," kg"]}),e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 text-right",children:st(ue.codAmount)}),e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 text-right",children:st(ue.serviceCharges)}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(cx,{status:ue.status,invoiced:ue.invoice!==null&&ue.invoice!==void 0})})]},ue._id))})]})}),e.jsx("div",{className:"md:hidden p-4 space-y-4",children:Z.map(ue=>e.jsx(ds,{order:ue},ue._id))})]})]})]}),e.jsx("div",{className:"xl:col-span-1",children:e.jsxs(Un,{className:"p-6 xl:sticky xl:top-24",children:[e.jsx(Xi,{className:"mb-6",children:"Invoice Summary"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Wl,{label:"COD Total",value:st(ye)}),e.jsx(Wl,{label:"Service Charges",value:st(Fe)}),e.jsx(Wl,{label:"WHT IT u/s 6A of ITO, 2001 (2.0%)",children:e.jsx("input",{type:"number",min:"0",step:"0.01",value:Ee,onChange:ue=>me(Math.max(0,parseFloat(ue.target.value)||0)),className:"w-28 px-3 py-1 text-sm text-right border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"0.00"})}),e.jsx(Wl,{label:"WHT ST u/s 3 of STA, 1990 (2.0%)",children:e.jsx("input",{type:"number",min:"0",step:"0.01",value:ne,onChange:ue=>J(Math.max(0,parseFloat(ue.target.value)||0)),className:"w-28 px-3 py-1 text-sm text-right border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500",placeholder:"0.00"})}),e.jsx(Wl,{label:"Net Payable",value:st(rt),type:"total"})]})]})})]}),e.jsx(Un,{className:"p-6 mt-6 print:hidden",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-4",children:[e.jsxs("button",{onClick:_s,disabled:h||Array.from(xe).filter(ue=>!ue.startsWith("TEST-")).length===0||!j||!_,className:"px-6 py-3 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-semibold rounded-lg shadow-sm transition-colors flex items-center justify-center space-x-2",children:[e.jsx(x0,{className:"w-5 h-5"}),e.jsx("span",{children:h?"Saving Invoice...":"Save Invoice"})]}),e.jsxs("button",{onClick:pt,disabled:!A,className:"px-6 py-3 border border-gray-300 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed text-gray-700 font-semibold rounded-lg shadow-sm transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Yx,{className:"w-5 h-5"}),e.jsx("span",{children:"Print Invoice"})]}),e.jsxs("button",{onClick:ct,disabled:!A||h,className:"px-6 py-3 border border-gray-300 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed text-gray-700 font-semibold rounded-lg shadow-sm transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Rc,{className:"w-5 h-5"}),e.jsx("span",{children:h?"Exporting...":"Export Excel"})]})]})})]}),f&&e.jsx("div",{className:"fixed bottom-4 right-4 z-50 max-w-md",children:e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:f}),e.jsx("button",{onClick:()=>y(""),className:"ml-4 text-red-600 hover:text-red-800 font-bold text-lg leading-none",children:""})]})})}),v&&e.jsx("div",{className:"fixed bottom-4 right-4 z-50 max-w-md",children:e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:v}),e.jsx("button",{onClick:()=>N(""),className:"ml-4 text-green-600 hover:text-green-800 font-bold text-lg leading-none",children:""})]})})})]})},nb=()=>{const[h,p]=D.useState([]),[f,y]=D.useState([]),[v,N]=D.useState(""),A=typeof window<"u"?localStorage.getItem("token"):null,R=async()=>{N("");try{const[w,C]=await Promise.all([fetch("/api/users/riders",{headers:{Authorization:A?`Bearer ${A}`:""}}),fetch("/api/orders",{headers:{Authorization:A?`Bearer ${A}`:""}})]),O=await w.json(),_=await C.json();if(!w.ok)throw new Error(O.message||"Failed riders");if(!C.ok)throw new Error(_.message||"Failed orders");p(O),y(_)}catch(w){N(w.message)}};D.useEffect(()=>{R()},[]);const j=async w=>{try{const C=f.filter(O=>O.assignedRider&&(O.assignedRider._id===w||O.assignedRider===w)&&O.status==="ASSIGNED");for(const O of C)await fetch(`/api/orders/${O._id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:A?`Bearer ${A}`:""},body:JSON.stringify({status:"OUT_FOR_DELIVERY"})});await R()}catch(C){N(C.message)}};return e.jsxs("div",{className:"space-y-8",children:[v&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:v}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Logistics"}),e.jsx("button",{onClick:R,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2 px-3",children:"Rider"}),e.jsx("th",{className:"py-2 px-3",children:"Assigned"}),e.jsx("th",{className:"py-2 px-3",children:"Start Route"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:h.map(w=>{const C=f.filter(O=>O.assignedRider&&(O.assignedRider._id===w._id||O.assignedRider===w._id)&&O.status==="ASSIGNED");return e.jsxs("tr",{children:[e.jsxs("td",{className:"py-2 px-3 flex items-center gap-2",children:[e.jsx(gs,{className:"w-4 h-4"})," ",w.name]}),e.jsx("td",{className:"py-2 px-3",children:C.length}),e.jsx("td",{className:"py-2 px-3",children:e.jsxs("button",{onClick:()=>j(w._id),className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded flex items-center gap-2",children:[e.jsx(f0,{className:"w-4 h-4"})," Start"]})})]},w._id)})})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Rider Orders & Status"}),e.jsx("button",{onClick:R,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2 px-3",children:"Rider"}),e.jsx("th",{className:"py-2 px-3",children:"Booking"}),e.jsx("th",{className:"py-2 px-3",children:"Status"}),e.jsx("th",{className:"py-2 px-3",children:"City"}),e.jsx("th",{className:"py-2 px-3",children:"COD/Collected"}),e.jsx("th",{className:"py-2 px-3",children:"Updated"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:f.filter(w=>!!w.assignedRider&&["OUT_FOR_DELIVERY","DELIVERED","RETURNED","FAILED","ASSIGNED"].includes(w.status)).map(w=>{var C,O;return e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3",children:typeof w.assignedRider=="object"?(C=w.assignedRider)==null?void 0:C.name:((O=h.find(_=>_._id===w.assignedRider))==null?void 0:O.name)||""}),e.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:w.bookingId}),e.jsx("td",{className:"py-2 px-3",children:w.status}),e.jsx("td",{className:"py-2 px-3",children:w.destinationCity}),e.jsx("td",{className:"py-2 px-3",children:w.status==="DELIVERED"?`Rs ${Number(w.amountCollected||w.codAmount||0).toLocaleString()}`:`Rs ${Number(w.codAmount||0).toLocaleString()}`}),e.jsx("td",{className:"py-2 px-3 text-xs text-gray-500",children:new Date(w.updatedAt||w.createdAt).toLocaleString()})]},w._id)})})]})})]})]})},rb="/assets/logo-c9zLNN14.png",ib=()=>{var te,ce,$,Re,oe,Ee,me;const{id:h}=tl(),p=As(),[f,y]=D.useState(null),[v,N]=D.useState(!0),[A,R]=D.useState(""),[j,w]=D.useState(null),C=localStorage.getItem("token");D.useEffect(()=>{h&&O(),_()},[h]),D.useEffect(()=>{f&&!v&&setTimeout(()=>{try{window.print()}catch(ne){console.error("Print failed:",ne)}},500)},[f,v]);const O=async()=>{try{N(!0);const ne=await fetch(`/api/invoice/${h}`,{headers:{Authorization:`Bearer ${C}`}});if(!ne.ok)throw new Error("Failed to load invoice");const J=await ne.json();y(J)}catch(ne){R(ne.message)}finally{N(!1)}},_=async()=>{try{const ne=await fetch("/api/company-profile/public"),J=await ne.json();ne.ok&&J.success?w(J.data):w({companyName:"LahoreLink Courier Services",logoUrl:"",address:{line1:"Office # 123, Main Boulevard, Gulberg III",city:"Lahore",country:"Pakistan"},phone:"+92-42-111-LINK (5465)",email:"finance@lahorelink.com",website:"www.lahorelink.com",footerNote:"For support contact: +92-42-111-LINK (5465) | Email: support@lahorelink.com"})}catch(ne){console.error("Error loading company profile:",ne),w({companyName:"LahoreLink Courier Services",logoUrl:"",address:{line1:"Office # 123, Main Boulevard, Gulberg III",city:"Lahore",country:"Pakistan"},phone:"+92-42-111-LINK (5465)",email:"finance@lahorelink.com",website:"www.lahorelink.com",footerNote:"For support contact: +92-42-111-LINK (5465) | Email: support@lahorelink.com"})}},L=ne=>`PKR ${Number(ne||0).toLocaleString()}`,P=ne=>new Date(ne).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});if(v)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"text-lg",children:"Loading invoice..."})});if(A||!f)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-600 text-lg mb-4",children:A||"Invoice not found"}),e.jsx("button",{onClick:()=>p(-1),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Go Back"})]})});const V=f.codTotal||0,Y=(f.serviceChargesTotal!=null?f.serviceChargesTotal:f.flyerChargesTotal)||0,ee=f.whtIt||0,K=f.whtSt||0,H=V+Y-ee-K,q=f.netPayable!=null?f.netPayable:H;return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        @media print {
          body { margin: 0; padding: 0; }
          .no-print { display: none !important; }
          .print-page {
            width: 100% !important;
            max-width: none !important;
            margin: 0 !important;
            padding: 20px !important;
            box-shadow: none !important;
          }
          @page { size: A4; margin: 15mm; }
        }
        .invoice-table th, .invoice-table td {
          border: 1px solid #e5e7eb;
          padding: 8px;
          text-align: left;
        }
        .invoice-table {
          border-collapse: collapse;
          width: 100%;
        }
      `}),e.jsxs("div",{className:"no-print flex justify-between items-center p-4 bg-white border-b",children:[e.jsx("button",{onClick:()=>p(-1),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Back"}),e.jsx("button",{onClick:()=>window.print(),className:"px-4 py-2 bg-primary hover:bg-primary-hover text-white rounded",children:"Print Invoice"})]}),e.jsxs("div",{className:"print-page max-w-4xl mx-auto bg-white p-8",children:[e.jsxs("div",{className:"flex justify-between items-start mb-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center space-x-3 mb-2",children:e.jsx("img",{src:(j==null?void 0:j.logoUrl)||rb,alt:(j==null?void 0:j.companyName)||"Company Logo",className:"w-32 h-16 object-contain"})}),e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[e.jsxs("div",{children:["Email: ",(j==null?void 0:j.email)||"info@lahorelink.com"]}),(j==null?void 0:j.website)&&e.jsxs("div",{children:["Website: ",j.website]}),e.jsxs("div",{children:["Phone: ",(j==null?void 0:j.phone)||"+92-42-111-LINK (5465)"]}),e.jsxs("div",{children:["Address:"," ",j!=null&&j.address?`${j.address.line1}, ${j.address.city}, ${j.address.country}`:"Lahore, Pakistan"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900 mb-2",children:["Inv.No# ",f.invoiceNumber]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Date: ",P(f.invoiceDate)]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3 border-b border-gray-300 pb-2",children:"Bill To:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Account Name:"})," ",f.accountName]}),f.accountNumber&&e.jsxs("div",{children:[e.jsx("strong",{children:"Account Number:"})," ",f.accountNumber]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Customer:"})," ",((te=f.shipper)==null?void 0:te.companyName)||((ce=f.shipper)==null?void 0:ce.name)]}),(($=f.shipper)==null?void 0:$.address)&&e.jsxs("div",{children:[e.jsx("strong",{children:"Address:"})," ",f.shipper.address]}),((Re=f.shipper)==null?void 0:Re.email)&&e.jsxs("div",{children:[e.jsx("strong",{children:"Email:"})," ",f.shipper.email]}),((oe=f.shipper)==null?void 0:oe.phone)&&e.jsxs("div",{children:[e.jsx("strong",{children:"Phone:"})," ",f.shipper.phone]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3 border-b border-gray-300 pb-2",children:"Invoice Details:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Invoice Date:"})," ",P(f.invoiceDate)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Period:"})," ",P(f.parcelFrom)," -"," ",P(f.parcelTo)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Total Orders:"})," ",((Ee=f.orders)==null?void 0:Ee.length)||0]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx("span",{className:"text-green-600 font-medium",children:f.status})]})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 border-b border-gray-300 pb-2",children:"Order Details:"}),e.jsxs("table",{className:"invoice-table text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{children:"CN/Booking ID"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Consignee"}),e.jsx("th",{children:"Destination"}),e.jsx("th",{children:"Weight (kg)"}),e.jsx("th",{className:"text-right",children:"COD Amount"}),e.jsx("th",{className:"text-right",children:"Service Charges"}),e.jsx("th",{children:"Status"})]})}),e.jsxs("tbody",{children:[(me=f.orders)==null?void 0:me.map(ne=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono text-xs",children:ne.bookingId}),e.jsx("td",{children:P(ne.createdAt)}),e.jsx("td",{children:ne.consigneeName}),e.jsx("td",{children:ne.destinationCity}),e.jsx("td",{children:ne.weightKg}),e.jsx("td",{className:"text-right",children:L(ne.codAmount)}),e.jsx("td",{className:"text-right",children:L(ne.serviceCharges)}),e.jsx("td",{children:e.jsx("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full",children:ne.status})})]},ne._id)),(!f.orders||f.orders.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center text-gray-500 py-4",children:"No orders found"})})]})]})]}),e.jsx("div",{className:"flex justify-end mb-8",children:e.jsx("div",{className:"w-72",children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-600",children:"COD Total:"}),e.jsx("span",{className:"font-medium",children:L(V)})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-600",children:"Service Charges:"}),e.jsx("span",{className:"font-medium",children:L(Y)})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-600",children:"WHT IT u/s 6A of ITO, 2001 (2.0%):"}),e.jsx("span",{className:"font-medium",children:L(ee)})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-600",children:"WHT ST u/s 3 of STA, 1990 (2.0%):"}),e.jsx("span",{className:"font-medium",children:L(K)})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-t-2 border-gray-400 mt-4",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:"Net Payable:"}),e.jsx("span",{className:"text-lg font-bold text-primary",children:L(q)})]})]})})}),e.jsxs("div",{className:"mt-12 pt-8 border-t border-gray-300",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Contact Information:"}),e.jsx("p",{children:"For any queries regarding this invoice, please contact:"}),e.jsxs("p",{children:["Email: ",(j==null?void 0:j.email)||"finance@lahorelink.com"]}),e.jsxs("p",{children:["Phone: ",(j==null?void 0:j.phone)||"+92-42-111-LINK (5465)"]})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t border-gray-200 text-center text-xs text-gray-500",children:[(j==null?void 0:j.footerNote)&&e.jsx("p",{className:"mb-2",children:j.footerNote}),e.jsx("p",{children:"This is a computer generated invoice. No signature required."}),e.jsxs("p",{children:["Generated on ",new Date().toLocaleDateString()," by"," ",(j==null?void 0:j.companyName)||"LahoreLink Logistics"," Management System"]})]})]})]})]})},Uu=()=>{const h=Ga(),[p,f]=D.useState("dashboard"),[y,v]=D.useState([]),[N,A]=D.useState([]),[R,j]=D.useState(""),[w,C]=D.useState("date:desc"),[O,_]=D.useState("all"),[L,P]=D.useState("ALL"),[V,Y]=D.useState(!1),[ee,K]=D.useState(""),[H,q]=D.useState(null),[te,ce]=D.useState({pendingCod:0,pendingPrepaid:0,totalOrders:0,lllWarehouse:0,outForDelivery:0,totalCod:0,totalServiceCharges:0,netAmount:0}),[$,Re]=D.useState("COD"),[oe,Ee]=D.useState("today"),[me,ne]=D.useState({consigneeName:"",consigneePhone:"",consigneeAddress:"",destinationCity:"Lahore",serviceType:"SAME_DAY",codAmount:"",productDescription:"",pieces:"1",fragile:!1,weightKg:"",remarks:""}),{user:J}=Fs(),ae=(J==null?void 0:J.token)||Xs(),F=As(),[W,Q]=D.useState(""),[Ne,Se]=D.useState([]),[fe,E]=D.useState(!1),[G,U]=D.useState([]),Z=async()=>{try{const ye=await fetch("/api/orders",{headers:{Authorization:ae?`Bearer ${ae}`:""}});if(console.log("DEBUG fetchOrders response status:",ye.status,"ok:",ye.ok),ye.ok){const Fe=await ye.json();console.log("DEBUG fetchOrders data count:",Fe.length),v(Fe),A(Fe),new Date().setHours(0,0,0,0);let rt=new Date;rt.setHours(0,0,0,0),oe==="7days"?rt.setDate(rt.getDate()-6):oe==="15days"?rt.setDate(rt.getDate()-14):oe==="30days"&&rt.setDate(rt.getDate()-29);const st=Fe.filter(ze=>{const Ue=new Date(ze.createdAt);return Ue.setHours(0,0,0,0),Ue.getTime()>=rt.getTime()}),_s=st.filter(ze=>ze.paymentType==="COD"&&!["DELIVERED","RETURNED","FAILED"].includes(ze.status)).reduce((ze,Ue)=>ze+Number(Ue.codAmount||0),0),pt=st.filter(ze=>ze.paymentType!=="COD"&&!["DELIVERED","RETURNED","FAILED"].includes(ze.status)).reduce((ze,Ue)=>ze+Number(Ue.codAmount||0),0),ct=st.reduce((ze,Ue)=>ze+Number(Ue.codAmount||0),0),ds=st.reduce((ze,Ue)=>ze+Number(Ue.serviceCharges||0),0),ue=ct-ds;ce({pendingCod:_s,pendingPrepaid:pt,totalOrders:st.length,lllWarehouse:st.filter(ze=>ze.status==="AT_LLL_WAREHOUSE").length,outForDelivery:st.filter(ze=>ze.status==="OUT_FOR_DELIVERY").length,totalCod:ct,totalServiceCharges:ds,netAmount:ue})}else if(ye.status===401){const Fe="Session expired. Please login again.";console.log("DEBUG fetchOrders 401:",Fe),K(Fe)}else{const Fe="Failed to load orders";console.log("DEBUG fetchOrders error:",Fe),K(Fe)}}catch(ye){console.error("DEBUG fetchOrders exception:",ye.message),K("Error: "+ye.message)}},we=ye=>{Ee(ye)},xe=async()=>{try{const ye=await fetch("/api/finance/summary/shipper/me",{headers:{Authorization:ae?`Bearer ${ae}`:""}});console.log("DEBUG fetchFinance response status:",ye.status,"ok:",ye.ok);const Fe=await ye.json();if(console.log("DEBUG fetchFinance response data:",Fe),ye.ok)q(Fe);else{const We=(Fe==null?void 0:Fe.message)||"Failed to load finance data";console.log("DEBUG fetchFinance error message:",We),K(We)}}catch(ye){console.error("DEBUG fetchFinance exception:",ye.message),K("Error loading finance data: "+ye.message)}};D.useEffect(()=>{Z(),xe()},[ae,oe]),D.useEffect(()=>{h.pathname.includes("/shipper/create")?f("list"):h.pathname.includes("/shipper/orders")?f("orders"):f("dashboard")},[h.pathname]),D.useEffect(()=>{const ye=R.toLowerCase();A(y.filter(Fe=>{var We,rt,st;return((We=Fe.bookingId)==null?void 0:We.toLowerCase().includes(ye))||((rt=Fe.consigneeName)==null?void 0:rt.toLowerCase().includes(ye))||((st=Fe.destinationCity)==null?void 0:st.toLowerCase().includes(ye))}))},[R,y]);const Ge=fn.useMemo(()=>{if(O==="all")return N;const ye=new Date;let Fe=new Date(ye),We=new Date(ye);if(O==="today")Fe.setHours(0,0,0,0),We.setHours(23,59,59,999);else if(O==="week"){const rt=ye.getDay(),st=rt===0?-6:1-rt;Fe=new Date(ye),Fe.setDate(ye.getDate()+st),Fe.setHours(0,0,0,0),We=new Date(Fe),We.setDate(Fe.getDate()+6),We.setHours(23,59,59,999)}else O==="month"&&(Fe=new Date(ye.getFullYear(),ye.getMonth(),1,0,0,0,0),We=new Date(ye.getFullYear(),ye.getMonth()+1,0,23,59,59,999));return N.filter(rt=>{const st=new Date(rt==null?void 0:rt.createdAt);return Number.isNaN(st.getTime())?!1:st.getTime()>=Fe.getTime()&&st.getTime()<=We.getTime()})},[N,O]),Ve=fn.useMemo(()=>L==="ALL"?Ge:Ge.filter(ye=>L==="DELIVERED"?ye.status==="DELIVERED":L==="RETURNED"?ye.status==="RETURNED":L==="OUT_FOR_DELIVERY"?ye.status==="OUT_FOR_DELIVERY":L==="PENDING"?!["DELIVERED","RETURNED","FAILED","OUT_FOR_DELIVERY"].includes(ye.status):!0),[Ge,L]),Je=fn.useMemo(()=>{const ye=ct=>{if(!ct)return NaN;const ds=new Date(ct);if(!Number.isNaN(ds.getTime()))return ds.getTime();if(typeof ct=="string"){const ue=ct.trim();if(ue.includes("/")){const ze=ue.split("/");if(ze.length===3){const[Ue,Te,ot]=ze;if(String(Ue).length===2){const Ye=Number(Ue),Kt=Number(Te),pn=Number(ot);return new Date(pn,Kt-1,Ye).getTime()}}}if(ue.includes("-")){const ze=ue.split("-");if(ze.length===3&&String(ze[0]).length===2){const[Ue,Te,ot]=ze;return new Date(Number(ot),Number(Te)-1,Number(Ue)).getTime()}}}return NaN},Fe=ct=>Number((ct==null?void 0:ct.codAmount)||0),We=ct=>Number((ct==null?void 0:ct.serviceCharges)||0),[rt,st]=String(w||"date:desc").split(":"),_s=st==="asc"?1:-1,pt=Ve.map((ct,ds)=>({o:ct,idx:ds}));return pt.sort((ct,ds)=>{var Ue,Te,ot,Ye;let ue,ze;return rt==="date"?(ue=ye((Ue=ct.o)==null?void 0:Ue.createdAt),ze=ye((Te=ds.o)==null?void 0:Te.createdAt)):rt==="cod"?(ue=Fe(ct.o),ze=Fe(ds.o)):rt==="charges"?(ue=We(ct.o),ze=We(ds.o)):rt==="status"&&(ue=String(((ot=ct.o)==null?void 0:ot.status)||"").toLowerCase(),ze=String(((Ye=ds.o)==null?void 0:Ye.status)||"").toLowerCase()),ue===ze?ct.idx-ds.idx:typeof ue=="string"||typeof ze=="string"?String(ue).localeCompare(String(ze))*_s:Number.isNaN(ue)&&Number.isNaN(ze)?ct.idx-ds.idx:Number.isNaN(ue)?1:Number.isNaN(ze)?-1:(ue-ze)*_s}),pt.map(ct=>ct.o)},[Ve,w]);D.useEffect(()=>{const ye=W.trim().toLowerCase();if(ye.length<2){Se([]);return}Se(y.filter(Fe=>{var We,rt,st,_s;return((We=Fe.bookingId)==null?void 0:We.toLowerCase().includes(ye))||((rt=Fe.trackingId)==null?void 0:rt.toLowerCase().includes(ye))||((st=Fe.consigneeName)==null?void 0:st.toLowerCase().includes(ye))||((_s=Fe.destinationCity)==null?void 0:_s.toLowerCase().includes(ye))}).slice(0,8))},[W,y]);const jt=(ye,Fe)=>{U(We=>Fe?We.includes(ye)?We:[...We,ye]:We.filter(rt=>rt!==ye))},Be=async()=>{if(G.length!==0)try{const ye=localStorage.getItem("token"),Fe=await fetch("/api/orders/labels/print",{method:"POST",headers:{"Content-Type":"application/json",Authorization:ye?`Bearer ${ye}`:""},body:JSON.stringify({orderIds:G})});if(!Fe.ok){if(Fe.status===401){alert("Session expired. Please login again.");return}const st=await Fe.text();alert(st||"Failed to generate labels");return}const We=await Fe.text(),rt=window.open("","_blank");if(!rt){alert("Popup blocked. Please allow popups to print labels.");return}rt.document.write(We),rt.document.close(),rt.focus(),setTimeout(()=>{try{rt.print()}catch{}},200)}catch(ye){alert(ye.message||"Error generating labels")}},lt=y.filter(ye=>ye.status==="DELIVERED").length,Ke=y.filter(ye=>!["DELIVERED","RETURNED","FAILED"].includes(ye.status)).reduce((ye,Fe)=>ye+Number(Fe.codAmount||0),0),ft=y.filter(ye=>ye.status==="RETURNED").length,Oe=ye=>({CREATED:"Pending",ASSIGNED:"In LLL Warehouse",OUT_FOR_DELIVERY:"Out for delivery",RETURNED:"Returned",DELIVERED:"Delivered",FAILED:"Failed"})[ye]||ye,mt=ye=>{const Fe=ye.bookingState==="BOOKED",We=Fe?"bg-green-100 text-green-700 border-green-200":"bg-amber-100 text-amber-700 border-amber-200",rt=Fe?"Booked":"Unbooked";return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs border ${We}`,children:rt})},yt=ye=>ye.isIntegrated?e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs border border-blue-200 bg-blue-50 text-blue-700",children:"Integrated"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs border border-gray-200 bg-gray-50 text-gray-700",children:"Manual"}),Ze=async ye=>{try{K("");const Fe=await fetch(`/api/orders/${ye}/book`,{method:"PATCH",headers:{Authorization:ae?`Bearer ${ae}`:""}}),We=await Fe.json();if(!Fe.ok)throw new Error((We==null?void 0:We.message)||"Booking failed");v(rt=>rt.map(st=>st._id===ye?We:st)),A(rt=>rt.map(st=>st._id===ye?We:st))}catch(Fe){K(Fe.message||"Failed to book order")}},Xe=fn.useMemo(()=>{let ye=new Date;ye.setHours(0,0,0,0),oe==="7days"?ye.setDate(ye.getDate()-6):oe==="15days"?ye.setDate(ye.getDate()-14):oe==="30days"&&ye.setDate(ye.getDate()-29);const Fe=y.filter(pt=>{const ct=new Date(pt.createdAt);return ct.setHours(0,0,0,0),ct.getTime()>=ye.getTime()}),We=Fe.length,rt=Fe.filter(pt=>!["DELIVERED","RETURNED","FAILED"].includes(pt.status)).length,st=Fe.filter(pt=>!["DELIVERED","RETURNED","FAILED"].includes(pt.status)).reduce((pt,ct)=>{const ds=ct.paymentType==="COD";return $==="COD"&&ds||$==="DP"&&!ds?pt+(ct.codAmount||0):pt},0),_s={total:Fe.length,unbooked:Fe.filter(pt=>pt.bookingState!=="BOOKED").length,booked:Fe.filter(pt=>pt.bookingState==="BOOKED").length,warehouse:Fe.filter(pt=>pt.status==="AT_LLL_WAREHOUSE").length,ofd:Fe.filter(pt=>pt.status==="OUT_FOR_DELIVERY").length,delivered:Fe.filter(pt=>pt.status==="DELIVERED").length,attempted:Fe.filter(pt=>["FAILED","FIRST_ATTEMPT","SECOND_ATTEMPT","THIRD_ATTEMPT"].includes(pt.status)).length,returned:Fe.filter(pt=>pt.status==="RETURNED").length};return{header:{total:We,pending:rt,amount:st},grid:_s}},[y,oe,$]),Tt=async ye=>{if(ye.preventDefault(),Y(!0),K(""),!me.weightKg||me.weightKg<=0){K("Weight must be greater than 0"),Y(!1);return}try{const Fe={consigneeName:me.consigneeName,consigneePhone:me.consigneePhone,consigneeAddress:me.consigneeAddress,destinationCity:me.destinationCity,serviceType:me.serviceType,codAmount:me.paymentType==="ADVANCE"?0:Number(me.codAmount||0),paymentType:me.paymentType,productDescription:me.productDescription,pieces:Number(me.pieces),fragile:!!me.fragile,weightKg:Number(me.weightKg),remarks:me.remarks},We=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:ae?`Bearer ${ae}`:""},body:JSON.stringify(Fe)});if(!We.ok){const rt=await We.json().catch(()=>({message:"Failed"}));throw new Error(rt.message||"Order creation failed")}await Z(),f("list"),ne({consigneeName:"",consigneePhone:"",consigneeAddress:"",destinationCity:"Lahore",serviceType:"SAME_DAY",codAmount:"",paymentType:"COD",productDescription:"",pieces:"1",fragile:!1,weightKg:"",remarks:""})}catch(Fe){K(Fe.message)}finally{Y(!1)}},He=p==="dashboard";return e.jsxs("div",{className:"space-y-8",children:[He&&e.jsxs("div",{className:"block sm:hidden space-y-4",children:[e.jsxs("div",{className:"bg-[#0B6D45] p-6 rounded-b-3xl text-white shadow-lg -mx-4 -mt-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:oe==="7days"?"7 Days Orders":oe==="15days"?"15 Days Orders":oe==="30days"?"30 Days Orders":"Today's Orders"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 opacity-80",children:[e.jsx("span",{className:"text-2xl font-bold",children:Xe.header.total}),e.jsx(Gn,{className:"w-4 h-4 cursor-pointer",onClick:Z})]})]}),e.jsx("div",{className:"bg-[#085233] rounded-lg p-1 flex text-xs font-semibold",children:e.jsx("button",{onClick:()=>Re("COD"),className:`px-3 py-1 rounded-md transition-all ${$==="COD"?"bg-white text-[#0B6D45] shadow-sm":"text-green-100"}`,children:"COD"})})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("p",{className:"text-green-100 text-sm",children:["PKR ",e.jsx(Xn,{className:"inline w-3 h-3 ml-1"})]}),e.jsxs("div",{className:"flex justify-between items-end mt-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-3xl font-bold",children:Xe.header.amount.toLocaleString()}),e.jsx("p",{className:"text-xs text-green-100 mt-1",children:"Pending Amount"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-2xl font-bold",children:Xe.header.pending}),e.jsx("p",{className:"text-xs text-green-100 mt-1",children:"Pending Orders"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-2xl font-bold",children:Xe.header.total}),e.jsx("p",{className:"text-xs text-green-100 mt-1",children:"Total Orders"})]})]})]})]}),e.jsxs("div",{className:"flex justify-center gap-2 mb-4 px-2 overflow-x-auto",children:[e.jsx("button",{onClick:()=>we("7days"),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${oe==="7days"?"bg-black text-white":"bg-white text-gray-500 border border-gray-200"}`,children:"7 DAYS"}),e.jsx("button",{onClick:()=>we("15days"),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${oe==="15days"?"bg-black text-white":"bg-white text-gray-500 border border-gray-200"}`,children:"15 DAYS"}),e.jsx("button",{onClick:()=>we("30days"),className:`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${oe==="30days"?"bg-black text-white":"bg-white text-gray-500 border border-gray-200"}`,children:"30 DAYS"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 px-1",children:[e.jsx(zn,{icon:a2,title:"Total Orders",count:Xe.grid.total,colorClass:"text-gray-600"}),e.jsx(zn,{icon:St,title:"Unbooked",count:Xe.grid.unbooked,colorClass:"text-amber-600"}),e.jsx(zn,{icon:Hp,title:"Booked",count:Xe.grid.booked,colorClass:"text-green-600"}),e.jsx(zn,{icon:Wi,title:"In Warehouse",count:Xe.grid.warehouse,colorClass:"text-blue-600"}),e.jsx(zn,{icon:qp,title:"Out for Delivery",count:Xe.grid.ofd,colorClass:"text-cyan-600"}),e.jsx(zn,{icon:Yn,title:"Delivered",count:Xe.grid.delivered,colorClass:"text-green-700"}),e.jsx(zn,{icon:Xn,title:"Attempted",count:Xe.grid.attempted,colorClass:"text-red-500"}),e.jsx(zn,{icon:p2,title:"Returned",count:Xe.grid.returned,colorClass:"text-orange-600"})]})]}),e.jsxs("div",{className:`${He?"hidden sm:block":""} bg-white p-6 rounded-xl border border-gray-100 shadow-sm`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(St,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Shipper Dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[p==="dashboard"&&e.jsx(zt,{onClick:async()=>{try{const ye=await fetch("/api/notifications/pickup-request",{method:"POST",headers:{"Content-Type":"application/json",Authorization:ae?`Bearer ${ae}`:""},body:JSON.stringify({shipperId:(J==null?void 0:J.id)||localStorage.getItem("userId"),message:"Pickup required"})});if(ye.ok)alert("Pickup request sent successfully!");else{const Fe=await ye.json();alert(Fe.message||"Failed to send pickup request")}}catch(ye){alert("Error sending pickup request: "+ye.message)}},variant:"outline",children:"Send Pickup Request"}),p==="list"&&e.jsxs(zt,{onClick:()=>f("create"),children:[e.jsx(n0,{className:"w-4 h-4"})," New Order"]})]})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Create and track shipments."})]}),p==="dashboard"&&e.jsxs("div",{className:"hidden sm:block bg-white rounded-xl border border-gray-100 shadow-sm p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Quick Actions"})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(zt,{onClick:()=>f("create"),children:[e.jsx(n0,{className:"w-4 h-4"})," Create New Order"]}),e.jsxs(zt,{variant:"outline",onClick:()=>f("orders"),children:[e.jsx(St,{className:"w-4 h-4"})," View All Orders"]})]})]}),p==="dashboard"&&e.jsxs("div",{className:"hidden sm:block bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:oe==="7days"?"Last 7 Days Orders":oe==="15days"?"Last 15 Days Orders":oe==="30days"?"Last 30 Days Orders":"Today's Orders"}),e.jsx("button",{onClick:Z,className:"text-gray-400 hover:text-primary",children:e.jsx(Gn,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx("button",{onClick:()=>we("today"),className:`px-3 py-1.5 text-xs rounded-full ${oe==="today"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"Today"}),e.jsx("button",{onClick:()=>we("7days"),className:`px-3 py-1.5 text-xs rounded-full ${oe==="7days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"7 Days"}),e.jsx("button",{onClick:()=>we("15days"),className:`px-3 py-1.5 text-xs rounded-full ${oe==="15days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"15 Days"}),e.jsx("button",{onClick:()=>we("30days"),className:`px-3 py-1.5 text-xs rounded-full ${oe==="30days"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"30 Days"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>Re("COD"),className:`px-3 py-1.5 text-xs rounded-full ${$==="COD"?"bg-primary text-white":"bg-gray-100 text-gray-600"}`,children:"COD"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Pending Amount"}),e.jsxs("p",{className:"text-lg font-bold text-secondary",children:["PKR"," ",$==="COD"?te.pendingCod.toLocaleString():te.pendingPrepaid.toLocaleString()]})]})]}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Orders Today"}),e.jsx("p",{className:"text-lg font-bold text-secondary",children:te.totalOrders})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[e.jsx(rs,{icon:gs,title:"Total Orders",count:te.totalOrders}),e.jsx(rs,{icon:St,title:"LLL Warehouse",count:te.lllWarehouse}),e.jsx(rs,{icon:gs,title:"Out for Delivery",count:te.outForDelivery}),e.jsx(rs,{icon:ts,title:"Pending COD",count:`PKR ${te.pendingCod.toLocaleString()}`}),e.jsx(rs,{icon:mn,title:"Pending Prepaid",count:`PKR ${te.pendingPrepaid.toLocaleString()}`})]})]}),p==="dashboard"&&e.jsxs("div",{className:"hidden sm:block grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(rs,{icon:St,title:"Total Bookings",count:y.length}),e.jsx(rs,{icon:gs,title:"Delivered",count:lt}),e.jsx(rs,{icon:ts,title:"COD Pending",count:`PKR ${Ke.toLocaleString()}`}),e.jsx(rs,{icon:Gn,title:"Returned",count:ft}),e.jsx(rs,{icon:ts,title:"Total COD",count:`PKR ${te.totalCod.toLocaleString()}`}),e.jsx(rs,{icon:ts,title:"Service Charges",count:`PKR ${te.totalServiceCharges.toLocaleString()}`}),e.jsx(rs,{icon:ts,title:"Net Amount",count:`PKR ${te.netAmount.toLocaleString()}`})]}),p==="create"?e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm max-w-2xl",children:e.jsxs("form",{onSubmit:Tt,className:"p-6 space-y-6",children:[ee&&e.jsx("p",{className:"text-sm text-red-600",children:ee}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(ht,{label:"Consignee Name",value:me.consigneeName,onChange:ye=>ne({...me,consigneeName:ye.target.value}),required:!0}),e.jsx(ht,{label:"Consignee Phone",value:me.consigneePhone,onChange:ye=>ne({...me,consigneePhone:ye.target.value}),required:!0}),e.jsx(ht,{label:"City",value:me.destinationCity,onChange:ye=>ne({...me,destinationCity:ye.target.value})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Service Type"}),e.jsxs("select",{className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white text-gray-900 focus:border-primary focus:ring-primary/20 focus:outline-none",value:me.serviceType,onChange:ye=>ne({...me,serviceType:ye.target.value}),children:[e.jsx("option",{value:"SAME_DAY",children:"SAME_DAY"}),e.jsx("option",{value:"OVERNIGHT",children:"OVERNIGHT"}),e.jsx("option",{value:"ECONOMY",children:"ECONOMY"})]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ht,{label:"Address",value:me.consigneeAddress,onChange:ye=>ne({...me,consigneeAddress:ye.target.value}),required:!0})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Payment Type"}),e.jsxs("select",{className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 bg-white text-gray-900",value:me.paymentType,onChange:ye=>ne({...me,paymentType:ye.target.value,codAmount:ye.target.value==="ADVANCE"?"":me.codAmount}),children:[e.jsx("option",{value:"COD",children:"COD"}),e.jsx("option",{value:"ADVANCE",children:"ADVANCE"})]})]}),e.jsx(ht,{label:"COD Amount (PKR)",type:"number",value:me.codAmount,onChange:ye=>ne({...me,codAmount:ye.target.value}),disabled:me.paymentType==="ADVANCE"}),e.jsx(ht,{label:"Weight (kg)",type:"number",step:"0.1",min:"0.1",value:me.weightKg,onChange:ye=>ne({...me,weightKg:ye.target.value}),required:!0,placeholder:"Enter weight in kg (e.g. 0.5, 1.2, 2.5)"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Service charges will be calculated automatically"})," ","based on the weight you enter and your shipper's configured weight brackets."]})})}),e.jsx(ht,{label:"Pieces",type:"number",value:me.pieces,onChange:ye=>ne({...me,pieces:ye.target.value})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ht,{label:"Product Description",value:me.productDescription,onChange:ye=>ne({...me,productDescription:ye.target.value})})}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:me.fragile,onChange:ye=>ne({...me,fragile:ye.target.checked})}),e.jsx("span",{className:"text-sm",children:"Fragile"})]}),e.jsx(ht,{label:"Remarks",value:me.remarks,onChange:ye=>ne({...me,remarks:ye.target.value})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(zt,{type:"button",variant:"outline",onClick:()=>{h.pathname.includes("/shipper/create")?f("list"):f("dashboard")},children:"Cancel"}),e.jsx(zt,{type:"submit",disabled:V,children:V?"Creating...":"Create Shipment"})]})]})]})}):p==="orders"?e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"My Orders"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto",children:[e.jsx("input",{value:R,onChange:ye=>j(ye.target.value),type:"text",placeholder:"Search orders...",className:"pl-3 pr-4 py-1.5 text-sm border border-gray-200 rounded-lg w-full sm:w-auto"}),e.jsxs("select",{value:L,onChange:ye=>P(ye.target.value),className:"pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white w-full sm:w-auto","aria-label":"Filter by Order Status",children:[e.jsx("option",{value:"ALL",children:"All Statuses"}),e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"OUT_FOR_DELIVERY",children:"Out for Delivery"}),e.jsx("option",{value:"DELIVERED",children:"Delivered"}),e.jsx("option",{value:"RETURNED",children:"Returned"})]}),e.jsxs("select",{value:O,onChange:ye=>_(ye.target.value),className:"pl-3 pr-8 py-1.5 text-sm border border-gray-200 rounded-lg bg-white w-full sm:w-auto","aria-label":"Filter by Date Range",children:[e.jsx("option",{value:"all",children:"All Orders"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"})]}),e.jsx("button",{onClick:Z,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"}),fe?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:Be,className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary",children:["Print Selected (",G.length,"/",N.length,")"]}),e.jsx("button",{onClick:()=>{E(!1),U([])},className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Cancel"})]}):e.jsx("button",{onClick:()=>{E(!0),U([])},className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary",children:"Print Labels"})]})]})}),e.jsx("div",{className:"p-6",children:Je.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No orders yet."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2 px-3",children:"Select"}),e.jsx("th",{className:"py-2 px-3",children:"Order ID"}),e.jsx("th",{className:"py-2 px-3",children:"Source"}),e.jsx("th",{className:"py-2 px-3",children:"Booking"}),e.jsx("th",{className:"py-2 px-3",children:"Consignee"}),e.jsx("th",{className:"py-2 px-3",children:"COD"}),e.jsx("th",{className:"py-2 px-3",children:"Date"}),e.jsx("th",{className:"py-2 px-3",children:"Status"}),e.jsx("th",{className:"py-2 px-3",children:"Payment"}),e.jsx("th",{className:"py-2 px-3",children:"Actions"})]})}),e.jsx("tbody",{children:Je.map(ye=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 cursor-pointer",onClick:()=>!fe&&F(`/shipper/order/${ye._id}`),children:[e.jsx("td",{className:"py-2 px-3",children:e.jsx("input",{type:"checkbox",onClick:Fe=>Fe.stopPropagation(),checked:G.includes(ye._id),onChange:Fe=>jt(ye._id,Fe.target.checked),disabled:!fe})}),e.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:ye.bookingId}),e.jsx("td",{className:"py-2 px-3",children:yt(ye)}),e.jsx("td",{className:"py-2 px-3",children:mt(ye)}),e.jsx("td",{className:"py-2 px-3 text-secondary",children:ye.consigneeName}),e.jsxs("td",{className:"py-2 px-3",children:["PKR"," ",Number(ye.codAmount||0).toLocaleString()]}),e.jsx("td",{className:"py-2 px-3",children:new Date(ye.createdAt).toLocaleDateString()}),e.jsx("td",{className:"py-2 px-3 text-xs",children:Oe(ye.status)}),e.jsx("td",{className:"py-2 px-3 text-xs",children:ye.paymentType}),e.jsx("td",{className:"py-2 px-3",children:ye.isIntegrated&&ye.bookingState==="UNBOOKED"&&e.jsx("button",{className:"px-3 py-1 text-xs rounded border border-primary text-primary hover:bg-primary hover:text-white",onClick:Fe=>{Fe.stopPropagation(),Ze(ye._id)},children:"Book Now"})})]},ye._id))})]})})})]}):null]})},N0=({status:h})=>{const p=f=>{switch(f){case"Delivered":return"bg-green-100 text-green-800 border-green-200";case"In Transit":return"bg-blue-100 text-blue-800 border-blue-200";case"Assigned":return"bg-indigo-100 text-indigo-800 border-indigo-200";case"Created":return"bg-gray-100 text-gray-800 border-gray-200";case"Returned":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"Failed":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-semibold border ${p(h)}`,children:h})},ux=()=>{const{id:h}=tl(),p=As(),[f,y]=D.useState(null),[v,N]=D.useState(null),[A,R]=D.useState(!0),[j,w]=D.useState(""),C=typeof window<"u"?localStorage.getItem("token"):null,O=async()=>{R(!0),w("");try{const V=await fetch(`/api/orders/${h}`,{headers:{Authorization:C?`Bearer ${C}`:""}}),Y=await V.json();if(!V.ok)throw new Error(Y.message||"Failed to fetch order");y(Y);try{const ee=await fetch(`/api/finance/transactions/order/${h}`,{headers:{Authorization:C?`Bearer ${C}`:""}}),K=await ee.json();ee.ok&&N(K)}catch{}}catch(V){w(V.message)}finally{R(!1)}};if(D.useEffect(()=>{O()},[h]),A)return e.jsx("div",{className:"p-6",children:"Loading..."});if(j)return e.jsx("div",{className:"p-6 text-red-600 text-sm",children:j});if(!f)return null;const _=Number(f.codAmount||0).toLocaleString(),L=v?Number(v.companyCommission||0):0,P=v?Number((v.totalCodCollected||0)-(v.companyCommission||0)):null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(St,{className:"w-6 h-6 text-primary"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-secondary",children:["Order ",f.bookingId]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Service: ",f.serviceType]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>p(`/label-print/${h}`),className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary flex items-center gap-2",children:[e.jsx(Yx,{className:"w-4 h-4"})," Print Label"]}),e.jsx("button",{onClick:()=>p(-1),className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Back"})]})]}),e.jsxs("div",{className:"bg-secondary text-white rounded-2xl p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs opacity-80",children:"COD Amount"}),e.jsxs("div",{className:"text-3xl font-bold",children:["PKR ",_]})]}),e.jsx(N0,{status:f.status})]}),v&&e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary mb-2",children:"Settlement"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Total COD Collected"}),e.jsxs("div",{className:"font-semibold",children:["PKR ",Number(v.totalCodCollected||0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Service Charges"}),e.jsxs("div",{className:"font-semibold",children:["PKR ",Number(L).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Net Amount"}),e.jsx("div",{className:"font-semibold",children:P!==null?`PKR ${Number(P).toLocaleString()}`:""})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Order Details"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Weight"}),e.jsxs("div",{className:"font-semibold",children:[f.weightKg||f.weight||"N/A"," kg"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Service Charges"}),e.jsxs("div",{className:"font-semibold",children:["PKR ",Number(f.serviceCharges||0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Pieces"}),e.jsx("div",{className:"font-semibold",children:f.pieces||1})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Payment Type"}),e.jsx("div",{className:"font-semibold",children:f.paymentType||"COD"})]}),f.productDescription&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-gray-500",children:"Product Description"}),e.jsx("div",{className:"font-semibold",children:f.productDescription})]}),f.remarks&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-gray-500",children:"Remarks"}),e.jsx("div",{className:"font-semibold",children:f.remarks})]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Consignee"}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gn,{className:"w-4 h-4"})," ",f.consigneeAddress,","," ",f.destinationCity]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vn,{className:"w-4 h-4"})," ",f.consigneePhone]})]})]})}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Created on ",new Date(f.createdAt).toDateString()]})]})},lb=()=>{const{id:h}=tl(),p=As(),[f,y]=D.useState(null),[v,N]=D.useState(null),[A,R]=D.useState(!0),[j,w]=D.useState(""),C=typeof window<"u"?localStorage.getItem("token"):null,O=async()=>{R(!0),w("");try{const V=await fetch(`/api/orders/${h}`,{headers:{Authorization:C?`Bearer ${C}`:""}}),Y=await V.json();if(!V.ok)throw new Error(Y.message||"Failed to fetch order");y(Y);try{const ee=await fetch(`/api/finance/transactions/order/${h}`,{headers:{Authorization:C?`Bearer ${C}`:""}}),K=await ee.json();ee.ok&&N(K)}catch{}}catch(V){w(V.message)}finally{R(!1)}};if(D.useEffect(()=>{O()},[h]),A)return e.jsx("div",{className:"p-6",children:"Loading..."});if(j)return e.jsx("div",{className:"p-6 text-red-600 text-sm",children:j});if(!f)return null;const _=Number(f.codAmount||0).toLocaleString(),L=v?Number(v.companyCommission||0):0,P=v?Number((v.totalCodCollected||0)-(v.companyCommission||0)):null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(St,{className:"w-6 h-6 text-primary"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-secondary",children:["Order ",f.bookingId]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Service: ",f.serviceType]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>p(-1),className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 flex items-center gap-1",children:[e.jsx(h0,{className:"w-4 h-4"})," Back"]})})]}),e.jsxs("div",{className:"bg-secondary text-white rounded-2xl p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs opacity-80",children:"COD Amount"}),e.jsxs("div",{className:"text-3xl font-bold",children:["PKR ",_]})]}),e.jsx(N0,{status:f.status})]}),v&&e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary mb-2",children:"Settlement"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Total COD Collected"}),e.jsxs("div",{className:"font-semibold",children:["PKR ",Number(v.totalCodCollected||0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Service Charges"}),e.jsxs("div",{className:"font-semibold",children:["PKR ",Number(L).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Net Amount"}),e.jsx("div",{className:"font-semibold",children:P!==null?`PKR ${Number(P).toLocaleString()}`:""})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Order Details"}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Weight"}),e.jsxs("div",{className:"font-semibold",children:[f.weightKg||f.weight||"N/A"," kg"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Service Charges"}),e.jsxs("div",{className:"font-semibold",children:["PKR ",Number(f.serviceCharges||0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Pieces"}),e.jsx("div",{className:"font-semibold",children:f.pieces||1})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Payment Type"}),e.jsx("div",{className:"font-semibold",children:f.paymentType||"COD"})]}),f.productDescription&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-gray-500",children:"Product Description"}),e.jsx("div",{className:"font-semibold",children:f.productDescription})]}),f.remarks&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-gray-500",children:"Remarks"}),e.jsx("div",{className:"font-semibold",children:f.remarks})]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Consignee"}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gn,{className:"w-4 h-4"})," ",f.consigneeAddress,","," ",f.destinationCity]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vn,{className:"w-4 h-4"})," ",f.consigneePhone]})]})]})}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Created on ",new Date(f.createdAt).toDateString()]})]})};function ob(){const[h,p]=D.useState(null),[f,y]=D.useState(!1),[v,N]=D.useState(""),A=localStorage.getItem("token"),R=async()=>{y(!0),N("");try{const _=await fetch("/api/integrations/shipper/me",{headers:{Authorization:A?`Bearer ${A}`:""}}),L=await _.json();if(!_.ok)throw new Error(L.message||"Failed to load");p(L)}catch(_){N(_.message)}finally{y(!1)}};D.useEffect(()=>{R()},[]);const j=async()=>{try{const _=await fetch("/api/integrations/shipper/me",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:A?`Bearer ${A}`:""},body:JSON.stringify({enabled:h.enabled,providers:h.providers})}),L=await _.json();if(!_.ok)throw new Error(L.message||"Failed to save");p(L),alert("Saved")}catch(_){alert(_.message)}},w=async()=>{try{const _=await fetch("/api/integrations/shipper/me/regenerate-key",{method:"POST",headers:{Authorization:A?`Bearer ${A}`:""}}),L=await _.json();if(!_.ok)throw new Error(L.message||"Failed to regenerate key");p(P=>({...P,apiKey:L.apiKey}))}catch(_){alert(_.message)}},C=async()=>{try{await navigator.clipboard.writeText(h.apiKey||""),alert("API Key copied")}catch{}},O=_=>`https://jeanelle-relaxative-lera.ngrok-free.dev/api/integrations/${_.toLowerCase()}/orders?key=${h.apiKey}`;return f?e.jsx("div",{className:"p-6",children:"Loading..."}):v?e.jsx("div",{className:"p-6 text-red-600",children:v}):h?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-secondary",children:"Integrations"}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[e.jsx("div",{className:"font-semibold",children:"Enable Integrations"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:!!h.enabled,onChange:_=>p(L=>({...L,enabled:_.target.checked}))})," Enabled"]})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-6",children:[e.jsx("div",{className:"font-semibold mb-2",children:"API Key"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[e.jsx("code",{className:"px-3 py-1.5 bg-gray-50 border border-gray-200 rounded text-sm select-all w-full sm:w-auto mb-2 sm:mb-0 break-all",children:h.apiKey}),e.jsxs("button",{onClick:C,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 w-full sm:w-auto",children:[e.jsx(r2,{className:"w-4 h-4 inline"})," Copy"]}),e.jsx("button",{onClick:w,className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary w-full sm:w-auto",children:"Regenerate"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["External systems must send header ",e.jsx("code",{children:"X-LahoreLink-Integration-Key"})," with this value."]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-6",children:[e.jsx("div",{className:"font-semibold mb-2",children:"Providers"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["SHOPIFY","WOOCOMMERCE","CUSTOM"].map(_=>{const L=(h.providers||[]).findIndex(Y=>Y.provider===_),P=L>=0?h.providers[L]:{enabled:!1},V=Y=>p(ee=>{const K=[...ee.providers||[]],H=K.findIndex(q=>q.provider===_);return H>=0?K[H]={...K[H],...Y}:K.push({provider:_,...Y}),{...ee,providers:K}});return e.jsxs("div",{className:"border border-gray-200 rounded p-4",children:[e.jsx("div",{className:"font-semibold mb-2",children:_}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:!!P.enabled,onChange:Y=>V({enabled:Y.target.checked})})," Enabled"]}),e.jsx("div",{className:"text-xs text-gray-600 mt-2",children:"Webhook URL:"}),e.jsx("code",{className:"text-xs bg-gray-50 border border-gray-200 rounded px-2 py-1 block mt-1 break-all",children:O(_)})]},_)})}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:j,className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary",children:"Save Changes"})})]})]}):null}const cb=()=>{const[h,p]=D.useState([]),[f,y]=D.useState(!0),[v,N]=D.useState(""),[A,R]=D.useState(""),[j,w]=D.useState(null),[C,O]=D.useState({}),_=typeof window<"u"?localStorage.getItem("token"):null,L=async()=>{y(!0),N("");try{const K=await fetch("/api/orders/integrated/pending",{headers:{Authorization:_?`Bearer ${_}`:""}}),H=await K.json();if(!K.ok)throw new Error((H==null?void 0:H.message)||"Failed to load integrated orders");p(Array.isArray(H)?H:[])}catch(K){N(K.message||"Failed to load integrated orders")}finally{y(!1)}};D.useEffect(()=>{L()},[]);const P=D.useMemo(()=>{const K=A.trim().toLowerCase();return K?h.filter(H=>String((H==null?void 0:H.bookingId)||"").toLowerCase().includes(K)||String((H==null?void 0:H.consigneeName)||"").toLowerCase().includes(K)||String((H==null?void 0:H.destinationCity)||"").toLowerCase().includes(K)):h},[h,A]),V=K=>{const H=(K==null?void 0:K.bookingState)==="BOOKED",q=(K==null?void 0:K.isDeleted)===!0,te=q?"Deleted":H?"Booked":"Pending Approval",ce=q?"bg-red-50 text-red-700 border-red-200":H?"bg-green-50 text-green-700 border-green-200":"bg-amber-50 text-amber-800 border-amber-200";return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs border ${ce}`,children:te})},Y=async K=>{try{O(te=>({...te,[K]:!0}));const H=await fetch(`/api/orders/${K}/book`,{method:"PATCH",headers:{Authorization:_?`Bearer ${_}`:""}}),q=await H.json();if(!H.ok)throw new Error((q==null?void 0:q.message)||"Failed to book order");p(te=>te.filter(ce=>ce._id!==K))}catch(H){N(H.message||"Failed to book order")}finally{O(H=>({...H,[K]:!1}))}},ee=async K=>{try{O(te=>({...te,[K]:!0}));const H=await fetch(`/api/orders/${K}/reject`,{method:"PATCH",headers:{Authorization:_?`Bearer ${_}`:""}}),q=await H.json();if(!H.ok)throw new Error((q==null?void 0:q.message)||"Failed to delete order");p(te=>te.filter(ce=>ce._id!==K)),w(null)}catch(H){N(H.message||"Failed to delete order")}finally{O(H=>({...H,[K]:!1}))}};return e.jsxs("div",{className:"space-y-6",children:[v&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:v}),e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(St,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Integrated Orders"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto",children:[e.jsx("input",{value:A,onChange:K=>R(K.target.value),type:"text",placeholder:"Search orders...",className:"pl-3 pr-4 py-1.5 text-sm border border-gray-200 rounded-lg w-full sm:w-auto"}),e.jsxs("button",{onClick:L,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 flex items-center gap-2",disabled:f,children:[e.jsx(Gn,{className:`w-4 h-4 ${f?"animate-spin":""}`}),"Refresh"]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:e.jsx("div",{className:"p-6",children:f?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):P.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No integrated orders pending approval."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500",children:[e.jsx("th",{className:"py-2 px-3",children:"Order ID"}),e.jsx("th",{className:"py-2 px-3",children:"Customer"}),e.jsx("th",{className:"py-2 px-3",children:"City"}),e.jsx("th",{className:"py-2 px-3",children:"COD / Amount"}),e.jsx("th",{className:"py-2 px-3",children:"Status"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:P.map(K=>{const H=!!C[K._id],q=Number((K==null?void 0:K.codAmount)||0);return e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"py-2 px-3 font-mono text-xs",children:K.bookingId}),e.jsx("td",{className:"py-2 px-3 text-secondary",children:K.consigneeName||""}),e.jsx("td",{className:"py-2 px-3",children:K.destinationCity||""}),e.jsxs("td",{className:"py-2 px-3",children:["PKR ",q.toLocaleString()]}),e.jsx("td",{className:"py-2 px-3",children:V(K)}),e.jsx("td",{className:"py-2 px-3",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>Y(K._id),disabled:H,className:"px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary disabled:opacity-60",children:H?"Working...":"Book"}),e.jsxs("button",{onClick:()=>w(K),disabled:H,className:"px-3 py-1.5 text-xs bg-red-50 hover:bg-red-100 text-red-700 rounded border border-red-200 flex items-center gap-2 disabled:opacity-60",children:[e.jsx(g0,{className:"w-4 h-4"})," Delete"]})]})})]},K._id)})})]})})})}),j&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>w(null),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",onClick:K=>K.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Confirm Delete"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Are you sure you want to delete this integrated order?"})]}),e.jsxs("div",{className:"p-6 flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>w(null),className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Cancel"}),e.jsx("button",{onClick:()=>ee(j._id),className:"px-3 py-1.5 text-xs bg-red-600 hover:bg-red-700 text-white rounded border border-red-600",disabled:!!C[j._id],children:"Confirm"})]})]})})]})},Or=h=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0}).format(Number(h||0)),hx=h=>{if(!h)return"";const p=new Date(h);return Number.isNaN(p.getTime())?"":p.toLocaleString()},db=h=>{if(h==null)return null;const p=typeof h=="number"?h:parseFloat(String(h));return!Number.isFinite(p)||p<=0?null:(Math.round(p*100)/100).toFixed(2).replace(/\.0+$/,"").replace(/\.([1-9])0$/,".$1")},ub=()=>{var ae,F,W,Q,Ne,Se,fe,E,G,U;const{user:h}=Fs(),p=(h==null?void 0:h.token)||Xs(),[f,y]=D.useState(!1),[v,N]=D.useState(!1),[A,R]=D.useState(""),[j,w]=D.useState(null),[C,O]=D.useState({rows:[],totals:null,total:0,page:1,totalPages:1}),[_,L]=D.useState(""),[P,V]=D.useState(""),[Y,ee]=D.useState("ALL"),[K,H]=D.useState(""),[q,te]=D.useState(1),ce=20,$=Number((j==null?void 0:j.balance)||0),Re=D.useMemo(()=>{const Z=$>=0;return{positive:Z,colorClass:Z?"text-green-700":"text-red-600",helper:Z?"Payable to Shipper":"Payable by Shipper"}},[$]),oe=async()=>{y(!0),R("");try{const Z=await fetch("/api/shipper/finance/summary",{headers:{Authorization:p?`Bearer ${p}`:""}}),we=await Z.json();if(!Z.ok)throw new Error(we.message||"Failed to load finance summary");w(we)}catch(Z){R(Z.message)}finally{y(!1)}},Ee=async(Z={})=>{N(!0),R("");try{const we=new URLSearchParams;(Z.from??_)&&we.set("from",Z.from??_),(Z.to??P)&&we.set("to",Z.to??P);const xe=Z.paidStatus??Y;(xe==="PAID"||xe==="UNPAID")&&we.set("status",xe);const Ge=Z.search??K;Ge&&String(Ge).trim()&&we.set("search",String(Ge).trim());const Ve=Z.page??q;we.set("page",String(Ve)),we.set("limit",String(ce));const Je=await fetch(`/api/shipper/finance/ledger?${we.toString()}`,{headers:{Authorization:p?`Bearer ${p}`:""}}),jt=await Je.json();if(!Je.ok)throw new Error(jt.message||"Failed to load ledger");O(jt)}catch(we){R(we.message)}finally{N(!1)}};D.useEffect(()=>{oe()},[p]),D.useEffect(()=>{Ee({page:q})},[p,q]);const me=async()=>{te(1),await Ee({page:1})},ne=async()=>{try{const Z=new URLSearchParams;_&&Z.set("from",_),P&&Z.set("to",P),(Y==="PAID"||Y==="UNPAID")&&Z.set("status",Y),K&&String(K).trim()&&Z.set("search",String(K).trim()),Z.set("format","csv"),Z.set("limit","all");const we=await fetch(`/api/shipper/finance/ledger?${Z.toString()}`,{headers:{Authorization:p?`Bearer ${p}`:""}});if(!we.ok){const Je=await we.json().catch(()=>({}));throw new Error(Je.message||"Failed to download CSV")}const xe=await we.blob(),Ge=window.URL.createObjectURL(xe),Ve=document.createElement("a");Ve.href=Ge,Ve.download="shipper-ledger.csv",document.body.appendChild(Ve),Ve.click(),Ve.remove(),window.URL.revokeObjectURL(Ge)}catch(Z){R(Z.message)}},J=j==null?void 0:j.serviceChargesPolicy;return e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ts,{className:"w-6 h-6 text-green-600"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Finance"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(zt,{variant:"outline",onClick:ne,className:"text-xs",children:[e.jsx(Rc,{className:"w-4 h-4"}),"Download CSV"]})})]})}),A&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:A}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-5 border-b border-gray-100",children:[e.jsx("div",{className:"text-sm font-bold text-secondary",children:"Info"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Shipper profile (read-only)"})]}),e.jsxs("div",{className:"p-5 space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"text-gray-500",children:"Name"}),e.jsx("div",{className:"font-medium text-secondary text-right",children:((ae=j==null?void 0:j.shipper)==null?void 0:ae.name)||""})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"text-gray-500",children:"Company"}),e.jsx("div",{className:"font-medium text-secondary text-right",children:((F=j==null?void 0:j.shipper)==null?void 0:F.companyName)||""})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"text-gray-500",children:"Phone"}),e.jsx("div",{className:"font-medium text-secondary text-right",children:((W=j==null?void 0:j.shipper)==null?void 0:W.phone)||""})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"text-gray-500",children:"Email"}),e.jsx("div",{className:"font-medium text-secondary text-right",children:((Q=j==null?void 0:j.shipper)==null?void 0:Q.email)||""})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"text-gray-500",children:"Address"}),e.jsx("div",{className:"font-medium text-secondary text-right",children:((Ne=j==null?void 0:j.shipper)==null?void 0:Ne.address)||""})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"text-gray-500",children:"CNIC/NTN"}),e.jsx("div",{className:"font-medium text-secondary text-right",children:((Se=j==null?void 0:j.shipper)==null?void 0:Se.cnic)||""})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"text-gray-500",children:"Account Created"}),e.jsx("div",{className:"font-medium text-secondary text-right",children:hx((fe=j==null?void 0:j.shipper)==null?void 0:fe.createdAt)})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-5 border-b border-gray-100",children:[e.jsx("div",{className:"text-sm font-bold text-secondary",children:"Services / Charges"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Pricing policy decided by management"})]}),e.jsx("div",{className:"p-5",children:J?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Policy"}),e.jsx("div",{className:"font-medium text-secondary",children:"Weight Brackets (PKR / parcel)"})]}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b bg-gray-50",children:[e.jsx("th",{className:"py-2 px-3",children:"Min (kg)"}),e.jsx("th",{className:"py-2 px-3",children:"Max (kg)"}),e.jsx("th",{className:"py-2 px-3 text-right",children:"Charge"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:(J.weightBrackets||[]).map((Z,we)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-3",children:Number(Z.minKg||0)}),e.jsx("td",{className:"py-2 px-3",children:Z.maxKg===null||Z.maxKg===void 0?"":Number(Z.maxKg)}),e.jsx("td",{className:"py-2 px-3 text-right font-medium",children:Or(Z.charge)})]},we))})]})}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Units:",e.jsx("span",{className:"font-medium text-gray-700",children:" PKR per parcel"})]})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"No pricing policy found."})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-5 border-b border-gray-100",children:[e.jsx("div",{className:"text-sm font-bold text-secondary",children:"Balance"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Computed from ledger entries"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:`text-4xl font-extrabold tracking-tight ${Re.colorClass}`,children:f?"":Or($)}),e.jsx("div",{className:"mt-2 text-sm text-gray-500",children:Re.helper}),e.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:["Positive/Zero:",e.jsx("span",{className:"text-green-700 font-medium",children:" payable to shipper"}),e.jsx("span",{className:"mx-2",children:"|"}),"Negative:",e.jsx("span",{className:"text-red-600 font-medium",children:" payable by shipper"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(sl,{className:"w-4 h-4 text-gray-500"}),e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Ledger / Journal"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Newest first"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"From"}),e.jsx("input",{type:"date",value:_,onChange:Z=>L(Z.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"To"}),e.jsx("input",{type:"date",value:P,onChange:Z=>V(Z.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"Paid Status"}),e.jsxs("select",{value:Y,onChange:Z=>ee(Z.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"ALL",children:"All"}),e.jsx("option",{value:"PAID",children:"Paid"}),e.jsx("option",{value:"UNPAID",children:"Unpaid"})]})]}),e.jsxs("div",{className:"flex flex-col md:col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"Search Booking ID"}),e.jsx("input",{value:K,onChange:Z=>H(Z.target.value),placeholder:"e.g. BKG-000123",className:"px-3 py-2 text-sm border border-gray-200 rounded-lg"})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 w-full sm:w-auto",children:[e.jsx(zt,{onClick:me,className:"w-full sm:w-auto text-xs",children:"Apply Filters"}),e.jsx(zt,{variant:"outline",onClick:()=>{L(""),V(""),ee("ALL"),H(""),te(1),Ee({from:"",to:"",paidStatus:"ALL",search:"",page:1})},className:"w-full sm:w-auto text-xs",children:"Reset"})]}),e.jsxs("div",{className:"text-xs text-gray-500 w-full sm:w-auto",children:["Totals (filtered):",e.jsxs("span",{className:"ml-2",children:["COD: ",e.jsx("span",{className:"font-medium text-secondary",children:Or(((E=C==null?void 0:C.totals)==null?void 0:E.totalCod)||0)})]}),e.jsxs("span",{className:"ml-2",children:["Charges: ",e.jsx("span",{className:"font-medium text-secondary",children:Or(((G=C==null?void 0:C.totals)==null?void 0:G.totalServiceCharges)||0)})]}),e.jsxs("span",{className:"ml-2",children:["Receivable: ",e.jsx("span",{className:"font-medium text-secondary",children:Or(((U=C==null?void 0:C.totals)==null?void 0:U.totalReceivable)||0)})]})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-[900px] md:min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b bg-gray-50",children:[e.jsx("th",{className:"py-3 px-4",children:"Date/Time"}),e.jsx("th",{className:"py-3 px-4",children:"Particular"}),e.jsx("th",{className:"py-3 px-4",children:"Booking ID"}),e.jsx("th",{className:"py-3 px-4 text-right",children:"Weight (kg)"}),e.jsx("th",{className:"py-3 px-4 text-right",children:"COD Amount"}),e.jsx("th",{className:"py-3 px-4 text-right",children:"Service Charges"}),e.jsx("th",{className:"py-3 px-4 text-right",children:"Receivable"}),e.jsx("th",{className:"py-3 px-4 text-center",children:"Paid"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:v?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"py-10 px-4 text-center text-gray-500",children:"Loading transactions"})}):((C==null?void 0:C.rows)||[]).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"py-10 px-4 text-center text-gray-500",children:"No transactions found"})}):(C.rows||[]).map(Z=>{const we=Number(Z.receivable??Z.amount??0),xe=db(Z.weightKg);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-xs text-gray-600",children:hx(Z.date)}),e.jsx("td",{className:"py-3 px-4",children:Z.particular||""}),e.jsx("td",{className:"py-3 px-4 font-mono text-xs",children:Z.bookingId||""}),e.jsx("td",{className:"py-3 px-4 text-right",children:xe??"N/A"}),e.jsx("td",{className:"py-3 px-4 text-right",children:Or(Z.codAmount??0)}),e.jsx("td",{className:"py-3 px-4 text-right",children:Or(Z.serviceCharges??0)}),e.jsx("td",{className:`py-3 px-4 text-right font-semibold ${we>=0?"text-green-700":"text-red-600"}`,children:Or(we)}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Z.status==="PAID"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:Z.status==="PAID"?"Paid":"Unpaid"})})]},Z._id)})})]})}),e.jsxs("div",{className:"p-4 border-t border-gray-100 flex items-center justify-between flex-wrap gap-2",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Showing page ",(C==null?void 0:C.page)||1," of ",(C==null?void 0:C.totalPages)||1," (Total ",(C==null?void 0:C.total)||0,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>te(Z=>Math.max(1,Z-1)),disabled:((C==null?void 0:C.page)||1)<=1,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Prev"}),e.jsx("button",{onClick:()=>te(Z=>Math.min((C==null?void 0:C.totalPages)||1,Z+1)),disabled:((C==null?void 0:C.page)||1)>=((C==null?void 0:C.totalPages)||1),className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})},fx=()=>{const{user:h,refreshMe:p,logout:f}=Fs(),y=As(),[v,N]=D.useState(!1),[A,R]=D.useState(""),[j,w]=D.useState(()=>h?{role:h.role,portalActive:h.portalActive??null,weightBracketsCount:h.weightBracketsCount??null}:null),C=async()=>{try{N(!0),R("");const L=await p();w({role:L==null?void 0:L.role,portalActive:L==null?void 0:L.portalActive,weightBracketsCount:L==null?void 0:L.weightBracketsCount})}catch(L){if((L==null?void 0:L.status)===401){await f(),y("/",{replace:!0});return}R(L.message||"Failed to fetch status")}finally{N(!1)}},O=async()=>{try{await f()}finally{y("/",{replace:!0})}};D.useEffect(()=>{C()},[]);const _=(j==null?void 0:j.portalActive)===!0;return D.useEffect(()=>{_&&y("/shipper/dashboard",{replace:!0})},[_,y]),e.jsx("div",{className:"min-h-[70vh] flex items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-xl bg-white border border-gray-100 shadow-sm rounded-2xl p-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center",children:e.jsx(m0,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-secondary",children:"Verification in Progress"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Your account is under configuration. Please wait until management sets your weight brackets. You will get access once configured."})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[A&&e.jsxs("div",{className:"p-3 rounded-lg bg-red-50 border border-red-100 flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(Xn,{className:"w-4 h-4"}),A]}),e.jsxs("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-200 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-gray-600",children:"Portal access"}),e.jsx("div",{className:"font-semibold text-secondary",children:j?_?"ACTIVE":"PENDING":""})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("div",{className:"text-gray-600",children:"Weight brackets"}),e.jsx("div",{className:"font-semibold text-secondary",children:typeof(j==null?void 0:j.weightBracketsCount)=="number"?j.weightBracketsCount:""})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Contact support if this takes longer than expected."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(zt,{onClick:O,disabled:v,variant:"outline",children:[e.jsx(Xx,{className:"w-4 h-4"}),"Logout"]}),e.jsxs(zt,{onClick:C,disabled:v,variant:"outline",children:[e.jsx(Gn,{className:`w-4 h-4 ${v?"animate-spin":""}`}),"Refresh Status"]})]})]}),_&&e.jsx("div",{className:"p-3 rounded-lg bg-green-50 border border-green-100 text-green-700 text-sm",children:"Your portal is now active. Redirecting you to your dashboard..."})]})]})})},xx={0:"101001101101",1:"110100101011",2:"101100101011",3:"110110010101",4:"101001101011",5:"110100110101",6:"101100110101",7:"101001011011",8:"110100101101",9:"101100101101",A:"110101001011",B:"101101001011",C:"110110100101",D:"101011001011",E:"110101100101",F:"101101100101",G:"101010011011",H:"110101001101",I:"101101001101",J:"101011001101",K:"110101010011",L:"101101010011",M:"110110101001",N:"101011010011",O:"110101101001",P:"101101101001",Q:"101010110011",R:"110101011001",S:"101101011001",T:"101011011001",U:"110010101011",V:"100110101011",W:"110011010101",X:"100101101011",Y:"110010110101",Z:"100110110101","-":"100101011011",".":"110010101101"," ":"100110101101",$:"100100100101","/":"100100101001","+":"100101001001","%":"101001001001","*":"100101101101"},zu=({value:h,height:p=60,barWidth:f=2,targetWidth:y,showValue:v=!0,className:N=""})=>{const A=typeof p=="string"&&p.startsWith("h-"),R=A?p==="h-6"?24:p==="h-8"?32:40:p;if(!h)return e.jsx("div",{className:`${N} ${A?p:""} border border-dashed border-gray-400 flex items-center justify-center text-xs text-gray-500`,children:"[BARCODE]"});const j=`*${String(h).toUpperCase()}*`;let w="";for(const L of j){const P=xx[L]||xx["-"];w+=P+"0"}const C=[];let O=0;for(const L of w){const P=f;L==="1"&&C.push(e.jsx("rect",{x:O,y:0,width:P,height:R,fill:"#000"},O)),O+=P}const _=y||O;return e.jsxs("div",{className:N,children:[e.jsx("svg",{width:A?"100%":_,height:A?p:R,viewBox:`0 0 ${O} ${R}`,xmlns:"http://www.w3.org/2000/svg",shapeRendering:"crispEdges",preserveAspectRatio:"none",style:A?{display:"block"}:{},children:C}),v&&h&&e.jsx("div",{className:"text-xs text-center mt-1",children:h})]})};var Yi={},Hu={exports:{}},Vu,mx;function hb(){if(mx)return Vu;mx=1;var h="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Vu=h,Vu}var Gu,gx;function fb(){if(gx)return Gu;gx=1;var h=hb();function p(){}function f(){}return f.resetWarningCache=p,Gu=function(){function y(A,R,j,w,C,O){if(O!==h){var _=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw _.name="Invariant Violation",_}}y.isRequired=y;function v(){return y}var N={array:y,bigint:y,bool:y,func:y,number:y,object:y,string:y,symbol:y,any:y,arrayOf:v,element:y,elementType:y,instanceOf:v,node:y,objectOf:v,oneOf:v,oneOfType:v,shape:v,exact:v,checkPropTypes:f,resetWarningCache:p};return N.PropTypes=N,N},Gu}var px;function Jx(){return px||(px=1,Hu.exports=fb()()),Hu.exports}var Xu,yx;function $x(){return yx||(yx=1,Xu={L:1,M:0,Q:3,H:2}),Xu}var Yu,bx;function em(){return bx||(bx=1,Yu={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}),Yu}var qu,wx;function xb(){if(wx)return qu;wx=1;var h=em();function p(f){this.mode=h.MODE_8BIT_BYTE,this.data=f}return p.prototype={getLength:function(f){return this.data.length},write:function(f){for(var y=0;y<this.data.length;y++)f.put(this.data.charCodeAt(y),8)}},qu=p,qu}var Ku,Nx;function mb(){if(Nx)return Ku;Nx=1;var h=$x();function p(f,y){this.totalCount=f,this.dataCount=y}return p.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],p.getRSBlocks=function(f,y){var v=p.getRsBlockTable(f,y);if(v==null)throw new Error("bad rs block @ typeNumber:"+f+"/errorCorrectLevel:"+y);for(var N=v.length/3,A=new Array,R=0;R<N;R++)for(var j=v[R*3+0],w=v[R*3+1],C=v[R*3+2],O=0;O<j;O++)A.push(new p(w,C));return A},p.getRsBlockTable=function(f,y){switch(y){case h.L:return p.RS_BLOCK_TABLE[(f-1)*4+0];case h.M:return p.RS_BLOCK_TABLE[(f-1)*4+1];case h.Q:return p.RS_BLOCK_TABLE[(f-1)*4+2];case h.H:return p.RS_BLOCK_TABLE[(f-1)*4+3];default:return}},Ku=p,Ku}var Zu,vx;function gb(){if(vx)return Zu;vx=1;function h(){this.buffer=new Array,this.length=0}return h.prototype={get:function(p){var f=Math.floor(p/8);return(this.buffer[f]>>>7-p%8&1)==1},put:function(p,f){for(var y=0;y<f;y++)this.putBit((p>>>f-y-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(p){var f=Math.floor(this.length/8);this.buffer.length<=f&&this.buffer.push(0),p&&(this.buffer[f]|=128>>>this.length%8),this.length++}},Zu=h,Zu}var Wu,jx;function tm(){if(jx)return Wu;jx=1;for(var h={glog:function(f){if(f<1)throw new Error("glog("+f+")");return h.LOG_TABLE[f]},gexp:function(f){for(;f<0;)f+=255;for(;f>=256;)f-=255;return h.EXP_TABLE[f]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},p=0;p<8;p++)h.EXP_TABLE[p]=1<<p;for(var p=8;p<256;p++)h.EXP_TABLE[p]=h.EXP_TABLE[p-4]^h.EXP_TABLE[p-5]^h.EXP_TABLE[p-6]^h.EXP_TABLE[p-8];for(var p=0;p<255;p++)h.LOG_TABLE[h.EXP_TABLE[p]]=p;return Wu=h,Wu}var Qu,Cx;function sm(){if(Cx)return Qu;Cx=1;var h=tm();function p(f,y){if(f.length==null)throw new Error(f.length+"/"+y);for(var v=0;v<f.length&&f[v]==0;)v++;this.num=new Array(f.length-v+y);for(var N=0;N<f.length-v;N++)this.num[N]=f[N+v]}return p.prototype={get:function(f){return this.num[f]},getLength:function(){return this.num.length},multiply:function(f){for(var y=new Array(this.getLength()+f.getLength()-1),v=0;v<this.getLength();v++)for(var N=0;N<f.getLength();N++)y[v+N]^=h.gexp(h.glog(this.get(v))+h.glog(f.get(N)));return new p(y,0)},mod:function(f){if(this.getLength()-f.getLength()<0)return this;for(var y=h.glog(this.get(0))-h.glog(f.get(0)),v=new Array(this.getLength()),N=0;N<this.getLength();N++)v[N]=this.get(N);for(var N=0;N<f.getLength();N++)v[N]^=h.gexp(h.glog(f.get(N))+y);return new p(v,0).mod(f)}},Qu=p,Qu}var Ju,Ax;function pb(){if(Ax)return Ju;Ax=1;var h=em(),p=sm(),f=tm(),y={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},v={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(N){for(var A=N<<10;v.getBCHDigit(A)-v.getBCHDigit(v.G15)>=0;)A^=v.G15<<v.getBCHDigit(A)-v.getBCHDigit(v.G15);return(N<<10|A)^v.G15_MASK},getBCHTypeNumber:function(N){for(var A=N<<12;v.getBCHDigit(A)-v.getBCHDigit(v.G18)>=0;)A^=v.G18<<v.getBCHDigit(A)-v.getBCHDigit(v.G18);return N<<12|A},getBCHDigit:function(N){for(var A=0;N!=0;)A++,N>>>=1;return A},getPatternPosition:function(N){return v.PATTERN_POSITION_TABLE[N-1]},getMask:function(N,A,R){switch(N){case y.PATTERN000:return(A+R)%2==0;case y.PATTERN001:return A%2==0;case y.PATTERN010:return R%3==0;case y.PATTERN011:return(A+R)%3==0;case y.PATTERN100:return(Math.floor(A/2)+Math.floor(R/3))%2==0;case y.PATTERN101:return A*R%2+A*R%3==0;case y.PATTERN110:return(A*R%2+A*R%3)%2==0;case y.PATTERN111:return(A*R%3+(A+R)%2)%2==0;default:throw new Error("bad maskPattern:"+N)}},getErrorCorrectPolynomial:function(N){for(var A=new p([1],0),R=0;R<N;R++)A=A.multiply(new p([1,f.gexp(R)],0));return A},getLengthInBits:function(N,A){if(1<=A&&A<10)switch(N){case h.MODE_NUMBER:return 10;case h.MODE_ALPHA_NUM:return 9;case h.MODE_8BIT_BYTE:return 8;case h.MODE_KANJI:return 8;default:throw new Error("mode:"+N)}else if(A<27)switch(N){case h.MODE_NUMBER:return 12;case h.MODE_ALPHA_NUM:return 11;case h.MODE_8BIT_BYTE:return 16;case h.MODE_KANJI:return 10;default:throw new Error("mode:"+N)}else if(A<41)switch(N){case h.MODE_NUMBER:return 14;case h.MODE_ALPHA_NUM:return 13;case h.MODE_8BIT_BYTE:return 16;case h.MODE_KANJI:return 12;default:throw new Error("mode:"+N)}else throw new Error("type:"+A)},getLostPoint:function(N){for(var A=N.getModuleCount(),R=0,j=0;j<A;j++)for(var w=0;w<A;w++){for(var C=0,O=N.isDark(j,w),_=-1;_<=1;_++)if(!(j+_<0||A<=j+_))for(var L=-1;L<=1;L++)w+L<0||A<=w+L||_==0&&L==0||O==N.isDark(j+_,w+L)&&C++;C>5&&(R+=3+C-5)}for(var j=0;j<A-1;j++)for(var w=0;w<A-1;w++){var P=0;N.isDark(j,w)&&P++,N.isDark(j+1,w)&&P++,N.isDark(j,w+1)&&P++,N.isDark(j+1,w+1)&&P++,(P==0||P==4)&&(R+=3)}for(var j=0;j<A;j++)for(var w=0;w<A-6;w++)N.isDark(j,w)&&!N.isDark(j,w+1)&&N.isDark(j,w+2)&&N.isDark(j,w+3)&&N.isDark(j,w+4)&&!N.isDark(j,w+5)&&N.isDark(j,w+6)&&(R+=40);for(var w=0;w<A;w++)for(var j=0;j<A-6;j++)N.isDark(j,w)&&!N.isDark(j+1,w)&&N.isDark(j+2,w)&&N.isDark(j+3,w)&&N.isDark(j+4,w)&&!N.isDark(j+5,w)&&N.isDark(j+6,w)&&(R+=40);for(var V=0,w=0;w<A;w++)for(var j=0;j<A;j++)N.isDark(j,w)&&V++;var Y=Math.abs(100*V/A/A-50)/5;return R+=Y*10,R}};return Ju=v,Ju}var $u,Ex;function yb(){if(Ex)return $u;Ex=1;var h=xb(),p=mb(),f=gb(),y=pb(),v=sm();function N(R,j){this.typeNumber=R,this.errorCorrectLevel=j,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var A=N.prototype;return A.addData=function(R){var j=new h(R);this.dataList.push(j),this.dataCache=null},A.isDark=function(R,j){if(R<0||this.moduleCount<=R||j<0||this.moduleCount<=j)throw new Error(R+","+j);return this.modules[R][j]},A.getModuleCount=function(){return this.moduleCount},A.make=function(){if(this.typeNumber<1){var R=1;for(R=1;R<40;R++){for(var j=p.getRSBlocks(R,this.errorCorrectLevel),w=new f,C=0,O=0;O<j.length;O++)C+=j[O].dataCount;for(var O=0;O<this.dataList.length;O++){var _=this.dataList[O];w.put(_.mode,4),w.put(_.getLength(),y.getLengthInBits(_.mode,R)),_.write(w)}if(w.getLengthInBits()<=C*8)break}this.typeNumber=R}this.makeImpl(!1,this.getBestMaskPattern())},A.makeImpl=function(R,j){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var w=0;w<this.moduleCount;w++){this.modules[w]=new Array(this.moduleCount);for(var C=0;C<this.moduleCount;C++)this.modules[w][C]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(R,j),this.typeNumber>=7&&this.setupTypeNumber(R),this.dataCache==null&&(this.dataCache=N.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,j)},A.setupPositionProbePattern=function(R,j){for(var w=-1;w<=7;w++)if(!(R+w<=-1||this.moduleCount<=R+w))for(var C=-1;C<=7;C++)j+C<=-1||this.moduleCount<=j+C||(0<=w&&w<=6&&(C==0||C==6)||0<=C&&C<=6&&(w==0||w==6)||2<=w&&w<=4&&2<=C&&C<=4?this.modules[R+w][j+C]=!0:this.modules[R+w][j+C]=!1)},A.getBestMaskPattern=function(){for(var R=0,j=0,w=0;w<8;w++){this.makeImpl(!0,w);var C=y.getLostPoint(this);(w==0||R>C)&&(R=C,j=w)}return j},A.createMovieClip=function(R,j,w){var C=R.createEmptyMovieClip(j,w),O=1;this.make();for(var _=0;_<this.modules.length;_++)for(var L=_*O,P=0;P<this.modules[_].length;P++){var V=P*O,Y=this.modules[_][P];Y&&(C.beginFill(0,100),C.moveTo(V,L),C.lineTo(V+O,L),C.lineTo(V+O,L+O),C.lineTo(V,L+O),C.endFill())}return C},A.setupTimingPattern=function(){for(var R=8;R<this.moduleCount-8;R++)this.modules[R][6]==null&&(this.modules[R][6]=R%2==0);for(var j=8;j<this.moduleCount-8;j++)this.modules[6][j]==null&&(this.modules[6][j]=j%2==0)},A.setupPositionAdjustPattern=function(){for(var R=y.getPatternPosition(this.typeNumber),j=0;j<R.length;j++)for(var w=0;w<R.length;w++){var C=R[j],O=R[w];if(this.modules[C][O]==null)for(var _=-2;_<=2;_++)for(var L=-2;L<=2;L++)_==-2||_==2||L==-2||L==2||_==0&&L==0?this.modules[C+_][O+L]=!0:this.modules[C+_][O+L]=!1}},A.setupTypeNumber=function(R){for(var j=y.getBCHTypeNumber(this.typeNumber),w=0;w<18;w++){var C=!R&&(j>>w&1)==1;this.modules[Math.floor(w/3)][w%3+this.moduleCount-8-3]=C}for(var w=0;w<18;w++){var C=!R&&(j>>w&1)==1;this.modules[w%3+this.moduleCount-8-3][Math.floor(w/3)]=C}},A.setupTypeInfo=function(R,j){for(var w=this.errorCorrectLevel<<3|j,C=y.getBCHTypeInfo(w),O=0;O<15;O++){var _=!R&&(C>>O&1)==1;O<6?this.modules[O][8]=_:O<8?this.modules[O+1][8]=_:this.modules[this.moduleCount-15+O][8]=_}for(var O=0;O<15;O++){var _=!R&&(C>>O&1)==1;O<8?this.modules[8][this.moduleCount-O-1]=_:O<9?this.modules[8][15-O-1+1]=_:this.modules[8][15-O-1]=_}this.modules[this.moduleCount-8][8]=!R},A.mapData=function(R,j){for(var w=-1,C=this.moduleCount-1,O=7,_=0,L=this.moduleCount-1;L>0;L-=2)for(L==6&&L--;;){for(var P=0;P<2;P++)if(this.modules[C][L-P]==null){var V=!1;_<R.length&&(V=(R[_]>>>O&1)==1);var Y=y.getMask(j,C,L-P);Y&&(V=!V),this.modules[C][L-P]=V,O--,O==-1&&(_++,O=7)}if(C+=w,C<0||this.moduleCount<=C){C-=w,w=-w;break}}},N.PAD0=236,N.PAD1=17,N.createData=function(R,j,w){for(var C=p.getRSBlocks(R,j),O=new f,_=0;_<w.length;_++){var L=w[_];O.put(L.mode,4),O.put(L.getLength(),y.getLengthInBits(L.mode,R)),L.write(O)}for(var P=0,_=0;_<C.length;_++)P+=C[_].dataCount;if(O.getLengthInBits()>P*8)throw new Error("code length overflow. ("+O.getLengthInBits()+">"+P*8+")");for(O.getLengthInBits()+4<=P*8&&O.put(0,4);O.getLengthInBits()%8!=0;)O.putBit(!1);for(;!(O.getLengthInBits()>=P*8||(O.put(N.PAD0,8),O.getLengthInBits()>=P*8));)O.put(N.PAD1,8);return N.createBytes(O,C)},N.createBytes=function(R,j){for(var w=0,C=0,O=0,_=new Array(j.length),L=new Array(j.length),P=0;P<j.length;P++){var V=j[P].dataCount,Y=j[P].totalCount-V;C=Math.max(C,V),O=Math.max(O,Y),_[P]=new Array(V);for(var ee=0;ee<_[P].length;ee++)_[P][ee]=255&R.buffer[ee+w];w+=V;var K=y.getErrorCorrectPolynomial(Y),H=new v(_[P],K.getLength()-1),q=H.mod(K);L[P]=new Array(K.getLength()-1);for(var ee=0;ee<L[P].length;ee++){var te=ee+q.getLength()-L[P].length;L[P][ee]=te>=0?q.get(te):0}}for(var ce=0,ee=0;ee<j.length;ee++)ce+=j[ee].totalCount;for(var $=new Array(ce),Re=0,ee=0;ee<C;ee++)for(var P=0;P<j.length;P++)ee<_[P].length&&($[Re++]=_[P][ee]);for(var ee=0;ee<O;ee++)for(var P=0;P<j.length;P++)ee<L[P].length&&($[Re++]=L[P][ee]);return $},$u=N,$u}var Ac={},Sx;function bb(){if(Sx)return Ac;Sx=1,Object.defineProperty(Ac,"__esModule",{value:!0});var h=Object.assign||function(w){for(var C=1;C<arguments.length;C++){var O=arguments[C];for(var _ in O)Object.prototype.hasOwnProperty.call(O,_)&&(w[_]=O[_])}return w},p=Jx(),f=N(p),y=so(),v=N(y);function N(w){return w&&w.__esModule?w:{default:w}}function A(w,C){var O={};for(var _ in w)C.indexOf(_)>=0||Object.prototype.hasOwnProperty.call(w,_)&&(O[_]=w[_]);return O}var R={bgColor:f.default.oneOfType([f.default.object,f.default.string]).isRequired,bgD:f.default.string.isRequired,fgColor:f.default.oneOfType([f.default.object,f.default.string]).isRequired,fgD:f.default.string.isRequired,size:f.default.number.isRequired,title:f.default.string,viewBoxSize:f.default.number.isRequired,xmlns:f.default.string},j=(0,y.forwardRef)(function(w,C){var O=w.bgColor,_=w.bgD,L=w.fgD,P=w.fgColor,V=w.size,Y=w.title,ee=w.viewBoxSize,K=w.xmlns,H=K===void 0?"http://www.w3.org/2000/svg":K,q=A(w,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return v.default.createElement("svg",h({},q,{height:V,ref:C,viewBox:"0 0 "+ee+" "+ee,width:V,xmlns:H}),Y?v.default.createElement("title",null,Y):null,v.default.createElement("path",{d:_,fill:O}),v.default.createElement("path",{d:L,fill:P}))});return j.displayName="QRCodeSvg",j.propTypes=R,Ac.default=j,Ac}var Tx;function wb(){if(Tx)return Yi;Tx=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.QRCode=void 0;var h=Object.assign||function(V){for(var Y=1;Y<arguments.length;Y++){var ee=arguments[Y];for(var K in ee)Object.prototype.hasOwnProperty.call(ee,K)&&(V[K]=ee[K])}return V},p=Jx(),f=O(p),y=$x(),v=O(y),N=yb(),A=O(N),R=so(),j=O(R),w=bb(),C=O(w);function O(V){return V&&V.__esModule?V:{default:V}}function _(V,Y){var ee={};for(var K in V)Y.indexOf(K)>=0||Object.prototype.hasOwnProperty.call(V,K)&&(ee[K]=V[K]);return ee}var L={bgColor:f.default.oneOfType([f.default.object,f.default.string]),fgColor:f.default.oneOfType([f.default.object,f.default.string]),level:f.default.string,size:f.default.number,value:f.default.string.isRequired},P=(0,R.forwardRef)(function(V,Y){var ee=V.bgColor,K=ee===void 0?"#FFFFFF":ee,H=V.fgColor,q=H===void 0?"#000000":H,te=V.level,ce=te===void 0?"L":te,$=V.size,Re=$===void 0?256:$,oe=V.value,Ee=_(V,["bgColor","fgColor","level","size","value"]),me=new A.default(-1,v.default[ce]);me.addData(oe),me.make();var ne=me.modules;return j.default.createElement(C.default,h({},Ee,{bgColor:K,bgD:ne.map(function(J,ae){return J.map(function(F,W){return F?"":"M "+W+" "+ae+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:q,fgD:ne.map(function(J,ae){return J.map(function(F,W){return F?"M "+W+" "+ae+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:Y,size:Re,viewBoxSize:ne.length}))});return Yi.QRCode=P,P.displayName="QRCode",P.propTypes=L,Yi.default=P,Yi}var Nb=wb();const vb=Mc(Nb),Rx=({value:h,size:p="w-8 h-8"})=>h?e.jsx("div",{className:`${p} flex items-center justify-center bg-white p-1`,children:e.jsx(vb,{value:h,size:256,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 256 256"})}):null,jb=()=>{const{id:h}=tl(),p=Ga(),f=As(),[y,v]=D.useState(null),[N,A]=D.useState(null),[R,j]=D.useState(""),w=typeof window<"u"?localStorage.getItem("token"):null,C=async()=>{j("");try{const P=new URLSearchParams(p.search).get("ids");if(P){const V=await fetch(`/api/orders/labels?ids=${encodeURIComponent(P)}`,{headers:{Authorization:w?`Bearer ${w}`:""}}),Y=await V.json();if(!V.ok)throw new Error(Y.message||"Failed to load labels");A(Y.labels||[])}else{const V=await fetch(`/api/orders/${h}/label`,{headers:{Authorization:w?`Bearer ${w}`:""}}),Y=await V.json();if(!V.ok)throw new Error(Y.message||"Failed to load label");v(Y)}}catch(L){j(L.message)}};if(D.useEffect(()=>{C()},[h,p.search]),D.useEffect(()=>{N&&N.length>0&&setTimeout(()=>{try{window.print()}catch{}},200)},[N]),D.useEffect(()=>{},[]),R)return e.jsx("div",{className:"p-6 text-red-600",children:R});if(!y&&!N)return e.jsx("div",{className:"p-6",children:"Loading..."});const O=L=>{if(L===null||typeof L>"u")return null;const P=typeof L=="number"?L:parseFloat(String(L));return!Number.isFinite(P)||P<=0?null:(Math.round(P*100)/100).toFixed(2).replace(/\.0+$/,"").replace(/\.([1-9])0$/,".$1")},_=L=>{var U,Z,we,xe,Ge,Ve,Je,jt,Be,lt,Ke,ft,Oe,mt,yt,Ze,Xe,Tt,He,ye,Fe;const P=(U=L.order)!=null&&U.createdAt?new Date(L.order.createdAt).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],V=Number(((Z=L.order)==null?void 0:Z.codAmount)||0),Y=Number(((we=L.order)==null?void 0:we.serviceCharges)||0),ee=((xe=L.order)==null?void 0:xe.paymentType)||((Ge=L.shipper)==null?void 0:Ge.serviceType)||"COD",K=String(ee).toUpperCase(),q=(K==="ADVANCE"?0:V)+Y,te=((Ve=L.order)==null?void 0:Ve.remarks)||((Je=L.order)!=null&&Je.fragile?"FRAGILE - Handle with care":"Allow to open in front of rider"),ce=((jt=L.order)==null?void 0:jt.productDescription)||"N/A",$=((Be=L.consignee)==null?void 0:Be.name)||"N/A",Re=((lt=L.consignee)==null?void 0:lt.phone)||"N/A",oe=((Ke=L.consignee)==null?void 0:Ke.address)||"N/A",Ee=((ft=L.consignee)==null?void 0:ft.destinationCity)||"N/A",me=L.bookingId||"N/A",ne=((Oe=L.shipper)==null?void 0:Oe.name)||"N/A",J=((mt=L.shipper)==null?void 0:mt.address)||((yt=L.shipper)==null?void 0:yt.companyName)||"N/A",ae=((Ze=L.shipper)==null?void 0:Ze.phone)||"N/A",F=L.trackingId||"N/A",W=K,Q=O(typeof((Xe=L.order)==null?void 0:Xe.weightKg)<"u"&&((Tt=L.order)==null?void 0:Tt.weightKg)!==null?L.order.weightKg:(He=L.order)==null?void 0:He.weight),Ne=Q?`${Q} KG`:"N/A",Se=(ye=L.order)!=null&&ye.fragile?"true":"false",fe=((Fe=L.order)==null?void 0:Fe.pieces)||1,E=`LLL|${me}`;return e.jsxs("div",{className:"bg-white text-black w-full max-w-[800px] border-2 border-black box-border shadow-lg mx-auto print:shadow-none",children:[e.jsxs("div",{className:"grid grid-cols-12 divide-x-2 divide-black",children:[e.jsxs("div",{className:"col-span-4 flex flex-col",children:[e.jsx("div",{className:"border-b-2 border-black text-center font-bold text-sm py-1",children:"Customer Information"}),e.jsxs("div",{className:"p-2 text-xs leading-snug flex-grow",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"font-bold text-gray-600 mr-1",children:"Name:"}),e.jsx("span",{className:"font-bold",children:$})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"font-bold text-gray-600 mr-1",children:"Phone:"}),e.jsx("span",{className:"font-bold",children:Re})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-bold text-gray-600 mr-1",children:"Address:"}),e.jsx("span",{children:oe})]}),e.jsx("div",{className:"border-t border-black my-1"}),e.jsxs("div",{className:"font-bold text-sm mt-1",children:["Destination: ",Ee]}),e.jsx("div",{className:"border-t border-black my-1"}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("span",{className:"font-bold",children:["Order: ",me]}),e.jsx("div",{className:"mt-1 w-3/4",children:e.jsx(zu,{value:String(me).replace(/[^0-9]/g,""),height:"h-6",showValue:!1})}),me!=="N/A"&&e.jsx("div",{className:"mt-1 flex justify-center",children:e.jsx(Rx,{value:E,size:"w-[70px] h-[70px]"})})]})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col",children:[e.jsx("div",{className:"border-b-2 border-black text-center font-bold text-sm py-1",children:"Brand Information"}),e.jsxs("div",{className:"p-2 text-[10px] leading-tight font-condensed",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsxs("span",{className:"font-bold",children:["Shipper: ",ne]}),e.jsx("span",{className:"font-bold",children:ae})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"font-bold mr-1",children:"Shipper Address:"}),e.jsx("span",{children:J})]})]}),e.jsxs("div",{className:"border-t-2 border-black flex-grow flex flex-col items-center justify-center p-2",children:[e.jsxs("div",{className:"font-black text-lg mb-1",children:["Amount: Rs ",q.toLocaleString()]}),e.jsx("div",{className:"w-3/4",children:e.jsx(zu,{value:String(q).replace(/[^0-9]/g,""),height:"h-8",showValue:!1})})]})]}),e.jsxs("div",{className:"col-span-4 flex flex-col",children:[e.jsx("div",{className:"border-b-2 border-black text-center font-bold text-sm py-1",children:"Parcel Information"}),e.jsxs("div",{className:"flex items-center justify-between px-2 py-2 border-b border-black",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("img",{src:"/logo.png",alt:"Company Logo",className:"h-[74px]"})}),me!=="N/A"&&e.jsx("div",{className:"flex flex-col items-center",children:e.jsx(Rx,{value:"https://lahorelinklogistics.com",size:"w-[70px] h-[70px]"})})]}),e.jsx("div",{className:"p-2 flex flex-col items-center border-b border-black",children:e.jsx("div",{className:"w-full",children:e.jsx(zu,{value:String(F).replace(/[^0-9]/g,""),height:"h-10",className:"w-full"})})}),e.jsxs("div",{className:"flex-grow text-xs font-bold",children:[e.jsxs("div",{className:"p-1 border-b border-black",children:["Service: ",W]}),e.jsxs("div",{className:"grid grid-cols-2 border-b border-black",children:[e.jsxs("div",{className:"p-1 border-r border-black",children:["Date: ",P]}),e.jsxs("div",{className:"p-1 text-right",children:["Weight: ",Ne]})]}),e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsxs("div",{className:"p-1 border-r border-black",children:["Fragile: ",Se]}),e.jsxs("div",{className:"p-1 text-right",children:["Pieces: ",fe]})]})]})]})]}),e.jsxs("div",{className:"border-t-2 border-black p-1 text-xs",children:[e.jsx("span",{className:"font-bold mr-1",children:"Remarks:"}),e.jsxs("span",{className:"font-bold",children:["- ",te]})]}),e.jsxs("div",{className:"border-t-2 border-black p-0.5 text-[10px] leading-tight font-condensed h-10 overflow-hidden",children:[e.jsx("span",{className:"font-bold mr-1",children:"Products:"}),e.jsx("span",{children:ce!=="N/A"?`[ ${fe} x ${ce} ]`:"[Product information not available]"})]})]})};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        /* Screen */
        .no-print { display: inline-flex; }
        @media print { .no-print { display: none !important; } }

        /* Print: only label content */
        @media print {
          body * { visibility: hidden !important; }
          #label-root, #label-root * { visibility: visible !important; }
          #label-root { position: absolute; left: 0; top: 0; width: 100%; margin: 0; padding: 0; }
          .space-y-6 > * + * { margin-top: 0 !important; }
          .print\\:space-y-0 > * + * { margin-top: 0 !important; }
          .print\\:mb-0 { margin-bottom: 0 !important; }
          .print\\:page-break-after-always { page-break-after: always; }
        }
        @page { size: A4 portrait; margin: 8mm; }
      `}),e.jsxs("div",{className:"flex justify-between px-6 pt-6",children:[e.jsx("button",{className:"no-print px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>f(-1),children:"Back"}),e.jsx("button",{className:"no-print px-3 py-1.5 text-xs bg-primary hover:bg-primary-hover text-white rounded border border-primary",onClick:()=>window.print(),children:"Print"})]}),e.jsx("div",{id:"label-root",className:"p-8 print:p-0",children:N?e.jsx("div",{className:"w-full space-y-6 print:space-y-0",children:N.map((L,P)=>e.jsx("div",{className:"w-full flex justify-center mb-6 print:mb-0 print:page-break-after-always",children:_(L)},P))}):e.jsx("div",{className:"w-full flex justify-center",children:y&&_(y)})})]})},Cb=()=>{const[h,p]=D.useState([]),[f,y]=D.useState(!0),[v,N]=D.useState(""),[A,R]=D.useState(null),[j,w]=D.useState(""),[C,O]=D.useState([]),[_,L]=D.useState(null),P=typeof window<"u"?localStorage.getItem("token"):null,V=b0(),{user:Y}=Fs(),[ee,K]=D.useState(!1),H=async()=>{y(!0),N("");try{const E=await fetch("/api/orders",{headers:{Authorization:P?`Bearer ${P}`:""}}),G=await E.json();if(!E.ok)throw E.status===403&&((G==null?void 0:G.code)==="RIDER_PORTAL_INACTIVE"||String((G==null?void 0:G.message)||"").toLowerCase().includes("rider account is under configuration"))&&K(!0),new Error(G.message||"Failed to fetch orders");K(!1),p(G)}catch(E){N(E.message)}finally{y(!1)}},q=async()=>{try{const E=await fetch("/api/finance/summary/rider/me",{headers:{Authorization:P?`Bearer ${P}`:""}}),G=await E.json();E.ok&&R(G)}catch{}},te=async E=>{if(E&&E.preventDefault(),L(null),!!j.trim())try{const G=await fetch(`/api/orders?q=${encodeURIComponent(j.trim())}`,{headers:{Authorization:P?`Bearer ${P}`:""}}),U=await G.json();G.ok&&Array.isArray(U)&&U.length>0?L(U[0]):L({notFound:!0})}catch{}};D.useEffect(()=>{H(),q()},[]);const ce=As();D.useEffect(()=>{const E=j.trim().toLowerCase();if(E.length<2){O([]);return}O(h.filter(G=>{var U,Z,we,xe;return((U=G.bookingId)==null?void 0:U.toLowerCase().includes(E))||((Z=G.trackingId)==null?void 0:Z.toLowerCase().includes(E))||((we=G.consigneeName)==null?void 0:we.toLowerCase().includes(E))||((xe=G.destinationCity)==null?void 0:xe.toLowerCase().includes(E))}).slice(0,8))},[j,h]);const $=async(E,G)=>{try{const U=await fetch(`/api/orders/${E}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:P?`Bearer ${P}`:""},body:JSON.stringify({status:G})}),Z=await U.json();if(!U.ok)throw new Error(Z.message||"Failed to update status");await H()}catch(U){N(U.message)}},Re=E=>{const G=Number(E);return Number.isNaN(G)?"":G.toLocaleString()},oe=D.useMemo(()=>h.filter(E=>new Date(E.createdAt).toDateString()===new Date().toDateString()).length,[h]);D.useMemo(()=>h.filter(E=>E.status==="DELIVERED").length,[h]),D.useMemo(()=>h.filter(E=>E.status==="RETURNED").length,[h]),D.useMemo(()=>h.filter(E=>!["DELIVERED","RETURNED"].includes(E.status)).length,[h]),D.useMemo(()=>h.filter(E=>E.status==="OUT_FOR_DELIVERY").length,[h]),D.useMemo(()=>h.filter(E=>["FIRST_ATTEMPT","SECOND_ATTEMPT","THIRD_ATTEMPT","FAILED"].includes(E.status)).length,[h]);const Ee=[{label:"7 DAYS",value:"7days"},{label:"15 DAYS",value:"15days"},{label:"30 DAYS",value:"30days"}],[me,ne]=D.useState("7days"),J=D.useMemo(()=>{let E=new Date;return E.setHours(0,0,0,0),me==="7days"?E.setDate(E.getDate()-6):me==="15days"?E.setDate(E.getDate()-14):me==="30days"&&E.setDate(E.getDate()-29),h.filter(G=>{const U=new Date(G.createdAt);return U.setHours(0,0,0,0),U.getTime()>=E.getTime()})},[h,me]),ae=D.useMemo(()=>J.filter(E=>E.status==="DELIVERED").length,[J]),F=D.useMemo(()=>J.filter(E=>E.status==="RETURNED").length,[J]),W=D.useMemo(()=>J.filter(E=>E.status==="OUT_FOR_DELIVERY").length,[J]),Q=D.useMemo(()=>J.filter(E=>["FIRST_ATTEMPT","SECOND_ATTEMPT","THIRD_ATTEMPT","FAILED"].includes(E.status)).length,[J]),Ne=D.useMemo(()=>J.filter(E=>!["DELIVERED","RETURNED"].includes(E.status)).length,[J]),Se=()=>{var E,G,U,Z,we;return e.jsx("div",{className:"space-y-8",children:e.jsx(y0,{heroTitle:me==="7days"?"7 Days Tasks":me==="15days"?"15 Days Tasks":"30 Days Tasks",heroCount:J.length,onRefresh:H,kpis:[{prefix:"PKR",value:Re(((E=A==null?void 0:A.totals)==null?void 0:E.todayCodCollected)||0),label:"COD Today"},{value:Ne,label:"Pending"},{value:J.length,label:"Total Orders"}],periodOptions:Ee,activePeriod:me,onPeriodChange:xe=>ne(xe),statCards:[{key:"today",icon:mn,title:"Assigned Today",value:oe,colorClass:"text-gray-600"},{key:"outForDelivery",icon:gs,title:"Out for Delivery",value:W,colorClass:"text-cyan-600"},{key:"delivered",icon:a0,title:"Delivered",value:ae,colorClass:"text-green-700"},{key:"returned",icon:r0,title:"Returned",value:F,colorClass:"text-orange-600"},{key:"attempted",icon:mn,title:"Attempts",value:Q,colorClass:"text-red-500"},...A?[{key:"codToday",icon:ts,title:"COD Today",value:`PKR ${Re(((G=A==null?void 0:A.totals)==null?void 0:G.todayCodCollected)||0)}`,colorClass:"text-green-600"},{key:"totalCod",icon:ts,title:"Total COD",value:`PKR ${Re(((U=A==null?void 0:A.totals)==null?void 0:U.totalCodCollected)||0)}`,colorClass:"text-emerald-600"},{key:"settledCount",icon:ts,title:"Settled",value:(Z=A==null?void 0:A.totals)==null?void 0:Z.settledCount,colorClass:"text-indigo-600"},{key:"pendingCountFinance",icon:ts,title:"Pending",value:(we=A==null?void 0:A.totals)==null?void 0:we.pendingCount,colorClass:"text-amber-600"}]:[]]})})},fe=()=>{var E,G;return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(gs,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Rider Dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("form",{onSubmit:te,className:"relative",children:[e.jsx(al,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:j,onChange:U=>w(U.target.value),type:"text",placeholder:"Enter Booking/Tracking ID",className:"pl-9 pr-4 py-1.5 text-sm border border-gray-200 rounded-lg"}),C.length>0&&e.jsx("ul",{className:"absolute left-0 top-full mt-1 w-72 bg-white border border-gray-200 rounded-lg shadow z-10",children:C.map(U=>e.jsxs("li",{className:"px-3 py-2 text-sm hover:bg-gray-50 cursor-pointer",onMouseDown:()=>L(U),children:[e.jsx("span",{className:"font-mono text-xs mr-2",children:U.bookingId}),e.jsx("span",{children:U.consigneeName}),e.jsxs("span",{className:"text-xs text-gray-500",children:["  ",U.destinationCity]})]},U._id))})]}),e.jsx("button",{onClick:H,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",children:"Refresh"})]})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Overview of assigned orders."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Today"}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:h.filter(U=>new Date(U.createdAt).toDateString()===new Date().toDateString()).length})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Delivered"}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:h.filter(U=>U.status==="DELIVERED").length})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Returned"}),e.jsx("h3",{className:"text-2xl font-bold text-secondary",children:h.filter(U=>U.status==="RETURNED").length})]}),A&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 md:col-span-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"COD Today"}),e.jsxs("h3",{className:"text-xl font-bold text-secondary",children:["PKR ",Number(A.totals.todayCodCollected||0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Total COD"}),e.jsxs("h3",{className:"text-xl font-bold text-secondary",children:["PKR ",Number(A.totals.totalCodCollected||0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Settled"}),e.jsx("h3",{className:"text-xl font-bold text-secondary",children:A.totals.settledCount})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Pending"}),e.jsx("h3",{className:"text-xl font-bold text-secondary",children:A.totals.pendingCount})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold text-sm text-secondary",children:"Recent Payments"}),e.jsx("ul",{className:"mt-2 space-y-2",children:(A.transactions||[]).slice(0,5).map(U=>e.jsxs("li",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["PKR ",Number(U.totalCodCollected||0).toLocaleString()]}),e.jsx("span",{className:"text-xs",children:U.settlementStatus})]},U._id))})]})]})})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"font-bold text-lg text-secondary mb-3",children:"All Orders"}),v&&e.jsx("p",{className:"text-sm text-red-600",children:v}),f?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):h.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No assigned orders."}):e.jsx("ul",{className:"space-y-3",children:h.map(U=>e.jsxs("li",{className:"border border-gray-100 rounded-lg p-4 cursor-pointer hover:bg-gray-50",onClick:()=>ce(`/rider/task/${U._id}`),children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-mono text-xs",children:U.bookingId}),e.jsx("span",{className:"text-xs",children:U.status})]}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-2 mt-1",children:[e.jsx(gn,{className:"w-3 h-3"}),e.jsxs("span",{children:[U.consigneeAddress,"  ",U.destinationCity]})]}),e.jsxs("div",{className:"mt-2 text-right text-sm font-semibold text-secondary",children:["PKR ",Number(U.codAmount||0).toLocaleString()]}),U.status!=="DELIVERED"&&U.status!=="RETURNED"&&e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{onClick:()=>$(U._id,"FIRST_ATTEMPT"),className:"px-3 py-1.5 text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 rounded",children:"1st Attempt"}),e.jsx("button",{onClick:()=>$(U._id,"SECOND_ATTEMPT"),className:"px-3 py-1.5 text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 rounded",children:"2nd Attempt"}),e.jsx("button",{onClick:()=>$(U._id,"THIRD_ATTEMPT"),className:"px-3 py-1.5 text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 rounded",children:"3rd Attempt"}),e.jsxs("button",{onClick:()=>$(U._id,"DELIVERED"),className:"px-3 py-1.5 text-xs bg-green-600 hover:bg-green-700 text-white rounded",children:[e.jsx(a0,{className:"w-4 h-4 inline"})," Delivered"]}),e.jsxs("button",{onClick:()=>$(U._id,"RETURNED"),className:"px-3 py-1.5 text-xs bg-red-600 hover:bg-red-700 text-white rounded",children:[e.jsx(r0,{className:"w-4 h-4 inline"})," Return"]})]})]},U._id))})]})}),_&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>L(null),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden",onClick:U=>U.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Order Detail"}),e.jsx("button",{onClick:()=>L(null),className:"text-gray-400 hover:text-gray-600",children:""})]}),e.jsx("div",{className:"p-6 space-y-2 text-sm",children:_.notFound?e.jsx("p",{className:"text-red-600",children:"No order found"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Business:"})," ",((E=_.shipper)==null?void 0:E.companyName)||((G=_.shipper)==null?void 0:G.name)]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Booking ID:"})," ",e.jsx("span",{className:"font-mono",children:_.bookingId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Tracking ID:"})," ",e.jsx("span",{className:"font-mono",children:_.trackingId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Consignee:"})," ",_.consigneeName,"  ",_.destinationCity]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Address:"})," ",_.consigneeAddress]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Phone:"})," ",_.consigneePhone]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Service Type:"})," ",_.serviceType]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Pieces:"})," ",_.pieces]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Fragile:"})," ",_.fragile?"Yes":"No"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Remarks:"})," ",_.remarks||""]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Payment Type:"})," ",_.paymentType]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"COD:"})," Rs ",Number(_.codAmount||0).toLocaleString()]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Status: ",_.status]})]})}),e.jsx("div",{className:"p-4 flex justify-end gap-2 border-t border-gray-100",children:e.jsx("button",{className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600",onClick:()=>L(null),children:"Close"})})]})})]})};return ee?e.jsx("div",{className:"min-h-[70vh] flex items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-xl bg-white border border-gray-100 shadow-sm rounded-2xl p-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center",children:e.jsx(m0,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-secondary",children:"Rider Configuration in Progress"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Your rider account is under configuration. Please wait for management to set your commission rules before using the rider portal."})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[v&&e.jsxs("div",{className:"p-3 rounded-lg bg-red-50 border border-red-100 flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(Xn,{className:"w-4 h-4"}),v]}),e.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-200 text-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-gray-600",children:"Commission status"}),e.jsx("div",{className:"font-semibold text-secondary",children:Y!=null&&Y.commissionStatus?String(Y.commissionStatus).toUpperCase():"PENDING"})]})}),e.jsx("div",{className:"text-xs text-gray-500",children:"Contact management if this takes longer than expected."})]})]})}):V?e.jsx(Se,{}):e.jsx(fe,{})},Ab=()=>{const[h,p]=D.useState([]),[f,y]=D.useState(!0),[v,N]=D.useState(""),A=typeof window<"u"?localStorage.getItem("token"):null,R=async()=>{y(!0),N("");try{const j=await fetch("/api/orders",{headers:{Authorization:A?`Bearer ${A}`:""}}),w=await j.json();if(!j.ok)throw new Error(w.message||"Failed to fetch orders");p(w)}catch(j){N(j.message)}finally{y(!1)}};return D.useEffect(()=>{R()},[]),e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(St,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"All Orders"})]})}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[v&&e.jsx("p",{className:"text-sm text-red-600",children:v}),f?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."}):e.jsx("ul",{className:"space-y-3",children:h.map(j=>e.jsxs("li",{className:"border border-gray-100 rounded-lg p-4 flex justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-700",children:[j.consigneeName,"  ",j.destinationCity]}),e.jsx("span",{className:"text-xs",children:j.status})]},j._id))})]})]})},Eb=()=>{const{id:h}=tl(),p=As(),[f,y]=D.useState(null),[v,N]=D.useState(!0),[A,R]=D.useState(""),j=typeof window<"u"?localStorage.getItem("token"):null,w=async()=>{N(!0),R("");try{const _=await fetch(`/api/orders/${h}`,{headers:{Authorization:j?`Bearer ${j}`:""}}),L=await _.json();if(!_.ok)throw new Error(L.message||"Failed to fetch order");y(L)}catch(_){R(_.message)}finally{N(!1)}};D.useEffect(()=>{w()},[h]);const C=async _=>{try{const L=await fetch(`/api/orders/${h}/status`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:j?`Bearer ${j}`:""},body:JSON.stringify({status:_})}),P=await L.json();if(!L.ok)throw new Error(P.message||"Failed to update status");y(P)}catch(L){R(L.message)}};if(v)return e.jsx("div",{className:"p-6",children:"Loading..."});if(A)return e.jsx("div",{className:"p-6 text-red-600 text-sm",children:A});if(!f)return null;const O=Number(f.codAmount||0).toLocaleString();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-secondary text-white rounded-2xl p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs opacity-80",children:"Collect Cash"}),e.jsxs("div",{className:"text-3xl font-bold",children:["PKR ",O]})]}),e.jsx("button",{onClick:()=>p(-1),className:"p-2 bg-white/10 rounded-lg",children:e.jsx(h0,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-secondary",children:f.consigneeName}),e.jsx("p",{className:"text-xs text-gray-500",children:f.bookingId})]}),e.jsx(N0,{status:f.status})]}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gn,{className:"w-4 h-4"})," ",f.consigneeAddress,"  ",f.destinationCity]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vn,{className:"w-4 h-4"})," ",f.consigneePhone]}),e.jsxs("div",{children:["Service Type: ",f.serviceType]}),e.jsxs("div",{children:["Pieces: ",f.pieces]}),e.jsxs("div",{children:["Fragile: ",f.fragile?"Yes":"No"]}),e.jsxs("div",{children:["Remarks: ",f.remarks||""]}),e.jsxs("div",{children:["Payment Type: ",f.paymentType]})]})]})}),f.status!=="DELIVERED"&&f.status!=="RETURNED"&&e.jsxs("div",{className:"flex gap-3",children:[f.status==="ASSIGNED"&&e.jsxs("button",{onClick:()=>C("OUT_FOR_DELIVERY"),className:"flex-1 h-12 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold",children:[e.jsx(f0,{className:"w-4 h-4 inline"})," Start Delivery"]}),e.jsx("button",{onClick:()=>C("FIRST_ATTEMPT"),className:"flex-1 h-12 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg font-semibold",children:"1st Attempt"}),e.jsx("button",{onClick:()=>C("SECOND_ATTEMPT"),className:"flex-1 h-12 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg font-semibold",children:"2nd Attempt"}),e.jsx("button",{onClick:()=>C("THIRD_ATTEMPT"),className:"flex-1 h-12 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg font-semibold",children:"3rd Attempt"}),e.jsxs("button",{onClick:()=>C("DELIVERED"),className:"flex-1 h-12 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold",children:[e.jsx(a0,{className:"w-4 h-4 inline"})," Delivered"]}),e.jsxs("button",{onClick:()=>C("RETURNED"),className:"flex-1 h-12 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold",children:[e.jsx(r0,{className:"w-4 h-4 inline"})," Return"]})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Shipment created on ",new Date(f.createdAt).toDateString()]})]})},Sb=()=>{const[h,p]=D.useState(null),[f,y]=D.useState(""),[v,N]=D.useState(!1),{user:A}=Fs(),R=(A==null?void 0:A.token)||Xs(),j=async O=>{if(!O||!O.trim()){y("Please enter or scan a booking ID");return}N(!0),y(""),p(null);try{const _=await fetch(`/api/orders/details/${encodeURIComponent(O.trim())}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${R}`}}),L=_.headers.get("content-type");if(!L||!L.includes("application/json")){const V=await _.text();throw new Error(`Server returned non-JSON response: ${V.substring(0,100)}`)}const P=await _.json();if(!_.ok)throw new Error(P.message||"Failed to fetch order details");p(P)}catch(_){y(_.message),p(null)}finally{N(!1)}},w=O=>{j(O)},C=O=>{y(O)};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ii,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Scan Parcel QR"})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Scan QR code from parcel label to view order details (read-only)"})]}),e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsx(Bc,{onScan:w,onError:C})}),v&&e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-600",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Processing scan..."})]})}),f&&e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"p-4 bg-red-50 border border-red-100 text-red-600 rounded-lg flex items-center gap-2",children:[e.jsx(xn,{className:"w-5 h-5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Assignment Failed"}),e.jsx("p",{className:"text-sm",children:f})]})]})}),h&&e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-100 text-blue-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Yn,{className:"w-5 h-5"}),e.jsx("p",{className:"font-semibold",children:"Order Details"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(St,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Booking ID:"}),e.jsx("span",{className:"font-mono",children:h.bookingId})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Tracking ID:"}),e.jsx("span",{className:"font-mono",children:h.trackingId})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Consignee:"}),e.jsx("span",{children:h.consigneeName})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gn,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Address:"}),e.jsxs("span",{children:[h.consigneeAddress,", ",h.destinationCity]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Phone:"}),e.jsx("span",{children:h.consigneePhone})]}),h.codAmount>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ts,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"COD Amount:"}),e.jsxs("span",{children:["PKR ",Number(h.codAmount).toLocaleString()]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200",children:[e.jsx("span",{className:"font-medium",children:"Status:"}),e.jsx("span",{className:"ml-2 px-2 py-1 bg-blue-200 text-blue-800 rounded text-xs font-semibold",children:h.status})]}),h.assignedRider&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-200",children:[e.jsx("span",{className:"font-medium",children:"Assigned Rider:"}),e.jsx("span",{className:"ml-2",children:h.assignedRider.name})]})]})]})})]})},Ec=h=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0}).format(Number(h||0)),Tb=h=>{if(!h)return"";const p=new Date(h);return Number.isNaN(p.getTime())?"":p.toLocaleString()},Rb=[{key:"today",label:"Today"},{key:"7",label:"7 Days"},{key:"15",label:"15 Days"},{key:"30",label:"30 Days"}],Ob=()=>{const h=Xs(),[p,f]=D.useState(!1),[y,v]=D.useState(""),[N,A]=D.useState(""),[R,j]=D.useState({summary:null,items:[],page:1,totalPages:1,total:0}),[w,C]=D.useState(""),[O,_]=D.useState(""),[L,P]=D.useState("all"),[V,Y]=D.useState("desc"),[ee,K]=D.useState(1),H=20,q=Ee=>{const me=new Date,ne=new Date(me);ne.setHours(23,59,59,999);let J=new Date(me);if(J.setHours(0,0,0,0),Ee!=="today"){const ae=Number(Ee);!Number.isNaN(ae)&&ae>0&&(J=new Date(ne),J.setDate(J.getDate()-(ae-1)),J.setHours(0,0,0,0))}C(J.toISOString().slice(0,10)),_(ne.toISOString().slice(0,10)),K(1)},te=async(Ee={})=>{f(!0),v(""),A("");try{const me=new URLSearchParams,ne=Ee.from??w,J=Ee.to??O,ae=Ee.status??L,F=Ee.sortOrder??V,W=Ee.page??ee;ne&&me.set("from",ne),J&&me.set("to",J),ae&&ae!=="all"&&me.set("status",ae),F&&(F==="asc"||F==="desc")&&me.set("sortOrder",F),me.set("page",String(W)),me.set("limit",String(H));const Q=await fetch(`/api/riders/finance/me?${me.toString()}`,{headers:{Authorization:h?`Bearer ${h}`:""}}),Ne=await Q.json();if(!Q.ok)throw new Error(Ne.message||"Failed to load rider finance");j(Ne),!Ne.items||Ne.items.length===0?A("No records found for selected range"):A("Finance loaded successfully")}catch(me){v(me.message||"Failed to load finance data")}finally{f(!1)}};D.useEffect(()=>{te({page:1})},[h]),D.useEffect(()=>{const Ee=()=>{te({page:1})};return window.addEventListener("focus",Ee),()=>window.removeEventListener("focus",Ee)},[h]);const ce=R.summary||{},$=D.useMemo(()=>{const Ee=Number(ce.unpaidBalance||0),me=Ee>=0;return{value:Ee,positive:me,colorClass:me?"text-green-700":"text-red-600",helper:me?"Payable to Rider":"Payable by Rider"}},[ce.unpaidBalance]),Re=async()=>{K(1),await te({page:1})},oe=()=>{C(""),_(""),P("all"),Y("desc"),K(1),te({from:"",to:"",status:"all",sortOrder:"desc",page:1})};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ts,{className:"w-6 h-6 text-green-600"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"Rider Finance"})]})}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Your earnings and settlements overview."})]}),y&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 text-red-600 text-sm rounded",children:y}),N&&!y&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-100 text-green-700 text-sm rounded",children:N}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Delivered (range)"}),e.jsx("div",{className:"mt-1 text-2xl font-bold text-secondary",children:ce.deliveredCount||0})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Returned (range)"}),e.jsx("div",{className:"mt-1 text-2xl font-bold text-secondary",children:ce.returnedCount||0})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"COD Collected (range)"}),e.jsx("div",{className:"mt-1 text-xl font-bold text-secondary",children:Ec(ce.codCollected||0)})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Unpaid Balance"}),e.jsx("div",{className:`mt-1 text-xl font-extrabold ${$.colorClass}`,children:Ec($.value)}),e.jsx("div",{className:"mt-1 text-xs text-gray-500",children:$.helper})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(sl,{className:"w-4 h-4 text-gray-500"}),e.jsx("h3",{className:"font-bold text-lg text-secondary",children:"Transactions"})]}),e.jsx("div",{className:"flex items-center gap-2 text-xs",children:Rb.map(Ee=>e.jsx("button",{type:"button",onClick:()=>q(Ee.key),className:"px-3 py-1.5 rounded-full border border-gray-200 bg-gray-50 hover:bg-gray-100 text-gray-700",children:Ee.label},Ee.key))})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"From"}),e.jsx("input",{type:"date",value:w,onChange:Ee=>C(Ee.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"To"}),e.jsx("input",{type:"date",value:O,onChange:Ee=>_(Ee.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"Status"}),e.jsxs("select",{value:L,onChange:Ee=>P(Ee.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"returned",children:"Returned"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"Sort by Date"}),e.jsxs("select",{value:V,onChange:Ee=>{Y(Ee.target.value),K(1),te({sortOrder:Ee.target.value,page:1})},className:"px-3 py-2 text-sm border border-gray-200 rounded-lg bg-white",children:[e.jsx("option",{value:"desc",children:"Sort by Date  Newest First"}),e.jsx("option",{value:"asc",children:"Sort by Date  Oldest First"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-end gap-2",children:[e.jsx(zt,{onClick:Re,className:"w-full sm:w-auto text-xs",children:"Apply Filters"}),e.jsx(zt,{variant:"outline",onClick:oe,className:"w-full sm:w-auto text-xs",children:"Reset"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-[900px] md:min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b bg-gray-50",children:[e.jsx("th",{className:"py-3 px-4",children:"Date/Time"}),e.jsx("th",{className:"py-3 px-4",children:"Order ID"}),e.jsx("th",{className:"py-3 px-4",children:"Shipper"}),e.jsx("th",{className:"py-3 px-4",children:"Destination"}),e.jsx("th",{className:"py-3 px-4 text-right",children:"COD Amount"}),e.jsx("th",{className:"py-3 px-4 text-right",children:"Rider Earning"}),e.jsx("th",{className:"py-3 px-4 text-center",children:"Status"}),e.jsx("th",{className:"py-3 px-4 text-center",children:"Settlement"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:p?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"py-10 px-4 text-center text-gray-500",children:"Loading transactions"})}):(R.items||[]).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"py-10 px-4 text-center text-gray-500",children:"No transactions found"})}):(R.items||[]).map(Ee=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-xs text-gray-600",children:Tb(Ee.date)}),e.jsx("td",{className:"py-3 px-4 font-mono text-xs",children:Ee.orderId||""}),e.jsx("td",{className:"py-3 px-4",children:Ee.shipperName||""}),e.jsx("td",{className:"py-3 px-4",children:Ee.destination||""}),e.jsx("td",{className:"py-3 px-4 text-right",children:Ec(Ee.codAmount||0)}),e.jsx("td",{className:"py-3 px-4 text-right font-semibold text-secondary",children:Ec(Ee.riderEarning||0)}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-700",children:Ee.status||""})}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Ee.settlementStatus==="PAID"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:Ee.settlementStatus==="PAID"?"Paid":"Unpaid"})})]},Ee.id))})]})}),e.jsxs("div",{className:"p-4 border-t border-gray-100 flex items-center justify-between flex-wrap gap-2",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["Showing page ",R.page||1," of ",R.totalPages||1," (Total ",R.total||0,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{const Ee=Math.max(1,(R.page||1)-1);K(Ee),te({page:Ee})},disabled:(R.page||1)<=1,className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Prev"}),e.jsx("button",{onClick:()=>{const Ee=Math.min(R.totalPages||1,(R.page||1)+1);K(Ee),te({page:Ee})},disabled:(R.page||1)>=(R.totalPages||1),className:"px-3 py-1.5 text-xs bg-gray-50 hover:bg-gray-100 rounded border border-gray-200 text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})},Db=()=>{const[h,p]=D.useState({name:"",email:"",password:"",confirmPassword:"",companyName:"",cnicNumber:"",contactNumber:"",emergencyContact:"",pickupAddress:"",accountHolderName:"",accountNumber:"",iban:""}),[f,y]=D.useState({}),[v,N]=D.useState(""),[A,R]=D.useState(!1),[j,w]=D.useState(!1),[C,O]=D.useState(!1),_=As(),L=Y=>{const{name:ee,value:K}=Y.target;p(H=>({...H,[ee]:K})),f[ee]&&y(H=>({...H,[ee]:""}))},P=()=>{const Y={};return h.name.trim()||(Y.name="Name is required"),h.email?/\S+@\S+\.\S+/.test(h.email)||(Y.email="Email is invalid"):Y.email="Email is required",h.password?h.password.length<6&&(Y.password="Password must be at least 6 characters"):Y.password="Password is required",h.confirmPassword?h.password!==h.confirmPassword&&(Y.confirmPassword="Passwords do not match"):Y.confirmPassword="Please confirm your password",h.companyName.trim()||(Y.companyName="Business name is required"),h.contactNumber.trim()||(Y.contactNumber="Contact number is required"),h.accountHolderName.trim()||(Y.accountHolderName="Account holder name is required"),h.accountNumber.trim()||(Y.accountNumber="Account number is required"),y(Y),Object.keys(Y).length===0},V=async Y=>{if(Y.preventDefault(),N(""),!!P()){R(!0);try{const{confirmPassword:ee,...K}=h,H=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...K,role:"SHIPPER"})}),q=await H.json();if(!H.ok)throw new Error(q.message||"Signup failed");_("/")}catch(ee){N(ee.message||"An error occurred during signup")}finally{R(!1)}}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#F8F9FA] p-6",children:e.jsxs("form",{onSubmit:V,className:"w-full max-w-md bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-secondary mb-6",children:"Sign up as Shipper"}),v&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:v}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ht,{label:"Name",name:"name",value:h.name,onChange:L,error:f.name,required:!0}),f.name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.name})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Email",type:"email",name:"email",value:h.email,onChange:L,error:f.email,required:!0}),f.email&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.email})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Password",type:j?"text":"password",name:"password",value:h.password,onChange:L,error:f.password,required:!0,rightElement:e.jsx("button",{type:"button",onClick:()=>w(Y=>!Y),className:"text-gray-400 hover:text-gray-600","aria-label":j?"Hide password":"Show password",children:j?e.jsx(Qi,{className:"w-4 h-4"}):e.jsx(Ji,{className:"w-4 h-4"})})}),f.password&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.password})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Confirm Password",type:C?"text":"password",name:"confirmPassword",value:h.confirmPassword,onChange:L,error:f.confirmPassword,required:!0,rightElement:e.jsx("button",{type:"button",onClick:()=>O(Y=>!Y),className:"text-gray-400 hover:text-gray-600","aria-label":C?"Hide password":"Show password",children:C?e.jsx(Qi,{className:"w-4 h-4"}):e.jsx(Ji,{className:"w-4 h-4"})})}),f.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.confirmPassword})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Business Name",name:"companyName",value:h.companyName,onChange:L,error:f.companyName,required:!0}),f.companyName&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.companyName})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"CNIC Number",name:"cnicNumber",value:h.cnicNumber,onChange:L,placeholder:"#####-#######-#",error:f.cnicNumber}),f.cnicNumber&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.cnicNumber})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Contact Number",name:"contactNumber",value:h.contactNumber,onChange:L,placeholder:"03XXXXXXXXX",error:f.contactNumber,required:!0}),f.contactNumber&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.contactNumber})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Emergency Contact",name:"emergencyContact",value:h.emergencyContact,onChange:L,error:f.emergencyContact}),f.emergencyContact&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.emergencyContact})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Pickup Address",name:"pickupAddress",value:h.pickupAddress,onChange:L,error:f.pickupAddress}),f.pickupAddress&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.pickupAddress})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Account Holder Name",name:"accountHolderName",value:h.accountHolderName,onChange:L,error:f.accountHolderName,required:!0}),f.accountHolderName&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.accountHolderName})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Account Number",name:"accountNumber",value:h.accountNumber,onChange:L,error:f.accountNumber,required:!0}),f.accountNumber&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.accountNumber})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"IBAN (optional)",name:"iban",value:h.iban,onChange:L,error:f.iban}),f.iban&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.iban})]}),e.jsx(zt,{type:"submit",fullWidth:!0,className:"mt-2",disabled:A,children:A?"Creating Account...":"Create Account"})]})]})})},_b=()=>{const[h,p]=D.useState({name:"",email:"",password:"",confirmPassword:"",cnic:"",vehicleType:"",vehicleNumber:"",vehicleModel:""}),[f,y]=D.useState({}),[v,N]=D.useState(""),[A,R]=D.useState(!1),[j,w]=D.useState(!1),[C,O]=D.useState(!1),_=As(),L=Y=>{const{name:ee,value:K}=Y.target;p(H=>({...H,[ee]:K})),f[ee]&&y(H=>({...H,[ee]:""}))},P=()=>{const Y={};return h.name.trim()||(Y.name="Name is required"),h.email?/\S+@\S+\.\S+/.test(h.email)||(Y.email="Email is invalid"):Y.email="Email is required",h.password?h.password.length<6&&(Y.password="Password must be at least 6 characters"):Y.password="Password is required",h.confirmPassword?h.password!==h.confirmPassword&&(Y.confirmPassword="Passwords do not match"):Y.confirmPassword="Please confirm your password",h.cnic.trim()||(Y.cnic="CNIC is required"),h.vehicleType||(Y.vehicleType="Vehicle type is required"),h.vehicleNumber.trim()||(Y.vehicleNumber="Vehicle number is required"),y(Y),Object.keys(Y).length===0},V=async Y=>{if(Y.preventDefault(),N(""),!!P()){R(!0);try{const{confirmPassword:ee,...K}=h,H=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...K,role:"RIDER"})}),q=await H.json();if(!H.ok)throw new Error(q.message||"Signup failed");_("/")}catch(ee){N(ee.message||"An error occurred during signup")}finally{R(!1)}}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#F8F9FA] p-6",children:e.jsxs("form",{onSubmit:V,className:"w-full max-w-md bg-white p-8 rounded-2xl shadow-sm border border-gray-100 space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-secondary mb-6",children:"Sign up as Rider"}),v&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:v}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(ht,{label:"Name",name:"name",value:h.name,onChange:L,error:f.name,required:!0}),f.name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.name})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Email",type:"email",name:"email",value:h.email,onChange:L,error:f.email,required:!0}),f.email&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.email})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Password",type:j?"text":"password",name:"password",value:h.password,onChange:L,error:f.password,required:!0,rightElement:e.jsx("button",{type:"button",onClick:()=>w(Y=>!Y),className:"text-gray-400 hover:text-gray-600","aria-label":j?"Hide password":"Show password",children:j?e.jsx(Qi,{className:"w-4 h-4"}):e.jsx(Ji,{className:"w-4 h-4"})})}),f.password&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.password})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Confirm Password",type:C?"text":"password",name:"confirmPassword",value:h.confirmPassword,onChange:L,error:f.confirmPassword,required:!0,rightElement:e.jsx("button",{type:"button",onClick:()=>O(Y=>!Y),className:"text-gray-400 hover:text-gray-600","aria-label":C?"Hide password":"Show password",children:C?e.jsx(Qi,{className:"w-4 h-4"}):e.jsx(Ji,{className:"w-4 h-4"})})}),f.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.confirmPassword})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"CNIC",name:"cnic",value:h.cnic,onChange:L,placeholder:"#####-#######-#",error:f.cnic,required:!0}),f.cnic&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.cnic})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Vehicle Type"}),e.jsxs("select",{name:"vehicleType",value:h.vehicleType,onChange:L,className:`w-full px-4 py-2.5 rounded-lg border ${f.vehicleType?"border-red-500 focus:ring-red-200":"border-gray-200 focus:border-primary focus:ring-primary/20"} bg-white text-gray-900 focus:outline-none focus:ring-2 transition-all duration-200`,required:!0,children:[e.jsx("option",{value:"",children:"Select vehicle type"}),e.jsx("option",{value:"Bike",children:"Bike"}),e.jsx("option",{value:"Car",children:"Car"}),e.jsx("option",{value:"Van",children:"Van"}),e.jsx("option",{value:"Pickup",children:"Pickup"}),e.jsx("option",{value:"Other",children:"Other"})]}),f.vehicleType&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.vehicleType})]}),e.jsxs("div",{children:[e.jsx(ht,{label:"Vehicle Number / Registration",name:"vehicleNumber",value:h.vehicleNumber,onChange:L,placeholder:"e.g. LEA-1234",error:f.vehicleNumber,required:!0}),f.vehicleNumber&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:f.vehicleNumber})]}),e.jsx("div",{children:e.jsx(ht,{label:"Vehicle Model (optional)",name:"vehicleModel",value:h.vehicleModel,onChange:L,placeholder:"e.g. Honda CD-70 2020",error:f.vehicleModel})}),e.jsx(zt,{type:"submit",fullWidth:!0,className:"mt-2",disabled:A,children:A?"Creating Account...":"Create Account"})]})]})})},Ib=({seconds:h,onComplete:p})=>{const[f,y]=D.useState(h);D.useEffect(()=>{if(f===0){p();return}const N=setTimeout(()=>y(f-1),1e3);return()=>clearTimeout(N)},[f,p]);const v=N=>{const A=Math.floor(N/60),R=N%60;return`${A}:${R<10?"0":""}${R}`};return e.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:["Code expires in: ",e.jsx("span",{className:"font-medium",children:v(f)})]})},Mb=()=>{const[h,p]=D.useState(1),[f,y]=D.useState(""),[v,N]=D.useState(""),[A,R]=D.useState(""),[j,w]=D.useState(""),[C,O]=D.useState(null),[_,L]=D.useState(!1),[P,V]=D.useState(!1),[Y,ee]=D.useState(""),K=As(),H=async Ee=>{Ee.preventDefault(),O(null),L(!0);try{const me=await fetch("/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f})}),ne=await me.json().catch(()=>({}));if(!me.ok)throw new Error(ne.message||"Failed to send verification code");O({ok:!0,message:"Verification code sent to your email"}),p(2),V(!0)}catch(me){O({ok:!1,message:me.message||"Failed to send verification code"})}finally{L(!1)}},q=async Ee=>{Ee.preventDefault(),O(null),L(!0);try{const me=await fetch("/api/auth/verify-reset-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f,code:v})}),ne=await me.json().catch(()=>({}));if(!me.ok)throw new Error(ne.message||"Invalid verification code");ee(ne.resetToken),O({ok:!0,message:"Code verified. Please set a new password."}),p(3)}catch(me){O({ok:!1,message:me.message})}finally{L(!1)}},te=async Ee=>{if(Ee.preventDefault(),A!==j){O({ok:!1,message:"Passwords do not match"});return}if(A.length<6){O({ok:!1,message:"Password must be at least 6 characters"});return}O(null),L(!0);try{const me=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:Y,password:A,confirmPassword:j})}),ne=await me.json().catch(()=>({}));if(!me.ok)throw new Error(ne.message||"Failed to reset password");O({ok:!0,message:"Password reset successfully! Redirecting to login..."}),setTimeout(()=>K("/"),2e3)}catch(me){O({ok:!1,message:me.message})}finally{L(!1)}},ce=()=>{O(null),N(""),H(new Event("submit"))},$=()=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Reset your password"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Enter the email address associated with your account and we'll send you a verification code."}),e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[e.jsx(ht,{label:"Email",type:"email",value:f,onChange:Ee=>y(Ee.target.value),placeholder:"Enter your email address",required:!0}),e.jsx(zt,{type:"submit",fullWidth:!0,disabled:_,className:"mt-4",children:_?"Sending...":"Send Verification Code"})]})]}),Re=()=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Enter Verification Code"}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["We've sent a 6-digit code to ",e.jsx("span",{className:"font-medium",children:f}),". Please enter it below to verify your identity."]}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Verification Code"}),e.jsx("input",{type:"text",value:v,onChange:Ee=>N(Ee.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"Enter 6-digit code",required:!0,maxLength:6,inputMode:"numeric",pattern:"[0-9]*",className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 focus:border-primary focus:ring-2 focus:ring-primary/20 bg-white text-gray-900 placeholder-gray-400 focus:outline-none transition-all duration-200"})]}),P&&e.jsx(Ib,{seconds:600,onComplete:()=>V(!1)}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("button",{type:"button",onClick:ce,className:"text-sm text-blue-600 hover:text-blue-800 disabled:opacity-50",disabled:P||_,children:"Resend Code"}),!P&&e.jsx("span",{className:"text-sm text-gray-500",children:"Didn't receive a code? Try again"})]}),e.jsx(zt,{type:"submit",fullWidth:!0,disabled:_||v.length!==6,className:"mt-4",children:_?"Verifying...":"Verify Code"})]})]}),oe=()=>e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create New Password"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Please create a new password for your account."}),e.jsxs("form",{onSubmit:te,className:"space-y-4",children:[e.jsx(ht,{label:"New Password",type:"password",value:A,onChange:Ee=>R(Ee.target.value),placeholder:"Enter new password",required:!0,minLength:6}),e.jsx(ht,{label:"Confirm New Password",type:"password",value:j,onChange:Ee=>w(Ee.target.value),placeholder:"Confirm new password",required:!0,minLength:6}),e.jsx(zt,{type:"submit",fullWidth:!0,disabled:_||!A||A!==j,className:"mt-4",children:_?"Resetting...":"Reset Password"})]})]});return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:e.jsxs("div",{className:"w-full max-w-md bg-white p-8 rounded-xl shadow-sm border border-gray-100",children:[C&&e.jsx("div",{className:`p-3 mb-6 rounded-lg text-sm ${C.ok?"bg-green-50 text-green-700 border border-green-100":"bg-red-50 text-red-700 border border-red-100"}`,children:C.message}),h>1&&h<3&&e.jsxs("button",{onClick:()=>p(h-1),className:"flex items-center text-sm text-gray-500 hover:text-gray-700 mb-4",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back"]}),h===1&&$(),h===2&&Re(),h===3&&oe()]})})};function kb(){return new URLSearchParams(Ga().search)}const Bb=()=>{const p=kb().get("token")||"",[f,y]=D.useState(""),[v,N]=D.useState(""),[A,R]=D.useState(null),[j,w]=D.useState(!1),C=As();D.useEffect(()=>{p||R({ok:!1,message:"Missing token. Use the link from your email."})},[p]);const O=async _=>{if(_.preventDefault(),R(null),f.length<6)return R({ok:!1,message:"Password too short (min 6 chars)"});if(f!==v)return R({ok:!1,message:"Passwords do not match"});w(!0);try{const L=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:p,password:f})}),P=await L.json().catch(()=>({}));if(!L.ok)throw new Error(P.message||"Reset failed");R({ok:!0,message:"Password reset successfully. Redirecting to login..."}),setTimeout(()=>C("/"),2500)}catch(L){R({ok:!1,message:L.message})}finally{w(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-6",children:e.jsxs("div",{className:"w-full max-w-md bg-white p-8 rounded shadow",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Choose a new password"}),A&&e.jsx("div",{className:`p-3 mb-4 rounded ${A.ok?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:A.message}),e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsx(ht,{label:"New password",type:"password",value:f,onChange:_=>y(_.target.value),required:!0}),e.jsx(ht,{label:"Confirm password",type:"password",value:v,onChange:_=>N(_.target.value),required:!0}),e.jsx(zt,{type:"submit",fullWidth:!0,disabled:j||!p,children:j?"Resetting...":"Reset password"})]})]})})},Ox=()=>{const[h,p]=D.useState(null),[f,y]=D.useState(""),[v,N]=D.useState(!1),{user:A}=Fs(),R=(A==null?void 0:A.token)||Xs(),j=async O=>{if(!O||!O.trim()){y("Please enter or scan a booking ID");return}N(!0),y(""),p(null);try{const _=await fetch("/api/orders/scan",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${R}`},body:JSON.stringify({bookingId:O.trim()})}),L=await _.json();if(!_.ok)throw new Error(L.message||"Failed to scan order");p(L.order)}catch(_){y(_.message),p(null)}finally{N(!1)}},w=O=>{j(O)},C=O=>{y(O)};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ii,{className:"w-6 h-6 text-primary"}),e.jsx("h3",{className:"text-lg font-bold text-secondary",children:"LLL Warehouse Scanner"})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Scan QR code from order label to mark order as arrived at LLL warehouse"})]}),e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsx(Bc,{onScan:w,onError:C})}),v&&e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-600",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Processing scan..."})]})}),f&&e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"p-4 bg-red-50 border border-red-100 text-red-600 rounded-lg flex items-center gap-2",children:[e.jsx(xn,{className:"w-5 h-5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Scan Failed"}),e.jsx("p",{className:"text-sm",children:f})]})]})}),h&&e.jsx("div",{className:"bg-white p-6 rounded-xl border border-gray-100 shadow-sm",children:e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-700 mb-3",children:[e.jsx(Yn,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-semibold text-lg",children:["Order ",h.bookingId," marked as Arrived at LLL Warehouse"]})]}),e.jsx("div",{className:"text-sm text-gray-700 space-y-2 bg-white p-3 rounded border border-green-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Order ID:"}),e.jsx("span",{className:"font-mono ml-2",children:h.bookingId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Status:"}),e.jsx("span",{className:"ml-2 px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-semibold",children:h.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Consignee:"}),e.jsx("span",{className:"ml-2",children:h.consigneeName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-500",children:"City:"}),e.jsx("span",{className:"ml-2",children:h.destinationCity})]}),h.shipper&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Shipper:"}),e.jsx("span",{className:"ml-2",children:h.shipper.name||h.shipper.email})]})]})})]})})]})},Lb=()=>{const{login:h}=Fs(),p=Ga(),f=As();return fn.useEffect(()=>{const y=new URLSearchParams(p.search),v=y.get("token"),N=y.get("role"),A=y.get("name"),R=y.get("email"),j=y.get("id");if(v){h({token:v,role:N,name:A,email:R,id:j}),y.delete("token"),y.delete("role"),y.delete("name"),y.delete("email"),y.delete("id");const C=window.location.pathname+(y.toString()?`?${y.toString()}`:"");window.history.replaceState({},document.title,C),f(N==="CEO"?"/dashboard/ceo":N==="MANAGER"?"/manager/dashboard":N==="SHIPPER"?"/shipper/dashboard":"/rider/dashboard")}else f("/")},[p,h,f]),e.jsx("div",{children:"Authenticating..."})},Pb=()=>{const{user:h}=Fs(),p=({children:f})=>{if(h){const y=h.role==="CEO"?"/dashboard/ceo":h.role==="MANAGER"?"/manager/dashboard":h.role==="SHIPPER"?"/shipper/dashboard":"/rider/dashboard";return e.jsx(Ki,{to:y,replace:!0})}return f};return e.jsxs(jp,{children:[e.jsx(gt,{path:"/auth/callback",element:e.jsx(Lb,{})}),e.jsx(gt,{path:"/",element:e.jsx(p,{children:e.jsx(dy,{})})}),e.jsx(gt,{path:"/signup/shipper",element:e.jsx(p,{children:e.jsx(Db,{})})}),e.jsx(gt,{path:"/signup/rider",element:e.jsx(p,{children:e.jsx(_b,{})})}),e.jsx(gt,{path:"/forgot-password",element:e.jsx(p,{children:e.jsx(Mb,{})})}),e.jsx(gt,{path:"/reset-password",element:e.jsx(p,{children:e.jsx(Bb,{})})}),e.jsx(gt,{path:"/dashboard/ceo",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(my,{})})}),e.jsx(gt,{path:"/ceo/users",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(gy,{})})}),e.jsx(gt,{path:"/ceo/orders",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(py,{})})}),e.jsx(gt,{path:"/ceo/integrated-orders",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(yy,{})})}),e.jsx(gt,{path:"/ceo/orders/:id",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(lb,{})})}),e.jsx(gt,{path:"/ceo/commission",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(ox,{})})}),e.jsx(gt,{path:"/ceo/finance/riders",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(lx,{})})}),e.jsx(gt,{path:"/ceo/finance/company",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(vy,{})})}),e.jsx(gt,{path:"/ceo/finance/invoice",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(dx,{})})}),e.jsx(gt,{path:"/ceo/logistics",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(by,{})})}),e.jsx(gt,{path:"/ceo/company-profile",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(wy,{})})}),e.jsx(gt,{path:"/ceo/warehouse-scan",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(ix,{})})}),e.jsx(gt,{path:"/ceo/scanner",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(Ox,{})})}),e.jsx(gt,{path:"/ceo/assign-scan",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(Qy,{})})}),e.jsx(gt,{path:"/ceo/riders",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(Jy,{})})}),e.jsx(gt,{path:"/ceo/riders/:id/settlements",element:e.jsx(Et,{allowedRoles:["CEO"],children:e.jsx(eb,{})})}),e.jsx(gt,{path:"/manager/dashboard",element:e.jsx(Et,{allowedRoles:["MANAGER"],children:e.jsx(tb,{})})}),e.jsx(gt,{path:"/manager/orders",element:e.jsx(Et,{allowedRoles:["MANAGER"],children:e.jsx(sb,{})})}),e.jsx(gt,{path:"/manager/riders",element:e.jsx(Et,{allowedRoles:["MANAGER"],children:e.jsx(lx,{})})}),e.jsx(gt,{path:"/manager/commission",element:e.jsx(Et,{allowedRoles:["MANAGER"],children:e.jsx(ox,{})})}),e.jsx(gt,{path:"/manager/finance/invoice",element:e.jsx(Et,{allowedRoles:["MANAGER"],children:e.jsx(dx,{})})}),e.jsx(gt,{path:"/manager/logistics",element:e.jsx(Et,{allowedRoles:["MANAGER"],children:e.jsx(nb,{})})}),e.jsx(gt,{path:"/manager/warehouse-scan",element:e.jsx(Et,{allowedRoles:["MANAGER"],children:e.jsx(ix,{})})}),e.jsx(gt,{path:"/invoice-print/:id",element:e.jsx(Et,{allowedRoles:["MANAGER","CEO"],noLayout:!0,children:e.jsx(ib,{})})}),e.jsx(gt,{path:"/manager/scanner",element:e.jsx(Et,{allowedRoles:["MANAGER"],children:e.jsx(Ox,{})})}),e.jsx(gt,{path:"/shipper/dashboard",element:e.jsx(Et,{allowedRoles:["SHIPPER"],children:e.jsx(Uu,{})})}),e.jsx(gt,{path:"/shipper/orders",element:e.jsx(Et,{allowedRoles:["SHIPPER"],children:e.jsx(Uu,{})})}),e.jsx(gt,{path:"/shipper/create",element:e.jsx(Et,{allowedRoles:["SHIPPER"],children:e.jsx(Uu,{})})}),e.jsx(gt,{path:"/shipper/orders/:id",element:e.jsx(Et,{allowedRoles:["SHIPPER"],children:e.jsx(ux,{})})}),e.jsx(gt,{path:"/shipper/order/:id",element:e.jsx(Et,{allowedRoles:["SHIPPER"],children:e.jsx(ux,{})})}),e.jsx(gt,{path:"/shipper/integrations",element:e.jsx(Et,{allowedRoles:["SHIPPER"],children:e.jsx(ob,{})})}),e.jsx(gt,{path:"/shipper/integrated-orders",element:e.jsx(Et,{allowedRoles:["SHIPPER"],children:e.jsx(cb,{})})}),e.jsx(gt,{path:"/shipper/finance",element:e.jsx(Et,{allowedRoles:["SHIPPER"],children:e.jsx(ub,{})})}),e.jsx(gt,{path:"/pending-approval",element:e.jsx(Et,{allowedRoles:["SHIPPER"],noLayout:!0,children:e.jsx(fx,{})})}),e.jsx(gt,{path:"/shipper/pending-approval",element:e.jsx(Et,{allowedRoles:["SHIPPER"],noLayout:!0,children:e.jsx(fx,{})})}),e.jsx(gt,{path:"/label-print/:id",element:e.jsx(Et,{allowedRoles:["SHIPPER"],noLayout:!0,children:e.jsx(jb,{})})}),e.jsx(gt,{path:"/rider/dashboard",element:e.jsx(Et,{allowedRoles:["RIDER"],children:e.jsx(Cb,{})})}),e.jsx(gt,{path:"/rider/history",element:e.jsx(Et,{allowedRoles:["RIDER"],children:e.jsx(Ab,{})})}),e.jsx(gt,{path:"/rider/task/:id",element:e.jsx(Et,{allowedRoles:["RIDER"],children:e.jsx(Eb,{})})}),e.jsx(gt,{path:"/rider/scan",element:e.jsx(Et,{allowedRoles:["RIDER"],children:e.jsx(Sb,{})})}),e.jsx(gt,{path:"/rider/finance",element:e.jsx(Et,{allowedRoles:["RIDER"],children:e.jsx(Ob,{})})}),e.jsx(gt,{path:"*",element:h?e.jsx(Ki,{to:h.role==="CEO"?"/dashboard/ceo":h.role==="MANAGER"?"/manager/dashboard":h.role==="SHIPPER"?"/shipper/dashboard":"/rider/dashboard",replace:!0}):e.jsx(Ki,{to:"/",replace:!0})})]})},Fb=()=>e.jsx(Op,{children:e.jsx(kp,{children:e.jsx(cy,{children:e.jsx(Pb,{})})})}),am=document.getElementById("root");if(!am)throw new Error("Could not find root element to mount to");const Ub=Dg.createRoot(am);Ub.render(e.jsx(fn.StrictMode,{children:e.jsx(Fb,{})}));
